/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray(e,a){return _arrayWithHoles(e)||_iterableToArrayLimit(e,a)||_unsupportedIterableToArray(e,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,a){if(e){if("string"==typeof e)return _arrayLikeToArray(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,a):void 0}}function _arrayLikeToArray(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,r=new Array(a);t<a;t++)r[t]=e[t];return r}function _iterableToArrayLimit(e,a){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,l,o=[],i=!0,n=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!a||o.length!==a);i=!0);}catch(d){n=!0,l=d}finally{try{i||null==t["return"]||t["return"]()}finally{if(n)throw l}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var arrExpFunctions=["getstockvalue","getcostrate","getclosingstock","checkstock","domrp"],saveActRecSuccess=!1,AxActionSave=!1,iViewRefresh=!1;WrkflFlag=!1;var axFramReload=!1,isMobile=isMobileDevice(),fldChangeDttype=!1;function CheckExpFunctions(e){for(var a=!1,t=0;t<arrExpFunctions.length;t++)if(-1!=e.indexOf(arrExpFunctions[t].toLowerCase())){a=!0;break}return a}function EvaluateAxFunction(e,a,t){var r=AxActiveRowNo,l=AxActivePRow,o=AxActiveDc,i=AxActivePDc,n=FldOldValue,d=GetFldNamesIndx(e),s="",c="";if(-1!=d&&(s=GetExpressionType(e,d),c=Expressions[d].toString()),CheckExpFunctions(c.toLowerCase()))GetDependents(a,"");else{var p=GetFieldGridType(a),f=e,m=GetDcNo(f);if(-1!=d&&""!=c){var u="";if("NG"==s&&"NG"==p)"axpattachmentpath"==f?(f=f+"000F"+m,"username"==(u=c.substring(1,c.length-1))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(f,u)):"username"==(u=EvalPrepared(f=f+"000F"+m,"000",c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(f,u);else if("NG"==s&&"GR"==p){"username"==(u=EvalPrepared(f=f+(v=GetClientRowNo(AxActiveRowNo,m))+"F"+m,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(f,u)}else if("GR"!=s&&"PG"!=s||"NG"!=p){if("GR"==s&&"GR"==p){var v=GetClientRowNo(AxActiveRowNo,AxActiveDc),w=GetDcNo(f);if(AxActiveDc!=w){D=0;D=parseInt(GetDcRowCount(w),10);for(C=1;C<=D;C++){S=GetClientRowNo(C,w);AxActiveRowNo=GetDbRowNo(S,w);y=f+S+"F"+w;"username"==(u=Evaluate(y,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(y,u)}}else{var h=f;if("username"==(u=(f=f+v+"F"+AxActiveDc).indexOf("_referimages")>-1||f.indexOf("dc"+w+"_image")>-1||f.indexOf("dc"+w+"_imagepath")>-1?GetReferExpr(f,v,c):Evaluate(f,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(f,u),AxActiveDc==w&&isSumTillGrid){isSumTillGrid=!1;var g=parseInt(AxActiveRowNo)+1;D=0;D=parseInt(GetDcRowCount(w),10);for(C=g;C<=D;C++){S=GetClientRowNo(C,w);AxActiveRowNo=GetDbRowNo(S,w);y=h+S+"F"+w;"username"==(u=Evaluate(y,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(y,u)}}}}else if("PG"==s&&"PG"==p){"username"==(u=EvalPrepared(f=f+(v=GetClientRowNo(AxActiveRowNo,AxActiveDc))+"F"+AxActiveDc,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(f,u)}else if("PG"==s&&"GR"==p){var A=GetFieldsDcNo(a);AxActivePRow=AxActiveRowNo,AxActiveDc=m,AxActivePDc=A;var x=GetClientRowNo(AxActivePRow,AxActivePDc),b=GetPopRows(AxActivePDc,x,AxActiveDc).split(","),N=f;for(C=0;C<b.length;C++)""!=b[0]&&(AxActiveRowNo=GetDbRowNo(b[C],AxActiveDc),"username"==(u=EvalPrepared(f=N+b[C]+"F"+m,b[C].toString(),c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(f,u))}else if("GR"==s&&"PG"==p){m!=(A=GetFieldsDcNo(a))&&(AxActiveRowNo=AxActivePRow,AxActiveDc=m);var F=GetClientRowNo(AxActiveRowNo,AxActiveDc);"username"==(u=EvalPrepared(f=f+F+"F"+AxActiveDc,F,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(f,u)}}else{var D=0;D=parseInt(GetDcRowCount(m),10);for(var C=1;C<=D;C++){var y,S=GetRowNoHelper(C);AxActiveRowNo=GetDbRowNo(S,m),"username"==(u=EvalPrepared(y=f+S+"F"+m,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(y,u)}}isSumTillGrid!=undefined&&(isSumTillGrid=!1),AxActiveRowNo=r,AxActivePRow=l,AxActiveDc=o,AxActivePDc=i,FldOldValue=n}}}function EvaluateAxFunctionPerf(e,a,t){var r=AxActiveRowNo,l=AxActivePRow,o=AxActiveDc,i=AxActivePDc,n=FldOldValue,d=GetFldNamesIndx(e),s="",c="";if(-1!=d&&(s=GetExpressionType(e,d),c=Expressions[d].toString()),CheckExpFunctions(c.toLowerCase()))GetDependents(a,"");else{var p=GetFieldGridType(a),f=e,m=GetDcNo(f);if(-1!=d&&""!=c){var u="";if("NG"==s&&"NG"==p)"axpattachmentpath"==f?(f=f+"000F"+m,"username"==(u=c.substring(1,c.length-1))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(f,u)):"username"==(u=EvalPrepared(f=f+"000F"+m,"000",c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(f,u);else if("NG"==s&&"GR"==p){"username"==(u=EvalPrepared(f=f+(v=GetClientRowNo(AxActiveRowNo,m))+"F"+m,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(f,u)}else if("GR"!=s&&"PG"!=s||"NG"!=p){if("GR"==s&&"GR"==p){var v=GetClientRowNo(AxActiveRowNo,AxActiveDc),w=GetDcNo(f);if(AxActiveDc!=w){D=0;D=parseInt(GetDcRowCount(w),10);for(C=1;C<=D;C++){S=GetClientRowNo(C,w);AxActiveRowNo=GetDbRowNo(S,w);y=f+S+"F"+w;"username"==(u=Evaluate(y,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(y,u)}}else{var h=f;if("username"==(u=(f=f+v+"F"+AxActiveDc).indexOf("_referimages")>-1||f.indexOf("dc"+w+"_image")>-1||f.indexOf("dc"+w+"_imagepath")>-1?GetReferExpr(f,v,c):Evaluate(f,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(f,u),AxActiveDc==w&&isSumTillGrid){isSumTillGrid=!1;var g=parseInt(AxActiveRowNo)+1;D=0;D=parseInt(GetDcRowCount(w),10);for(C=g;C<=D;C++){S=GetClientRowNo(C,w);AxActiveRowNo=GetDbRowNo(S,w);y=h+S+"F"+w;"username"==(u=Evaluate(y,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(y,u)}}}}else if("PG"==s&&"PG"==p){"username"==(u=EvalPrepared(f=f+(v=GetClientRowNo(AxActiveRowNo,AxActiveDc))+"F"+AxActiveDc,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(f,u)}else if("PG"==s&&"GR"==p){var A=GetFieldsDcNo(a);AxActivePRow=AxActiveRowNo,AxActiveDc=m,AxActivePDc=A;var x=GetClientRowNo(AxActivePRow,AxActivePDc),b=GetPopRows(AxActivePDc,x,AxActiveDc).split(","),N=f;for(C=0;C<b.length;C++)""!=b[0]&&(AxActiveRowNo=GetDbRowNo(b[C],AxActiveDc),"username"==(u=EvalPrepared(f=N+b[C]+"F"+m,b[C].toString(),c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(f,u))}else if("GR"==s&&"PG"==p){m!=(A=GetFieldsDcNo(a))&&(AxActiveRowNo=AxActivePRow,AxActiveDc=m);var F=GetClientRowNo(AxActiveRowNo,AxActiveDc);"username"==(u=EvalPrepared(f=f+F+"F"+AxActiveDc,F,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(f,u)}}else{var D=0;D=parseInt(GetDcRowCount(m),10);for(var C=1;C<=D;C++){var y,S=GetRowNoHelper(C);AxActiveRowNo=GetDbRowNo(S,m),"username"==(u=EvalPrepared(y=f+S+"F"+m,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(y,u)}}isSumTillGrid!=undefined&&(isSumTillGrid=!1),AxActiveRowNo=r,AxActivePRow=l,AxActiveDc=o,AxActivePDc=i,FldOldValue=n}}}function GetFldNamesIndx(e){for(var a=-1,t=0;t<ExpFldNames.length;t++){if(ExpFldNames[t].split(".")[1]==e){a=t;break}}return a}function GetExpressionType(e,a){var t=ExpFldNames[a].split(".")[2].substring(1);return IsDcPopGrid(t)?"PG":IsDcGrid(t)?"GR":"NG"}function GetFieldGridType(e){var a=GetFieldsDcNo(e);return IsDcPopGrid(a)?"PG":IsDcGrid(a)?"GR":"NG"}function Assignfldval(e,a){if("MessageSetAxFont"!=a){var t="",r=$j("#"+e);if(r.length>0){if("***"==r[0].value)return;$j("#"+("img~"+e)).length>0&&(isFocusFrmPickList=!0);var l=GetFieldsName(e),o=GetFieldsRowNo(e),i=GetFieldsDcNo(e),n=GetDbRowNo(o,i);TstructHasPop&&IsParentField(l,i)&&UpdatePopUpParents(e);for(var d=0,s=0;s<FNames.length;s++)if(FNames[s]==l){d=FDecimal[s],t=FDataType[s];break}"numeric"==t.toLowerCase()?(a=fixit(a,d),UpdateFieldArray(e,n,a,"parent",""),a=CommaFormatted(fixit(a,d)),CallSetFieldValue(e,a)):"text"==r[0].type||"hidden"==r[0].type?("''"==a&&(a=""),a||(a=""),"Date/Time"==t&&0==a&&(a=""),UpdateFieldArray(e,n,a,"parent",""),CallSetFieldValue(e,a)):("character"==t.toLowerCase()&&(a=a.toString()),UpdateFieldArray(e,n,a,"parent",""),CallSetFieldValue(e,a)),-1!=l.indexOf("axpvalid")&&DoFormControlPrivilege(e,a),-1!=e.indexOf("axpcurrencydec")&&UpdateAxpCurrDec(a,"GetDep")}}}function AssignfldvalPerf(e,a){if("MessageSetAxFont"!=a){var t="",r=GetFieldsName(e),l=GetFieldsRowNo(e),o=GetFieldsDcNo(e),i=GetDbRowNo(l,o);TstructHasPop&&IsParentField(r,o)&&UpdatePopUpParents(e);for(var n=0,d=0;d<FNames.length;d++)if(FNames[d]==r){n=FDecimal[d],t=FDataType[d];break}"numeric"==t.toLowerCase()?(a=fixit(a,n),UpdateFieldArray(e,i,a,"parent",""),a=CommaFormatted(fixit(a,n)),CallSetFieldValue(e,a)):"Date/Time"==t?(0==a&&(a=""),UpdateFieldArray(e,i,a,"parent",""),CallSetFieldValue(e,a)):("character"==t.toLowerCase()&&(a=a.toString()),UpdateFieldArray(e,i,a,"parent",""),CallSetFieldValue(e,a)),-1!=r.indexOf("axpvalid")&&DoFormControlPrivilege(e,a),-1!=e.indexOf("axpcurrencydec")&&UpdateAxpCurrDec(a,"GetDep")}}function CallFileUploadAction(actionName,Title,ftype,confirmmsg){if(confirmmsg&&""!=confirmmsg){var glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var CallFileUploadActionCB=$.confirm({title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:"false",rtl:isRTL,escapeKey:"buttonB",content:confirmmsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){CallFileUploadActionCB.close(),CallFileUploadActionAfterConfirm()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy")}}}})}function CallFileUploadActionAfterConfirm(){Title="File Upload",gActionname=actionName,gConfirmmsg=confirmmsg,displayBootstrapModalDialog("File Upload","xs","147px",!0,"./fileupload.aspx?act=upload")}CallFileUploadActionCB===undefined&&CallFileUploadActionAfterConfirm()}function CallAfterFileUploadAction(){var e=$j("#cb_sactbu").val();CallAction(gActionname,e,gConfirmmsg)}function GetCancelRemarks(e,a,t){ShowPrompt(e,a,t,!0)}function ShowPrompt(actionName,fileup,manRemarks,isRemarksEntered){var msgStatus=!0,i=0;try{var AxHeader=AxBeforeShowPrompt()}catch(ex){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"})}var cutMsg=eval(callParent("lcm[38]")),cutMsgEnter=eval(callParent("lcm[39]")),cutMsgChar=eval(callParent("lcm[40]"));$j.msgBox({type:"prompt",title:"Remarks",inputs:[0==isRemarksEntered?{header:cutMsg,type:"label",name:""}:{},AxHeader==undefined?{header:cutMsgEnter,type:"textarea",name:"remark"}:{header:AxHeader,type:"textarea",name:"remark"},{header:cutMsgChar,type:"readonly",value:"150"}],buttons:[{value:"Ok"},{value:"Close"}],afterClose:function(){msgStatus||ShowPrompt(actionName,fileup,manRemarks,!1)},success:function(e,a){"Ok"==e?""==a[0].value&&"y"==manRemarks?msgStatus=!1:(CallActionExt(actionName,fileup,a[0].value),msgStatus=!0):(actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),EnableToolBarBtns())}}),isWizardTstruct&&$j(".msgBox").css("z-index","999"),ShowDimmer(!1)}function EnableToolBarBtns(){$j("#icons").length>0&&$j("#icons").prop("disabled")&&$j("#icons").prop("disabled",!1)}function CheckDisabledActionBtn(e){var a=!1;return $j(".action").each(function(){var t=$j(this).html().toLowerCase(),r=t.substring(t.indexOf("callaction")+11).indexOf("&quot;"+e+"&quot;");if(-1==r&&(r=t.substring(t.indexOf("callaction")+11).indexOf('"'+e+'"')),-1!=r&&"disabled"==$j(this).attr("disabled"))return a=!0,!1}),a}function CallAction(e,a,t,r,l,o){try{if(""!=window.frameElement.contentWindow.jQuery("#form1").attr("action")&&window.frameElement.contentWindow.jQuery("#form1").attr("action").indexOf("&actionflg=change")>-1&&window.frameElement.contentWindow.jQuery("#form1").attr("action").indexOf("&transid=paget")>-1){var i=window.frameElement.contentWindow.jQuery("#form1").attr("action"),n=decodeURI(i).split("?")[1].split("&").map(function(e){return e.split("=")}).reduce(function(e,a){var t=_slicedToArray(a,2),r=t[0],l=t[1];return"stransid"!=r.toLowerCase()&&"fldname"!=r.toLowerCase()&&"flddcno"!=r.toLowerCase()&&"dbdatatype"!=r.toLowerCase()||(e[r]=l),e},{});if(changedFieldDatatype(n.stransid,n.flddcno,n.fldname,n.dbdatatype),fldChangeDttype){if(fldChangeDttype=!1,"Character"==n.dbdatatype&&("addwholenumber"==e||"adddecimalnumb"==e||"adddate"==e||"addtime"==e||"addmobilenumber"==e||"addphonenumber"==e||"addcurrency"==e||"addpincode"==e||"addzipcode"==e||"addrandomnumber"==e||"adddc"==e||"genmap"==e||"fillg"==e||"mdmaps"==e||"actions"==e||"addimage"==e||"addrichtext"==e))return void showAlertDialog("error","Data already exists in transaction table, can not change datatype. If you want to change datatype, needs to take backup of the table and delete the data from concerned column.");if("Numeric"==n.dbdatatype&&("adddate"==e||"addtime"==e||"adddc"==e||"genmap"==e||"fillg"==e||"mdmaps"==e||"actions"==e||"addimage"==e||"addrichtext"==e||"addshorttext"==e||"addsimpletext"==e||"addlargetext"==e||"addautogenerate"==e||"dropdwnlist"==e||"addmultiselect"==e||"addchecklist"==e||"addcheckbox"==e||"addradiogroup"==e||"addemail"==e||"addurl"==e||"addipaddress"==e||"addpassword"==e||"addtable"==e))return void showAlertDialog("error","Data already exists in transaction table, can not change datatype. If you want to change datatype, needs to take backup of the table and delete the data from concerned column.");if("Date%2fTime"==n.dbdatatype&&("adddc"==e||"genmap"==e||"fillg"==e||"mdmaps"==e||"actions"==e||"addimage"==e||"addrichtext"==e||"addshorttext"==e||"addsimpletext"==e||"addlargetext"==e||"addautogenerate"==e||"dropdwnlist"==e||"addmultiselect"==e||"addchecklist"==e||"addcheckbox"==e||"addradiogroup"==e||"addemail"==e||"addurl"==e||"addipaddress"==e||"addpassword"==e||"addtable"==e||"addwholenumber"==e||"adddecimalnumb"==e||"addmobilenumber"==e||"addphonenumber"==e||"addcurrency"==e||"addpincode"==e||"addzipcode"==e||"addrandomnumber"==e))return void showAlertDialog("error","Data already exists in transaction table, can not change datatype. If you want to change datatype, needs to take backup of the table and delete the data from concerned column.");if("Image"==n.dbdatatype&&("adddc"==e||"genmap"==e||"fillg"==e||"mdmaps"==e||"actions"==e||"addrichtext"==e||"adddate"==e||"addtime"==e||"addshorttext"==e||"addsimpletext"==e||"addlargetext"==e||"addautogenerate"==e||"dropdwnlist"==e||"addmultiselect"==e||"addchecklist"==e||"addcheckbox"==e||"addradiogroup"==e||"addemail"==e||"addurl"==e||"addipaddress"==e||"addpassword"==e||"addtable"==e||"addwholenumber"==e||"adddecimalnumb"==e||"adddate"==e||"addtime"==e||"addmobilenumber"==e||"addphonenumber"==e||"addcurrency"==e||"addpincode"==e||"addzipcode"==e||"addrandomnumber"==e))return void showAlertDialog("error","Data already exists in transaction table, can not change datatype. If you want to change datatype, needs to take backup of the table and delete the data from concerned column.");if("Text"==n.dbdatatype&&("adddc"==e||"genmap"==e||"fillg"==e||"mdmaps"==e||"actions"==e||"addimage"==e||"adddate"==e||"addtime"==e||"addshorttext"==e||"addsimpletext"==e||"addlargetext"==e||"addautogenerate"==e||"dropdwnlist"==e||"addmultiselect"==e||"addchecklist"==e||"addcheckbox"==e||"addradiogroup"==e||"addemail"==e||"addurl"==e||"addipaddress"==e||"addpassword"==e||"addtable"==e||"addwholenumber"==e||"adddecimalnumb"==e||"adddate"==e||"addtime"==e||"addmobilenumber"==e||"addphonenumber"==e||"addcurrency"==e||"addpincode"==e||"addzipcode"==e||"addrandomnumber"==e))return void showAlertDialog("error","Data already exists in transaction table, can not change datatype. If you want to change datatype, needs to take backup of the table and delete the data from concerned column.")}}}catch(p){}if(actionCallFlag==actionCallbackFlag){if(actionCallFlag=Math.random(),$("#icons,#btnSaveTst").css({"pointer-events":"auto"}),$j("#hdnActionName").val(e),o==undefined&&(o=""),AxActiveAction=e,CheckDisabledActionBtn(e)||AxIsTstructLocked)return actionCallbackFlag=actionCallFlag,void $("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"});if(ShowDimmer(!0),"readivdef"==AxActiveAction||"deleteivdef"==AxActiveAction||"saveasivdef"==AxActiveAction){ShowDimmer(!1);var d="deleteivdef"==AxActiveAction?"Deleting iview structure and tables..":"Creating iview structure..";callParentNew("StructLoader("+d+")","function")}""!=currentCK&&ShowdivContentCK($("#"+currentCK),!1);var s=!0;try{s=AxBeforeCallAction(e)}catch(p){}if(s==undefined&&(s=!0),s&&"iSave"==e&&""!=$j("#recordid000F0").val()&&"0"!=$j("#recordid000F0").val()&&"T"==saveValueFlag&&$j("#savevale000F1").length>0&&"F"==$j("#savevale000F1").val()){var c=$("#name000F1").val();if(!confirm("SaveValue of "+c+" has been changed to false. Field value could not be saved in DcTable."))return EnableToolBarBtns(),actionCallbackFlag=actionCallFlag,ShowDimmer(!1),AxWaitCursor(!1),void $("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"})}if(s){if("y"==r){if("0"==$j("#recordid000F0").val())return showAlertDialog("warning",2009,"client"),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),void ShowDimmer(!1);if("cancelled"==tstructCancelled.toLowerCase())return showAlertDialog("error",2024,"client"),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),void ShowDimmer(!1);if(!AxAllowCancel)return actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),ShowDimmer(!1),showAlertDialog("error",2025,"client")}if($j("#icons").length>0&&$j("#icons").prop("disabled"))return actionCallbackFlag=actionCallFlag,void $("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"});if($j("#icons").length>0&&$j("#icons").prop("disabled",!0),t==undefined&&(t=""),""!=t&&!confrm&&!confirm(t))return EnableToolBarBtns(),actionCallbackFlag=actionCallFlag,ShowDimmer(!1),AxWaitCursor(!1),void $("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"});"y"==r?(GetCancelRemarks(e,a,l),ShowDimmer(!1)):CallActionExt(e,a,"",o)}}else $("#icons,#btnSaveTst").css({"pointer-events":"none"})}function CallActionExt(e,a,t,r){var l,o,i=$j("#recordid000F0").val();ArrActionLog="CallAction-"+e+"Recordid-"+i,AxWaitCursor(!0);var n="";if(""!=a&&a!=undefined)if(":"==a.substring(0,1)){var d=a.substring(1,a.length);if(1==IsGridField(d));else n=$j("#"+(d+"000F0")).val()}else n=a.toString();var s,c=transid,p="",f=(i=$j("#recordid000F0").val(),0),m=0,u=e;if(-1!=e.indexOf("_")&&(-1!=$j.inArray(GetFieldsName(e),FNames)&&(s=e.lastIndexOf("_"),e=e.substring(s+1)),-1!=e.indexOf("F"))){m=parseInt(GetActiveRow(u),10)+1;var v=e.lastIndexOf("F");f=parseInt(e.toString().substring(v+1)),e=e.substring(0,v-3)}var w=traceSplitStr+"Action-"+e+traceSplitChar,h="";if(""!=n){var g=(h=n).lastIndexOf("\\");-1!=g&&(h=h.substring(g+1))}var A=GetOpenTabDcs(),x=UploadFiles(),b=GetDeletedRows(),N=GetChangedRows(),F="";t!=undefined&&(F="<cancelremarks>"+(t=CheckSpecialCharsInXml(t))+"</cancelremarks>"),p=p+'<root axpapp="'+proj+'" trace="'+w+'" recordid="'+i+'"  fno="'+f+'" afiles="'+("undefined"!=typeof headerAttachDir&&"true"==headerAttachDir.toLowerCase()?"":x)+'"  dcname="'+A+'" actrow="'+m+'" sessionid="'+sid+'"  stype="tstructs" sname="'+c+'" actname="'+e+'" __file="'+h+'" options="true" dsignstatus="'+r+'">'+F+"<varlist><row>";var D=(null===(l=callParentNew("middle1","id"))||void 0===l?void 0:null===(o=l.contentWindow)||void 0===o?void 0:o.dwbIvDefName)||callParentNew("dwbIvDefName"),C=callParentNew("ivColDesignJSON"),y=callParentNew("ivParamsOrder");if(callParentNew("isDWB")&&D&&C&&C[D]){var S=C[D].map(function(e){return[e.Savestr,e.mergeid,e.mergename].join("|")}).join();S&&(p=p.replace("<root",'<root changedColumnOrder="'.concat(S,'"')))}if(callParentNew("isDWB")&&D&&y&&y[D]){var R=y[D].map(function(e){return e.name}).join();R&&(p=p.replace("<root",'<root changedParamOrder="'.concat(R,'"')))}"ad__d"==transid&&""!=recordid?callParentNew("dwbtstdctable")==$("#tablename000F1").val()&&callParentNew("dwbtstdctable=",""):callParentNew("dwbtstdctable=","");var j="t";"sect"!=transid&&"NF_AG"!=transid&&"mntss"!=transid&&"ad_fg"!=transid&&"ad_s"!=transid&&"ad_sc"!=transid&&"axcad"!=transid&&"ad_sp"!=transid&&"ad_ic"!=transid||(j="t"+transid);try{callBackFunDtls="CallActionExt♠"+e+"♠"+a+"♠"+t+"♠"+r,ASB.WebService.CallActionWS(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,DeletedFieldValue,ArrActionLog,A,p,n,j,b,N,tstDataId,x,SuccessCallbackAction,OnException)}catch(G){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),AxWaitCursor(!1);var P=G.name+"^♠^"+G.message;showAlertDialog("error",2030,"client",P),callParentNew("HideStructLoader()","function")}}function SuccessCallbackAction(e,a){if(-1===e.toLowerCase().indexOf("access violation")){if(actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),ArrActionLog="",CheckSessionTimeout(e))return;var t=e.split("*#*")[1];void 0!==t&&""!=t&&(console.log("Clearing cache in action"),ClearRedisKeys(t)),e.indexOf("*#*")>-1&&(e=e.substring(0,e.indexOf("*#*"))),ChangedFields.length=0,ChangedFieldDbRowNo.length=0,ChangedFieldValues.length=0,DeletedDCRows.length=0,DeletedFieldValue.length=0,EnableToolBarBtns();try{if(AxAftertstCallAction(e))return SetFormDirty(!1),AxWaitCursor(!1),void ShowDimmer(!1)}catch(r){}ParseServiceResult(e,"Action");try{AxAfterCallAction()}catch(r){}1==AxActionSave&&parent.axMainPageReload==transid&&(parent.doPageUnload="false",parent.window.location.href="../aspx/mainnew.aspx"),SetFormDirty(!1),AxWaitCursor(!1),ShowDimmer(!1),callParentNew("HideStructLoader()","function")}else callParentNew("HideStructLoader()","function"),AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}function EvaluateRapidExpressions(e){var a=e.split(","),t=0;for(t=0;t<a.length;t++)EvaluateAxFunction(GetFieldsName(a[t]),a[t])}var AxFormLoadSkipped=!1;function AssignLoadValues(resultJson,calledFrom,actnName,navigationURL){if(actnName=void 0!==actnName?actnName:"","This proces taking time is more than expected. You will get a notification once completed"!=resultJson){for(var resval=resultJson.split("*$*"),ind=0;ind<resval.length;ind++)if("FDCache"!=resval[ind]){var strSingleLineText=resval[ind].toString().replace(new RegExp("\\n","g"),"");if(strSingleLineText=strSingleLineText.replace(new RegExp("\\t","g"),"&#9;"),strSingleLineText=strSingleLineText.replace(/\\/g,";bkslh"),strSingleLineText=strSingleLineText.replace(new RegExp("&lt","g"),"<"),strSingleLineText=strSingleLineText.replace(new RegExp("&gt","g"),">"),""!=strSingleLineText){try{var myJSONObject=$j.parseJSON(strSingleLineText)}catch(ex){continue}if(myJSONObject.error)ExecErrorMsg(myJSONObject.error,calledFrom);else if(myJSONObject.data&&"Iview"!=calledFrom)ExecData(myJSONObject.data,calledFrom);else if(myJSONObject.evalexpr)EvaluateRapidExpressions(myJSONObject.flds);else if(myJSONObject.fastdata)ExecData(myJSONObject.fastdata,calledFrom);else if(myJSONObject.pickdata)ExecPickData(myJSONObject.pickdata,calledFrom);else if(myJSONObject.command)ExecCommand(myJSONObject.command,actnName,navigationURL);else if(myJSONObject.formcontrol)try{ExecFormControl(myJSONObject.formcontrol,calledFrom)}catch(ex){console.log(ex.message)}else if(myJSONObject.message)("undefined"==typeof pickListRowCount||pickListRowCount>0||-1==pickListRowCount)&&(1!=iViewRefresh?ExecMessage(myJSONObject.message,calledFrom):eval(callParent("ivCmdRefresh")+"= '"+myJSONObject.message[0].msg+"'"));else if(myJSONObject.wfnode)"undefined"!=typeof tstructCancelled&&"cancelled"!=tstructCancelled.toLowerCase()&&ExecWorkflow(myJSONObject.wfnode);else if(myJSONObject.attachment&&"Iview"!=calledFrom&&"iview"!=document.title.toLowerCase())ExecAttachments(myJSONObject.attachment);else if(myJSONObject.memvar)ExecMemVars(myJSONObject.memvar,calledFrom);else if(myJSONObject.timetaken)ExecTimetaken(myJSONObject.timetaken);else if(myJSONObject.rowrefresh&&"true"==myJSONObject.rowrefresh&&myJSONObject.row&&"iview"==document.title.toLowerCase())ExecRefreshIviewRows(myJSONObject.row);else{if(resultJson.indexOf("dsignresult")>-1){if(myJSONObject.dsignresult){Execdsignresult(myJSONObject.dsignresult);break}continue}if(resultJson.indexOf("dsignmsg")>-1){if(myJSONObject.dsignmsg){ExecDsignMsg(myJSONObject.dsignmsg);break}continue}}"undefined"!=typeof GridDispHead&&GridDispHead&&(grDisObj!=undefined&&displayGfirstcol(grDisObj,grDisname),grDisObj="",grDisname="")}}else AxFormLoadSkipped=!0;try{AxAfterFormLoad(calledFrom)}catch(ex){}AxWaitCursor(!1),WrkflFlag||ShowDimmer(!1),myJSONObject=null}else showAlertDialog("info",appGlobalVarsObject.lcm[491])}function AssignWsPerfExprValues(e){if("undefined"!=typeof formParamFlds&&""!=formParamFlds){var a=0;formParamFlds.forEach(function(e){""!=e&&"transid"!=e&&GetActualFieldName(e).split(",").forEach(function(e){if(""!=e)try{var t=ReplaceUrlSpecialChars(formParamVals[a]);SetFieldValue(e,t);var r=GetFieldsRowNo(e),l=GetFieldsDcNo(e),o=GetDbRowNo(r,l);UpdateFieldArray(e,o,t,"parent")}catch(i){}}),a++})}"undefined"!=typeof wsPerfEvalExpClient&&""!=wsPerfEvalExpClient&&wsPerfEvalExpClient.forEach(function(e){""!=e&&GetActualFieldName(e).split(",").forEach(function(a){""!=a&&EvaluateAxFunction(e,a)})})}function AssignLoadValuesDesignMode(e,a){for(var t=e.split("*$*"),r=0;r<t.length;r++){var l=t[r].toString().replace(new RegExp("\\n","g"),"");if(""!=(l=(l=l.replace(new RegExp("\\t","g"),"&#9;")).replace(/\\/g,";bkslh"))){try{var o=$j.parseJSON(l)}catch(i){continue}if(o.formcontrol)try{ExecFormControlDesignMode(o.formcontrol,a)}catch(i){console.log(i.message)}o=null}}}function Execdsignresult(e){for(var a="",t="",r=0;r<e.length;r++)a=a+","+e[r].docname,t=t+","+e[r].docuser;dsignconfirmation(a,t)}function dsignconfirmation(documentname,users){var cutMsg=eval(callParent("lcm[41]")),cutMsgWd=eval(callParent("lcm[42]")),cutMsgOw=eval(callParent("lcm[43]")),msg="Document("+documentname+") "+cutMsg+"</br>";msg+="now pending with "+users+"  </br>",msg+="<a onclick='CallActionForDsign(\"withdraw\");'>"+cutMsgWd+"</br></br></a>",msg+="<a onclick='CallActionForDsign(\"overwrite\");'>"+cutMsgOw+"</br></a>",$j.msgBox({content:msg,type:"info"},100)}function CallActionForDsign(e){CallAction($j("#hdnActionName").val(),"","","","",e)}function ExecDsignMsg(e){showAlertDialog("info",e.msg)}function ExecTimetaken(e){ASBDbTime="",ASBTotal="";for(var a=0;a<e.length;a++)e[a].total&&(ASBTotal=e[a].total),e[a].dbtime&&(ASBDbTime=e[a].dbtime)}function ExecRefreshIviewRows(e){({apply:function(){ivirDataTableApi&&_this.getRows().length==_this.rowData.length&&_this.rows.forEach(function(e,a){var t=parseInt(e||"1");ivDatas[t-1]=_this.rowData[a],ivDatas[t-1][getPropertyAccess("rowno")]=t.toString(),refreshRow(ivirDataTableApi.row(t-1),ivDatas[t-1])})},getRows:function(){switch(_this.rows=$j("#hdnSRows").val().split("♣").filter(function(e){return e}),0==_this.rows.length&&(_this.rows=["1"]),_this.getActionEvent()){case"Current Row":case"":_this.rows=[_this.rows[0]];break;case"Each Selected Rows":_this.rows=[_this.rows[_this.rows.length-1]];break;case"All Selected Rows":default:break;case"All Rows":_this.rows=ivDatas.map(function(e){return e[getPropertyAccess("rowno")]})}return _this.rows},getActionEvent:function(){return _this.event=(eventObj=ivActions[$j("#hdnAct").val().substr(4)])&&eventObj["@apply"]||"Current Row",_this.event},process:function(e){_this=this,_this.rowData=e,_this.apply()}}).process(e)}function CheckSpCharsInFldValue(e){for(var a=e.indexOf("^^dq");-1!=a;)a=(e=e.replace("^^dq",'"')).indexOf("^^dq");return-1!=e.indexOf(";bkslh")&&(e=e.replace(new RegExp(";bkslh","g"),"\\")),e=e.replace(new RegExp("<br>","g"),"\n")}function ExecMemVars(e,a){for(var t="",r="",l=0;l<e.length;l++){t="",r="",e[l].n&&(t=e[l].n),e[l].v&&(r=e[l].v);for(var o=-1,i=0;i<Parameters.length;i++){if(Parameters[i].split("~")[0].toString().toLowerCase()==t.toLowerCase()){o=i;break}}-1!=o?Parameters[o]=t+"~"+r:Parameters[Parameters.length]=t+"~"+r}}function ExecPickData(e,a){for(var t="",r=0,l="",o="no",i=0;i<e.length;i++)e[i].rcount?r=e[i].rcount:e[i].idupdate?o=e[i].idupdate:e[i].fname?t=e[i].fname:e[i].fvalue&&(l=e[i].fvalue);if("yes"==o&&"1"==r&&""!=t&&""!=l){var n=AxActDepFld.lastIndexOf("F"),d=AxActDepFld.substring(0,n-3),s=AxActDepFld.substring(n-3,n),c=AxActDepFld.substring(n+1);if(s=GetDbRowNo(s,c),-1!=l.indexOf("~"))l=l.split("~")[0];if(l=(l=CheckSpCharsInFldValue(l)).replace("^","¿"),isPKItemSelected=!0,d==t){UpdateFieldArray(AxActDepFld,s,l,"parent");var p=l;-1!=l.indexOf("¿")&&(p=l.substring(l.indexOf("¿")+1)),GetFieldValue(AxActDepFld)!=p&&SetFieldValue(AxActDepFld,p)}}}function ClearChecklistOnGetDep(e){var a=ClearSqlChkList(e);if(IsDcGrid(GetDcNo(GetFieldsName(e)))){var t,r="<input type='checkbox' class='multiFldChk' id='"+e+"' name='"+e+"' title='"+a+"' value='' disabled='disabled' style='display:none'> ";$j(".multiChkSpan").each(function(){if($j(this).attr("name")==e)return t=$j(this),!1});var l=$j("#chkAll_"+e);l.prop("checked")&&(l.removeAttr("checked"),l.prop("checked",!1)),l.attr("disabled","disabled"),t.append(r)}}function ExecData(dataJsonObj,calledFrom){FillGridFillRows=0,FillGridCurrentDC=0;var dcNo="0",fldName="",fldValue="",fldType="",fldDbRowNo="",masterRow=0,delRows="",tmpActiveRow="",tmpActiveDc="",isDcFormatGrid=!1,formatGridIdx=-1,dcKeyColumn="",fName="",rid=$j("#recordid000F0").val(),axActiveDc=AxActiveDc,prevFldType="",expDepArray=new Array;if("GetDep"==calledFrom&&IsDcGrid(AxActiveDc)){var dcIdx=$j.inArray(AxActiveDc,DCFrameNo);expDepArray=DCExpDeps[dcIdx].toString().split(",")}for(var comboFld="",comboVal="",comboRowNo="",depFlds="",idCol="",isPopGrid=!1,curRowNo="",dcOldHasData="",dcOldRowCount=0,isChkCleared=!1,i=0;i<dataJsonObj.length;i++){if(fldName=dataJsonObj[i].n,fldValue=dataJsonObj[i].v,fldType=dataJsonObj[i].t,fldDbRowNo=dataJsonObj[i].r,masterRow=dataJsonObj[i].mr,fldValue=CheckSpCharsInFldValue(fldValue),dataJsonObj[i].idcol&&(idCol=dataJsonObj[i].idcol),delRows=dataJsonObj[i].cr?dataJsonObj[i].cr:"","dc"==fldType){var dcHasRows="";dcHasRows=dataJsonObj[i].hasdatarows,dcNo=fldName.substring(2);var dcCaption="";dcCaption=dataJsonObj[i].c;var fgName="";if(fgName=dataJsonObj[i].fg?dataJsonObj[i].fg:"",""!=dcCaption&&SetDcCaption(dcNo,dcCaption),formatGridIdx=GetFormatGridIndex(dcNo),-1!=formatGridIdx?(isDcFormatGrid=!0,dcKeyColumn=DcKeyColumns[formatGridIdx]):(isDcFormatGrid=!1,dcKeyColumn=""),isPopGrid=!!IsDcPopGrid(dcNo),"GetDep"==calledFrom&&isPopGrid&&IsParentDc(axActiveDc)&&(DeletePopRowsAfterGetDep(),AxSubWsRows=new Array,AxSubDsRows=new Array),IsDcGrid(dcNo)){var dcIdx=$j.inArray(dcNo,DCFrameNo);dcOldHasData=DCHasDataRows[dcIdx],""!=dcHasRows&&("yes"==dcHasRows?(DCHasDataRows[dcIdx]="True","False"==dcOldHasData&&("GetDep"==calledFrom&&""==delRows||(delRows="d*,"+delRows))):"no"==dcHasRows&&(DCHasDataRows[dcIdx]="False"))}if(IsDcGrid(dcNo)&&IsDcVisible(dcNo)){if("LoadData"==calledFrom){if("0"!=recordid&&isDcFormatGrid)continue;UpdateDcRowArrays(dcNo,"001","Add")}var ind=0;if(ind=""==fgName?$j.inArray("dc"+dcNo,FillParamDCs):$j.inArray(fgName,FillGridName),-1!=ind&&""!=delRows){var fillCond=FillCondition[ind];if("INIT"==fillCond||"AOWE"==fillCond)-1==delRows.indexOf("d*")&&(delRows="d*,"+delRows),0==$("#gridHd"+dcNo+" tbody tr").length&&"GetDep"==calledFrom&&"no"==dcHasRows&&(delRows="d*");else if("APPEND"==fillCond){var existingRec=$("#gridHd"+dcNo+" tbody tr").length;existingRec>0?$("#gridHd"+dcNo).data("fg-append-rec",existingRec):0==existingRec&&"Action"==calledFrom&&-1==delRows.indexOf("d*")?(delRows="d*,"+delRows,$("#gridHd"+dcNo).removeData("fg-append-rec")):$("#gridHd"+dcNo).removeData("fg-append-rec")}}if(tmpActiveRow=AxActiveRowNo,tmpActiveDc=AxActiveDc,AxDepRows=new Array,"GetDep"==calledFrom&&isPopGrid&&IsParentDc(axActiveDc)){dcOldRowCount=GetDcRowCount(dcNo);continue}"CallAdd"!=calledFrom&&(SetRows(dcNo,fldValue,delRows,calledFrom,dcOldHasData,dcHasRows),"LoadData"==calledFrom&&fillgridColOptVisibility(dcNo)),AxActiveRowNo=tmpActiveRow,AxActiveDc=tmpActiveDc}"yes"==dcHasRows&&SetHdnRowCount(dcNo,calledFrom)}else{if(0==rid&&fldName!=undefined&&fldName==AxAutoGenFld){var hdnAutogenerateFld=$j("#hdnShowAutoGenFldValue").val();"true"==hdnAutogenerateFld.toLowerCase()||(fldValue="Auto")}if("GetDep"==calledFrom&&"cl"==prevFldType&&"dv"!=fldType&&""!=comboFld&&(ClearChecklistOnGetDep(comboFld),comboFld="",comboVal=""),"dv"==fldType)fldName=comboFld;else{if("axpcurrencydec"==fldName.toLowerCase()&&UpdateAxpCurrDec(fldValue,calledFrom),"PopGridCombos"==calledFrom&&""!=AxPopRowNo&&(fldDbRowNo=AxPopRowNo),"GetDep"==calledFrom&&IsDcPopGrid(dcNo)&&IsParentDc(axActiveDc)){var wsRowNo=fldDbRowNo,sIdx=-1;"True"!=dcOldHasData&&"1"==wsRowNo||(sIdx=$j.inArray(wsRowNo,AxSubWsRows),fldDbRowNo=GetSubDsRowNo(fldDbRowNo,dcNo)),-1==sIdx&&(AxActiveDc=dcNo,AddRowAfterGetDep(fldDbRowNo,dcNo,dcOldHasData),curRowNo=fldDbRowNo)}if("0"==dcNo&&(dcNo=GetDcNo(fldName)),fillParamId=$j.inArray("dc"+dcNo,FillParamDCs),"-1"!=fillParamId&&(fillCond=FillCondition[fillParamId],"APPEND"==fillCond)){var recCount=$("#gridHd"+dcNo).data("fg-append-rec");recCount!=undefined&&"LoadData"!=calledFrom&&"Action"!=calledFrom&&"GetDep"!=calledFrom&&(fldDbRowNo=parseInt(fldDbRowNo)+recCount)}fldName=ConstructFieldName(fldName,dcNo,fldDbRowNo),RedrawField(comboFld,calledFrom,isPopGrid),comboFld=""}if(""==fldName)continue;var fld=$j("#"+fldName),fName=GetFieldsName(fldName);if(("undefined"!=typeof AutosaveDraft&&"true"==AutosaveDraft&&"false"==checkIsdraft||"undefined"!=typeof AutosaveDraft&&""==AutosaveDraft&&"false"==checkIsdraft)&&((-1!=fName.indexOf("axp_gridattach_")||fName.toLowerCase()=="dc"+dcNo+"_image"||fName.startsWith("axp_nga_")||fName.toLowerCase().startsWith("axpfile_"))&&(fName.startsWith("axp_nga_")||fName.toLowerCase().startsWith("axpfile_")||SetGridAttValue(fldName,fldValue),fldName.toLowerCase().startsWith("axpfile_")?ConstructAxpAttachHTML(fldValue,fldName):ConstructAttachHTML(fldValue,fldName),showAttachmentPopover()),-1!=fldName.toLowerCase().indexOf("dc"+dcNo+"_referimages")&&SetGridRefValue(fldName,fldValue)),"LoadData"==calledFrom&&isDcFormatGrid){var fIndx=fldName.lastIndexOf("F"),fRNo=GetFieldsRowNo(fldName);if(dcKeyColumn==fName){if("0"==recordid){var oldKeyVal=$j("#"+fldName).val();CallSetFieldValue(fldName,oldKeyVal);continue}continue}}if(fld.length>0){var fArrayIdx=-1;if(fArrayIdx=$j.inArray(GetFieldsName(fldName),FNames),"m"==fldType)CallSetFieldValue(fldName,fldValue),"mntss"==transid&&"sql_editor_test000F2"==fldName&&"0"!=recordid&&(sql_editor_test=fldValue);else if("cl"==fldType||"rg"==fldType)comboFld=fldName,comboVal=fldValue,isChkCleared=!1,CallSetFieldValue(fldName,fldValue),"GetDep"==calledFrom&&i+1==dataJsonObj.length?(ClearChecklistOnGetDep(comboFld),comboFld="",comboVal=""):"GetDep"==calledFrom&&$("#"+comboFld).removeData("valuelist");else if("i"==fldType)if(""!=fldValue)if(-1!=fldValue.indexOf("//"))$j("#"+fldName).attr("src",fldValue);else{var fileName=fldValue.split("\\\\"),hdnScriptsUrlPath=$j("#hdnScriptsUrlpath"),fldValuePath="";fldValuePath=fileName.length>1?hdnScriptsUrlPath[0]!=undefined?hdnScriptsUrlPath.val()+"axpert/"+sid+"/"+fileName[fileName.length-2]+"/"+fileName[fileName.length-1]:"../scripts/axpert/"+sid+"/"+fileName[fileName.length-2]+"/"+fileName[fileName.length-1]:hdnScriptsUrlPath[0]!=undefined?hdnScriptsUrlPath.val()+"axpert/"+sid+"/"+fileName[fileName.length-1]:"../scripts/axpert/"+sid+"/"+fileName[fileName.length-1],GetDateTime(),$j("#"+fldName).attr("src",fldValuePath+"?"+imageSuffix)}else $j("#"+fldName).attr("src","../AxpImages/upload.png");else if("b"==fldType){if(-1!=fldName.indexOf("axpbutton")){var fIndx=fldName.lastIndexOf("F"),uIndx=fldName.lastIndexOf("_");fld.val(fldName.substring(uIndx+1,fIndx-3))}}else if("c"==fldType)if("hidden"==fld.attr("type"))CallSetFieldValue(fldName,fldValue),comboFld="";else if("checkbox"==fld.attr("type"))comboFld="","yes"==fldValue.toLowerCase()?(fld.prop("checked",!0),fld.attr("checked",!0)):(fld.prop("checked",!1),fld.attr("checked",!1));else{comboFld=fldName,comboVal=fldValue;var fIndx=fldName.lastIndexOf("F"),fName=GetFieldsName(fldName),fldIsAutoComp=!1;$j("#"+fldName).hasClass("fldAutocomplete")&&(fldIsAutoComp=!0);var fldIsMultiSelect=!1;if($j("#"+fldName).hasClass("fldmultiSelect")&&(fldIsMultiSelect=!0),fldIsAutoComp||fldIsMultiSelect||ClearComboBox(fld,fName,fldValue),dataJsonObj[i].dpm){var depFldsStr=dataJsonObj[i].dpm;depFlds=depFldsStr.split(",")}masterRow!=undefined&&0!=masterRow?("1"!=fldDbRowNo&&"PopGridCombos"!=calledFrom&&(fldIsAutoComp||fldIsMultiSelect||CopyFromMasterRow(fldName,dcNo,masterRow,calledFrom,isPopGrid)),MasterRow.push(fName),CallSetFieldValue(fldName,fldValue)):(fldIsAutoComp||fldIsMultiSelect)&&CallSetFieldValue(fldName,fldValue),UpdateAssignedFld(comboFld),comboFld=""}else if("dv"==fldType&&""!=comboFld){var comboField=$j("#"+comboFld);if(comboField!=undefined)if("select-one"==comboField.prop("type")){var comboItems=fldValue.split("~"),depValue=fldValue,fldIdVal="";"yes"==idCol?(fldIdVal=comboItems[0],fldValue=comboItems[1]):fldValue=comboItems[0];var optHtml="",htmlFldVal=fldValue.replace(/ /g,"&nbsp;"),tmpVal=fldValue.replace(/ /g,String.fromCharCode(160)),comboFldnm=GetFieldsName(comboFld);if(fldValue==comboVal||comboVal==tmpVal?(optHtml="<option selected value='"+fldIdVal+"'>"+fldValue+"</option>",comboField.append(optHtml),CallSetFieldValue(comboFld,fldValue,!1,calledFrom),"001"==GetFieldsRowNo(comboFld)&&"LoadData"==calledFrom&&"0"!=rid&&$j.inArray(comboFldnm,MasterRow)>-1&&SetEditRowComboValues(comboFld,optHtml.replace("selected",""),dcNo,comboFldnm)):(optHtml="<option value='"+fldIdVal+"'>"+fldValue+"</option>",comboField.append(optHtml),"001"==GetFieldsRowNo(comboFld)&&"LoadData"==calledFrom&&"0"!=rid&&$j.inArray(comboFldnm,MasterRow)>-1&&SetEditRowComboValues(comboFld,optHtml,dcNo,comboFldnm)),null!=dataJsonObj[i].dp)for(var dependentValues=dataJsonObj[i].dp.toString().split("¿"),tmpCmoboFld=GetFieldsName(comboFld),cnt=0;cnt<dependentValues.length;cnt++)for(var strDepVals=dependentValues[cnt].split("~"),depInd=0;depInd<strDepVals.length;depInd++)ComboParentField.push(tmpCmoboFld),ComboParentValue.push(fldValue),ComboDepField.push(depFlds[depInd]),ComboDepValue.push(strDepVals[depInd])}else if(!("checkbox"!=comboField.attr("type")&&"checkbox"!=comboField.data("type")&&"radio"!=comboField.attr("type")||"undefined"!=typeof IsObjCustomHtml&&"False"!=IsObjCustomHtml)){var spanClass="",align="",strChecked="",fldClass="",fldHint="",IsChkList="checkbox"==comboField.attr("type")||"checkbox"==comboField.data("type"),tmpFld;if(IsChkList){spanClass=".multiChkSpan",align="<div class='clear'></div>";var chkValSep=GetChkSeparator(GetFieldsName(comboFld)),arrChkItems=comboVal.split(chkValSep);-1!=$j.inArray(fldValue,arrChkItems)&&(strChecked="checked=checked"),0==isChkCleared&&(comboField.hasClass("multiFldChk")||(fldHint=ClearSqlChkList(comboFld),isChkCleared=!0)),fldClass="type=checkbox class='multiFldChk'"}else spanClass=".multiRgrpSpan,.multiFldRdg",align="&nbsp;&nbsp;&nbsp;&nbsp;","v"==FldAlignType[fArrayIdx].toLowerCase()&&(align="<div class='clear'></div>"),comboVal==fldValue&&(strChecked="checked=checked"),0==isChkCleared&&(fldHint=ClearRadioGrp(comboFld),isChkCleared=!0),fldClass="type=radio class='multiFldRdg'";var tmpID="";try{tmpFld=$j(spanClass+"[name="+comboFld+"]"),tmpID=tmpFld.attr("name")}catch(ex){}tmpFld!=undefined&&tmpFld.hasClass("flddis")&&(fldClass+=" disabled");var chkId=tmpID;fldValue=CheckSpecialCharsInStr(fldValue),""!=fldValue&&(fldValue=fldValue.replace(/&amp;/g,"&"),fldValue=fldValue.replace("/&apos;/g","'"));var fldclText="",fldclValue="";"yes"==idCol?(fldclValue=fldValue.split("~")[0],fldclText=fldValue.split("~")[1]):(fldclValue=fldValue,fldclText=fldValue);var chkHtml="";if(chkHtml="<span><input "+fldClass+" id='"+(IsChkList?chkId:fldName)+"' onchange='CallMainBlur(this)'  name='"+(IsChkList?chkId:fldName)+"' title='"+fldHint+"' value='"+fldclValue+"' "+strChecked+" ></input>"+fldclText+align+"</span>",IsDcGrid(dcNo)||"radio"==comboField.attr("type"))tmpFld.append(chkHtml);else{var tokenData=$("#"+tmpID).data("valuelist"),tokens=[];tokens="object"==_typeof(tokenData)?tokenData:$("#"+tmpID).data("valuelist").split($("#"+tmpID).data("separator")).map(function(e){return{value:e,label:e}}).filter(function(e){return e.value&&e.label}),tokens.push({value:fldclValue,label:fldclText}),tokens=_toConsumableArray(new Set(tokens)),$("#"+tmpID).data("valuelist",tokens);try{$("#"+tmpID).data("bs.tokenfield").$input.autocomplete({source:tokens})}catch(ex){}}if(IsChkList){var chkAllObj=$j("#chkAll_"+chkId);chkAllObj.hasClass("flddis")||chkAllObj.removeAttr("disabled");var hideAllObj=$j("#hideAll_"+chkId);if(hideAllObj.removeAttr("disabled"),chkAllObj.length>0){var itemLength=$j("input[name='"+chkId+"']").length;arrChkItems.length<itemLength?(chkAllObj.removeAttr("checked"),chkAllObj.prop("checked",!1)):""!=comboVal&&arrChkItems.length==itemLength&&(chkAllObj.attr("checked","checked"),chkAllObj.prop("checked",!0))}}else $j("div[id*='"+fName+"']").find("input[data-dummyradio=true]").remove(),"radio"==comboField.attr("type")?$j("#dv"+fName).find(".input-group").append(chkHtml):$j("#dv"+fName).append(chkHtml)}}if("dc"!=fldType&&"dv"!=fldType){if("s"==fldType||"m"==fldType||"cb"==fldType||"rg"==fldType){CallSetFieldValue(fldName,fldValue,!1,calledFrom);var dwbfieldName=GetFieldsName(fldName),dwbfldInd=GetFieldIndex(dwbfieldName),fldDType=GetDWBFieldType(fldName,dwbfldInd);if(fldName.startsWith("axptm_")||fldName.startsWith("axpdbtm_")||""!=fldDType&&"time"==fldDType.toLowerCase()){var glType=eval(callParent("gllangType")),dtpkrRTL=!1;dtpkrRTL="ar"==glType;var dvId=$("#"+fldName).parents("[id^='divDc']").attr("id");TimePickerEvent("#"+dvId,dtpkrRTL)}}"PopGridCombos"!=calledFrom&&"Action"!=calledFrom&&"GetDep"!=calledFrom||UpdateFieldArray(fldName,fldDbRowNo,fldValue,"parent");var glCulture=eval(callParent("glCulture"));if(glCulture!=undefined&&"en-us"==glCulture){var fdName=GetFieldsName(fldName),fldDIndex=$j.inArray(fdName,FNames),fldDType=GetFieldType(fdName,fldDIndex);if(fldDType!=undefined&&"date/time"==fldDType.toLowerCase()){var fldDValue=DateDisplayFormat(fldValue);CallSetFieldValue(fldName,fldDValue,!1,calledFrom)}}}}var grfdName=GetFieldsName(fldName);!axInlineGridEdit&&"form"==AxpGridForm&&IsGridField(grfdName)&&formGridRowBlur($("#"+fldName))}-1!=fldName.indexOf("axpvalid")&&DoFormControlPrivilege(fldName,fldValue),"dc"!=fldType&&"dv"!=fldType&&UpdateOldValues(fldName,fldValue),prevFldType=fldType}"LoadData"==calledFrom&&"0"==recordid&&AxAutoGenFld!=undefined&&SetAutoGenerateValue(calledFrom),"LoadData"==calledFrom&&"0"!=recordid||1==IsDraftLoad?(UpdatePopGridInfo(),GetHtmlForFormatGrids()):"LoadData"!=calledFrom&&("GetDep"==calledFrom&&(AxActiveDc=axActiveDc),AssignPopGridRows(),ArrPopNewDcs=new Array,ArrPopNewRows=new Array),CallEvalExpOnFormSkip()}function SetAutoGenerateValue(e){var a=GetDcNo(AxAutoGenFld),t="";t=IsDcGrid(a)?ConstructFieldName(AxAutoGenFld,a,"001"):ConstructFieldName(AxAutoGenFld,a,"000"),"false"==$j("#hdnShowAutoGenFldValue").val().toLowerCase()&&CallSetFieldValue(t,"Auto",!1,e)}function CallEvalExpOnFormSkip(){if(AxFormLoadSkipped){AxFormLoadSkipped=!1;for(var e=0;e<FNames.length;e++){var a=GetFldNamesIndx(FNames[e]),t="";if(-1!=a&&(t=Expressions[a].toString()),""!=t){var r="";r=IsGridField(FNames[e])?FNames[e]+"001F"+FldFrameNo[e]:FNames[e]+"000F"+FldFrameNo[e],EvaluateAxFunction(FNames[e],r),UpdateFieldArray(r,1,GetFieldValue(r),"parent","FormLoad")}}}}function SetHdnRowCount(e,a){if("GetTabData"==a&&$j("#hdnRCntDc"+e).length>0){var t=parseInt($j("#hdnRCntDc"+e).val(),10)+1;$j("#hdnRCntDc"+e).val(t),UpdateDcRowArrays(e,GetRowNoHelper(t),"Add")}}function SetEditRowComboValues(e,a,t,r){var l=GetDcRowCount(t),o=GetRowNoHelper(l);$j("#"+r+o+"F"+t).append(a)}function CallMainBlur(e){var a=e.id;MainBlur($j("#"+a))}function RedrawField(e,a,t){if(""!=e&&(window.navigator.userAgent.indexOf("MSIE ")>0?($j("#"+e).css("background-color","white"),$j("#"+e).focus()):$j("#"+e).hide().show(),"LoadData"==a&&!IsDraftLoad&&$j("#"+e).length>0)){if(t)return;$j("#"+e).width($j("#"+e).width()+2)}}function GetHtmlForFormatGrids(){var e=$j("#dvFormatDc").html();$j("#dvFormatDc").html(""),AssignHTML(e,"LoadData","")}function UpdateOldValues(e,a){var t=$j.inArray(FldLoadedFields,e);-1==t?(FldLoadedFields.push(e),FldLoadedValues.push(a)):FldLoadedValues[t]=a}function UpdateNewPopInfo(e,a){var t=$j.inArray(e,ArrPopNewDcs);if(-1!=t)if(""!=ArrPopNewRows[t]){-1==ArrPopNewRows[t].indexOf(a)&&(ArrPopNewRows[t]+=","+a)}else ArrPopNewRows[t]=ArrPopNewRows[t];else ArrPopNewDcs.push(e),ArrPopNewRows.push(a)}function AssignPopGridRows(){if(TstructHasPop)for(var e=0;e<ArrPopNewDcs.length;e++){var a=$j.inArray(ArrPopNewDcs[e],PopGridDCs),t=PopGridDCs[a].toString(),r=PopParentDCs[a].toString(),l=$j.inArray(r,DCFrameNo);if("false"!=DCHasDataRows[l].toString().toLowerCase()&&(l=$j.inArray(ArrPopNewDcs[e],DCFrameNo),"false"!=DCHasDataRows[l].toString().toLowerCase()))for(var o=ArrPopNewRows[e].split(","),i=0;i<o.length;i++){var n=o[i],d=PopParentFlds[a].split(","),s="";for(ind=0;ind<d.length;ind++){var c=GetSubFieldId("sub"+t+"_"+d[ind],n,t),p=GetFieldValue(c);-1!=p.indexOf(",")&&(p=removeCommas(p)),""==s?s=p:s+="¿"+p}UpdateParentStr(r,t,s,n)}}}function ClearPopRowsArray(){for(var e=0;e<PopRows.length;e++)PopRows[e]=""}function UpdatePopGridInfo(){if(TstructHasPop){ClearPopRowsArray();for(var e=0;e<PopGridDCs.length;e++){var a=PopGridDCs[e].toString(),t=GetDcRowCount(a),r=PopParentDCs[e].toString(),l=PopParentFlds[e].split(","),o=$j.inArray(r,DCFrameNo);if("false"!=DCHasDataRows[o].toString().toLowerCase()&&(o=$j.inArray(a,DCFrameNo),"false"!=DCHasDataRows[o].toString().toLowerCase()))for(var i=1;i<=t;i++){var n=GetClientRowNo(i,a),d="";for(ind=0;ind<l.length;ind++){var s=GetSubFieldId("sub"+a+"_"+l[ind],n,a),c=GetFieldValue(s);""==d?d=c:d+="¿"+c}UpdateParentStr(r,a,d,n)}}}}function UpdateParentStr(e,a,t,r){for(var l=0;l<ParentDcNo.length;l++){var o=PopParentsStr[l].toLowerCase(),i=t.toLowerCase();if(o=ReplaceCharsInParStr(o),i=ReplaceCharsInParStr(i),ParentDcNo[l]==e&&PopGridDcNo[l]==a&&o==i){var n=PopRows[l].toString();if(""==n)n=r;else{var d=n.split(",");-1==$j.inArray(r,d)&&(n+=","+r)}PopRows[l]=n;break}}}function ReplaceCharsInParStr(e){return e=(e=e.replace(/,/g,"")).replace(/\./g,"")}function ExecAttachments(e){for(var a=0;a<e.length;a++){for(var t=e[a].att,r=(t=t.split(",")).length,l=$j("#recordid000F0").val(),o="",i=0;i<r;i++)if(-1==fileonloadarray.indexOf(t[i].toString())){fileonloadarray.push(t[i].toString());var n=CheckUrlSpecialChars(t[i].toString());n='"'+n+'"';var d=parseInt(i,10)+1;0==i&&(attachments+='<div class="row attachmentData">'),attachments+='<div class="col-md-4 col-sm-6"><div class="attachments"><a class=linkrem alt=\'Remove File\' onclick=\'javascript:RemoveFile('+n+","+l+");'><img class='close pull-right' src='../axpimages/icons/16x16/cross.png' alt='delete' /></a>&nbsp;<a id=loadattach"+d+' class="pull-left Attachlink flagcount" style="cursor:pointer;" onclick=\'javascript:OpenAttachment('+n+","+l+");'>"+fileonloadarray[i].toString()+"</a></div></div>",i==r-1&&(attachments+="</div>")}""!=attachments&&(o+="<input id=hdncount type=hidden value="+i+" >",$j("#attachment-overlay").show(),$j("#attachment-overlay").css("display","block !important"),$j("#attachment-overlay").removeClass("hide"),$j("#attachment-overlay").html(attachments+o))}}function ExecWorkflow(e){var a=!1,t="",r="";getComntWf();for(var l=0;l<e.length;l++){if($j("#workflowoverlay").show(),e[l].btn){var o=e[l].btn,i=new Array;if(""!=o){i=o.split("~"),ReadonlyWfButtons();for(var n=0;n<i.length;n++)"a"==i[n]?($j("#btntabapprove").prop("disabled",!1),$j("#btntabapprove").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<li onclick="SlectBoxWrf(\'Approve\')" class="Selectboxlist" id="Approve">Approve</li>')):"r"==i[n]?($j("#btntabreject").prop("disabled",!1),$j("#btntabreject").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<li onclick="SlectBoxWrf(\'Reject\')" class="Selectboxlist" id="Reject">Reject</li>')):"t"==i[n]?($j("#btntabreturn").prop("disabled",!1),$j("#btntabreturn").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<li onclick="SlectBoxWrf(\'Return\')" class="Selectboxlist" id="Return">Return</li>')):"v"==i[n]&&($j("#btntabreview").prop("disabled",!1),$j("#btntabreview").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<li onclick="SlectBoxWrf(\'Review\')" class="Selectboxlist" id="Review">Review & Forward</li>')),a=!0}else $("#selectbox").attr("disabled","disabled"),$(".wrkflwinline").addClass("hide"),ReadonlyWfButtons()}else if(0==a)$("#selectbox").attr("disabled","disabled"),$(".wrkflwinline").addClass("hide"),ReadonlyWfButtons();else{var d=$j("#txtCommentWF");d.length>0&&d.prop("disabled",!1)}if(e[l].status&&$j("#lblStatus").text(e[l].status),e[l].lno&&$j("#hdnWfLno").val(e[l].lno),e[l].elno){$j("#hdnWfELno").val(e[l].elno);var s=e[l].elno}if(e[l].appstatus&&(appstatus=e[l].appstatus,("Approved"==appstatus&&1==AxOnApproveDisable||"Rejected"==appstatus&&1==AxOnRejectDisable)&&Readonlyform()),e[l].readonlyform&&"true"==e[l].readonlyform&&Readonlyform(),e[l].allowcancel&&(AxAllowCancel="true"==e[l].allowcancel.toString().toLowerCase()),e[l].maxlevel&&(r=e[l].maxlevel),e[l].levels){var c=getWfUsrName(r,e[l].levels),p=getWfStatus(r,e[l].levels);e[l].levels[0].lno;-1==$.inArray("",c)?(t=constructWrkHtml(r,c,p,s,e[l].levels),$(t).insertAfter($("#stratWrkf")),popoverWrkFl()):getWfLevelUSsrs($.inArray("",c),r,c,p,s,e[l].levels)}}s>0&&($(".wrkflwPending").addClass("wrkflwPendingCls"),$(".downArr").addClass("workflowdropdownCls"),$(".icobtn").addClass("iconbtnCls")),adjustwin("100",window),"true"==AxIsTstructLocked&&($("#selectbox").attr("disabled","disabled"),$(".wrkflwinline").addClass("hide"))}function ExecMessage(messageJsonObj,calledFrom){for(var i=0;i<messageJsonObj.length;i++){var msgs=messageJsonObj[i].msg;if(!(void 0!==$j("#middle1",parent.document).attr("src")&&0===$j("#middle1",parent.document).attr("src").indexOf("tstruct.aspx")&&"iview"!=document.title.toLowerCase()&&IsPickListField(AxActDepFld)&&msgs.indexOf("Invalid selection")>-1&&"GetDep"==calledFrom)){if(msgs.indexOf("recordid")>-1){var msgsArray=msgs.split(",");msgs="";for(var x=0;x<msgsArray.length;x++)-1==msgsArray[x].indexOf("recordid=")&&(x==msgsArray.length-1?msgs+=msgsArray[x]:msgs+=msgsArray[x]+",")}msgs.indexOf("errfld")>-1&&(msgs=msgs.substring(0,msgs.lastIndexOf("errfld")-2)),msgs=msgs.split(",");for(var responsemsgFlds=msgs.length,msg="",mm=0;mm<responsemsgFlds;mm++){msg+=msgs[mm]+",";var stPos=msg.indexOf("["),endPos=msg.indexOf("]"),errFld=msg.substring(stPos+1,endPos);if(""!=errFld){var nerr=msg.substring(stPos,endPos+2);msg=msg.replace(nerr,""),alertType="error"}for(var index=msg.indexOf("^^dq");-1!=index;)msg=msg.replace("^^dq",'"'),index=msg.indexOf("^^dq")}if(""!=msg){if("Action"==calledFrom&&msg.indexOf("recordid")>0&&(msg=msg.substr(0,msg.indexOf("recordid"))),1==saveActRecSuccess&&(alertType="success",saveActRecSuccess=!1),"Transaction has been canceled"==msg)msg=eval(callParent("lcm[44]")),alertType="error";else if("Action"!=calledFrom&&"Iview"!=calledFrom||-1==msg.indexOf("`"))-1!=msg.toLowerCase().indexOf("invalid")||-1!=msg.indexOf("cannot be left empty")?alertType="error":-1!=msg.toLowerCase().indexOf("is completed")||-1!=msg.toLowerCase().indexOf("saved successfully")?alertType="success":alertType="info";else{var alType=msg.split("`")[0].toLowerCase();alType.indexOf(",")>-1&&(alType=alType.split(",")[1]),"simple"==alType||""==alType?alertType="info":"warning"==alType?alertType="warning":"confirmation"==alType?alertType="success":"exceptions"==alType&&(alertType="error"),msg=msg.split("`")[1].slice(0,-1)}if(-1!=msg.indexOf("cannot be left empty")){var cutMsg=eval(callParent("lcm[45]"));msg=msg.replace("cannot be left empty",cutMsg)}if(blurDisabled=!0,"GetDep"==calledFrom&&1==IsPickListField(AxActDepFld))if(""!=msg&&""==AxPickResult){if(AxActionSave?(showAlertDialog(alertType,msg,"","","function~redirectOnSaveAction()"),disableBtnBeforeReload()):showAlertDialog(alertType,msg),errFrompickfld=msg,""!=AxActDepFld){var rowNo=GetClientRowNo(AxActiveRowNo,AxActiveDc),fldName=AxActDepFld+rowNo+"F"+AxActiveDc,focusFld=$j("#"+fldName);focusFld.length>0&&focusFld.focus()}}else currentPickList=AxActDepFld,SuccGetSearchResult(AxPickResult);else if(AxActionSave?"New"==AxActiveAction?showAlertDialog(alertType,msg):(showAlertDialog(alertType,msg,"","","function~redirectOnSaveAction()"),disableBtnBeforeReload()):showAlertDialog(alertType,msg),errFrompickfld=msg,""!=AxActiveField){var rowNo=GetClientRowNo(AxActiveRowNo,AxActiveDc),fldName=AxActiveField+rowNo+"F"+AxActiveDc,focusFld=$j("#"+fldName);focusFld.length>0&&focusFld.focus()}}}}var curFrame=$(window.frameElement);"axpiframe"===curFrame.attr("id")&&0==axFramReload&&ReloadMiddleIframe(),0!=axFramReload&&(axFramReload=!1)}function ExecFormControl(e,a){for(var t=e.length,r=0;r<t;r++){if(e[r].dc){var l,o="";o=e[r].dc,l=e[r].dcact;var i=parseInt(o.substr(2,o.length));if("hide"==l){"undefined"!=typeof isWizardTstruct&&isWizardTstruct?ToggleWizardDc(i,"hide"):ShowingDc(i,"hide");var n=$.inArray(i.toString(),VisibleDCs);-1!=n&&VisibleDCs.splice(n,1)}else if("show"==l){"undefined"!=typeof isWizardTstruct&&isWizardTstruct?ToggleWizardDc(i,"show"):ShowingDc(i,"show"),-1==$.inArray(i.toString(),VisibleDCs)&&VisibleDCs.push(i.toString())}else"disable"==l?ShowingDc(i,"Disable",a):ShowingDc(i,"Enable")}if(e[r].readonlytrans)if("no"!=e[r].readonlytrans){var d=document.getElementById("breadcrumb");if(d){var s=d.innerHTML;s=s.substring(0,s.length-11),d.innerHTML=s+" - Read Only</h3></div>"}Readonlyform()}if(e[r].btnname){var c,p="";p=e[r].btnname,c=e[r].btnact;GetExactFieldName(p);var f=!1;x=null,-1!=p.indexOf(".")&&p.replace(".","\\."),"remove"==p.toLowerCase()?p="delete":"list view"==p.toLowerCase()?p="listview":"new"==p.toLowerCase()&&(p="add"),$j(":button").each(function(){$j(this).attr("id")!=p&&$j(this).attr("value")!=p||(f=!0,x=$j(this))}),f||$j(".action img").each(function(){if($j(this).attr("id")==p)return x=$j(this),f=!0,!1}),f||$j(".axpBtn").each(function(){if($j(this).attr("id")==p)return x=$j(this),f=!0,!1}),f||$j("#icons").find("a").each(function(){($j(this).attr("class")==p.toLowerCase()||void 0!==p&&$j(this).text()==p)&&(x=$j(this),f=!0)}),f||$j("#nextprevicons").find("a").each(function(){$j(this).attr("class")==p.toLowerCase()&&(x=$j(this),f=!0)}),"disable"==c?CallProcessFormControl(p,"","2",""):"enable"==c?CallProcessFormControl(p,"","1",""):(null!=x&&x.length>0?f=!0:$j("#"+p.toLowerCase()).length>0?(f=!0,x=$j("#"+p.toLowerCase())):"Save"==p?$j("#imgSaveTst")&&(f=!0,x=$j("#imgSaveTst")):(x=p+"000F0",$j("#"+x).length>0&&(f=!0,x=$j("#"+x))),f&&x.length>0&&("hide"==c?("li"==x.parent()[0].tagName.toLowerCase()&&x.parent().css({display:"none"}),"add"==p?$j("#New").length>0&&$j("#New").css({display:"none"}):("reject"==p.toLowerCase()||"approve"==p.toLowerCase())&&$j("#icons").find("a#actbtn_"+p).length>0&&$j("#icons").find("a#actbtn_"+p).parent().css({display:"none"}),x.css({display:"none"})):"show"==c?("li"==x.parent()[0].tagName.toLowerCase()&&x.parent().css({display:"inline-block"}),"add"==p&&$j("#New").length>0&&$j("#New").css({display:"inline-block"}),x.css({display:"block"})):"disable"==c?(FadeImage(x.attr("id"),1),x.attr("disabled","disabled"),x.addClass("btndis"),SetAutoCompAccess("disabled",x)):"enable"==c&&(x.prop("disabled",!1),SetAutoCompAccess("enabled",x)),f=!1))}if(e[r].fldname){var m,u,v="";v=e[r].fldname,m=e[r].fldact,u=e[r].setcaption;var w=GetFieldsRowFrameNo(v),h=GetFieldsName(v),g=w.substring(4);if("000F0"==w&&(v=v.substring(0,v.length-1)+"1"),u!=undefined&&w==v){var A=GetDcNo(v);v=IsDcGrid(A)?v+"001F"+A:v+"000F"+A}var x=$j("#"+v),b=!1;if(u!=undefined||m!=undefined){if(u!=undefined)-1==$j.inArray(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+u,AxFormContSetCapFldsGrid)&&AxFormContSetCapFldsGrid.push(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+u),SetCaptionFormControl(v,u);if("setfocus"==m)-1==$j.inArray(GetDcNo(v)+"~"+v+"~"+m,AxFormContFldSetFocus)&&AxFormContFldSetFocus.push(GetDcNo(v)+"~"+v+"~"+m);else if(m!=undefined){-1==$j.inArray(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+m,AxFormContSetFldActGrid)&&AxFormContSetFldActGrid.push(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+m)}}else if(x.length>0){if(IsDcGrid(g)&&(b=!0),"hide"==m)if(b)$j("#th-"+h).hide(),x.hide(),x.parent().hide();else{x.css("visibility","hidden");var N=GetFieldsName(v);$j("#dv"+N).hide()}else b?($j("#th-"+h).show(),x.show(),x.parent().show()):x.css("visibility","visible");"disable"==m?ProcessFormControl(v,"2",""):ProcessFormControl(v,"1","")}else{if("hide"==m||"show"==m)-1==$j.inArray(h+"~"+m,AxFormContHiddenFlds)&&AxFormContHiddenFlds.push(h+"~"+m);else if(u!=undefined){-1==$j.inArray(v+"~"+u,AxFormContSetCapFlds)&&AxFormContSetCapFlds.push(v+"~"+u)}}}}SetFormContFldActGrid(""),"undefined"!=typeof isWizardTstruct&&isWizardTstruct&&CheckWizardSaveButton()}function ExecFormControlDesignMode(e,a){for(var t=e.length,r=0;r<t;r++)if(e[r].fldname){var l,o="";if(o=e[r].fldname,(l=e[r].setcaption)!=undefined){var i=GetFieldsRowFrameNo(o);if("000F0"==i&&(o=o.substring(0,o.length-1)+"1"),l!=undefined&&i==o){var n=GetDcNo(o);o=IsDcGrid(n)?o+"001F"+n:o+"000F"+n}-1==$j.inArray(GetDcNo(GetFieldsName(o))+"~"+GetFieldsName(o)+"~"+l,AxFormContSetCapFldsGrid)&&AxFormContSetCapFldsGrid.push(GetDcNo(GetFieldsName(o))+"~"+GetFieldsName(o)+"~"+l),SetCaptionFormControl(o,l)}}}function ConstructParams(e,a){-1!=e.indexOf("###")&&(e=e.replace(/###/g,"¿")),-1!=a.indexOf("###")&&(a=a.replace(/###/g,"¿"));e=e.split("¿");var t=a.split("¿"),r="",l=e.length;if(0!=l)for(var o=0;o<l;o++)r=r+"&"+(e[o]+"="+CheckUrlSpecialChars(t[o])).replace(/%26/g,"--.--");return r}function CheckUrlSpecialChars(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/%/g,"%25")).replace(/#/g,"%23")).replace(/&/g,"%26")).replace(/'/g,"%27")).replace(/"/g,"%22")).replace("+","%2b")).replace(/ /g,"%20")).replace(/\\/g,"%5C")).replace(/</g,"%3C")).replace(/>/g,"%3E")}function ReplaceUrlSpecialChars(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/%25/g,"%")).replace(/%26/g,"&")).replace(/%27/g,"'")).replace(/%23/g,"#")).replace(/%22/g,'"')).replace(/%2b/g,"+")).replace(/%20/g," ")).replace(/%5C/g,"\\")).replace(/%3C/g,"<")).replace(/%3E/g,">")}function closeRemodalwindow(){$j("#popupIframeRemodal",parent.document).attr("src")!=undefined&&$j(".remodal-close",parent.document).click()}function ExecCommand(cmdJsonObj,actnName,axpConfigNavType){actnName=void 0!==actnName?actnName:"";for(var popup="",pgname="",cmdName="",cmdVal="",multipleDocs,saveAction=!1,lockedBy="",parFrm=$j("#axpiframe",parent.document),curFrame=$(window.frameElement),openIviewCmdIndex=cmdJsonObj.reduce(function(e,a,t){return"openiview"==a.cmd&&e.push(t),e},[]),saveAndPopupExist=!1,i=0;i<cmdJsonObj.length;i++){try{saveAndPopupExist="action"==cmdJsonObj[i].cmd&&"save"==cmdJsonObj[i].cmdval&&cmdJsonObj.findIndex(function(e){return"pop"==e.showin})>-1,saveAndPopupExist&&eval(callParent("isSuccessAlertInPopUp")+"= true")}catch(ex){}if(!("printfile"==cmdJsonObj[i].cmd&&""!=cmdName&&""!=cmdVal&&cmdName==cmdJsonObj[i].cmd&&cmdVal==cmdJsonObj[i].cmdval||"openiview"==cmdJsonObj[i].cmd&&openIviewCmdIndex.length>0&&openIviewCmdIndex[0]!=i||saveAndPopupExist))if(cmdName=cmdJsonObj[i].cmd,cmdVal=cmdJsonObj[i].cmdval,multipleDocs=cmdJsonObj[i].multiprintdocs,cmdJsonObj[i].lockedby&&(lockedBy=cmdJsonObj[i].lockedby),"openfile"==cmdName||"printfile"==cmdName){var docID,fldPath,filepath="",compressValue="",dirName="";cmdVal=CheckUrlSpecialChars(cmdVal);var fldPrintDirective=GetFieldValue("axp_printdirective000F1");""!=fldPrintDirective&&(fldPath=fldPrintDirective.split("~"),compressValue=fldPath[0].toString(),docID=GetFieldValue(fldPath[1]+"000F1"),(docID=undefined)&&(docID=""),fldPath.length>2&&(filepath=fldPath[2].toString()));var left=screen.width/2-200,top=screen.height/2-100;if("yes"==multipleDocs){dirName=cmdJsonObj[i].directory;var na="./OpenFiles.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}var windobj=window.open(na,"_blank");windobj.focus(),windobj.close()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(cmdVal.toLowerCase().indexOf("pdf")>-1){dirName="PDF",compressValue=compressValue||"";var isAttPDF="F";if(isAttPDF=cmdJsonObj[i].isatt,"true"==compressValue.toLowerCase()){var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}var windobj=window.open(na,"_blank");windobj.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if("T"==isAttPDF){isSelfOpened=!0,cmdVal==undefined&&(cmdVal=""),compressValue==undefined&&(compressValue=""),filepath==undefined&&(filepath=""),docID==undefined&&(docID=""),dirName==undefined&&(dirName="");var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName+"&Imp=t",curWin;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}"function"==typeof fixUnloadOnWindowSelfDownloads&&fixUnloadOnWindowSelfDownloads(window),curWin=window.open(na,"_self")}catch(ex){"function"==typeof BeforeWindowClose&&(window.onbeforeunload=BeforeWindowClose)}}else if(1==cmdJsonObj.length)if(iframeindex>-1&&null!=iframeindex){var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}var windobj=window.open(na,"axpiframe");windobj.focus(),window.parent.closeFrame()}catch(ex){window.parent.closeFrame(),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else if(3==cmdJsonObj.length&&"action"==cmdJsonObj[0].cmd&&"openfile"==cmdJsonObj[2].cmd)OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else{var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(","),winobj=window.open(na,"",params);winobj.moveTo(0,0),winobj.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}}else{isSelfOpened=!0,cmdVal==undefined&&(cmdVal=""),compressValue==undefined&&(compressValue=""),filepath==undefined&&(filepath=""),docID==undefined&&(docID=""),dirName==undefined&&(dirName="");var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName+"&Imp=t",curWin;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}"function"==typeof fixUnloadOnWindowSelfDownloads&&fixUnloadOnWindowSelfDownloads(window),curWin=window.open(na,"_self")}catch(ex){"function"==typeof BeforeWindowClose&&(window.onbeforeunload=BeforeWindowClose)}}}else if("recordlocked"==cmdName){AxIsTstructLocked=cmdVal;var cutMsg=eval(callParent("lcm[46]"));ShowInfoDialog(cutMsg+" - "+lockedBy),"admin"==user&&$("#dvMessage table tr").append('<a href="javascript:void(0)" id="lnkUnlockTstruct" onclick="javascript:forceUnlockTstruct();" title="Unlock" class="handCur">Unlock</a>').find("td").width("100%")}else if("done"==cmdName)showAlertDialog("success",2026,"client");else if("new"==cmdName)if(AxActiveAction="New",GetFldSetCarryValue(),SetCarryFlds.length>0){var querySCFld="";SetCarryFlds.forEach(function(e){var a=e.split("♠")[0];a=a.substring(0,a.lastIndexOf("F")-3);var t=e.split("♠")[1];querySCFld+="&"+a+"="+t}),querySCFld+="&act=open",AvoidPostBackAfterSave("tstruct.aspx?transid="+transid+querySCFld)}else AvoidPostBackAfterSave("tstruct.aspx?transid="+transid);else if("close"==cmdName)closeRemodalwindow();else if("refreshpage"==cmdName)try{if("axpiframe"===curFrame.attr("id"))axFramReload=!0,ReloadMiddleIframe();else{var url="./tstruct.aspx?&transid="+tst;window.document.location.href=url}}catch(ex){window.document.location.href=window.document.location.href}else if("refreshparent"==cmdName)window.opener.location.reload();else if("refresh"==cmdName){SetSession({key:"IsFromChildWindow",val:"true"}),iViewRefresh=!0;var localIviewName=findGetParameter("ivname",window.document.location.href);if(null!=localIviewName)try{var historyIviewLink=callParentNew("appLinkHistory")[callParentNew("curPageIndex")],historyIviewName=findGetParameter("ivname",historyIviewLink);window.document.location.href=null!=historyIviewName&&historyIviewName==localIviewName?historyIviewLink:window.document.location.href}catch(ex){window.document.location.href=window.document.location.href}else window.document.location.href=window.document.location.href}else if("canceled"==cmdName){if("no"!=cmdVal){var canReason=cmdJsonObj[i].reason;ShowInfoDialog(cancelMsg+" "+canReason),tstructCancelled="Cancelled",Readonlyform();var imgSave=$j("#imgSaveTst");imgSave.length>0&&(imgSave.prop("disabled",!0),imgSave.attr("disabled","disabled"),imgSave.css("cursor","default"));var btnSave=$j("#btnSaveTst");btnSave.length>0&&btnSave.attr("disabled","disabled")}}else if("opentstruct"==cmdName||"clear"==cmdName){var tstid=cmdVal;"clear"==cmdName&&(tstid=transid);var popname="openPop"+tstid;popup=cmdJsonObj[i].showin;var tparams="";cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)),"mntss"==tstid&&tparams.indexOf("&actionfld=change")>-1?callParentNew("actionfldflag=","change"):callParentNew("actionfldflag=","");var designParam="";if(actnName.startsWith("axpdesign_")&&(designParam="&theMode=design"),axpConfigNavType!=undefined&&""!=axpConfigNavType||!parFrm.hasClass("frameSplited")||"ad_tb"==tstid||"ad_tg"==tstid?axpConfigNavType&&""!=axpConfigNavType&&(popup="split"==axpConfigNavType?"split":"popup"==axpConfigNavType?"pop":"newpage"==axpConfigNavType?"newpage":""):popup="split","pop"==popup){tparams+="&AxPop=true";var openpopup="tstruct.aspx?act=open&transid="+tstid+tparams+designParam,popupWidth=("ad_tg"==tstid?"80vw":"")||"";"ad_as"==tstid?callParentNew("createPopupdesign")(openpopup):createPopup(openpopup,"",popupWidth)}else if("newpage"==popup)popupFullPage("tstruct.aspx?act=open&transid="+tstid+tparams+designParam);else if("split"!=popup){var redirectionLink="tstruct.aspx?act=open&transid="+tstid+tparams+designParam;"ad_sp"==tstid&&(redirectionLink="tstructnew.aspx?act=open&transid="+tstid+tparams+designParam);var customCalled=!1;try{customCalled=loadInMiddle1(redirectionLink,cmdJsonObj)}catch(ex){}customCalled||(window.document.location.href=redirectionLink)}else"split"==popup&&callParentNew("OpenOnPropertyBase(".concat("tstruct.aspx?act=open&transid="+tstid+tparams+designParam,")"),"function")}else if("loadtstruct"==cmdName){var tstid=cmdVal,popname="loadPop"+tstid;popup=cmdJsonObj[i].showin;var tparams="";if(cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)),axpConfigNavType!=undefined&&""!=axpConfigNavType||!parFrm.hasClass("frameSplited")||"ad_tb"==tstid||"ad_tg"==tstid?axpConfigNavType&&""!=axpConfigNavType&&(popup="split"==axpConfigNavType?"split":"popup"==axpConfigNavType?"pop":"newpage"==axpConfigNavType?"newpage":""):popup="split","pop"==popup){tparams+="&AxPop=true";var loadpopup="tstruct.aspx?act=load&transid="+tstid+tparams;"ad_tb"!=tstid&&"ad_tg"!=tstid&&"ad_as"!=tstid?createPopup(loadpopup):callParentNew("createPopupdesign")(loadpopup)}else"newpage"==popup?popupFullPage("tstruct.aspx?act=load&transid="+tstid+tparams):"split"!=popup?window.document.location.href="tstruct.aspx?act=load&transid="+tstid+tparams:"split"==popup&&(appGlobalVarsObject._CONSTANTS.callerWindow?appGlobalVarsObject._CONSTANTS.callerWindow.renderFormProperties("tstructnew.aspx?act=load&transid="+tstid+tparams):callParentNew("OpenOnPropertyBase(".concat("tstruct.aspx?act=load&transid="+tstid+tparams,")"),"function"))}else if("openiview"==cmdName){var ivn=cmdJsonObj[i].cmdval,popname="ivewPop"+ivn;popup=cmdJsonObj[i].showin;var tparams="";if(cmdJsonObj[i].pname){try{tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)}catch(ex){}"Iview"!=document.title&&(tparams+=(tparams?"&":"")+"AxIvNav=true")}if($j("#axp_ivname000F1").length>0&&(ivn=$j("#axp_ivname000F1").val()),axpConfigNavType!=undefined&&""!=axpConfigNavType||!parFrm.hasClass("frameSplited")||"toolbgrp"==ivn?axpConfigNavType&&""!=axpConfigNavType&&(popup="split"==axpConfigNavType?"split":"popup"==axpConfigNavType?"pop":"newpage"==axpConfigNavType?"newpage":""):popup="split","pop"==popup){var pop="true";tparams+="&AxIsPop=true";var loadpopup="ivtoivload.aspx?ivname="+ivn+"&"+tparams,popname,popupWidth=("toolbgrp"==ivn?"80vw":"")||"";createPopup(loadpopup,"",popupWidth)}else if("newpage"==popup)popupFullPage("ivtoivload.aspx?ivname="+ivn+"&"+tparams);else if("split"!=popup){var loadMiddle1URL="ivtoivload.aspx?ivname="+ivn+"&"+tparams;try{"middle1"==window.frameElement.id&&callParentNew("middle1URL=",loadMiddle1URL)}catch(ex){}var srcUrl="ivtoivload.aspx?ivname="+ivn+"&AxIvNav=true",linkParams=tparams;linkParams=linkParams.replace(/~/g,"="),linkParams=linkParams.replace(/¿/g,"&"),linkParams=ReplaceUrlSpecialChars(linkParams),""!=linkParams&&(setIviewNavigationData(linkParams,ivn),callParentNew("updateAppLinkObj("+srcUrl+",1)","function")),window.document.location.href=srcUrl}else"split"==popup&&callParentNew("OpenOnPropertyBase(".concat("ivtoivload.aspx?ivname="+ivn+"&"+tparams,")"),"function")}else if("openpage"==cmdName){pgname=cmdVal;var tparams="";cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)),""!=pgname&&pgname.toLowerCase().startsWith("pagets")?(pgname=pgname.substring(6),window.document.location.href="tstruct.aspx?act=open&transid="+pgname+tparams):""!=pgname&&pgname.toLowerCase().startsWith("pageiv")&&(pgname=pgname.substring(6),window.document.location.href="ivtoivload.aspx?ivname="+pgname+"&"+tparams)}else if("openpdf"==cmdName){var pdfpath=cmdVal,len=pdfpath.length,filepos=InStrPath(pdfpath)+1;pdfpath=pdfpath.substring(filepos,len),window.location.href="../"+pdfpath}else if("pageload"==cmdName||"loadpage"==cmdName){pgname=cmdVal;var tparams="";cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)),""!=pgname&&pgname.toLowerCase().startsWith("pagets")?(pgname=pgname.substring(6),window.document.location.href="tstruct.aspx?act=load&transid="+pgname+tparams):""!=pgname&&pgname.toLowerCase().startsWith("pageiv")&&(pgname=pgname.substring(6),window.document.location.href="ivtoivload.aspx?ivname="+pgname+"&"+tparams)}else if("action"==cmdName&&"save"==cmdVal)saveAction=!0,AxActionSave=!0;else if("recid"==cmdName){if(1==saveAction){$j("#recordid000F0").val(cmdVal);var recIdVal=$j("#recordid000F0").val();if("0"!=recIdVal){if(saveActRecSuccess=!0,eval(callParent("isSuccessAlertInPopUp")+"= true"),"axpiframe"===curFrame.attr("id")&&(axFramReload=!0,ReloadMiddleIframe()),"sect"==transid||"ad_ih"==transid)try{dwbCustomSaveRedirect()}catch(ex){}if("undefined"!=typeof transid&&"ad_lg"==transid)try{btn22onclick()}catch(ex){}}}}else if("newtrans"==cmdName)$j("#recordid000F0").val("0"),recordid="0";else if("filepath"==cmdName)try{var curWin;try{"function"==typeof fixUnloadOnWindowSelfDownloads&&fixUnloadOnWindowSelfDownloads(window),curWin=window.open("download.aspx","_self","width=400,height=300,scrollbars=yes,resizable=yes")}catch(ex){"function"==typeof BeforeWindowClose&&(window.onbeforeunload=BeforeWindowClose)}}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}else"copytrans"==cmdName&&"true"==cmdVal&&($j("#recordid000F0").val("0"),recordid="0")}}function forceUnlockTstruct(){var e=$j("#recordid000F0").val();if("0"!=e&&AxIsTstructLocked&&callParentNew("isLockOnRead")){try{ASB.WebService.UnlockTStructRecord(tst,e,!0,function(e,a){location.reload()})}catch(a){}}}function redirectOnSaveAction(){var e=$j("#recordid000F0").val(),a="";if(void 0!==callParentNew("axpiframe","id")&&(a="&AxSplit=true"),""==e||"0"==e)window.location.href="tstruct.aspx?act=load&transid="+tst+a;else if(saveActRecSuccess=!0,AxIsTstructCached)SaveInCache(e,"SaveAction");else{e&&"axcad"==transid&&clearCardCache(e);var t="";try{var r=callParentNew("axpiframe","id");if(void 0!==r){var l=getqsParameterByName("hltype",r.src);t=null==l?"":l}}catch(i){}if(!callParentNew("isDWB")||"mntss"!=tst&&"NF_AG"!=tst&&"ad_s"!=tst&&"ad__d"!=tst&&"ad_ge"!=tst&&"ad_md"!=tst&&"ad_fg"!=tst||"load"==t)window.location.href="tstruct.aspx?act=load&transid="+tst+"&recordid="+e+a;else{var o=callParentNew("dwbtstparams");"mntss"!=tst&&"NF_AG"!=tst||callParentNew("dwbtstparams=",o+"&oldrecid="+e),callParentNew("OpenOnPropertyBase(".concat("tstruct.aspx?act=open&transid=paget"+callParentNew("dwbtstparams"),")"),"function")}}}function SetRows(e,a,t,r,l,o){AxActiveDc=e;var i=GetDcRowCount(e);a=parseInt(a,10);var n=$j(".wrapperForGridData"+e+" tbody tr").length,d=!1;if(TstructHasPop&&(d=IsDcPopGrid(e))&&"GetDep"==r){for(var s=GetPopRows(AxActivePDc,GetClientRowNo(AxActivePRow,AxActivePDc),e).split(","),c=new Array,p=0;p<s.length;p++)c.push(s[p]);c.sort()}if(""!=t){var f;f=t.split(",");for(var m=0;m<f.length;m++){var u=f[m].substring(0,1),v=f[m].substring(1);if("d"==u)if("*"==v){GetDcRowCount(e);"no"!=o&&SetRowsInDc(e,i,r)}else DeleteDbRow(e,v,r);else if(TstructHasPop){var w=$j.inArray(e,DCFrameNo);"LoadData"!=r&&("GetDep"!=r||0!=n)||"0"==$j("#recordid000F0").val()&&"True"!=DCHasDataRows[w]?"i1"!=f[m].toString()||d&&"GetDep"==r&&"True"==l?(AddRow(e,r),AxDepRows.push(v+"~"+GetDcRowCount(e))):(AxDepRows.push(v+"~1"),1==d?"LoadData"!=r&&($j("#sp"+e+"R001F"+e).show(),UpdateNewPopInfo(e,"001"),UpdatePopUpArrays(e,"001",!0,"Add"),UpdateDcRowArrays(e,"001","Add")):(UpdatePopUpArrays(e,"001",!1,"Add"),UpdateDcRowArrays(e,"001","Add"))):"no"!=o&&(axInlineGridEdit?addNewInlineGridRow(e,r):AddNewRowInDc(e,r))}else{w=$j.inArray(e,DCFrameNo);"LoadData"!=r&&("GetDep"!=r||0!=n)||"0"==$j("#recordid000F0").val()&&"True"!=DCHasDataRows[w]?"i1"!=f[m].toString()&&""!=f[m].toString()||"i1"==f[m].toString()&&-1!=t.indexOf("i2")?axInlineGridEdit?addNewInlineGridRow(e,r):axInlineGridEdit||"form"!=AxpGridForm?AddNewRowInDc(e,r):AddNewFormRowInDc(e,r):"GetDep"!=r&&"Action"!=r||"i1"!=f[m].toString()||-1!=t.indexOf("i2")||-1==t.indexOf("d*")||"yes"!=o||(axInlineGridEdit?addNewInlineGridRow(e,r):axInlineGridEdit||"form"!=AxpGridForm?AddNewRowInDc(e,r):AddNewFormRowInDc(e,r)):"GetDep"==r&&"i1"==f[m].toString()&&-1==t.indexOf("i2")&&"False"==DCHasDataRows[w]||"no"!=o&&(axInlineGridEdit?addNewInlineGridRow(e,r):axInlineGridEdit||"form"!=AxpGridForm?AddNewRowInDc(e,r):AddNewFormRowInDc(e,r))}}ResetSerialNo(e,"000F"+e,a,!0)}}function DeletePopRows(e,a){for(var t=0;t<PopGridDcNo.length;t++)if(PopGridDcNo[t]==e){for(var r=PopRows[t].toString().split(","),l="",o=0;o<r.length;o++)r[o]!=a&&(""==l?l=r[o]:l+=","+r[o]);PopRows[t]=l}}function DeleteDbRow(e,a,t){var r=GetClientRowNo(a,e);if(IsSingleRow(e))"LoadData"!=t&&ClearDeletedFields(e,r);else{if(UpdateChangedDbRow(e,a,"Delete"),DeleteRowHtml(e,r),TstructHasPop)1==IsDcPopGrid(e)&&(DeletePopRows(e,r),"1"==a&&UpdatePopUpArrays(e,"001",!0,"Delete"));var l=GetDcRowCount(e);l=parseInt(l,10)-1,SetRowCount(e,l);var o=GetSerialNoCnt(e);o=parseInt(o,10)-1,SetSerialNoCnt(e,o)}}function UpdateChangedDbRow(e,a,t,r){for(var l=!1,o=-1,i=0;i<RowDcNo.length;i++)if(RowDcNo[i]==e&&DbRowNo[i]==a){o=i,l=!0;break}"Delete"==t?l&&-1!=o&&(RowDcNo.splice(o,1),DbRowNo.splice(o,1),ClientRowNo.splice(o,1),ResetDbRowNo(e,a,t)):l&&-1!=o&&(RowDcNo.insert(o,e),DbRowNo.insert(o,a),ClientRowNo.insert(o,r),ResetDbRowNo(e,a,t))}function DeleteRowHtml(e,a){$j("#sp"+e+"R"+a+"F"+e).remove()}function SetRowsInDc(e,a,t){if($j("#hdnRCntDc"+e).length>0){if(("LoadData"==t&&a>0?parseInt(a,10):axInlineGridEdit?a:parseInt(a,10)-1)>0)ClearRowsInGrid(e,t);else{var r=GetClientRowNo("1",e);ClearDeletedFields(e,r,"",!0)}}}function ClearRowsInGrid(e,a){document.getElementById("Frame"+e);var t=0;if(t=GetDcRowCount(e),t=parseInt(t,10),"LoadData"==a?t+=1:t=axInlineGridEdit?t+1:t,t>=1){for(var r=t-1;r>=1;r--){var l=GetClientRowNo(r,e),o=l+"F"+e,i="sp"+e+"R"+l+"F"+e;$j("tr#"+i).length>0?($j("tr#"+i).hasClass("inEditMode")&&$j("#editCancelButton"+e).click(),$j("tr#"+i).remove()):$j("div#"+i).hasClass("editWrapTr"),UpdateDcRowArrays(e,l,"Delete");for(var n=0;n<RowDcNo.length;n++)RowDcNo[n]==e&&parseInt(ClientRowNo[n],10)==r+1&&(r==t-1&&IsRowDupInDcArray(e,"001")?(ClientRowNo[n]="001",UpdateDcRowArrays(e,ClientRowNo[n],"Delete")):r==t-1&&(ClientRowNo[n]="001"));for(var d=GetGridFields(e),s=0;s<d.length;s++){var c=d[s]+o;RemoveDeletedFields(c)}}var p=GetClientRowNo("1",e);UpdateDcRowArrays(e,p,"Delete"),UpdateDcRowArrays(e,"001","Add");var f=GetGridFields(e);for(r=0;r<f.length;r++){c=f[r]+"001F"+e;CallSetFieldValue(c,"")}}changeEditLayoutIds(0,e),SetRowCount(e,"1",undefined,a),SetSerialNoCnt(e,"1")}function IsRowDupInDcArray(e,a){for(var t=0,r=0;r<RowDcNo.length;r++)RowDcNo[r]==e&&ClientRowNo[r]==a&&t++;return t>1}function ConstructFieldName(e,a,t){return e+GetClientRowNo(t,a)+"F"+a}function GetFirstRow(e){new Array;return GetDcClientRows(e).getMinVal()}function CopyFromMasterRow(e,a,t,r,l,o){var i=GetFieldsName(e),n="";if(IsDcGrid(a)){if(-1!=GetFormatGridIndex(a)){if(l&&""!=l){var d="gridDc"+a,s=GetFormatRowIndex(d,a,l,"header"),c=$j("#"+d+" tbody>tr:eq("+(s+1)+")").attr("id"),p=c.lastIndexOf("F");t=c.substring(p-3,p)}}else t=GetFirstRow(a);n=i+GetRowNoHelper(t)+"F"+a;var f=$j("#"+e);if("select-one"==f.attr("type")||"select-one"==f.prop("type")){$j("#"+e+" option").length>0&&$j("#"+e+" option").remove(),$j("#"+n+" option").each(function(){var a=$j(this);$j("#"+e).append($j("<option>",{value:a.val(),text:a.text()}))});var m=$j("#"+n)[0].selectedIndex;if(2==$j("#"+e+" option").length){var u=$j.inArray(i,FNames);"True"==FldAutoSelect[u]&&1==m?$j("#"+e)[0].selectedIndex=1:$j("#"+e)[0].selectedIndex=0}else $j("#"+e)[0].selectedIndex=0;o==undefined&&(o=IsDcPopGrid(a)),RedrawField(e,r,o)}else $j("#"+e).hasClass("fldAutocomplete")||$j("#"+e).hasClass("fldmultiSelect")||$j("#"+e).val($j("#"+n).val())}}function DoFormControlPrivilege(e,a){if("Approved"!=appstatus&&"Rejected"!=appstatus){var t,r;if(t=GetFieldsRowNo(e),r=GetFieldsDcNo(e),null!=e&&e!=undefined&&-1!=e.indexOf("axpvalid")&&""!=a&&a!=undefined){var l=a.toString().toUpperCase();if("B"==l)DisableDeleteBtn("del"+t+"F"+r,l);else if("A"==l)DisableDeleteBtn("del"+t+"F"+r,l);else if("C"==l){DisableDeleteBtn("del"+t+"F"+r,l);for(var o=GetGridFields(r),i=0;i<o.length;i++){e=o[i]+t+"F"+r;var n=$j("#"+e);n.length>0&&n.prop("disabled",!0),$j("#sp"+r+"R"+t+"F"+r).find(".pickimg").each(function(){$j(this).prop("disabled",!0),$j(this).css("cursor","default")})}}DisNewGridDelBtn(r,t,l)}}}function DisNewGridDelBtn(e,a,t){try{"B"!=t&&"C"!=t||($("#sp"+e+"R"+a+"F"+e+" td:first").find(".glyphicon.glyphicon-remove icon-arrows-remove").addClass("disabled").prop("disabled",!0),$("#sp"+e+"R"+a+"F"+e+" td:first").find(".glyphicon.glyphicon-trash").addClass("disabled").prop("disabled",!0),"C"==t&&$("#sp"+e+"R"+a+"F"+e+" td:first").find(".glyphicon.glyphicon-pencil.icon-software-pencil").addClass("disabled").prop("disabled",!0))}catch(r){}}function DisableDeleteBtn(e,a){delImg=$j("#"+e),delImg.length>0&&($j(this).prop("disabled",!0),delImg.css("cursor","default"),"C"==a||"B"==a?(delImg.addClass("disabledelete"),delImg.unbind("click")):(delImg.removeClass("disabledelete"),delImg.bind("click")))}function AttachFiles(){displayBootstrapModalDialog("File Upload","xs","147px",!0,"./fileupload.aspx?act=attach")}function callAfterFileAttach(){var e=$j("#attachfname").val();SetFormDirty(!0),FindDuplicate(e)?showAlertDialog("warning",2027,"client"):(filenamearray.push(e),ConstructAttachments())}function ConstructAttachments(){var e="",a="",t=0,r=0;if($j("#recordid000F0").length>0&&(r=$j("#recordid000F0").val()),fileonloadarray.length>0)for(var l=0;l<fileonloadarray.length;l++){var o='"'+fileonloadarray[l].toString()+'"';t=parseInt(l,10)+1,e+=0==l?'<div class="row attachmentData"><div class="col-md-4 col-sm-6"><div class="attachments"><a class=\'linkrem\' alt=\'Remove File\' onclick=\'javascript:RemoveFile('+o+","+r+");'><img  class='close pull-right' src='../axpimages/icons/16x16/cross.png' alt='delete' /></a>&nbsp;<a id=loadattach"+t+' class="pull-left Attachlink flagcount" style="cursor:pointer;" onclick=\'javascript:OpenAttachment('+o+","+r+");'>"+fileonloadarray[l].toString()+"</a></div></div>":"<div class=\"col-md-4 col-sm-6\"><div class=\"attachments\"><a class='linkrem' alt='Remove File' onclick='javascript:RemoveFile("+o+","+r+");'><img class='close pull-right' src='../axpimages/icons/16x16/cross.png' alt='delete' /></a>&nbsp;<a id=loadattach"+t+' class="pull-left Attachlink flagcount" style="cursor:pointer;" onclick=\'javascript:OpenAttachment('+o+","+r+");'>"+fileonloadarray[l].toString()+"</a></div></div>"}if(filenamearray.length>0){for(var i=0;i<filenamearray.length;i++){o='"'+(o=CheckUrlSpecialChars(o=filenamearray[i].toString()))+'"';0==t?(t=1,e+='<div class="row attachmentData"><div class="col-md-4 col-sm-6"><div class="attachments"> <a class="pull-left Attachlink flagcount"  id=loadattach" + attcount + " style="cursor:pointer;" onclick=\'javascript:OpenAttachment('+o+","+r+(r>0?",true":"")+" );' >"+filenamearray[i].toString()+"</a> <a class=linkrem alt=Remove File onclick='javascript:RemoveNewFiles("+o+');\'> <img class="close pull-right" src="../axpimages/icons/16x16/cross.png"  alt=""> </a><div class="clear"></div></div></div>'):(t=parseInt(t,10)+1,e+='<div class="col-md-4 col-sm-6"><div class="attachments"> <a class="pull-left Attachlink flagcount"  id=loadattach" + attcount + " style="cursor:pointer;"  onclick=\'javascript:OpenAttachment('+o+","+r+(r>0?",true":"")+");' >"+filenamearray[i].toString()+"</a> <a class=linkrem alt=Remove File onclick='javascript:RemoveNewFiles("+o+');\'> <img class="close pull-right" src="../axpimages/icons/16x16/cross.png"  alt=""> </a><div class="clear"></div></div></div>')}e+="</div>"}if(a+="<input id=hdncount type=hidden value="+t+">",$j("#attachment-overlay").show(),$j("#attachment-overlay").css("display","block !important;"),$j("#attachment-overlay").removeClass("hide"),$j("#attachment-overlay").html(e+a),-1!=GetFieldIndex("axp_attachedfiles")){var n=GetActualFieldName("axp_attachedfiles"),d=filenamearray.join(","),s=GetFieldsDcNo(n),c=GetDbRowNo(GetFieldsRowNo(n),s);GetFieldsRowNo(n);UpdateFieldArray(n,c,d,"parent"),CallSetFieldValue(n,d)}}function RemoveNewFiles(e){e=ReplaceUrlSpecialChars(e);try{ASB.WebService.RemoveNewFiles(e,sid)}catch(a){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}RemoveArrVal(e,filenamearray),$j("#attachment-overlay").hide(),ConstructAttachments(),adjustwin("100",window)}var attFileName="";function RemoveFile(fname,rid){if("undefined"==typeof tstructCancelled||"cancelled"!==tstructCancelled.toLowerCase()){attFileName=ReplaceUrlSpecialChars(fname);var cutMsg=eval(callParent("lcm[47]")),glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var RemoveFileCB=$.confirm({title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:"false",rtl:isRTL,escapeKey:"buttonB",content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){RemoveFileCB.close(),RemoveFileAfterConfirm()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy")}}}})}else showAlertDialog("warning",eval(callParent("lcm[303]")));function RemoveFileAfterConfirm(){var e='<root axpapp="'+proj+'"  sessionid="'+sid+'"  filename="'+fname+'" transid="'+tst+'"  recordid="'+rid+'"   trace="'+trace+'">';try{ASB.WebService.RemoveAttachment(e,tstDataId,SuccessRemAttFile)}catch(a){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}}}function SuccessRemAttFile(e,a){if(!CheckSessionTimeout(e)){var t=$j.parseJSON(e);if(t.message){var r=t.message[0].msg;"done"==r?(RemoveArrVal(attFileName,fileonloadarray),ConstructAttachments(),SetFormDirty(!0)):showAlertDialog("error",r)}}}function RemoveArrVal(e,a){for(var t=0;t<a.length;t++)if(e==a[t]){a.splice(t,1);break}}function OpenAttachment(e,a,t){e=ReplaceUrlSpecialChars(e);var r='<root axpapp="'+proj+'"  sessionid="'+sid+'"  filename="'+e+'" transid="'+tst+'"  recordid="'+a+'"   trace="♦♦GetAttachedFile♦">';try{var l=$j(".attachmentData a").length/2;if(0==a||""==a||$j(".attachmentData .flagcount").length!=l||t){var o='{"command":[{"cmd":"openfile","cmdval":';SuccChoicesOpenAtt(o=o+'"'+e+'","isatt":"T"}]}',null)}else ASB.WebService.ViewAttachment(r,tstDataId,SuccChoicesOpenAtt)}catch(i){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}}function SuccChoicesOpenAtt(e,a){CheckSessionTimeout(e)||AssignLoadValues(e,"")}function FindDuplicate(e){for(var a=0;a<fileonloadarray.length;a++)if(e==fileonloadarray[a])return!0;for(var t=0;t<filenamearray.length;t++)if(e==filenamearray[a])return!0;return!1}function EvalPrepared(fldName,rowNo,exprStr,exprType){""!=exprStr&&(exprStr=exprStr.replace(/♦/g,","));var fName=GetFieldsName(fldName);wordlist=new Array;var fldIdx=$j.inArray(fName,FNames),posStr="";-1!=fldIdx&&(posStr=ExprPosArray[fldIdx]);var estr=CheckEval(exprStr,rowNo);estr!=exprStr&&(posStr=""),exprStr=estr,""==posStr&&(posStr=PrepareExpression(fName,exprStr,exprType),ExprPosArray[fldIdx]=posStr),wordlist=new Array;var startPos=posStr.toString().substring(0,posStr.toString().indexOf(",")),endPos=posStr.toString().substring(posStr.toString().indexOf(",")+1);startPos=parseInt(startPos,10),endPos=parseInt(endPos,10);for(var i=startPos;i<=endPos;i++){var strExp=EWords[i],ch=strExp.split(""),firstchar=ch[0];if("v"==firstchar){var fName=strExp.substring(1),fldVal=PrepareField(fName,rowNo);strExp=fldVal}else if("c"==firstchar){var fName=strExp.substring(1);fName=GetExactFieldName(fName),strExp="c"+fName}wordlist.push(strExp)}for(var fun=!0,i=0;i<wordlist.length;i++)"sFIELDCHANGED"!=wordlist[i]&&"sfieldchanged"!=wordlist[i].toString().toLowerCase()||(fun=!1);if(fun){EvalFun();var s=GetExprString();if(""==s)return"";try{var res=eval(s)}catch(ex){try{var res=eval("'"+s+"'")}catch(exp){res=""}}return"Infinity"==res&&(res=0),res}return!0}function PrepareField(fldName,rowNo){var fldVal="",templ="";if("activerow"==fldName.toString().toLowerCase())fldVal=GetClientRowNo(AxActiveRowNo,AxActiveDc);else if("activeprow"==fldName.toString().toLowerCase())fldVal=GetClientRowNo(AxActivePRow,AxActivePDc);else{var dcNo=GetDcNo(fldName);if(fldName=GetExactFieldName(fldName),templ=IsDcGrid(dcNo)?fldName+GetClientRowNo(rowNo,dcNo)+"F"+dcNo:fldName+"000F"+dcNo,document.getElementById(templ))chrstate=!1,templ=templ;else{chrstate=!1;var dcNo=GetDcNo(fldName),clientRow="";if(IsDcPopGrid(dcNo)?(clientRow=GetClientRowNo(AxActiveRowNo,AxActiveDc),templ=fldName+clientRow+"F"+AxActiveDc):TstructHasPop&&IsDcParentGrid(dcNo)?""!=AxActivePRow&&""!=AxActivePDc?(clientRow=GetClientRowNo(AxActivePRow,AxActivePDc),templ=fldName+clientRow+"F"+AxActivePDc):(clientRow=GetClientRowNo(AxActiveRowNo,AxActiveDc),templ=fldName+clientRow+"F"+AxActiveDc):IsDcGrid(dcNo)&&"000"==rowNo?(clientRow=GetClientRowNo(AxActiveRowNo,dcNo),templ=fldName+clientRow+"F"+dcNo):templ=fldName+rowNo+"F"+dcNo,document.getElementById(templ))templ=templ;else{var fIdx=$j.inArray(fldName,FNames);-1!=fIdx?fldv="":fldVal=fldName;for(var k=0;k<varlist.length;k++)if(fldVal==varlist[k].toLowerCase()){chrstate=!0,fldVal=valuelist[k];var dtlenth=fldVal.split("/");2==dtlenth[0].length&&2==dtlenth[1].length&&4==dtlenth[2].length?s="d"+fldVal:isNaN(fldVal)?fldVal="s"+fldVal:(""==fldVal&&(fldVal=0),fldVal=fldVal,fldVal="n"+fldVal,1==fldVal.length&&(fldVal="n0"))}}}if(!chrstate)if(document.getElementById(templ)){fldVal=GetFieldValue(templ),fldName==AxAutoGenFld&&"Auto"==fldVal&&(fldVal="");var fldIdx=$j.inArray(fldName,FNames),fldDType="";if(-1!=fldIdx&&(fldDType=FDataType[fldIdx].toString()),""!=fldDType)if("Date/Time"==fldDType){var glCulture=eval(callParent("glCulture"));""!=fldVal&&glCulture!=undefined&&"en-us"==glCulture&&(fldVal=GetDateStr(fldVal,"mm/dd/yyyy","dd/mm/yyyy")),fldVal="d"+fldVal}else"Character"==fldDType?fldVal="s"+fldVal:(fldVal.length>3&&-1!=fldVal.indexOf(",")&&(fldVal=removeCommas(fldVal)),""==fldVal&&(fldVal=0),fldVal="n"+fldVal,1==fldVal.length&&(fldVal="n0"));else isNaN(fldVal)?fldVal="s"+fldVal:(fldVal.length>3&&-1!=fldVal.indexOf(",")&&(fldVal=removeCommas(fldVal)),""==fldVal&&(fldVal=0),fldVal="n"+fldVal,1==fldVal.length&&(fldVal="n0"))}else templ=fldName,""!=fldVal&&(isNaN(fldVal)?t="s":t="n",fldVal=t+fldVal)}for(var r=0;r<funclist.length;r++)if(templ.toLowerCase()==funclist[r].toString().toLowerCase()){fldVal="f"+funclist[r],chrstate=!0;break}return fldVal}function CheckSpecialCharInGlobalVar(e){return e=e.replace(/;bkslh/g,"\\")}function PrepareExpression(e,a,t){expressiontype=t;var r=0;varlist=new Array,valuelist=new Array,wordlist=new Array;var l=0;expFldname=e;transid,e.lastIndexOf("F");var o=a;if(Parameters.length>1)for(var i=0;i<Parameters.length;i++){var n=Parameters[i].toString();n=n.split("~"),varlist[l]=n[0].toString(),valuelist[l]=CheckSpecialCharInGlobalVar(n[1].toString()),l++}varlist[l]="activerow",valuelist[l]=AxActiveRowNo;new Array,new Array;o=TrimAll(o);for(var d=(o+=" ").split(""),c=0;c<d.length;c++){if("{"!=d[c])if("}"!=d[c])if(constword)wordstring+=d[c];else if((isDelimiter(d[c])||isOperator(d[c]))&&(""!=wordstring&&(wordstring="v"+wordstring,wordlist[r]=wordstring,r++),wordstring=""),"("!=d[c])")"!=d[c]?isOperator(d[c])?(wordlist[r]="o"+d[c],r++):" "!=d[c]&&(","!=d[c]?wordstring+=d[c]:(wordlist[r]="l,",r++,wordstring="")):("("==brackets.charAt(brackets.length-1)?(wordlist[r]="b)",r++):(wordlist[r]="e",r++),brackets=brackets.slice(0,-1));else{if(wordlist.length>0){var p=wordlist[wordlist.length-1];p=p.substr(0,1),brackets+="f"==p||"v"==p?"v":"("}else brackets+="(";wordlist[r]="b(",r++}else 1==bcount?(constword=!1,s="c"+wordstring,wordlist[r]=s,r++,bcount=0,wordstring=""):(bcount--,wordstring+=d[c]);else bcount>0?wordstring+=d[c]:(constword=!0,wordstring=""),bcount++}for(var f=EWords.length,m=0;m<wordlist.length;m++)EWords.push(wordlist[m]);return f+","+(EWords.length-1)}function SaveAsDraft(){try{if(1==AxGlobalChange){var e=getTabDCStatus();ASB.WebService.SaveAsDraft(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,tst,tstDataId,e,SuccessCallbackDrafts,OnSaveDraftException)}}catch(a){ShowDimmer(!1),AxWaitCursor(!1)}}function getTabDCStatus(){var e="";for(i=0;i<TabDCs.length;i++)e+="DC"+TabDCs[i]+"-"+TabDCStatus[i]+",";return e.slice(0,-1)}function SuccessCallbackDrafts(e,a){CheckSessionTimeout(e)||ShowDimmer(!1)}function OnSaveDraftException(e){AxWaitCursor(!1),ShowDimmer(!1)}function GetDependentArray(){var e=new Array;if("true"!=displayAutoGenVal&&$j(".autogen").length>0){var a=$j(".autogen")[0].id,t=GetFieldsName(a),r=GetFieldIndex(t),l="";AxAutoGenFld=t,-1!=r&&(l=FldDependents[r].toString().substring(1)),""!=l&&(e=l.split(","))}return e}function ClearImageSrc(e){IsFormDirty||SetFormDirty(!0);var a=e.id.replace("del-","").trim();$j("#"+a).attr("src","../AxpImages/upload.png");var t=parseInt(GetFieldsRowNo(a),10);UpdateFieldArray(a,t,"","parent","")}function CheckAllListItems(e){var a=e.id,t=!0;t=!!$j("#"+a).prop("checked");var r=a.replace("chkAll_","").trim(),l=$j("#hideAll_"+r),o=$j("#chkAll_"+r),i=GetChkSeparator(GetFieldsName(r));if(t){var n="";$j("input:checkbox[id='"+r+"']").each(function(){if(0==$j(this).prop("disabled")){$j(this).attr("checked","checked"),$j(this).prop("checked",!0);var e=$j(this).val();""==n?n=e:n+=i+e}}),""!=n&&UpdateAssignedFld(r)}else $j("input:checkbox[id='"+r+"']").each(function(){$j(this).removeAttr("checked"),$j(this).prop("checked",!1)});o.prop("checked")&&l.prop("checked")&&ShowSelectedChkItems("hideAll_"+r),!o.prop("checked")&&l.prop("checked")&&(l.removeAttr("checked"),l.prop("checked",!1));try{AxAfterCheckAll()}catch(d){}"undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?CheckDependencyPerf(r):CheckDependency(r)}function ShowSelectedChkItems(e){if(e!=undefined){var a=!0;a=!!$j("#"+e).prop("checked");var t=e.replace("hideAll_","").trim();$j("input:checkbox[id='"+t+"']").each(function(){a?$j(this).attr("checked")?$j(this).parent().show():$j(this).parent().hide():$j(this).parent().show()})}}function SetDcCaption(e,a){$j.inArray(e,TabDCs)>-1?$j("#ank"+e+" span.text").text(a):$j("#dcCaption"+e).text(a)}function SetDynamicDcCaptions(e){e=e||"";for(var a=0;a<DCFrameNo.length;a++)if(""==e||e==DCFrameNo[a]){var t=DCCaption[a].toString();if(-1!=t.indexOf("{")){for(var r=GetWordsBetweenCurlies(t),l=0;l<r.length;l++){var o=GetExactFieldName(r[l]),i="";if(-1!=GetFieldIndex(o)){var n=GetDcNo(o);i=IsGridField(o)?GetFieldValue(o+GetRowNoHelper(AxActiveRowNo)+"F"+n):GetFieldValue(o+"000F"+n)}else i=CheckGlobalVars(o);t=t.replace("{"+r[l]+"}",i)}SetDcCaption(DCFrameNo[a],t)}}}function GetWordsBetweenCurlies(e){for(var a,t=[],r=/{([^}]+)}/g;a=r.exec(e);)t.push(a[1]);return t}function EvaluateDcCaption(e,a){for(var t=e.split(","),r=0;r<t.length;r++)for(var l=0;l<DCFrameNo.length;l++)if(DCFrameNo[l].toString()==e){var o=DCCaption[l].toString();if(-1!=o.indexOf("{")){for(var i=GetWordsBetweenCurlies(o),n=0;n<i.length;n++){var d=GetExactFieldName(i[n]),s="";if(-1!=GetFieldIndex(d)){EvaluateAxFunction(d,d);var c=GetDcNo(d);s=GetFieldValue(d+GetRowNoHelper(AxActiveRowNo)+"F"+c)}else s=CheckGlobalVars(d);o=o.replace("{"+i[n]+"}",s)}SetDcCaption(DCFrameNo[l],o);break}}}var arrGlobalVars=new Array,arrGlobalVarValues=new Array;function CheckGlobalVars(e){var a=0;if(Parameters.length>1&&0==arrGlobalVars.length)for(var t=0;t<Parameters.length;t++){var r=Parameters[t].toString();r=r.split("~"),arrGlobalVars[a]=r[0].toString(),arrGlobalVarValues[a]=CheckSpecialCharInGlobalVar(r[1].toString()),a++}var l;return-1!=(l=$j.inArray(e,arrGlobalVars))?arrGlobalVarValues[l]:e}function UpdateAxpCurrDec(e,a){var t=new Array,r="";if((t=e.split(",")).length>0&&""!=e){r=t[0].toString();for(var l=-1,o=1;o<t.length;o++){var i=t[o];if(t[o].indexOf("~")>-1&&(i=t[o].toString().substr(0,t[o].indexOf("~"))),l=$j.inArray(i,FNames),FDecimal[l]=r,t[o].indexOf("~")>-1&&(r=t[o].toString().substring(t[o].toString().lastIndexOf("~")+1)),"GetDep"==a){if(currdecVal="",parseInt(r,10)>parseInt(FDupDecimals[l],10))return showAlertDialog("warning",2031,"client",FCaption[l]),void(currdecVal=FCaption[l]);var n="",d=FldFrameNo[l];if(IsGridField(i)){var s;s=parseInt(GetDcRowCount(d),10);for(var c=1;c<=s;c++){n=i+GetClientRowNo(c,d)+"F"+d;var p=NumericFldOnBlur(GetFieldValue(n),l);SetFieldValue(n,p),UpdateFieldArray(n,c,p,"parent")}}else{n=i+"000F"+d;p=NumericFldOnBlur(GetFieldValue(n),l);SetFieldValue(n,p);var f=GetFieldsRowNo(n),m=GetDbRowNo(f,d);UpdateFieldArray(n,m,p,"parent","")}}}}}function GetReferExpr(e,a,t){return t.indexOf("@")>-1?t.substring(1,t.indexOf("}")):t.startsWith("{")>-1?t.substring(1,t.indexOf("}")):Evaluate(e,a,t,"expr")}function OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction){if(cmdVal=cmdVal||"",filepath=filepath||"",docID=docID||"",dirName=dirName||"",saveAction)return eval(callParent("isSaveAndPrintClick")+"= true"),eval(callParent("isSavePrintValues")+".push(cmdVal)"),eval(callParent("isSavePrintValues")+".push(filepath)"),eval(callParent("isSavePrintValues")+".push(docID)"),void eval(callParent("isSavePrintValues")+".push(dirName)");eval(callParent("isSaveAndPrintClick")+"= false"),eval(callParent("isSavePrintValues")+"=[]"),$j.ajax({url:"openfile.aspx/GetPdfFile",type:"POST",cache:!1,async:!1,data:JSON.stringify({urfpath:cmdVal,urdocid:docID,urpath:filepath,dirName:dirName}),dataType:"json",contentType:"application/json",beforeSend:function(){ShowDimmer(!0)},success:function success(data){if(null!=data.d||""!=data.d)if("error"!=data.d){if(jQBrowser.chrome||jQBrowser.opera||jQBrowser.safari)try{if(isMobile){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(openFastReportInNewWindow){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else printJS(data.d)}catch(ex){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.mozilla){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.msie){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.msedge){var fileUrl=data.d,win;try{win=window.open("","fasrreport","width=600,height=400,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=auto,resizable=yes"),win.location.href=fileUrl,win.focus(),setTimeout(function(){win.print()},5e3)}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else{var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}setTimeout(function(){deletepdffile(data.d)},1e3)}else ShowDimmer(!1),ShowDialog("warning",data.d);else ShowDimmer(!1),ShowDialog("warning",2022,"client")},error:function(e,a,t){ShowDimmer(!1),ShowDialog("warning",2022,"client")}})}function deletepdffile(e){$j.ajax({url:"openfile.aspx/DeletePrintPDF",type:"POST",cache:!1,data:JSON.stringify({pdfPath:e}),async:!1,dataType:"json",contentType:"application/json",success:function(e){ShowDimmer(!1)},error:function(e,a,t){ShowDimmer(!1)}})}function ExecErrorMsg(e,a){for(var t=0;t<e.length;t++){var r,l=e[t].msg;e[t].errfld&&(r=e[t].errfld);for(var o=l.indexOf("^^dq");-1!=o;)o=(l=l.replace("^^dq",'"')).indexOf("^^dq");if(null!=l&&l!=undefined&&""!=l){if(l.indexOf("errfld")>-1&&(l=(l=l.substring(0,l.lastIndexOf("errfld")-2)).replace('",',"").replace('" ,',"")),showAlertDialog("error",l),"CancelTrans"==a)return;var i="";if(r){var n=r.toString().split(",");i=n[0];var d=GetDcNo(i),s=i+(p=GetClientRowNo(n[1],d))+"F"+d;(c=$j("#"+s)).length>0&&c.focus()}else if(""!=AxActiveField){var c,p=GetClientRowNo(AxActiveRowNo,AxActiveDc);s=AxActiveField+p+"F"+AxActiveDc;(c=$j("#"+s)).length>0&&c.focus()}}}}function getComntWf(){var e=$j("#recordid000F0").val();$.ajax({url:"tstruct.aspx/GetWrkFlwCmmt",type:"POST",cache:!1,async:!0,data:JSON.stringify({tid:tst,rid:e}),dataType:"json",contentType:"application/json",success:function(e){for(var a=JSON.parse(e.d),t=0;t<a.length;t++){var r=a[t];for(var l in r){var o=r[l];delete r[l],r[l.toLowerCase()]=o}a[t]=r}for(var i='<table class="table table-bordered firstble table-fixed"><thead><tr><th class="col-sm-4">Date</th><th class="col-sm-2">Status</th><th class="col-sm-4">Comments</th><th class="col-sm-2">User</th></tr></thead><tbody>',n=0;n<a.length;n++)i+='<tr class="tblrowcolor" tabindex="0">',i+='<td class="col-sm-4"> '+a[n].datetime+"</td>",i+='<td class="col-sm-2">'+("return"==a[n].status?"Returned":a[n].status)+"</td>",i+='<td class="col-sm-4">'+a[n].comments+"</td>",i+='<td class="col-sm-2">'+a[n].username+"</td>",i+="</tr>";i+="</tbody>",$("#tblWrk").html(i),$("#collapseOneTable").html(i),$("#comment").addClass("hide"),$("#btnWrfSave").addClass("hide"),$("#btnWrfCancel").addClass("hide")},error:function(e){console.log(e)}}),isWizardTstruct&&$("body").append($("#consumergoods").detach())}function getWfUsrName(e,a){for(var t=[],r=1;r<parseInt(e)+1;r++){for(var l="",o=0;o<a.length;o++)a[o].lno==r&&"-1"!=$j("#hdnWfLno").val()?l+=""==l?a[o].un:","+a[o].un:"-1"==$j("#hdnWfLno").val()&&""==l&&(l+=a[$j("#hdnWfELno").val()].un);t.push(l)}return t}function getWfStatus(e,a){for(var t=[],r=!1,l=1;l<parseInt(e)+1;l++){var o="";r||(o="Notapplicable");for(var i=0;i<a.length;i++)a[i].lno==l&&"-1"!=$j("#hdnWfLno").val()?(r||(o=""),r=!0,""==o?"forwarded"==a[i].st.toLowerCase()?o+="reviewed":o+=a[i].st:"forwarded"==a[i].st.toLowerCase()?o+=",reviewed":o+=","+a[i].st):"-1"==$j("#hdnWfLno").val()&&(r||(o=""),r=!0,""==o&&("forwarded"==a[$j("#hdnWfELno").val()].st.toLowerCase()?o+="reviewed":o+=a[$j("#hdnWfELno").val()].st));t.push(o)}return t}function getWfLevelUSsrs(e,a,t,r,l,o){WrkflFlag=!0,ShowDimmer(!0);$j("#recordid000F0").val();var i=constructWrkHtml(a,t,r,l,o);$(i).insertAfter($("#stratWrkf")),popoverWrkFl()}function constructWrkHtml(e,a,t,r,l){for(var o="",i=0,n=0;n<parseInt(e);n++)if(l.length>i&&"-1"==$j("#hdnWfLno").val()&&r!=l[i].lno&&i++,"undefined"==typeof l[i]||l[i].lno==n+1||"-1"==$j("#hdnWfLno").val()){o+='<div class="workflowMsg workflowdisplayinline">';var d=t[n].toLowerCase();d.indexOf(",")>-1&&(d=(d=d.split(",")).indexOf("pending")>-1?"pending":d[d.length-1]),$("#stratWrkf")[0].innerHTML="Workflow","forwarded"==d.toLowerCase()&&(d="reviewed"),(d.indexOf("pending")>-1||""==d)&&(d="Pending"),d.indexOf("rejected")>-1&&(d="rejected"),d.indexOf("rejected"),d.indexOf("returned"),o+='<div class="msglable workflowdisplayinline wrkflw'+d+'" data-toggle="popoverone" data-trigger="hover" style="text-transform:capitalize;" data-placement="bottom" data-content="',""==t[n]?o+=capitalizeFirstLetter(d="Pending")+(""!=a[n]?("pending"==d.toLowerCase()?" with ":" by ")+a[n]:"")+'">':"undefined"!=typeof l[i]&&l[i].lno==r&&parseInt(r)==n+1?o+=$j("#lblStatus").text()+'">':o+=d+("Pending"==d?" with ":" by ")+a[n]+'">',"notapplicable"===d&&(d="NA"),"approved"==d?o+='<span class="para"><i class="icon-arrows-circle-check wrkflwicons"></i> L'+(n+1)+"</span>":"Pending"==d?o+='<span class="para"><i class="icon-basic-clock wrkflwicons"></i> L'+(n+1)+"</span>":"rejected"==d?o+='<span class="para"><i class="icon-arrows-circle-remove wrkflwicons"></i> L'+(n+1)+"</span>":"reviewed"==d?o+='<span class="para"><i class="icon-arrows-circle-left wrkflwicons"></i> L'+(n+1)+"</span>":"returned"==d&&(o+='<span class="para"><i class="icon-arrows-circle-right wrkflwicons"></i> L'+(n+1)+"</span>"),o+="</div></div>";for(var s=0;s<l.length;s++)if(l[s].lno==r&&parseInt(r)==n+1&&"Pending"==d){o+='<div class="downArr workflowdisplayinline" id="workflowdropdown"><i class="workflowOptions icon-arrows-down downarrow" title="select"></i></div>';break}a[n].indexOf(",")>-1&&(o+='<div class="itemone workflowdisplayinline"  data-content="'+a[n]+'" data-toggle="popoverone" data-trigger="hover" data-placement="bottom">'+a[n].split(",").length+"</div>"),i++}return o}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function popoverWrkFl(){$('[data-toggle="popoverone"]').popover(),$("div[aria-expanded='false']")?$("#togglearrow").attr("title","Expand"):$("#togglearrow").attr("title","Collapse")}function LimtCharacters(e,a,t){chars=e.value.length,a-chars<0?document.getElementById(t).innerHTML="0 of 250":document.getElementById(t).innerHTML=a-chars+" of 250",chars>a&&(e.value=e.value.substring(0,a))}function popupFullPage(e){callParentNew("splitfull()","function"),$j("#middle1",parent.document).attr("src",e)}function setIviewNavigationData(e,a){if(""!=a)try{ASB.WebService.SetIviewNavigationData(e,a,function(){})}catch(t){}}function changedFieldDatatype(e,a,t,r){$.ajax({type:"POST",url:"../WebService.asmx/CallExecuteSQLFldSN",cache:!1,async:!1,contentType:"application/json",data:JSON.stringify({transId:e,dcName:a,fldName:t,fldDtType:r}),dataType:"json",success:function(e){try{var a=$.parseJSON(e.d),t=getCaseInSensitiveJsonProperty(a.result.row[0],"rcount");fldChangeDttype="0"!=t}catch(r){}}})}$(document).ready(function(){$("#btnViewCommts").click(function(){$("#consumergoods").modal("show"),$("[data-toggle=popover]").popover("hide")})});