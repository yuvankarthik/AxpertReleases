/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,d=new Array(t);a<t;a++)d[a]=e[a];return d}window.onbeforeunload=function(){appGlobalVarsObject._CONSTANTS.callerWindow=null},document.addEventListener("contextmenu",function(e){return e.preventDefault()});var grid,transid="",caption="",sourceDetails="",addedItemUpdated=!1,addedItemRecordId="0";function initDesigner(e){var t=!0,a=getEditJSON(e);grid=GridStack.init({column:36,cellHeight:115,float:!0,acceptWidgets:!0,minRow:10,dragIn:".sidebar .grid-stack-item",dragInOptions:{revert:"invalid",scroll:!1,appendTo:"body",helper:"clone"},removable:"#trash"}).on("resizestart",function(e,t){$(t).parent().addClass("ui-droppable-active")}).on("resizestop",function(e,t){$(t).parent().removeClass("ui-droppable-active")}).on("added",function(a,d){$("#dragInfo").addClass("d-none"),setTimeout(function(){$(frameElement).parents(".remodal").find(".developerWorkBenchToolbar .dwbiconsUl").show()},0),t||d.forEach(function(t,a){if(0==a){var d;addedItemUpdated=!1;var i="ax_fld_id".concat(Math.floor(1e5*Math.random()));if($(t.el).attr("data-control-id",i).data("data-control-id",i),"addform"==(null===(d=sourceDetails)||void 0===d?void 0:d[0])){var r,o,n=$(t.el).find("[placeholder]").text(),l=new BSModal(i,n,'<iframe id="modal-addfield" src="tstructnew.aspx?act=open&transid=ad_af&stransid='.concat(e,"&formcaption=").concat(caption).concat(e?"("+e+")":"","&fcaption=").concat(n,"&fldtype=").concat($(t.el).data("placeholder"),'" class="w-100 vh-100"></iframe>'),function(e){$(l.modal._dialog).find("iframe").css({height:"".concat($(l.modal._dialog).find(".modal-body").height()-10,"px")}).removeClass("vh-100"),$(l.modal._element).attr("data-control-id",i).data("data-control-id",i),appGlobalVarsObject._CONSTANTS.callerWindow=window,appGlobalVarsObject._CONSTANTS.calledWindow=null},function(e){addedItemUpdated?addedItemUpdated&&"0"!=addedItemRecordId&&$(t.el).attr("data-recid",addedItemRecordId).data("recid",addedItemRecordId):grid.removeWidget(t.el,!0,!0),addedItemUpdated=!1,addedItemRecordId="0",appGlobalVarsObject._CONSTANTS.callerWindow&&(appGlobalVarsObject._CONSTANTS.callerWindow=null),appGlobalVarsObject._CONSTANTS.calledWindow=null});l.scrollableDialog(),(r=l.modalBody.classList).add.apply(r,["p-5","py-2"]),(o=l.modalFooter.classList).add.apply(o,["p-5","py-2"]),l.cancelBtn.classList.add("d-none"),l.cancelBtn.classList.add("btn-sm"),l.okBtn.classList.add("btn-sm"),l.okBtn.removeAttribute("data-bs-dismiss"),l.okBtn.innerText=appGlobalVarsObject.lcm[399],l.okBtn.addEventListener("click",function(e){$(document.getElementById("modal-addfield"))[0].contentWindow.$(".toolbarRightMenu").find("a[title=usave]").trigger("click")})}}})}),a.forEach(function(e){var t,a=$(".sidebar .grid-stack-item[data-placeholder=".concat(e.fldtype.replaceAll(" ","\\ "),"]")).clone(),d="ax_fld_id".concat(Math.floor(1e5*Math.random()));a.attr("data-control-id",d).data("data-control-id",d),a.attr("data-id",e.name).data("id",e.name),a.attr("data-recid",e.recordid).data("recid",e.recordid),a.find("[placeholder]").text(e.caption);var i=null==a?void 0:null===(t=a[0])||void 0===t?void 0:t.outerHTML;i&&grid.addWidget(i,e.design||{})}),t=!1,setTimeout(function(){$(frameElement).parents(".remodal").find(".developerWorkBenchToolbar .dwbiconsUl").show()},0)}function editFieldProperty(e){var t,a,d=e.data("controlId"),i=e.find("[placeholder]").text();addedItemRecordId=e.data("recid");var r=new BSModal(d,i,'<iframe id="modal-editfield" src="tstructnew.aspx?act=load&transid=ad_af&recordid='.concat(addedItemRecordId,'" class="w-100 vh-100"></iframe>'),function(e){$(r.modal._dialog).find("iframe").css({height:"".concat($(r.modal._dialog).find(".modal-body").height()-10,"px")}).removeClass("vh-100"),$(r.modal._element).attr("data-control-id",d).data("data-control-id",d),appGlobalVarsObject._CONSTANTS.callerWindow=window,appGlobalVarsObject._CONSTANTS.calledWindow=null},function(t){addedItemUpdated||"0"!=addedItemRecordId?addedItemUpdated&&"0"!=addedItemRecordId&&$(e).attr("data-recid",addedItemRecordId).data("recid",addedItemRecordId):grid.removeWidget(null==e?void 0:e[0],!0,!0),addedItemUpdated=!1,addedItemRecordId="0",appGlobalVarsObject._CONSTANTS.callerWindow&&(appGlobalVarsObject._CONSTANTS.callerWindow=null),appGlobalVarsObject._CONSTANTS.calledWindow=null});r.scrollableDialog(),(t=r.modalBody.classList).add.apply(t,["p-5","py-2"]),(a=r.modalFooter.classList).add.apply(a,["p-5","py-2"]),r.cancelBtn.removeAttribute("data-bs-dismiss"),r.cancelBtn.innerText=appGlobalVarsObject.lcm[248],r.cancelBtn.addEventListener("click",function(e){$(document.getElementById("modal-editfield"))[0].contentWindow.$(".toolbarRightMenu").find("a[title=uremove]").trigger("click")}),r.cancelBtn.classList.add("btn-sm"),r.okBtn.classList.add("btn-sm"),r.okBtn.removeAttribute("data-bs-dismiss"),r.okBtn.innerText=appGlobalVarsObject.lcm[399],r.okBtn.addEventListener("click",function(e){$(document.getElementById("modal-editfield"))[0].contentWindow.$(".toolbarRightMenu").find("a[title=usave]").trigger("click")})}function getDesignerJSON(){this.form_serialized_data=_.map($("body"),function(e){this.dc_serialized_data=_.map($(".grid-stack"),function(e){e=$(e),dc_id=$(e).attr("id"),e.parents(".grid-icons").length>0?"T":"F",this.serialized_data=_.map($("#"+dc_id+" > .grid-stack-item"),function(e){return e=$(e),{fld_id:$(e).data("id"),x:+e.attr("gs-x"),y:+e.attr("gs-y"),w:+e.attr("gs-w"),h:+e.attr("gs-h"),visibility:!e.hasClass("designHidden")}},this);var t=this.serialized_data.length?GridStack.Utils.sort(this.serialized_data,1,36).map(function(e){return{fld_id:e.fld_id,x:e.x,y:e.y,width:e.w,height:e.h,visibility:e.visibility}}):null;return dc_id=0==dc_id.indexOf("divDc")?dc_id.substr(5):dc_id.substr(dc_id.lastIndexOf("F")+1),{dc_id:dc_id,isGrid:!1,gridStretch:!1,fieldsDesign:t,tableDesign:[]}},this);var t="undefined"==typeof dcLayoutType||""==dcLayoutType||"default"==dcLayoutType?"undefined"!=typeof isDcLayoutSelected&&1==isDcLayoutSelected?designObj[0].dcs:this.dc_serialized_data:designObj[0].dcs,a="undefined"!=typeof dcLayoutType&&""!=dcLayoutType&&"default"!=dcLayoutType?this.dc_serialized_data:[];return{transid:transid,compressedMode:!0,newDesign:!0,staticRunMode:!0,wizarcdDC:!1,selectedLayout:null,selectedFontSize:14,selectedControlHeight:25,tstUpdatedOn:"undefined"!=typeof tstructUpdateOn?tstructUpdateOn:"",dcLayout:"default",formWidth:"100",formAlignment:"default",fieldCaptionWidth:"30",formLabel:"undefined"!=typeof formLabelJSON&&""!=formLabelJSON?JSON.parse(formLabelJSON):[],buttonFieldFont:"undefined"!=typeof buttonFieldFontJSON&&""!=buttonFieldFontJSON?JSON.parse(buttonFieldFontJSON):[],dcs:t,newdcs:a}},this);var e=form_serialized_data[0].dcs.map(function(e,t){return e.dc_id}),t=[];try{null!=designObj[0].dcs&&(t=designObj[0].dcs.filter(function(t,a){if(-1==e.indexOf(t.dc_id))return!0}))}catch(a){}return form_serialized_data[0].dcs=_.sortBy([].concat(_toConsumableArray(form_serialized_data[0].dcs),_toConsumableArray(t)),"dc_id"),JSON.stringify(this.form_serialized_data,null,"")}function formSave(){SavePublishDesignerJSONWeb(!1),appGlobalVarsObject._CONSTANTS.callerWindow=window,appGlobalVarsObject._CONSTANTS.window.$("#btn_readtstructdef").trigger("click")}function SavePublishDesignerJSONWeb(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0],t=getDesignerJSON(),a=$("#SaveID").val(),d=$("#PublishID").val();$(".grid-stack").removeClass("dirty"),ShowDimmer(!0),$.ajax({url:"tstruct.aspx/SavePublishDesign",type:"POST",cache:!1,async:!0,data:JSON.stringify({Transid:transid,DesignType:"SAVEPUBLISH",Content:t,SavedId:a}),dataType:"json",contentType:"application/json",success:function(t){""!=t.d?(a=t.d.split("~")[0],d=t.d.split("~")[1],$("#SaveID").attr("value",a),e&&showAlertDialog("success",DesigntstructMessages.designSaved),$("#PublishID").val(d),$("#IsPublish").val("Y")):showAlertDialog("error","Error while save & publish design."),ShowDimmer(!1)},error:function(e){showAlertDialog("error",e),ShowDimmer(!1)}})}function getEditJSON(e){var t=[];try{return ShowDimmer(!0),$.ajax({url:"addForm.aspx/CallGetAddFormData",type:"POST",cache:!1,async:!1,data:JSON.stringify({transid:e,getCaption:!caption}),dataType:"json",contentType:"application/json",success:function(a){if("SESSION_TIMEOUT"==a.d)parent.window.location.href="../aspx/sess.aspx";else if(""!=a.d&&(dataJSON=JSON.parse(a.d),dataJSON.fields&&dataJSON.design)){var d=[],i=[];if(dataJSON.caption)try{caption=dataJSON.caption.result.row[0].caption,callParentNew("axpertPopupWrapper","id").querySelectorAll(".dwbLeftMenu")[0].textContent="".concat(caption,"(").concat(e,")")}catch(r){}try{d=dataJSON.fields.result.row.filter(function(e){return"T"!=e.hidden})}catch(r){}try{i=JSON.parse(dataJSON.design.result.row[0].content)}catch(r){}d.length>0&&(d.forEach(function(e){var t,a,d,r,o,n,l;(fldDesign=null===(t=i)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:null===(d=a.dcs)||void 0===d?void 0:null===(r=d.filter(function(e){return"1"==e.dc_id}))||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:null===(n=o.fieldsDesign)||void 0===n?void 0:null===(l=n.filter(function(t){return t.fld_id==e.name}))||void 0===l?void 0:l[0])?e.design={x:fldDesign.x,y:fldDesign.y,w:fldDesign.width,h:fldDesign.height}:e.design={}}),t=d)}ShowDimmer(!1)},error:function(){showAlertDialog("error","Error while executing the query."),ShowDimmer(!1)}}),t}catch(a){showAlertDialog("error","Error while executing the query."),ShowDimmer(!1)}}function openFormProperties(e){0==$("#editFormProperties").length&&(e.parents("body").find("editFormProperties").remove(),appGlobalVarsObject._CONSTANTS.callerWindow=window)}function renderFormProperties(e){var t,a,d=new BSModal("editFormProperties","Form Properties",'<iframe id="modal-editFormProperties" src="'.concat(e,'&AxPop=true" class="w-100 vh-100"></iframe>'),function(e){$(d.modal._dialog).find("iframe").css({height:"".concat($(d.modal._dialog).find(".modal-body").height()-10,"px")}).removeClass("vh-100"),appGlobalVarsObject._CONSTANTS.callerWindow=window,appGlobalVarsObject._CONSTANTS.calledWindow=null},function(e){appGlobalVarsObject._CONSTANTS.callerWindow&&(appGlobalVarsObject._CONSTANTS.callerWindow=null),appGlobalVarsObject._CONSTANTS.calledWindow=null});d.scrollableDialog(),(t=d.modalBody.classList).add.apply(t,["p-5","py-2"]),(a=d.modalFooter.classList).add.apply(a,["p-5","py-2"]),d.cancelBtn.classList.add("d-none"),d.cancelBtn.classList.add("btn-sm"),d.okBtn.classList.add("btn-sm"),d.okBtn.removeAttribute("data-bs-dismiss"),d.okBtn.innerText=appGlobalVarsObject.lcm[399],d.okBtn.addEventListener("click",function(e){$(document.getElementById("modal-editFormProperties"))[0].contentWindow.CallAction("iSave","","","n","n","","false")})}$(function(){try{callParentNew("dummyHider","id").style.display="none"}catch(d){}var e,t,a;void 0!==callParentNew("AxConfigPage")&&""!=callParentNew("AxConfigPage")?("addform"==(null===(e=sourceDetails=callParentNew("AxConfigPage").split("~"))||void 0===e?void 0:e[0])&&(transid=null===(t=sourceDetails)||void 0===t?void 0:t[1]),null!==(a=sourceDetails)&&void 0!==a&&a[2]&&(caption=sourceDetails[2]),initDesigner(transid)):showAlertDialog("error","An error occurred while opening the page")});