/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _createForOfIteratorHelper(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,c=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return r=t.done,t},e:function(t){c=!0,s=t},f:function(){try{r||null==a["return"]||a["return"]()}finally{if(c)throw s}}}}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function _iterableToArrayLimit(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var n,i,s=[],r=!0,c=!1;try{for(a=a.call(t);!(r=(n=a.next()).done)&&(s.push(n.value),!e||s.length!==e);r=!0);}catch(l){c=!0,i=l}finally{try{r||null==a["return"]||a["return"]()}finally{if(c)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function ownKeys(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){_defineProperty(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}var _subEntity,_entityForm,iframeindex=-1,SubEntity=function(){function t(){_classCallCheck(this,t),this.entityName="",this.entityTransId="",this.recordId="",this.keyValue="",this.metaData={},this.entityWiseMetaData={},this.entityWiseFields={},this.subEntityMapping={},this.listJson={},this.maxPageNumber=1,this.pageSize=50,this.chartsMetaData=[],this.subEntityList={},this.selectedCharts="",this.selectedSubEntities="",this.subEntityFilter,this.selectedChartsObj={},this.activitiesExpanded=!1,this.isSubEntitiesAvailable=!0,this.kpiFilter="",this.emptyRowsHtml="No data found"}return _createClass(t,[{key:"init",value:function(){if(this.getUrlParams(),this.inValid(this.entityName))this.catchError("Invalid Entity details");else{document.querySelector("#EntityTitle").innerHTML="".concat(this.entityName," - ").concat(this.keyValue);try{if(axDisallowCreate)axDisallowCreate.split(",").indexOf(this.entityTransId)>-1&&(this.allowCreate=!1,document.querySelector("#add-entity").remove());subEntityMetaData=subEntityMetaData.replaceAll('"{',"{").replaceAll('}"',"}"),subEntityMetaData=JSON.parse(subEntityMetaData),this.metaData=subEntityMetaData.result.metadata,(_subEntity.inValid(this.recordId)||"0"==this.recordId)&&(this.recordId=_entityForm.recordId),this.parseSubEntityMetaDataJSON(),this.initCharts(),this.bindEvents(),_entityForm.getRelatedEntityListData(),_entityForm.constructFormRelatedDataAccordions()}catch(t){showAlertDialog("error","Error occurred. Please check with administrator.")}}}},{key:"bindEvents",value:function(){$("#sub-entityhdr").on("shown.bs.collapse",function(){_subEntity.activitiesExpanded=!0,document.querySelector("#sub-entitycontainer").classList.contains("data-fetched")||_subEntity.getSubEntityListData(1)}),$("#sub-entityhdr").on("hide.bs.collapse",function(){_subEntity.activitiesExpanded=!1});var t=document.querySelectorAll(".chk-entities");t.forEach(function(e){e.addEventListener("change",function(e){t.length==document.querySelectorAll(".chk-entities:checked").length?document.querySelector("#check-all").checked=!0:document.querySelector("#check-all").checked=!1})});var e=document.getElementById("check-all");e.addEventListener("change",function(a){var n=e.checked;t.forEach(function(t){t.checked=n})})}},{key:"getNearestRecords",value:function(t){var e=this,a=e.listJson.filter(function(t){return!1===e.inValid(t[t.keycol])}),n=a.findIndex(function(e){return e.rno===t});if(-1===n)return[];var i=[];if(n>0){var s=_objectSpread(_objectSpread({},a[n-1]),{},{navtype:"prev"});i.push(s)}var r=_objectSpread(_objectSpread({},a[n]),{},{navtype:"current"});if(i.push(r),n<a.length-1){var c=_objectSpread(_objectSpread({},a[n+1]),{},{navtype:"next"});i.push(c)}return i}},{key:"hideChartsMenu",value:function(){var t;null===(t=document.querySelector("#add_chart"))||void 0===t||t.click()}},{key:"openNewTstruct",value:function(){parent.LoadIframe("../aspx/tstruct.aspx?transid=".concat(this.entityTransId))}},{key:"openSubEntityTstruct",value:function(t){var e,a,n,i,s="";null!==(e=this.subEntityMapping[t])&&void 0!==e&&e.mapfield&&null!==(a=this.subEntityMapping[t])&&void 0!==a&&a.mapsrcdata&&(s="act=open&".concat(null===(n=this.subEntityMapping[t])||void 0===n?void 0:n.mapfield,"=").concat(null===(i=this.subEntityMapping[t])||void 0===i?void 0:i.mapsrcdata));parent.LoadIframe("../aspx/tstruct.aspx?transid=".concat(t,"&").concat(s))}},{key:"editEntity",value:function(){parent.LoadIframe("../aspx/tstruct.aspx?transid=".concat(this.entityTransId,"&act=load&recordid=").concat(this.recordId,"&dummyload=false"))}},{key:"editSubEntity",value:function(t,e){parent.LoadIframe("../aspx/tstruct.aspx?transid=".concat(t,"&act=load&recordid=").concat(e,"&dummyload=false"))}},{key:"reloadEntityPage",value:function(){parent.LoadIframe("../aspx/EntityForm.aspx?ename=".concat(this.entityName,"&tstid=").concat(this.entityTransId,"&recid=").concat(this.recordId,"&keyval=").concat(this.keyValue))}},{key:"openEntityForm",value:function(t,e,a,n,i){if(i){this.updateRelatedData(e,i)}var s="../aspx/EntityForm.aspx?ename=".concat(t,"&tstid=").concat(e,"&recid=").concat(a,"&keyval=").concat(n);parent.LoadIframe(s)}},{key:"updateRelatedData",value:function(t,e){var a=this;window.top.entityNavList||(window.top.entityNavList={}),a.getNearestRecords(e).forEach(function(t){a.inValid(t.entityname)&&(t.entityname=a.subEntityList[t.transid])}),window.top.entityNavList[t]=a.getNearestRecords(e),window.top.entityNavList.lastTransId=t,window.top.entityNavList.lastCaption="".concat(a.keyValue)}},{key:"openEntityPage",value:function(t,e){parent.LoadIframe("../aspx/Entity.aspx?ename=".concat(t,"&tstid=").concat(e))}},{key:"getSubEntityKPIFilter",value:function(){var t="";return Object.entries(this.subEntityMapping).forEach(function(e){var a=_slicedToArray(e,2),n=a[0],i=a[1],s=i.mapdatavalue,r=i.mapfield;t+="".concat(n,"~~~~").concat(i.mapfieldjson.normalized||"F","~").concat(i.mapfieldjson.srctable||"","~").concat(i.mapfieldjson.srcfld||"","~").concat(i.mapfieldjson.allowempty||"F","~").concat(i.mapfieldjson.tablename||"","~").concat(r,"~'").concat(s,"'^")}),t.endsWith("^")?t.substr(0,t.length-1):t}},{key:"getSubEntityFilter",value:function(){var t=this,e="",a=[],n=document.querySelectorAll(".chk-entities:checked");return 0==n.length?(showAlertDialog("error","Error: No filters selected."),!1):(n.forEach(function(n){var i=n.value,s=t.subEntityMapping[i],r=s.mapfieldjson,c=s.mapdatavalue,l=s.mapfield;e+="".concat(i,"=All=").concat(r.tablename,".").concat(l,"~'").concat(c,"'~").concat(r.tablename,"~").concat(r.normalized,"~").concat(r.srctable,"~").concat(r.srcfield,"~").concat(r.allowempty,"++"),a.push(i)}),e.endsWith("++")&&(e=e.substr(0,e.length-2)),t.subEntityFilter=e,t.selectedSubEntities=a.join(","),!0)}},{key:"getSubEntityListData",value:function(t){var e=this;if(e.getSubEntityFilter()){parent.ShowDimmer(!0);var a={entityName:_subEntity.entityName,transId:e.entityTransId,recordId:e.recordId,fields:e.subEntityFilter,pageNo:t,pageSize:e.pageSize,metaData:!1,subEntityList:e.selectedSubEntities};e.callAPI("../aspx/EntityForm.aspx/GetSubEntityListDataWS",a,!1,function(a){if(parent.ShowDimmer(!1),a.success){var n,i=JSON.parse(JSON.parse(a.response).d);i=null!==(n=i.result.list)&&void 0!==n?n:[];try{i.constructor!=Array&&(i=JSON.parse(i))}catch(c){return void showAlertDialog("error","Error occurred in data fetch.")}if(0==(i.length||0)){if(1==t)return e.listJson=[],void(document.querySelector("#body_Container").innerHTML=e.emptyRowsHtml);noMoreRecordsMessage.style.display="block",setTimeout(function(){noMoreRecordsMessage.style.display="none"},3e3)}else try{var s;1==t&&(e.listJson=[],e.entityWiseFields={},document.querySelector("#body_Container").innerHTML="");var r=[];i.forEach(function(t){r.push(t.data_json)}),(s=e.listJson).push.apply(s,r),e.maxPageNumber=getMaxPageNumber(e.listJson),noMoreRecordsMessage.style.display="none",createListHTML(e.listJson,t),document.querySelector("#sub-entitycontainer").classList.add("data-fetched"),setTimeout(function(){document.querySelector("#activities-link").click()},100)}catch(l){$("#body_Container").append(JSON.parse(a.response).d)}}})}}},{key:"getSubEntityPaginationData",value:function(t){var e=this,a={entityName:_subEntity.entityName,transId:e.entityTransId,recordId:e.recordId,fields:e.subEntityFilter,pageNo:t,pageSize:this.pageSize,metaData:!1};this.callAPI("../aspx/EntityForm.aspx/GetSubEntityListDataWS",a,!0,function(a){if(a.success){var n,i,s,r=JSON.parse(JSON.parse(a.response).d);if(0==((null==r?void 0:null===(n=r.result)||void 0===n?void 0:null===(i=n.list)||void 0===i?void 0:i.length)||0))noMoreRecordsMessage.style.display="block",setTimeout(function(){noMoreRecordsMessage.style.display="none"},3e3);else e.maxPageNumber=t,noMoreRecordsMessage.style.display="none",r.result.list.forEach(function(t){t.data_json=JSON.parse(t.data_json)}),(s=e.listJson).push.apply(s,_toConsumableArray(r.result.list)),createListHTML(e.listJson,t)}})}},{key:"initCharts",value:function(){this.getSubEntityChartsData("General")}},{key:"createChartsFieldsForSelection",value:function(){var t=this,e=document.getElementById("subEnt");if(t.populateSubEnt(),e.addEventListener("change",function(){var e=this.value;t.populateGroupAndAggFields(e)}),document.getElementById("aggFld").addEventListener("change",function(){var t=document.getElementById("aggCond");"count"===this.value?(t.value=0,t.disabled=!0):(t.value="sum",t.disabled=!1)}),document.querySelectorAll("#subEnt option").length>1){var a=document.querySelector("#subEnt");a.selectedIndex=1;var n=new Event("change");a.dispatchEvent(n)}}},{key:"parseSubEntityMetaDataJSON",value:function(){var t=this,e={},a={},n={};t.metaData.filter(function(t){return"T"===t.subentity}).forEach(function(i){if(e[i.ftransid]||(e[i.ftransid]=i.fcaption||i.ftransid),a[i.ftransid]||(a[i.ftransid]={}),!t.inValid(i.entityrelfld)){n[i.ftransid]||(n[i.ftransid]={}),n[i.ftransid].mapfieldjson=i,n[i.ftransid].mapfield=i.fldname,n[i.ftransid].mapdatafield=i.entityrelfld,n[i.ftransid].mapsrcfield=i.srcfield;var s=t.keyValue,r=t.keyValue;if("recordid"==i.entityrelfld&&i.srcfield){s=t.recordId.toString();var c=_entityForm.entityFormJson.data.filter(function(t){return t.n===i.srcfield});c.length&&(r=ReverseCheckSpecialChars(c[0].v))}if("recordid"!=i.entityrelfld||i.srcfield){if(i.srcfield){var l=_entityForm.entityFormJson.data.filter(function(t){return t.n===i.entityrelfld});l.length&&(s=ReverseCheckSpecialChars(l[0].v));var o=_entityForm.entityFormJson.data.filter(function(t){return t.n===i.srcfield});o.length&&(r=ReverseCheckSpecialChars(o[0].v))}}else s=t.recordId.toString(),r=t.recordId.toString();n[i.ftransid].mapsrcdata=r,n[i.ftransid].mapdatavalue=s}a[i.ftransid][i.fldname]=i}),t.subEntityMapping=n,t.entityWiseMetaData=a,t.subEntityList=e,t.getActivitiesBtnsHTML(),t.getSubEntityKeyFields()}},{key:"getSubEntityKeyFields",value:function(){var t=this,e={subEntityList:Object.keys(t.subEntityList).join(",")};this.callAPI("../aspx/EntityForm.aspx/GetSubEntityKeyFieldsWS",e,!0,function(e){if(e.success){var a=JSON.parse(e.response).d;t.subEntityKeyFields=JSON.parse(a),ShowDimmer(!1)}else ShowDimmer(!1)})}},{key:"populateSubEnt",value:function(){for(var t=document.getElementById("subEnt"),e=0,a=Object.entries(this.subEntityList);e<a.length;e++){var n=_slicedToArray(a[e],2),i=n[0],s=n[1],r=document.createElement("option");r.value=i,r.text="".concat(s,"(").concat(i,")"),r.dataset.form=s,t.appendChild(r)}}},{key:"populateGroupAndAggFields",value:function(t){var e=document.getElementById("grpFld"),a=document.getElementById("aggFld");e.innerHTML="",a.innerHTML="";var n=document.createElement("option");n.value=0,n.text="Select Field",e.appendChild(n);var i=document.createElement("option");i.value="count",i.text="Count",a.appendChild(i);var s=document.getElementById("aggCond");if(s.value=0,s.disabled=!0,0!=t)for(var r=0,c=Object.entries(this.entityWiseMetaData[t]);r<c.length;r++){var l=_slicedToArray(c[r],2),o=(l[0],l[1]);if("F"===o.hide){if("T"===o.grpfield){var d=document.createElement("option");d.value=o.fldname,d.text="".concat(o.fldcap||"","(").concat(o.fldname,")"),e.appendChild(d)}if("T"===o.aggfield){var u=document.createElement("option");u.value=o.fldname,u.text="".concat(o.fldcap||"","(").concat(o.fldname,")"),a.appendChild(u)}}}}},{key:"getSelectedCharts",value:function(){var t=this,e={transId:t.entityTransId};this.callAPI("../aspx/EntityForm.aspx/GetSelectedSubEntityChartsWS",e,!0,function(e){e.success?(t.selectedCharts=JSON.parse(e.response).d,""!=t.selectedCharts?(t.getSubEntityChartsData("Custom"),t.getChartCaptions(),document.querySelector(".NO-KPI-Items").classList.add("d-none")):document.querySelector(".NO-KPI-Items").classList.remove("d-none"),ShowDimmer(!1)):ShowDimmer(!1)})}},{key:"deleteChart",value:function(t){if(confirm("Delete this chart?")){var e=this;if(e.selectedCharts){var a=e.selectedCharts.split(",");a=a.filter(function(e){return e!==t}),e.selectedCharts=a.join(",")}else e.selectedCharts="";if(""==e.selectedCharts){e.selectedChartsObj={};var n={transId:e.entityTransId,charts:""};this.callAPI("../aspx/EntityForm.aspx/GetSelectedSubEntityChartsWS",n,!0,function(t){e.hideChartsMenu()}),document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="",document.querySelector(".NO-KPI-Items").classList.remove("d-none")}else e.setSelectedCharts(),document.querySelector(".NO-KPI-Items").classList.add("d-none")}}},{key:"getSelectedChartsCriteria",value:function(){var t=this,e=[];return t.selectedCharts.split(",").forEach(function(a){var n=a.split("~~"),i=n[0],s=n[1],r=t.entityWiseMetaData[i][s],c=t.subEntityMapping[i].mapdatavalue,l=t.subEntityMapping[i].mapfield;e.push("".concat(a,"~~").concat(r.normalized,"~~").concat(r.srctable||"","~~").concat(r.srcfield||"","~~").concat(r.allowempty,"~~").concat(l,"~~").concat(c))}),e.join(",")}},{key:"getChartCriteria",value:function(t){return t.split("~~").slice(0,4).join("~~")}},{key:"getSubEntityChartsData",value:function(t){var e=this,a="";"General"==t?(a=e.getSubEntityKPIFilter(),e.kpiFilter=a):a=e.getSelectedChartsCriteria();var n={entityName:e.entityName,transId:e.entityTransId,condition:t,criteria:a,recordId:e.recordId,keyValue:e.keyValue};this.callAPI("../aspx/EntityForm.aspx/GetSubEntityChartsDataWS",n,!0,function(a){if(a.success){if("General"==t){e.kpiJson=JSON.parse(JSON.parse(a.response).d);var n=e.kpiJson.result.charts;if(n.length){e.isSubEntitiesAvailable=!0;var i=e.generateGeneralKPIHTML(n);i&&(document.querySelector("#KPI-2 .row").innerHTML=i,document.querySelector("#KPI-2").classList.remove("d-none"))}else e.isSubEntitiesAvailable=!1,document.querySelector("#sub-entitycontainer").classList.add("data-fetched"),document.querySelector("#body_Container").innerHTML=e.emptyRowsHtml,document.querySelector("#sub-entityhdr .Tkts-toolbar-Right").classList.add("d-none");return}document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="",e.chartsJson=JSON.parse(JSON.parse(a.response).d);var s=[];e.chartsJson.result.charts.forEach(function(t){var a=e.getChartCriteria(t.criteria),n=JSON.parse(t.data_json).map(function(t){return{data_label:t.keyname,value:t.keyvalue}});s.push({chartsid:a,charttype:"chart",chartjson:JSON.stringify(n),chartname:"".concat(e.selectedChartsObj[a])})}),e.chartsJson=s;callParentNew("LoadIframe");var r={},c={},l="",o="",d={dirLeft:!0,enableMasonry:!1,homePageType:"cards",isCardsDashboard:!0,isMobile:isMobileDevice()},u={css:[],js:[]};u.js.push("/ThirdParty/lodash.min.js"),u.js.push("/ThirdParty/deepdash.min.js"),u.js.push("/Js/handlebars.min.js?v=1"),u.js.push("/Js/handleBarsHelpers.min.js"),u.js.push("/ThirdParty/Highcharts/highcharts-3d.js"),u.js.push("/ThirdParty/Highcharts/highcharts-more.js"),u.js.push("/ThirdParty/Highcharts/highcharts.js"),u.js.push("/ThirdParty/Highcharts/highcharts-exporting.js"),u.js.push("/Js/high-charts-functions.min.js?v=20"),u.js.push("/Js/AxInterface.js?v=10"),u.js.push("/ThirdParty/DataTables-1.10.13/media/js/jquery.dataTables.js"),u.js.push("/ThirdParty/DataTables-1.10.13/media/js/dataTables.bootstrap.js"),u.js.push("/ThirdParty/DataTables-1.10.13/extensions/Extras/moment.min.js"),u.css.push("/ThirdParty/fullcalendar/lib/main.min.css"),u.js.push("/ThirdParty/fullcalendar/lib/main.min.js"),d.isMobile&&u.js.push("/ThirdParty/jquery-ui-touch-punch-master/jquery.ui.touch-punch.min.js"),d.enableMasonry&&u.js.push("/ThirdParty/masonry/masonry.pkgd.min.js"),u.js.push("/js/entity-charts.min.js?v=1"),document.getElementsByTagName("body")[0].classList.contains("btextDir-rtl")&&(d.dirLeft=!1),loadAndCall({files:u,callBack:function(){$(function(){ShowDimmer(!0),deepdash(_);if(r.value=JSON.stringify(e.chartsJson),c.value=JSON.stringify([]),""!=(l="")){l=l.replace(/'/g,"'");var t=parseXml(l),a=xml2json(t,"");o=JSON.parse(a)}appGlobalVarsObject._CONSTANTS.menuConfiguration=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.menuConfiguration,{menuJson:o}),appGlobalVarsObject._CONSTANTS.cardsPage={setCards:!1,cards:[]},$.axpertUI.options.cardsPage.cards=[],appGlobalVarsObject._CONSTANTS.cardsPage=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.cardsPage,{setCards:!0,cards:(JSON.parse(""!==r.value?ReverseCheckSpecialChars(r.value):"[]",function(t,e){try{return"object"===_typeof(e)||isNaN(e)||""===e.toString().trim()?e:"string"==typeof e&&(e.startsWith("0")||e.startsWith("-"))?parseFloat(e,10):JSON.parse(e)}catch(a){return e}})||[]).map(function(t){return _.mapKeys(t,function(t,e){return e.toString().toLowerCase()})}),design:(JSON.parse(""!==c.value?c.value:"[]",function(t,e){try{return"object"===_typeof(e)||isNaN(e)||""===e.toString().trim()?e:"string"==typeof e&&(e.startsWith("0")||e.startsWith("-"))?parseFloat(e,10):JSON.parse(e)}catch(a){return e}})||[]).map(function(t){return _.mapKeys(t,function(t,e){return e.toString().toLowerCase()})}),enableMasonry:d.enableMasonry,staging:{iframes:".splitter-wrapper",cardsFrame:{div:".cardsPageWrapper",cardsDiv:"#Homepage_CardsList_Wrapper",cardsDesigner:".cardsDesigner",cardsDesignerToolbar:".designer",editSaveButton:".editSaveCardDesign",icon:"span.material-icons",divControl:"#arrangeCards"}}});appGlobalVarsObject.lcm;var n=$.axpertUI.init({isHybrid:appGlobalVarsObject._CONSTANTS.isHybrid,isMobile:d.isMobile,compressedMode:appGlobalVarsObject._CONSTANTS.compressedMode,dirLeft:d.dirLeft,axpertUserSettings:{settings:appGlobalVarsObject._CONSTANTS.axpertUserSettings},cardsPage:appGlobalVarsObject._CONSTANTS.cardsPage});appGlobalVarsObject._CONSTANTS.cardsPage=n.cardsPage,ShowDimmer(!1)}),$.axpertUI.cardsPage._addCardHeader=function(t,e){t.find(".card-title").attr("title",e.chartname||"").find("headerContent").replaceWith(e.chartname||""),t.find(".card-header").attr("data-bs-target","#".concat(e.chartsid.replaceAll("~",""))),t.find(".KC_Items_Content").attr("id","".concat(e.chartsid.replaceAll("~",""))),t.attr("title",e.chartname||"");var a='<span class="material-icons material-icons-style" onclick="_subEntity.deleteChart(\''.concat(e.chartsid,"')\">close</span>");t.find("toolbarContent").replaceWith(a)}}})}})}},{key:"generateGeneralKPIHTML",value:function(t){var e=this,a="";return t.forEach(function(t){var n=JSON.parse(t.data_json)[0];0!=n.totrec&&(a+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">'.concat(e.subEntityList[n.transid],'</h6>\n                            <h3 class="title">').concat(n.totrec,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            '))}),a}},{key:"setSelectedCharts",value:function(t){var e=this;if(t)if(e.selectedCharts){var a=e.selectedCharts.split(",");a.push(t),a=_toConsumableArray(new Set(a)),e.selectedCharts=a.join(",")}else e.selectedCharts=t;var n={transId:e.entityTransId,charts:e.selectedCharts};this.callAPI("../aspx/EntityForm.aspx/SetSelectedSubEntityChartsWS",n,!0,function(t){t.success?(e.getSubEntityChartsData("Custom",e.selectedCharts),e.getChartCaptions(),e.hideChartsMenu(),ShowDimmer(!1)):(e.hideChartsMenu(),ShowDimmer(!1))})}},{key:"clearChartSelection",value:function(){if(confirm("Clear all Charts?")){var t=this;t.selectedCharts="",t.selectedChartsObj={};var e={transId:t.entityTransId,charts:""};this.callAPI("../aspx/EntityForm.aspx/SetSelectedSubEntityChartsWS",e,!0,function(e){t.hideChartsMenu()}),document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="",document.querySelector(".NO-KPI-Items").classList.remove("d-none")}}},{key:"applyChartSelection",value:function(){var t=document.getElementById("subEnt").value;if(0!=t){this.subEntityList[t];var e=document.getElementById("grpFld").value,a=(this.entityWiseMetaData[t][e],document.getElementById("aggCond").value),n=document.getElementById("aggFld").value;if("count"==n)a="count";else if(0==a)return showAlertDialog("error","Select a valid Display function"),void document.getElementById("aggCond").focus();if(0!=e){var i="".concat(t,"~~").concat(e,"~~").concat(n,"~~").concat(a);this.setSelectedCharts(i),document.querySelector(".NO-KPI-Items").classList.add("d-none")}else showAlertDialog("error","Select a valid Group By Field")}else showAlertDialog("error","Select a valid Form")}},{key:"getChartCaptions",value:function(){var t=this;t.selectedCharts.split(",").forEach(function(e){var a=e.split("~~"),n=a[0],i=t.subEntityList[n],s=a[1],r=t.entityWiseMetaData[n][s],c=a[3],l=a[2],o=t.entityWiseMetaData[n][l],d="";d="count"==c?"".concat(i," - ").concat(r.fldcap||""," wise ").concat(c):"".concat(i," - ").concat(r.fldcap||""," wise ").concat(o.fldcap||"","(").concat(c,")"),t.selectedChartsObj[e]=d})}},{key:"getActivitiesBtnsHTML",value:function(){for(var t="",e="",a=axDisallowCreate.split(","),n=0,i=Object.entries(this.subEntityList);n<i.length;n++){var s=_slicedToArray(i[n],2),r=s[0],c=s[1];-1==a.indexOf(r)&&(t+='<div class="menu-item px-3 my-0">\n                            <a href="#" class="menu-link px-3 py-2" data-kt-element="mode" onclick="_subEntity.openSubEntityTstruct(\''.concat(r,'\')">\n                                <span class="material-icons material-icons-style material-icons-2">keyboard_double_arrow_right</span>\n                                <span class="menu-title">').concat(c,"\n                                </span>\n                            </a>\n                        </div>")),e+='\n            <tr>\n                <td><input type="checkbox" id="chkentity_'.concat(r,'" class="chk-entities" value="').concat(r,'" data-fldcap="').concat(c,'" checked></td>\n                <td><label for="chkentity_').concat(r,'">').concat(c,"</label></td>\n            </tr>")}t?document.querySelector("#SubEntity-add").innerHTML=t:(document.querySelector("#SubEntity-add").remove(),document.querySelector("#SubEntity-add-btn").remove()),e='<table class="table table-hover text-start">\n            <thead class="thead-dark">\n                <tr>\n                    <th>\n                        <input type="checkbox" id="check-all" checked>\n                    </th>\n                    <th><label for="check-all">Select all</label></th>\n                </tr>\n            </thead>\n            <tbody id="table-body">\n                '.concat(e,'\n            </tbody>\n        </table>\n        <div class="modal-footer" style="padding: 0.5rem !important">\n            <button type="button" onclick="_subEntity.resetSubEntityFilter()" class="btn btn-white btn-sm">Reset</button>\n            <button type="button" onclick="_subEntity.applySubEntityFilter();" class="btn btn-primary">Apply</button>\n        </div>'),document.querySelector("#SubEntity-Filter").innerHTML=e}},{key:"applySubEntityFilter",value:function(){document.querySelector("#sub-entitycontainer").classList.remove("data-fetched"),document.querySelector("#body_Container").innerHTML="",this.getSubEntityListData(1)}},{key:"resetSubEntityFilter",value:function(){document.querySelector("#sub-entitycontainer").classList.remove("data-fetched"),document.querySelector("#body_Container").innerHTML="",event.preventDefault(),document.querySelectorAll(".chk-entities, #check-all").forEach(function(t){t.checked=!0}),this.getSubEntityListData(1)}},{key:"getUrlParams",value:function(){var t=window.location.search,e=new URLSearchParams(t);this.entityName=e.get("ename")||"",this.entityTransId=e.get("tstid"),this.recordId=e.get("recid")||"0",this.keyValue=e.get("keyval")||""}},{key:"callAPI",value:function(t,e,a,n){var i=this,s=new XMLHttpRequest;s.open("POST",t,a),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.isAxpertFlutter&&(s.setRequestHeader("Authorization","Bearer ".concat(armToken)),e.armSessionId=armSessionId),s.onreadystatechange=function(){4==this.readyState&&(200==this.status?n({success:!0,response:this.responseText}):(i.catchError(this.responseText),n({success:!1,response:this.responseText})))},s.send(JSON.stringify(e))}},{key:"catchError",value:function(t){showAlertDialog("error",t)}},{key:"showSuccess",value:function(t){showAlertDialog("success",t)}},{key:"dataConvert",value:function(t,e){if("AXPERT"==e)try{if("undefined"!=typeof(t=JSON.parse(t.d)).result[0].result.row)return t.result[0].result.row;if("undefined"!=typeof t.result[0].result)return t.result[0].result}catch(a){ShowDimmer(!1),this.catchError(a.message)}else if("ARM"==e)try{if(this.isAxpertFlutter||(t=JSON.parse(t.d)),t.result&&t.result.success){if(!this.isUndefined(t.result.data))return t.result.data}else this.isUndefined(t.result.message)||this.catchError(t.result.message)}catch(a){ShowDimmer(!1),this.catchError(a.message)}return t}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(t){return""==t}},{key:"isNull",value:function(t){return null==t}},{key:"isNullOrEmpty",value:function(t){return null==t||""==t}},{key:"inValid",value:function(t){return null==t||void 0===t||""==t}},{key:"isUndefined",value:function(t){return void 0===t}}]),t}(),Field=_createClass(function t(e){_classCallCheck(this,t),this.entity=e.entity,this.fcaption=e.fcaption,this.fldname=e.fldname,this.fldtype=e.fldtype,this.fdatatype=e.fdatatype,this.moe=e.moe,this.hide=e.hide,this.props=e.props}),SubEntityMetaData=_createClass(function e(t){if(_classCallCheck(this,e),!t||!Array.isArray(t))throw new Error("Invalid JSON data");this.metadata=t.map(function(t){return new Field(t)})}),formCompJSON={components:{N:{html:'<input type="number" class="inputcontent1" value="{{value}}" readonly>'},ST:{html:'<div class="inputcontent"  readonly>{{value}}</div>'},S:{html:'<div class="inputcontent"  readonly>{{v}}</div>'},M:{html:'<div class="inputcontent"  readonly>{{v}}</div>'},C:{html:'<div class="inputcontent"  readonly>{{v}}</div>'},RT:{html:'<p class="add-read-more show-less-content" >{{value}}</p><br>'},LT:{html:'<p class="add-read-more show-less-content" >{{value}}</p><br>'},D:{html:'<input type="date" class="form-control form-control-sm w-auto" value="{{value}}" readonly/>'},ATT:{html:' <div id="{{customid}}" class="Files-Attached " onclick="_entityForm.downloadfileattachment(\'{{v}}\',\'{{filepath}}\')" data-filename="{{v}}" data-filepath="{{filepath}}">\n                                  {{componentimg}}\n                               <div class="mx-3 fw-semibold attachmenttxt">\n                               <a class="attached-filename" data-bs-toggle="tooltip" data-bs-placement="bottom" title="{{v}}">{{v}}</a>\n                            </div>\n                       </div><br>'},GRID_ATT:{html:' <div id="{{customid}}" class="Files-Attached " onclick="_entityForm.showGridAttLink(\'{{v}}\')" data-filename="{{v}}">\n                                  {{componentimg}}\n                               <div class="mx-3 fw-semibold attachmenttxt">\n                               <a class="attached-filename" data-bs-toggle="tooltip" data-bs-placement="bottom" title="{{v}}">{{v}}</a>\n                            </div>\n                       </div><br>'},Image:{html:'<img class="{{colclassname}} col-sm-12"  src="{{src}}" alt="Girl in a jacket" style="width:150px;" height="100">'},togglebutton:{html:'<div class="form-check form-switch">\n                  <input class="form-check-input" type="checkbox" role="switch" {{checked}} onclick="return false;">\n                </div>'}}},fldTypes=["N","ST","D","LT","RT","ATT","Image","table","togglebutton"],EntityForm=function(){function t(){_classCallCheck(this,t),this.components=formCompJSON.components,this.fldtype=fldTypes,this.flds={},this.entityFormJson={},this.pageSize=5,this.emptyRowsHtml="No data found",this.hideControls=[]}return _createClass(t,[{key:"init",value:function(){this.getUrlParams();try{var t,e;entityFormMetaData=entityFormMetaData.replaceAll('"{',"{").replaceAll('}"',"}"),entityFormMetaData=JSON.parse(entityFormMetaData),entityFormData=entityFormData.replaceAll('"{',"{").replaceAll('}"',"}"),entityFormData=entityFormData.split("*$*")[1],entityFormData=JSON.parse(entityFormData),this.hideControls=(null===(t=entityFormData.data.find(function(t){var e;return"axro_hidecontrols"==(null===(e=t.n)||void 0===e?void 0:e.toLowerCase())}))||void 0===t?void 0:null===(e=t.v)||void 0===e?void 0:e.toLowerCase().split(","))||[],this.entityFormJson.data=entityFormData.data,this.entityFormJson.metadata=entityFormMetaData.result.metadata,this.entityFormJson.error=entityFormData.error,(_subEntity.inValid(this.recordId)||"0"==this.recordId)&&(this.recordId=this.entityFormJson.data.find(function(t){return"axp_recid1"==t.n}).v),this.constructEntityFormHTML(),this.readmore(),this.bindEvents(),this.applyTheme()}catch(a){showAlertDialog("error","Error occurred. Please check with administrator.")}parent.ShowDimmer(!1)}},{key:"getUrlParams",value:function(){var t=window.location.search,e=new URLSearchParams(t);this.entityName=e.get("ename")||"",this.entityTransId=e.get("tstid"),this.recordId=e.get("recid")||"0",this.keyValue=e.get("keyval")||""}},{key:"getRelatedEntityListData",value:function(){var t,e,a;window.top.entityNavList&&null!==(t=window.top.entityNavList)&&void 0!==t&&t.lastTransId&&_subEntity.subEntityList[window.top.entityNavList.lastTransId]&&null!==(e=window.top.entityNavList)&&void 0!==e&&e[window.top.entityNavList.lastTransId]&&window.top.entityNavList[window.top.entityNavList.lastTransId].length?this.createRelatedListHTML(window.top.entityNavList[window.top.entityNavList.lastTransId],window.top.entityNavList.lastTransId):window.top.entityNavList&&null!==(a=window.top.entityNavList)&&void 0!==a&&a[this.entityTransId]&&window.top.entityNavList[this.entityTransId].length&&this.createRelatedListHTML(window.top.entityNavList[this.entityTransId],this.entityTransId)}},{key:"createRelatedListHTML",value:function(t,e){var a,n=this,i="",s=!1,r=_createForOfIteratorHelper(t.filter(function(t){return t.recordid!=n.recordId&&t.transid==e}));try{for(r.s();!(a=r.n()).done;){var c,l=a.value;_subEntity.entityWiseFields[l.transid]||$.each(_subEntity.metaData.filter(function(t){return t.ftransid===l.transid}),function(t,e){n.populateEntityWiseFlds(t,e)});var o=entityKeyField;if(l.hasOwnProperty(o)||(o=getKeyField(l.transid).fldname,_subEntity.inValid(l[o])&&(o=Object.keys(l)[4])),l.keycol=o,!l.keycol||_subEntity.inValid(l[l.keycol])){for(var d=Object.keys(l),u=null,p=4;p<d.length;p++){var m=d[p];if(null!==l[m]&&l[m]!==undefined&&""!==l[m]){u=m;break}}l.keycol=u,o=u}var y=null===(c=l[o])||void 0===c?void 0:c.toString().replace("T00:00:00",""),h=l.entityname||n.entityName,f="";"prev"==l.navtype?(f="<<",s=!0):"next"==l.navtype?(f=">>",!0):f=s?">>":"<<";var v=">>"==f?"Next":"Previous";i+='<div class="Project_items">\n                        <div class="card  ">\n                           <div class="col-xl-12 col-md-12 d-flex flex-column flex-column-fluid   ">',i+=' <div class="page-Header">\n                        <h3 class="card-title collapsible cursor-pointer rotate" data-bs-toggle="collapse"\n                            aria-expanded="true" data-bs-target="#Sub-Entity_wrapper" >\n                            <div class="symbol symbol-25px symbol-circle initialized"  data-toggle="tooltip" title="'.concat(v,'" data-bs-original-title="').concat(v,'">\n                                <span class="symbol-label bg-warning text-inverse-warning fw-bold" style="height:30px !important; width:30px !important;">').concat(f,'</span>\n                            </div>\n                            <span class="Project_title" onclick="_subEntity.openEntityForm(\'').concat(h,"', '").concat(l.transid,"', '").concat(l.recordid,"','").concat(y,"')\">").concat(y,"</span>\n                        </h3>\n                    </div>"),i+="</div></div></div></div></div>"}}catch(b){r.e(b)}finally{r.f()}""!=i&&($("#related-records-container").removeClass("d-none"),$("#related-records-container .card-title").html("".concat(window.top.entityNavList.lastCaption)),$("#related-records").html(i))}},{key:"populateEntityWiseFlds",value:function(t,e){_subEntity.entityWiseFields[e.ftransid]||(_subEntity.entityWiseFields[e.ftransid]={},_subEntity.entityWiseFields[e.ftransid].largeTextElements=[],_subEntity.entityWiseFields[e.ftransid].attachmentElements=[],_subEntity.entityWiseFields[e.ftransid].otherElements=[],_subEntity.entityWiseFields[e.ftransid].buttonElements=[]);var a=getFieldDataType(e).toUpperCase();"BUTTON"===a?_subEntity.entityWiseFields[e.ftransid].buttonElements.push(e):"ATTACHMENTS"===a?_subEntity.entityWiseFields[e.ftransid].attachmentElements.push(e):"LARGE TEXT"===a?_subEntity.entityWiseFields[e.ftransid].largeTextElements.push(e):_subEntity.entityWiseFields[e.ftransid].otherElements.push(e)}},{key:"constructFormRelatedDataList",value:function(t,e){var a=this,n="No other data found";_subEntity.entityWiseFields[a.entityTransId]||$.each(_subEntity.metaData.filter(function(t){return t.ftransid===a.entityTransId}),function(t,e){a.populateEntityWiseFlds(t,e)});var i,s=_createForOfIteratorHelper(t);try{for(s.s();!(i=s.n()).done;){var r,c=i.value;if(c.recordid!=a.recordId){var l=entityKeyField;if(c.hasOwnProperty(l)||(l=getKeyField(c.transid).fldname,_subEntity.inValid(c[l])&&(l=Object.keys(c)[4])),c.keycol=l,!c.keycol||_subEntity.inValid(c[c.keycol])){for(var o=Object.keys(c),d=null,u=4;u<o.length;u++){var p=o[u];if(null!==c[p]&&c[p]!==undefined&&""!==c[p]){d=p;break}}c.keycol=d,l=d}var m=null===(r=c[l])||void 0===r?void 0:r.toString().replace("T00:00:00",""),y=c.entityname||a.entityName,h=getSubEntityInitials(y);"No other data found"==n&&(n=""),n+='<div class="Project_items">\n                        <div class="card  ">\n                           <div class="col-xl-12 col-md-12 d-flex flex-column flex-column-fluid   ">';generateRowButtonHTML(c,c.transid);n+=' <div class="page-Header">\n                        <h3 class="card-title collapsible cursor-pointer rotate" data-bs-toggle="collapse"\n                            aria-expanded="true" data-bs-target="#Sub-Entity_wrapper" >\n                            <div class="symbol symbol-25px symbol-circle initialized"  onclick="_subEntity.openEntityPage(\''.concat(y,"', '").concat(c.transid,'\')" data-toggle="tooltip" title="').concat(y,'" data-bs-original-title="').concat(y,'">\n                                        <span class="symbol-label bg-warning text-inverse-warning fw-bold" style="height:30px !important; width:30px !important;">').concat(h,'</span>\n                                    </div>\n                            <span class="Project_title" onclick="_subEntity.openEntityForm(\'').concat(y,"', '").concat(c.transid,"', '").concat(c.recordid,"','").concat(m,"')\">").concat(m,"</span>\n                        </h3>\n                    </div>"),n+="               \n                </div>\n            </div>",n+=generateRowElements(c,c.transid,"Other Data"),n+="</div></div></div>"}}}catch(f){s.e(f)}finally{s.f()}$("#related-records_".concat(e)).html(n),$("#related-records-container_".concat(e)).addClass("data-fetched"),$('[data-toggle="tooltip"]').tooltip(),initReadMore(),KTMenu.init()}},{key:"constructFormRelatedDataAccordions",value:function(){var t=[];if(""!=relatedDataFields){var e=[];relatedDataFields.split(",").forEach(function(t){e.push(t.split("~")[1])}),t=_subEntity.metaData.filter(function(t){return"F"===t.subentity&&"F"===t.hide&&e.includes(t.fldname)});var a="";t.forEach(function(t){var e=t.fldcap||"",n=_entityForm.entityFormJson.data.filter(function(e){return e.n===t.fldname});if(n.length){var i=1;n.forEach(function(n){e=ReverseCheckSpecialChars(n.v);var s="".concat(t.dcname).concat(i);a+='\n                <div class="card KC_Items related-accordions" id="related-records-container_'.concat(s).concat(t.fldname,'" data-fldid="').concat(t.fldname,'" data-dcname="').concat(t.dcname,'" data-rowno="').concat(i,'"  data-fldval="').concat(e,'" data-griddc="').concat(t.griddc,'">\n                    <div class="card-header collapsible cursor-pointer rotate collapsed" data-bs-toggle="collapse" aria-expanded="true" data-bs-target="#related-records_').concat(s).concat(t.fldname,'">\n                        <h3 class="card-title">').concat(t.fldcap||""," - ").concat(e,'</h3>\n                        <div class="card-toolbar rotate-180">\n                            <span class="material-icons material-icons-style material-icons-2">expand_circle_down\n                            </span>\n                        </div>\n                    </div>\n                    <div class="KC_Items_Content collapse heightControl pt-0---" id="related-records_').concat(s).concat(t.fldname,'">\n                        <bodycontent>No Data Found</bodycontent>\n                    </div>\n                </div>'),i++})}}),$(".KPI_Section").append(a),document.querySelectorAll(".related-accordions").forEach(function(t){$(t).on("show.bs.collapse",function(){if(!this.classList.contains("data-fetched")){var t=this.dataset.fldid,e=this.dataset.dcname,a=this.dataset.griddc,n=this.dataset.rowno;fetchFilteredData(t,this.dataset.fldval,e,a,n.toString())}})})}}},{key:"getEntityListDataForOtherData",value:function(t,e,a){parent.ShowDimmer(!0);var n=this,i={transId:n.entityTransId,fields:n.fields,pageNo:t,pageSize:n.pageSize,filter:n.filter,gridDc:a};this.callAPI("../aspx/Entity.aspx/GetEntityListWithGridDataWS",i,!1,function(a){if(a.success){var i,s,r;parent.ShowDimmer(!1);var c=JSON.parse(JSON.parse(a.response).d);c=null!==(i=null===(s=c.result.list)||void 0===s?void 0:null===(r=s[0])||void 0===r?void 0:r.data_json)&&void 0!==i?i:"[]";try{c.constructor!=Array&&(c=JSON.parse(c))}catch(l){return void showAlertDialog("error","Error occurred in data fetch.")}if(0==(c.length||0)){if(1==t)return n.listJson=[],void(document.querySelector("related-records_".concat(e)).innerHTML=n.emptyRowsHtml)}else n.constructFormRelatedDataList(c,e)}else parent.ShowDimmer(!1)})}},{key:"openEntityForm",value:function(t,e,a,n){var i="../aspx/EntityForm.aspx?ename=".concat(t,"&tstid=").concat(e,"&recid=").concat(a,"&keyval=").concat(n);parent.LoadIframe(i)}},{key:"constructEntityFormHTML",value:function(){var t=this.entityFormJson,e=document.getElementById("header_Container");if(_subEntity.inValid(t.error)){var a=this.groupByDC(t.data);this.parseFormMetaData(t.metadata),this.constructScriptButtons(t.metadata),e.innerHTML=this.generateHTML(a,t.metadata),document.querySelector("#dcTabs").insertAdjacentHTML("beforeend",'<li class="dcTabs"><a href="#sub-entityhdr" id="activities-link">Connected data</a></li>'),document.querySelectorAll("#dcTabs li a").forEach(function(t){t.addEventListener("click",function(t){var e;document.querySelectorAll("#dcTabs li").forEach(function(t){return t.classList.remove("active")}),this.closest("li").classList.add("active"),null===(e=document.querySelector("".concat(this.getAttribute("href")," .dc-heading.collapsed")))||void 0===e||e.click()})})}else e.innerHTML=t.error[0].msg}},{key:"parseFormMetaData",value:function(t){var e=this;t.forEach(function(t){e.flds[t.fname]=t})}},{key:"constructScriptButtons",value:function(t){var e="";t.filter(function(t){return"Button"==t.customdatatype}).forEach(function(t){e+='<div class="menu-item px-3 my-0" onclick="_entityForm.callScriptAction(\''.concat(t.fname,'\')">\n                        <a href="javascript:void(0)" class="menu-link px-3 py-2" data-kt-element="mode" data-target="lightTheme" data-kt-value="light">\n                            <span class="material-icons material-icons-style material-icons-2">keyboard_double_arrow_right</span>\n                            <span class="menu-title">').concat(t.caption,"\n                            </span>\n                        </a>\n                    </div>")}),e&&(document.querySelector("#scriptBtns-btn").classList.remove("d-none"),document.querySelector("#scriptBtns-container").innerHTML=e)}},{key:"callScriptAction",value:function(t){parent.ShowDimmer(!0);var e={transId:this.entityTransId,script:t,recordId:this.recordId};this.callAPI("../aspx/EntityForm.aspx/CallScriptsWS",e,!0,function(e){if(parent.ShowDimmer(!1),e.success)try{e=JSON.parse(JSON.parse(e.response).d).result,AssignLoadValues(e,"",t,"");try{AxAfterCallAction()}catch(a){}}catch(n){}else showAlertDialog("Error",e.response)})}},{key:"bindEvents",value:function(){var t=this,e=document.getElementById("Project_Entity_form");e.addEventListener("scroll",function(){if(t.isSubEntitiesAvailable&&t.activitiesExpanded&&isScrollAtBottomWithinDiv(e)){var a=t.maxPageNumber+1;t.getSubEntityListData(a)}}),this.bindThemeEvent()}},{key:"bindThemeEvent",value:function(){var t=this;document.querySelectorAll("#selectThemes .menu-link").forEach(function(e){e.addEventListener("click",function(a){a.preventDefault();var n=this.getAttribute("data-target");t.updateTheme(n),t.updateActiveClass(e),localStorage.setItem("selectedTheme-".concat(_subEntity.entityName),n)})})}},{key:"applyTheme",value:function(){var t=localStorage.getItem("selectedTheme-".concat(_subEntity.entityName));if(t){this.updateTheme(t);var e=document.querySelector('#selectThemes .menu-link[data-target="'.concat(t,'"]'));e&&this.updateActiveClass(e)}}},{key:"updateActiveClass",value:function(t){document.querySelectorAll("#selectThemes .menu-link").forEach(function(t){t.classList.remove("active")}),t.classList.add("active")}},{key:"updateTheme",value:function(t){var e=document.body;e.classList.remove("lightTheme","blackTheme","gradTheme","compactTheme"),"lightTheme"===t||"light"===t?e.classList.add("lightTheme"):"blackTheme"===t||"dark"===t?e.classList.add("blackTheme"):"gradTheme"===t||"gradient"===t||"system"===t?e.classList.add("gradTheme"):"compactTheme"!==t&&"pattern"!==t||e.classList.add("compactTheme")}},{key:"createHTML",value:function(t,e){var a=this,n="",i=t[0].n.toLowerCase();if(t[0].hasdatarows&&"yes"===t[0].hasdatarows){var s={};t.forEach(function(t){if("dc"!==t.t){var e=t.r;s[e]||(s[e]=[]),s[e].push(t)}});var r={};t.forEach(function(t){"dc"!==t.t&&(r[t.r]||(r[t.r]={}),r[t.r][t.n]=t.v)}),n+='<div class="row" style="position: relative; right: 3px;" id="'.concat(i,'">\n                                        <div class="dc-heading card-title cursor-pointer collapsible  rotate  collapsed" data-bs-toggle="collapse"\n                                            aria-expanded="true" data-bs-target="#').concat(i,'container" >\n                                            <span class="material-icons material-icons-style material-icons-2 rotate-180">expand_circle_down\n                                            </span>').concat(getCaption(i),'\n                                        </div>\n\n                                        <div id="').concat(i,'container" class="row sub-entity-row collapse"><table class="table table-light table-striped table-bordered tabularDC">'),n+="<thead><tr>";var c=e.filter(function(t){return"dc"!=t.datatype&&t.dcname==i&&null!=t.hidden&&"T"!=t.hidden});c.forEach(function(t){n+="<th>".concat(t.caption,"</th>")}),n+="</tr></thead>",n+="<tbody>",Object.keys(r).forEach(function(t){n+="<tr>",c.forEach(function(e,i){if(e.fname.startsWith("axpfile_")){var s=_entityForm.entityFormJson.data.find(function(t){return t.n===e.fname.replace("axpfile_","axpfilepath_")}),c=s?s.v:null;-1!=c.indexOf(";bkslh")&&(c=c.replace(new RegExp(";bkslh","g"),"\\")),c.endsWith("\\")&&(c=c.substr(0,c.length-1)),(l={}).v=ReverseCheckSpecialChars(r[t][e.fname]||""),l.filepath=c,n+="<td>".concat(a.createAttachmentHTML(l,i,""),"</td>")}else if(e.fname.startsWith("dc")&&e.fname.endsWith("_image")){var l;(l={}).v=ReverseCheckSpecialChars(r[t][e.fname]||""),n+="<td>".concat(a.createDCAttachmentHTML(l,i,""),"</td>")}else n+="<td>".concat(ReverseCheckSpecialChars(r[t][e.fname]||""),"</td>")}),n+="</tr>"}),n+="</tbody>",n+="</table></div></div>"}else{var l=1,o=0,d="";d="dc1"==i?'<div class="row" style="position: relative; right: 3px;" id="'.concat(i,'">\n                                        <div class="dc-heading card-title cursor-pointer collapsible  rotate  " data-bs-toggle="collapse"\n                                            aria-expanded="true" data-bs-target="#').concat(i,'container" >\n                                            <span class="material-icons material-icons-style material-icons-2 rotate-180">expand_circle_down\n                                            </span>').concat(getCaption(i),'\n                                        </div>\n\n                                        <div id="').concat(i,'container" class="row sub-entity-row collapse show">'):'<div class="row" style="position: relative; right: 3px;" id="'.concat(i,'">\n                                        <div class="dc-heading card-title cursor-pointer collapsible  rotate  collapsed" data-bs-toggle="collapse"\n                                            aria-expanded="true" data-bs-target="#').concat(i,'container" >\n                                            <span class="material-icons material-icons-style material-icons-2 rotate-180">expand_circle_down\n                                            </span>').concat(getCaption(i),'\n                                        </div>\n\n                                        <div id="').concat(i,'container" class="row sub-entity-row collapse">'),t.forEach(function(t){if(t.n){var n=getHiddenFlag(t.n);null!=n&&"T"!=n&&(o++,d+=a.nongridDcHTML(t,l,e))}l++}),d+="</div></div>",o>0&&(n+=d)}if(""!=n){var u="";"dc1"==t[0].n.toLowerCase()&&(u="active");var p='<li class="dcTabs '.concat(u,'"><a href="#').concat(t[0].n.toLowerCase(),'">').concat(getCaption(t[0].n.toLowerCase()),"</a></li>");document.querySelector("#dcTabs").insertAdjacentHTML("beforeend",p)}return n}},{key:"groupByDC",value:function(t){var e=this,a=[],n=[],i=!1;return t.forEach(function(t){var s,r;"dc"===t.t&&(i=!1,t.n&&e.hideControls.indexOf(null===(r=t.n)||void 0===r?void 0:r.toLowerCase())>-1&&(i=!0),n.length>0&&a.push(n),n=[]);i||!t.n||e.hideControls.indexOf(null===(s=t.n)||void 0===s?void 0:s.toLowerCase())>-1||n.push(t)}),n.length>0&&a.push(n),a}},{key:"generateHTML",value:function(t,e){var a=this,n="";return t.forEach(function(t){n+=a.createHTML(t,e)}),n}},{key:"nongridDcHTML",value:function(t,e,a){var n=t.n,i=ReverseCheckSpecialChars(t.v),s=getCaption(t.n),r="",c=t.t.toUpperCase();if("DC"!=c){var l,o=(null===(l=this.components[c])||void 0===l?void 0:l.html)||'<div class="inputcontent"  readonly>{{v}}</div>';if(""!=i){var d=this.getclassname(i,"");if(d.startsWith("col"))"";else{d=""}}if("RT"==c||"LT"==c)r=this.createRichTextComponent(t,e);else if("ATT"==c||n.startsWith("axpfile_")){var u=_entityForm.entityFormJson.data.find(function(t){return t.n===n.replace("axpfile_","axpfilepath_")}),p=u?u.v:null;-1!=p.indexOf(";bkslh")&&(p=p.replace(new RegExp(";bkslh","g"),"\\")),p.endsWith("\\")&&(p=p.substr(0,p.length-1)),t.filepath=p,r='<div class="'.concat(d,' col-sm-12 " data-type="').concat(c,'" data-name="').concat(n,'" data-ctype="').concat(this.flds[n].customdatatype,'"><label>').concat(s,"</label>").concat(this.createAttachmentHTML(t,e,d),"</div>")}else if(n.startsWith("dc")&&n.endsWith("_image"))r='<div class="'.concat(d,' col-sm-12 " data-type="').concat(c,'" data-name="').concat(n,'" data-ctype="').concat(this.flds[n].customdatatype,'"><label>').concat(s,"</label>").concat(this.createDCAttachmentHTML(t,e,d),"</div>");else if("Image"==this.flds[n].customdatatype)r='<div class="'.concat(d,' col-sm-12 " data-type="').concat(c,'" data-name="').concat(n,'" data-ctype="').concat(this.flds[n].customdatatype,'"><label>').concat(s,"</label>").concat(this.getTstructImage(t,e,d),"</div>");else if("T"==i||"F"==i){var m="T"===i?"checked":"";o=this.components.togglebutton.html.replace("{{checked}}",m),r='<div class="'.concat(d,' col-sm-12 " data-type="').concat(c,'" data-name="').concat(n,'" data-ctype="').concat(this.flds[n].customdatatype,'"><label>').concat(s,"</label>").concat(o,"</div>")}else r='<div class="'.concat(d,' col-sm-12 " data-type="').concat(c,'" data-name="').concat(n,'" data-ctype="').concat(this.flds[n].customdatatype,'"><label>').concat(s,"</label>").concat(o,"</div>")}return Handlebars.compile(r)(t)}},{key:"ConstructEntityForm",value:function(t,e){var a=document.querySelector(t);a.className="container";var n=!1,i=null;(l=document.createElement("div")).classList.add("row");for(var s=[],r=0;r<e.length;r++){if("DC"==e[r].props.split("~")[0]){var c=e[r].dcno;if(i!==c){var l;n=!1,""!==l.innerHTML&&(a.appendChild(l.cloneNode(!0)),l.innerHTML=""),(l=document.createElement("div")).classList.add("row"),l.style.position="relative",l.style.right="3px";var o=document.createElement("div");o.className="dc-heading",o.innerHTML="<h3>"+e[r].caption+"</h3>",l.appendChild(o),a.appendChild(l),i=c,this.isGridDC(e[r])&&(n=!0,s=[])}}if(n){if("DC"!==e[r].props.split("~")[0]&&this.fldtype.includes(e[r].props.split("~")[0])&&"F"!==e[r].props.split("~")[2]&&(s.push(e[r]),(r+1===e.length||"DC"===e[r+1].props.split("~")[0])&&s.length>0)){var d=this.gridDc(s,r);l.innerHTML+=d,s=[]}}else if("DC"!==e[r].props.split("~")[0]&&this.fldtype.includes(e[r].props.split("~")[0])&&"F"!==e[r].props.split("~")[2]){var u=this.nongridDc(e[r],r);l.innerHTML+=u}}""!==l.innerHTML&&a.appendChild(l)}},{key:"isGridDC",value:function(t){return"T"==t.props.split("~")[1]}},{key:"gridDc",value:function(t,e){var a={};t.forEach(function(t){var n,i=t.fieldid,s=t.value;a[i]||(a[i]=[]);var r=t.row-1;a[i][r]||(a[i][r]="");var c=t.props.split("~")[0],l=(null===(n=_entityForm.components[t.props.split("~")[0]])||void 0===n?void 0:n.html)||'<div class="inputcontent"  readonly>{{v}}</div>';if("ATT"==c||fldName.startsWith("axpfile_")||fldName.startsWith("dc")&&fldName.endsWith("_image")){var o=_entityForm.getclassname(t.value,t.props.split("~")[3]),d=_entityForm.entityFormJson.data.find(function(t){return t.n===fldName.replace("axpfile_","axpfilepath_")}),u=d?d.v:null;-1!=u.indexOf(";bkslh")&&(u=u.replace(new RegExp(";bkslh","g"),"\\")),fldjson.filepath=u,l='<div class="'.concat(o,' col-sm-12 " data-type="').concat(fieldType,'" data-name="').concat(fldName,'" data-ctype="').concat(this.flds[fldName].customdatatype,'"><label>').concat(fldCaption,"</label>").concat(this.createAttachmentHTML(fldjson,e,o),"</div>"),a[i][r]+=l+"<br>"}else if("togglebutton"==c&&_entityForm.fldtype.includes(t.props.split("~")[0])){var p,m=(null===(p=_entityForm.components[c])||void 0===p?void 0:p.html)||'<div class="inputcontent"  readonly>{{v}}</div>',y="T"===t.value?"checked":"";m=m.replace("{{checked}}",y),l='<div class="'.concat(o,' col-sm-12" style="display:inline-grid;" ><div><label style="font-weight:bold;">').concat(t.caption,"</label></div><div>").concat(m,"</div></div>"),a[i][r]+=l+"<br>"}else a[i][r]+=s+"<br>"});var n='<table class="table table-light table-striped table-bordered">';n+="<thead><tr>",Object.keys(a).forEach(function(t){n+="<th>"+t+"</th>"}),n+="</tr></thead><tbody>";for(var i=Math.max.apply(Math,_toConsumableArray(Object.values(a).map(function(t){return t.length}))),s=0;s<i;s++)n+="<tr>",Object.keys(a).forEach(function(t){var e=a[t][s]||"";n+="<td>"+e+"</td>"}),n+="</tr>";return n+="</tbody></table>"}},{key:"nongridDc",value:function(t,e){var a,n="",i=t.props.split("~")[0],s=(null===(a=this.components[i])||void 0===a?void 0:a.html)||'<div class="inputcontent"  readonly>{{v}}</div>';if(""!=t.value){var r=this.getclassname(t.value,t.props.split("~")[3]);if(r.startsWith("col"))c="";else{var c=r;r=""}}if("RT"==i||"LT"==i)n=this.createRichTextComponent(t,e);else if("ATT"==i)n=this.createAttachmentHTML(t,e,r);else if("Img"==i)n=this.getimage(t,e,r);else if("togglebutton"==i){var l="T"===t.value?"checked":"";s=s.replace("{{checked}}",l),n='<div class="'.concat(r,' col-sm-12 " style="display:inline-grid;" ><div><label style="font-weight:bold;">').concat(t.caption,"</label></div><div>").concat(s,"</div></div>")}else n='<div class="'.concat(r,' col-sm-12 " style="width:').concat(c,'px;"><div><label style="font-weight:bold;">{{caption}}</label></div><div>').concat(s,"</div></div>");return Handlebars.compile(n)(t)}},{key:"getimage",value:function(t,e,a){var n,i=this.downloadfileattachment(t.caption,""),s=t.props.split("~")[0],r=(null===(n=this.components[s])||void 0===n?void 0:n.html)||'<div class="inputcontent"  readonly>{{v}}</div>';return r=r.replace("{{colclassname}}","".concat(a)),r=i!=undefined?r.replace("{{src}}","".concat(i)):r.replace("{{src}}","../images/logo.png"),'<div class="'.concat(a,' col-sm-12 ">').concat(r,"</div>")}},{key:"getTstructImage",value:function(t,e,a){var n,i,s=ReverseCheckSpecialChars(t.v),r="";s.length>1&&(r=this.getScriptsPath()+"/"+s),GetDateTime(),i=r+"?"+imageSuffix;var c=(null===(n=this.components.Image)||void 0===n?void 0:n.html)||'<div class="inputcontent"  readonly>{{v}}</div>';return c=c.replace("{{colclassname}}","".concat(a)),i!=undefined&&(c=c.replace("{{src}}","".concat(i))),c}},{key:"getScriptsPath",value:function(){var t="",e=$j("#hdnScriptsUrlpath");return e[0]!=undefined&&(t=e.val()+"axpert/"+callParentNew("mainSessionId")),t}},{key:"createRichTextComponent",value:function(t,e){var a='<div class="col-lg-12 col-sm-12 ">\n                        <div class="mb-3">\n                            <label style="font-weight:bold;">{{caption}}</label>\n                        </div>\n                        <div id=\'textcontent'.concat(e,'\' class="mb-5">').concat(t.value,"</div>\n                    </div>");return a=Handlebars.compile(a)(t)}},{key:"createAttachmentHTML",value:function(t,e,a){var n,i=(null===(n=this.components.ATT)||void 0===n?void 0:n.html)||'<div class="inputcontent"  readonly>{{v}}</div>';i=i.replaceAll("{{customid}}","fileattached".concat(e));var s=ReverseCheckSpecialChars(t.v).split(".").pop().toLowerCase(),r=this.getFileImgHTML(s);return i=i.replace("{{componentimg}}","".concat(r)),Handlebars.compile(i)(t)}},{key:"createDCAttachmentHTML",value:function(t,e,a){var n,i=(null===(n=this.components.GRID_ATT)||void 0===n?void 0:n.html)||'<div class="inputcontent"  readonly>{{v}}</div>';i=i.replaceAll("{{customid}}","fileattached".concat(e));var s=ReverseCheckSpecialChars(t.v).split(".").pop().toLowerCase(),r=this.getFileImgHTML(s);return i=i.replace("{{componentimg}}","".concat(r)),Handlebars.compile(i)(t)}},{key:"getclassname",value:function(t,e){var a=document.createElement("div");a.style.visibility="hidden",a.style.whiteSpace="pre",a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a),a.textContent=t;var n=a.getBoundingClientRect().width;document.body.removeChild(a);return""==e||e==undefined||null==e?n>375&&n<800?"col-lg-8 Eform_Display_Items":n>800?"col-lg-12 Eform_Display_Items":"col-lg-6 Eform_Display_Items":e}},{key:"downloadfileattachment",value:function(t,e){var a=this.getScriptsPath()+"/"+t;ASB.WebService.LoadAxpFileToScript(e,t,function(){var t=(a=unescape(a)).lastIndexOf("/");t>-1&&(a=a.substring(0,t+1)+encodeURIComponent(a.substring(t+1,a.length)));if(isMobile){var e=a.match(/\/([^\/?#]+)$/)[1];OpenPdfFile(e,"","","",!1)}else window.open(a,"GridUploadFile","width=500,height=350,scrollbars=no,resizable=yes")})}},{key:"showGridAttLink",value:function(t){var e=this.getScriptsPath()+"/"+t;e=e.replace(//g,"'");var a=(e=unescape(e)).lastIndexOf("/");a>-1&&(e=e.substring(0,a+1)+encodeURIComponent(e.substring(a+1,e.length))),window.open(e,"GridUploadFile","width=500,height=350,scrollbars=no,resizable=yes")}},{key:"downloadAttachment",value:function(t,e,a){var n=document.createElement("a");n.style.display="none",document.body.appendChild(n),n.href=t,n.download=e,n.click(),document.body.removeChild(n)}},{key:"getFileImgHTML",value:function(t){switch(t){case"pdf":return'<img src="../Images/filetypes/pdf.svg" class="file-img"/>';case"ppt":case"pptx":return'<img src="../Images/filetypes/ppt.svg" class="file-img"/>';case"jpeg":case"jpg":case"png":return'<img src="../Images/filetypes/images.svg" class="file-img" />';case"doc":case"docx":return'<img src="../Images/filetypes/word.svg" class="file-img" />';case"txt":return'<img src="../Images/filetypes/text.svg" class="file-img" />';case"xls":case"xlsx":case"csv":return'<img src="../Images/filetypes/csv.svg" class="file-img"/>';default:return'<img src="../Images/filetypes/default.svg" class="file-img" />'}}},{key:"addmore",value:function(){document.querySelectorAll("[id^=".concat("textcontent","]")).forEach(function(t){var e=$(t).html();if(e.length>350){var a=e.substr(0,350),n=e.substr(350);$(t).html(a),$(t).append('<span class="more-text" style="display:none;">'+n+"</span>"),$(t).append('<a href="#" class="read-more">..Read More</a>')}$(t).on("click",".read-more",function(t){t.preventDefault(),"..Read More"===$(this).text()?($(this).text("Show Less"),$(this).prev(".more-text").show()):($(this).text("..Read More"),$(this).prev(".more-text").hide())})})}},{key:"readmore",value:function(){document.querySelectorAll("[id^=".concat("textcontent","]")).forEach(function(t){var e=t.innerHTML.trim().split("\n"),a=e.slice(0,2),n=a.join("\n"),i=document.createElement("div");i.innerHTML=n,document.body.appendChild(i);i.clientHeight;i.parentNode.removeChild(i);var s=e.slice(2).join("\n");a.length>=2?(t.innerHTML=n,t.insertAdjacentHTML("beforeend",'<span class="more-text" style="display:none;">'+s+"</span>"),t.insertAdjacentHTML("beforeend",'<a href="#" class="read-more" style="float:right;">..Read More</a>')):(t.innerHTML=n,t.insertAdjacentHTML("beforeend",'<span class="more-text" style="display:none;">'+s+"</span>"),t.insertAdjacentHTML("beforeend",'<a href="#" class="read-more" style="float:right;display:none;">..Read More</a>')),t.addEventListener("click",function(t){t.target.matches(".read-more")&&(t.preventDefault(),"..Read More"===t.target.textContent?(t.target.textContent="Read Less",t.target.previousElementSibling.style.display="inline"):(t.target.textContent="..Read More",t.target.previousElementSibling.style.display="none"))})})}},{key:"callAPI",value:function(t,e,a,n){var i=this,s=new XMLHttpRequest;s.open("POST",t,a),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.onreadystatechange=function(){4==this.readyState&&(200==this.status?n({success:!0,response:this.responseText}):(i.catchError(this.responseText),n({success:!1,response:this.responseText})))},s.send(JSON.stringify(e))}},{key:"setSelectedRelatedFields",value:function(){var t={transId:this.entityTransId,fields:this.selectedRelatedDataFields};this.callAPI("../aspx/EntityForm.aspx/SetSelectedRelatedDataFieldsWS",t,!0,function(t){t.success?(_subEntity.reloadEntityPage(),ShowDimmer(!1)):ShowDimmer(!1)})}},{key:"setSelectedDisplayFields",value:function(){var t={transId:this.entityTransId,fields:this.selectedDisplayFields,gridFields:this.selectedDisplayGridFields};this.callAPI("../aspx/EntityForm.aspx/SetSelectedDisplayFieldsWS",t,!0,function(t){t.success?(_subEntity.reloadEntityPage(),ShowDimmer(!1)):ShowDimmer(!1)})}}]),t}();function getCaption(t){for(var e=_entityForm.entityFormJson.metadata,a=0;a<e.length;a++)if(e[a].fname===t)return e[a].caption;return null}function getHiddenFlag(t){for(var e=_entityForm.entityFormJson.metadata,a=0;a<e.length;a++)if(e[a].fname===t)return e[a].hidden;return null}function createListHTML(t,e){var a="",n=filterRowsByPage(t,e);Object.keys(_subEntity.subEntityMapping).forEach(function(t){_subEntity.entityWiseFields[t]||$.each(_subEntity.metaData.filter(function(e){return e.ftransid===t}),function(t,e){_entityForm.populateEntityWiseFlds(t,e)})});var i,s=_createForOfIteratorHelper(n);try{for(s.s();!(i=s.n()).done;){var r=i.value,c=_subEntity.subEntityMapping[r.transid].keycol;r.hasOwnProperty(c)||(c=getKeyField(r.transid).fldname,_subEntity.inValid(r[c])&&(c=Object.keys(r)[4]),_subEntity.subEntityMapping[r.transid].keycol=c),r.keycol=c;var l=r[c],o=_subEntity.subEntityList[r.transid],d=getSubEntityInitials(o);a+='<div class="Project_items">\n                        <div class="card  ">\n                           <div class="col-xl-12 col-md-12 d-flex flex-column flex-column-fluid   ">';var u=generateRowButtonHTML(r,r.transid);if(a+=' <div class="page-Header">\n                                            <h3 class="card-title collapsible cursor-pointer rotate" data-bs-toggle="collapse"\n                                                aria-expanded="true" data-bs-target="#Sub-Entity_wrapper" >\n                                                <input class="Select-Project" type="checkbox" id="" name="" value="">\n                                                <div class="symbol symbol-25px symbol-circle initialized"  onclick="_subEntity.openEntityPage(\''.concat(o,"', '").concat(r.transid,'\')" data-toggle="tooltip" title="').concat(o,'" data-bs-original-title="').concat(o,'">\n                                                            <span class="symbol-label bg-warning text-inverse-warning fw-bold" style="height:30px !important; width:30px !important;">').concat(d,'</span>\n                                                        </div>\n                                                <span class="Project_title" onclick="_subEntity.openEntityForm(\'').concat(o,"', '").concat(r.transid,"', '").concat(r.recordid,"','").concat(l,"',").concat(r.rno,')">').concat(l,'</span>\n                                                <input type="hidden" id="transid_').concat(r.recordid,'" value="').concat(r.transid,'"/>\n                                                <input type="hidden" id="recid_').concat(r.recordid,'" value="').concat(r.recordid,'"/>\n                                                <div class="Project_updates">\n                                                    \n                                                </div>\n                                            </h3>\n                                            <div class="card-toolbar ">\n                                                <div class="d-flex ">\n                                                    <button type="submit" id="" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3" data-bs-toggle="tooltip" title="" data-bs-original-title="edit" onclick="_subEntity.editSubEntity(\'').concat(r.transid,"','").concat(r.recordid,'\')">\n                                                        <span class="material-icons material-icons-style material-icons-2" style="color: red;">\n                                                        edit_note\n                                                        </span>\n                                                    </button>\n                                                    <button type="button" id="" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm  tb-btn btn-sm d-none" data-kt-menu-trigger="{default:\'click\', lg: \'hover\'}" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">\n                                                       <span class="material-icons material-icons-style material-icons-2" style="color: #47BE7D;">\n                                                        more_vert\n                                                        </span>\n                                                    </button>\n                                                    <div id="selectThemes" class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-title-gray-700 menu-icon-gray-500 menu-active-bg menu-state-color fw-semibold py-4 fs-base w-150px" data-kt-menu="true" data-kt-element="theme-mode-menu">\n                                                      ').concat(u,"\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>"),!_subEntity.inValid(r.modifiedby)){var p=moment(r.modifiedon).fromNow();a+='<div class="workflow-row">\n                                            <div class=" workflow-items">\n\t\t\t\t\t\t\t\t\t\t\t<div class="symbol symbol-25px symbol-circle initialized d-none"\n                                                             data-bs-toggle="tooltip" title="" data-bs-original-title="'.concat(r.modifiedby,'">\n                                                            <span class="symbol-label bg-warning text-inverse-warning fw-bold">').concat(r.modifiedby[0],'</span>\n                                                        </div>\n                                                        <span class="txt-bold Project_updates-value">').concat(r.modifiedby,'</span>last modified <span class="txt-bold Project_updates-value" data-toggle="tooltip" data-placement="top" title="').concat(r.modifiedon.replace("T"," "),'" data-name="').concat(r.modifiedon.replace("T"," "),'" >').concat(p,"</span>")}_subEntity.inValid(r.axpeg_status)||(a+='<span class="material-icons material-icons-style material-icons-2 ">people</span>'.concat(r.axpeg_statustext,'\n                                                <button id="pd_timeline" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm entity-timelines" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end" data-kt-menu-flip="top-end" data-kt-menu-attach="parent" title="Timeline">\n                                                    <span class="material-icons material-icons-style material-icons-2">history</span>\n                                                </button>\n\n                                                <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light fw-bolder w-400px py-3" data-kt-menu="true" data-id="pd_timeline" data-processname="').concat(r.axpeg_processname,'" data-keyvalue="').concat(r.axpeg_keyvalue,'">\n                               \n                                                </div>')),a+='\n                                    \x3c!--<button type="submit" id="" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3">\n                                                    <span class="material-icons material-icons-style material-icons-2">history</span>\n                                                </button>--\x3e\n                                                \n                                            </div>\n                                        </div>',a+=generateRowElements(r,r.transid),a+="</div></div></div>"}}catch(m){s.e(m)}finally{s.f()}$("#body_Container").append(a),$('[data-toggle="tooltip"]').tooltip(),initReadMore(),KTMenu.init()}function getSubEntityInitials(t){var e="",a=t.split(" ");return 1===a.length?e=1==a[0].length?a[0].charAt(0):a[0].charAt(0)+a[0].charAt(1):2===a.length?e=a[0].charAt(0)+a[1].charAt(0):a.length>=3&&(e=a[0].charAt(0)+a[1].charAt(0)),e.toUpperCase()}function generateRowElements(t,e,a){var n='<div class="Data-fields-row">';if(a&&"Other Data"==a){n='<div class="Data-fields-row relateddata-row workflow-items">';var i,s=_createForOfIteratorHelper(_subEntity.entityWiseFields[e].otherElements);try{for(s.s();!(i=s.n()).done;){n+=generateHTMLBasedForOtherData(i.value,t)}}catch(p){s.e(p)}finally{s.f()}n.endsWith(",&nbsp;")&&(n=n.substr(0,n.length-7))}else{var r,c=_createForOfIteratorHelper(_subEntity.entityWiseFields[e].otherElements);try{for(c.s();!(r=c.n()).done;){n+=generateHTMLBasedOnDataType(r.value,t)}}catch(p){c.e(p)}finally{c.f()}var l,o=_createForOfIteratorHelper(_subEntity.entityWiseFields[e].largeTextElements);try{for(o.s();!(l=o.n()).done;){n+=generateHTMLBasedOnDataType(l.value,t)}}catch(p){o.e(p)}finally{o.f()}var d,u=_createForOfIteratorHelper(_subEntity.entityWiseFields[e].attachmentElements);try{for(u.s();!(d=u.n()).done;){n+=generateHTMLBasedOnDataType(d.value,t)}}catch(p){u.e(p)}finally{u.f()}}return n+="</div>",a&&"Other Data"==a&&(n=n.replaceAll("txt-bold"," ")),n}function generateRowButtonHTML(t,e){var a,n="",i=_createForOfIteratorHelper(_subEntity.entityWiseFields[e].buttonElements);try{for(i.s();!(a=i.n()).done;){n+='<div class="menu-item px-3 my-0">',n+=generateHTMLBasedOnDataType(a.value,t),n+="</div>"}}catch(s){i.e(s)}finally{i.f()}return n}function getFieldDataType(t){return _subEntity.inValid(t.cdatatype)?"n"==t.fdatatype?"Number":"d"==t.fdatatype?"Date":"c"==t.fdatatype?"Text":"i"==t.fdatatype?"Image":"t"==t.fdatatype?"Large Text":"Text":t.cdatatype}function generateHTMLBasedOnDataType(t,e){var a,n=t.fldname;if(n==entityKeyField&&e.transid==_subEntity.entityTransId||n==e.keycol&&e.transid==t.ftransid)return"";var i=getFieldDataType(t),s=t.fldcap||"",r=t.props,c=e[n];if(_subEntity.inValid(c)&&"BUTTON"!=i.toUpperCase()||"transid"==t.fldname)return"";"BUTTON"!=i.toUpperCase()&&(c=null===(a=c)||void 0===a?void 0:a.toString().replace("T00:00:00",""));var l="";switch(i){case"Large Text":l='<div class=" Data-fields-items Department-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                               <p class="task-description moretext" style="margin-bottom:0px !important;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t').concat(c,'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t </p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t <a class="moreless-button" href="#">Read more</a>\n                                            </div>');break;case"Short Text":l='<div class=" Data-fields-items Department-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">description</span><span class="txt-bold Data-field-value">').concat(c,"</span>\n                                            </div>");break;case"Currency":l='<div class=" Data-fields-items Department-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">payments</span><span class="txt-bold Data-field-value">').concat(c,"</span>\n                                            </div>");break;case"Date":l='<div class=" Data-fields-items Date-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">today</span><span class="txt-bold Data-field-value"> Dec 14 2023 </span>\n                                            </div>');break;case"Time":l=' <div class=" Data-fields-items Time-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">schedule</span><span class="txt-bold Data-field-value">11:30 PM</span>\n                                            </div>');break;case"Link":l='<div class=" Data-fields-items link-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">link</span><span class="txt-bold Data-field-value">').concat(c,"</span>\n                                            </div>");break;case"Mobile":case"Phone":l='<div class=" Data-fields-items Email-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">phone</span><span class="txt-bold Data-field-value">').concat(c,"</span>\n                                            </div>");break;case"Pincode":case"Zipcode":l='<div class=" Data-fields-items Email-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">location_on</span><span class="txt-bold Data-field-value">').concat(c,"</span>\n                                            </div>");break;case"Email":l='<div class=" Data-fields-items Email-field truncate" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="material-icons material-icons-style material-icons-2 ">mail</span><span class="txt-bold Data-field-value" data-text="').concat(c,'" onclick="showPopup(this)">').concat(c,"</span>\n                                            </div>");break;case"Bool":l="T"==c?'<div class=" Data-fields-items Email-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                    <div class="form-check form-switch">\n                          <input class="form-check-input" type="checkbox" role="switch" checked disabled>\n                          <span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div></div>"):'<div class=" Data-fields-items Email-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                    <div class="form-check form-switch" style="padding-top: 5px;">\n                          <input class="form-check-input" type="checkbox" role="switch" disabled>\n                          <span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div></div>");break;case"button":var o=r.split("|")[0].split("~")[1];l='<a href="javascript:void(0)" title="View form"\n                                                   class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center  btn-sm  me-2 ">\n                                                    <span class="material-icons material-icons-style material-icons-2"\n                                                          style="color: darkmagenta;">'.concat(o,"</span>").concat(s,"\n                                                </a>");break;case"Attachments":var d=getIconClass(getFileType(c));l='<div class="Files-Attached " data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n\t\t\t\t\t\t   ').concat(d,'\t\n\t\t\t\t\t\t   <div class="ms-1 fw-semibold">\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t  <a class="attached-filename" onclick="downloadFileFromPath(\'').concat("","','").concat(c,"')\">").concat(c,"</a>\t\t\t\t\t\t  \t\t\t\t\t\t\t  \n\t\t\t\t\t\t   </div>\t\t\t\t\t\t  \t\t\t\t\t\t   \n\t\t\t\t\t\t</div>");break;default:l='<div class=" Data-fields-items Department-field" data-toggle="tooltip" data-placement="top" title="'.concat(s,'" data-name="').concat(s.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                                <span class="txt-bold Data-field-value">').concat(c,"</span>\n                                            </div>")}return l}function generateHTMLBasedForOtherData(t,e){var a,n=t.fldname;if(n==entityKeyField&&e.transid==_subEntity.entityTransId||n==e.keycol&&e.transid==t.ftransid)return"";getFieldDataType(t);var i=t.fldcap||"",s=(t.props,e[n]);return _subEntity.inValid(s)||"transid"==t.fldname?"":(s=null===(a=s)||void 0===a?void 0:a.toString().replace("T00:00:00",""),'<div class="" data-toggle="tooltip" data-placement="top" title="'.concat(i,'" data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                <span class="txt-bold Data-field-value">').concat(s,"</span>\n            </div>,&nbsp;"))}function isScrollAtBottomWithinDiv(t){return t.scrollHeight-(t.scrollTop+t.clientHeight)<=1}function isScrollAtTopWithinDiv(t){return t.scrollTop<=1}function filterRowsByPage(t,e){return t.filter(function(t){return t.pageno===e})}function getMaxPageNumber(t){var e=-Infinity;return t.forEach(function(t){t.pageno>e&&(e=t.pageno)}),e}function initReadMore(){document.querySelectorAll(".moretext").forEach(function(t,e){var a=t.clientHeight,n=t.nextElementSibling;t.scrollHeight>t.clientHeight?(n.style.display="inline-block",t.style.maxHeight=a+"px"):n.style.display="none",n.addEventListener("click",function(){var e=window.getComputedStyle(t);"none"===e.maxHeight||e.maxHeight===a+"px"?(t.style.maxHeight=t.scrollHeight+"px",n.textContent="Read less"):(t.style.maxHeight=a+"px",n.textContent="Read more")})})}function getFilesHtml(t){var e="",a=t.axpfile_file.split(",");return $.each(a,function(a,n){var i=getFileType(n),s=getIconClass(i),r=t.axpfilepath_file+n;r=r.replace(/\\/g,"\\\\"),""!=n&&(e+='<div class="Files-Attached ">\n\t\t\t\t\t\t   '.concat(s,'\t\t\t\t\t\t   \n\t\t\t\t\t\t   <div class="ms-1 fw-semibold">\t\t\t\t\t\t  \n\t\t\t\t\t\t\t  <a class="attached-filename" onclick="downloadFileFromPath(\'').concat(r,"','").concat(n,"')\">").concat(n,'</a>                    \n\t\t\t\t\t\t\t  <div class="attached-filedetails">\n\t\t\t\t\t\t\t\t <span class="doctype">').concat(i,"</span>\n\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t   </div>\n\t\t\t\t\t\t</div>"))}),e}function getIconClass(t){switch(t){case"pdf":return'<img src="../images/pdf.svg" class="file-img" />';case"jpeg":case"jpg":case"png":return'<img src="../images/images.svg" class="file-img" />';case"doc":case"docx":return'<img src="../images/word.svg" class="file-img" />';case"txt":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">description</i>';case"xls":case"xlsx":return'<img src="../images/xl.svg" class="file-img"/>';case"ppt":case"pptx":return'<img src="../images/ppt.svg" class="file-img"/>';case"zip":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">archive</i>';case"mp3":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">audiotrack</i>';case"mp4":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">videocam</i>';default:return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">insert_drive_file</i>'}}function getFileType(t){var e=t.split(".");return e[e.length-1].toLowerCase()}function scrollToTopOfDiv(t){t.scrollTop=0}function showPopup(t){var e=t.getAttribute("data-text");document.getElementById("popupText").textContent=e,$("#myModal").modal("show")}function getKeyField(t){if(_subEntity.subEntityKeyFields&&_subEntity.subEntityKeyFields[t])return{fldname:_subEntity.subEntityKeyFields[t]};var e=_subEntity.metaData.filter(function(e){return e.ftransid===t}),a=e.find(function(t){return"Auto Generate"===t.cdatatype});if(a)return a;var n=e.find(function(t){return"F"===t.hide&&"F"===t.allowempty&&"F"===t.allowduplicate});if(n)return n;var i=e.find(function(t){return"F"===t.hide&&"F"===t.allowempty});if(i)return i;var s=e.find(function(t){return"F"===t.hide});return s||e[0]}function fetchFilteredData(t,e,a,n,i){var s=_subEntity.metaData.find(function(e){return e.fldname===t&&e.ftransid===_entityForm.entityTransId}),r="F";(relatedDataDisplayFields.indexOf("=".concat(t,"~"))>-1||relatedDataDisplayFields.indexOf("|".concat(t,"~"))>-1||"dc1"==a&&("All"==relatedDataDisplayFields||""==relatedDataDisplayFields))&&(r="T");var c="".concat(t,"~").concat(s.normalized,"~").concat(s.srctable||"","~").concat(s.srcfield||"","~").concat(s.fdatatype||"","~").concat(r||"F","~").concat(s.tablename||"","| = '").concat(e.toLowerCase(),"'");_entityForm.filter=c,_entityForm.fields=relatedDataDisplayFields||"All",_entityForm.getEntityListDataForOtherData(1,"".concat(a).concat(i).concat(t),n)}function openFieldSelection(){$("#fieldsModal").modal("show"),""==$("#fields-selection").html()&&createOtherDataFieldsLayout()}function openDisplayFieldSelection(){$("#displayFieldsModal").modal("show"),""==$("#displayfields-selection").html()&&createDisplayFieldsLayout()}function createOtherDataFieldsLayout(){var t=document.getElementById("fields-selection"),e=_subEntity.metaData.filter(function(t){return t.ftransid===_entityForm.entityTransId&&"F"===t.hide&&("DropDown"===t.cdatatype||"c"==t.fdatatype||"d"==t.fdatatype)}),a={};e.forEach(function(t){a[t.dcname]||(a[t.dcname]=[]),a[t.dcname].push(t)});var n="";Object.entries(a).forEach(function(t){var e=_slicedToArray(t,2),a=e[0],i=e[1],s=_entityForm.entityFormJson.metadata.find(function(t){return t.fname==a}).caption||a;n+='\n        <div class="card KC_Items">\n            <div class="card-header collapsible cursor-pointer rotate  '.concat("",'" data-bs-toggle="collapse" aria-expanded="true" data-bs-target="#fields-').concat(a,'">\n                <h3 class="card-title">').concat(s," (").concat(a,')</h3>\n                <div class="card-toolbar rotate-180">\n                    <span class="material-icons material-icons-style material-icons-2">\n                        expand_circle_down\n                    </span>\n                </div>\n            </div>\n            <div class="KC_Items_Content collapse ').concat("show",' heightControl pt-0---" id="fields-').concat(a,'">\n            <table class="table table-hover">\n                <tbody id="fields-table-body">'),i.forEach(function(t){n+='<tr><td><input type="checkbox" id="chk_'.concat(t.fldname,'" class="chk-fields chk-relateddataflds" value="').concat(t.fldname,'" data-fldcap="').concat(t.fldcap||"",'" data-dcname="').concat(a,'"></td>\n          <td><label for="chk_').concat(t.fldname,'">').concat(t.fldcap||""," (").concat(t.fldname,")</label></td></tr>")}),n+="</tbody></table></div></div>"}),t.innerHTML=n;var i=document.querySelectorAll(".chk-relateddataflds");""!==relatedDataFields&&relatedDataFields.split(",").forEach(function(t){var e=t.split("~")[1];document.querySelector("#chk_".concat(e)).checked=!0}),i.forEach(function(t){t.addEventListener("change",function(){var t,e=this,a=this.dataset.dcname,n=(null===(t=_entityForm.entityFormJson.metadata.find(function(t){return t.fname===a}))||void 0===t?void 0:t.customdatatype)||"F";if("T"==n){var i=document.querySelectorAll(".chk-relateddataflds"),s={};s[a]=n,i.forEach(function(t){var a,n=t.dataset.dcname;s[n]||(s[n]=(null===(a=_entityForm.entityFormJson.metadata.find(function(t){return t.fname===n}))||void 0===a?void 0:a.customdatatype)||"F");"T"==s[n]&&t!=e&&(t.checked=!1)})}})})}function createDisplayFieldsLayout(){var t=document.getElementById("displayfields-selection"),e=new Set;relatedDataFields.split(",").forEach(function(t){var a=t.split("~")[0];e.add(a)});var a=Array.from(e),n=_subEntity.metaData.filter(function(t){return t.ftransid===_entityForm.entityTransId&&"F"===t.hide&&a.includes(t.dcname)}),i={};n.forEach(function(t){i[t.dcname]||(i[t.dcname]=[]),i[t.dcname].push(t)});var s="";Object.entries(i).forEach(function(t){var e=_slicedToArray(t,2),a=e[0],n=e[1],i=!0;"dc1"==a&&(i=!1);var r=_entityForm.entityFormJson.metadata.find(function(t){return t.fname==a}),c=r.caption||a;s+='\n        <div class="card KC_Items">\n            <div class="card-header collapsible cursor-pointer rotate  '.concat(i?"collapsed":"",'" data-bs-toggle="collapse" aria-expanded="true" data-bs-target="#fields-').concat(a,'">\n                <h3 class="card-title">').concat(c," (").concat(a,')</h3>\n                <div class="card-toolbar rotate-180">\n                    <span class="material-icons material-icons-style material-icons-2">\n                        expand_circle_down\n                    </span>\n                </div>\n            </div>\n            <div class="KC_Items_Content collapse ').concat(i?"":"show",' heightControl pt-0---" id="fields-').concat(a,'">\n            <table class="table table-hover">\n                <tbody id="fields-table-body">'),n.forEach(function(t){s+='<tr><td><input type="checkbox" id="chkdisp_'.concat(t.fldname,'" class="chk-fields chk-displayflds" value="').concat(t.fldname,'" data-fldcap="').concat(t.fldcap||"",'" data-dcname="').concat(a,'" data-griddc="').concat(r.customdatatype||"T",'"></td>\n          <td><label for="chkdisp_').concat(t.fldname,'">').concat(t.fldcap||""," (").concat(t.fldname,")</label></td></tr>")}),s+="</tbody></table></div></div>"}),t.innerHTML=s,""!==relatedDataDisplayFields&&relatedDataDisplayFields.split("^").forEach(function(t){t.split("|").forEach(function(t){var e=t.indexOf("=")>-1?t.split("~")[0].split("=")[1]:t.split("~")[0];document.querySelector("#chkdisp_".concat(e)).checked=!0})});var r=document.querySelector("#chkdisp_".concat(entityKeyField));r&&(r.checked=!0,r.disabled=!0)}function fieldsModelClose(){$("#fieldsModal").modal("hide")}function displayFieldsModelClose(){$("#displayFieldsModal").modal("hide")}function applyRelatedDataFields(){var t=document.querySelectorAll(".chk-relateddataflds:checked");if(0!==t.length){var e="",a=!1;t.forEach(function(t){var n=t.value,i=t.dataset.dcname;a||(a="dc1"===t.dataset.dcname),e+="".concat(i,"~").concat(n,",")}),a?(e.endsWith(",")&&(e=e.substr(0,e.length-1)),_entityForm.selectedRelatedDataFields=e,_entityForm.setSelectedRelatedFields()):showAlertDialog("error","Error: No DC1 fields are selected. Please select atleast one DC1 field.")}else showAlertDialog("error","Error: No fields are selected.")}function resetRelatedDataFields(){_entityForm.selectedRelatedDataFields="",_entityForm.setSelectedRelatedFields()}function applyDisplayFields(){var t=document.querySelectorAll(".chk-displayflds:checked");if(0!==t.length){var e="";t.forEach(function(t){var a=t.value,n=t.dataset.dcname;e+="".concat(n,"~").concat(a,",")}),e.endsWith(",")&&(e=e.substr(0,e.length-1));var a="",n="",i={};t.forEach(function(t){var e="".concat(t.dataset.dcname,"~").concat(t.dataset.griddc);i[e]||(i[e]=[]);var a=t.value;i[e].push(a)}),Object.entries(i).forEach(function(t){var e=_slicedToArray(t,2),i=e[0],s=e[1],r="T"==i.split("~")[1],c=_subEntity.metaData.find(function(t){return t.fldname===s[0]&&t.ftransid==_subEntity.entityTransId});r?(n+="".concat(c.tablename,"="),s.forEach(function(t){var e=_subEntity.metaData.find(function(e){return e.fldname===t});n+="".concat(e.fldname,"~").concat(e.normalized,"~").concat(e.srctable||"","~").concat(e.srcfield||"","~").concat(e.allowempty,"|")}),n.endsWith("|")&&(n=n.substr(0,n.length-1)),n+="^"):(a+="".concat(c.tablename,"="),s.forEach(function(t){var e=_subEntity.metaData.find(function(e){return e.fldname===t&&e.ftransid==_subEntity.entityTransId});a+="".concat(e.fldname,"~").concat(e.normalized,"~").concat(e.srctable||"","~").concat(e.srcfield||"","~").concat(e.allowempty,"|")}),a.endsWith("|")&&(a=a.substr(0,a.length-1)),a+="^")}),a.endsWith("^")&&(a=a.substr(0,a.length-1)),n.endsWith("^")&&(n=n.substr(0,n.length-1)),_entityForm.selectedDisplayFields=a,_entityForm.selectedDisplayGridFields=n,_entityForm.setSelectedDisplayFields()}else showAlertDialog("error","Error: No fields are selected.")}function resetDisplayFields(){_entityForm.selectedDisplayFields="All",_entityForm.selectedDisplayGridFields="",_entityForm.setSelectedDisplayFields()}function getARMLogs(){var t=document.getElementById("logs-table-container");t.innerHTML="Loading logs...",$("#logsModal").modal("show");_subEntity.callAPI("../aspx/Entity.aspx/GetARMLogsWS",{},!0,function(e){if(e.success)try{var a=JSON.parse(JSON.parse(e.response).d);t.innerHTML=createARMLogsTable(a)}catch(n){t.innerHTML="No Logs available"}})}function createARMLogsTable(t){var e=document.createElement("table");e.className="table table-striped table-bordered";var a=document.createElement("tbody");return t.forEach(function(t){var e=document.createElement("tr"),n=document.createElement("td");n.innerText=t,e.appendChild(n),a.appendChild(e)}),e.appendChild(a),e.outerHTML}function searchFields(){var t=document.getElementById("searchBar").value.toLowerCase();document.querySelectorAll('[id^="fields-dc"]').forEach(function(e){for(var a=e.getElementsByTagName("tr"),n=0;n<a.length;n++){a[n].getElementsByTagName("label")[0].innerText.toLowerCase().includes(t)?a[n].style.display="":a[n].style.display="none"}})}$(document).ready(function(){_entityForm=new EntityForm,_subEntity=new SubEntity,_entityForm.init(),_subEntity.init()});