/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var arrExpFunctions=["getstockvalue","getcostrate","getclosingstock","checkstock","domrp"],saveActRecSuccess=!1,AxActionSave=!1,iViewRefresh=!1;WrkflFlag=!1;var axFramReload=!1,isMobile=isMobileDevice(),_iscmdOpenIview=!1;function CheckExpFunctions(e){for(var t=!1,a=0;a<arrExpFunctions.length;a++)if(-1!=e.indexOf(arrExpFunctions[a].toLowerCase())){t=!0;break}return t}function EvaluateAxFunction(e,t,a){var i=AxActiveRowNo,r=AxActivePRow,o=AxActiveDc,l=AxActivePDc,n=FldOldValue,s=GetFldNamesIndx(e),d="",c="";if(-1!=s&&(d=GetExpressionType(e,s),c=Expressions[s].toString()),CheckExpFunctions(c.toLowerCase()))return isDepForceCallOnExp="true",void GetDependents(t,"");var p=GetFieldGridType(t),m=e,f=GetDcNo(m);if(-1!=s&&""!=c){var u="";if("NG"==d&&"NG"==p)"axpattachmentpath"==m?(m=m+"000F"+f,"username"==(u=c.substring(1,c.length-1))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(m,u)):"username"==(u=EvalPrepared(m=m+"000F"+f,"000",c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(m,u);else if("NG"==d&&"GR"==p){var v=GetClientRowNo(AxActiveRowNo,f);"username"==(u=EvalPrepared(m=m+v+"F"+f,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(m,u)}else if("GR"!=d&&"PG"!=d||"NG"!=p){if("GR"==d&&"GR"==p){v=GetClientRowNo(AxActiveRowNo,AxActiveDc);var g=GetDcNo(m);if(AxActiveDc!=g){I=0;I=parseInt(GetDcRowCount(g),10);for(T=1;T<=I;T++){k=GetClientRowNo(T,g);AxActiveRowNo=GetDbRowNo(k,g);G=m+k+"F"+g;"username"==(u=Evaluate(G,k,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(G,u)}}else{var w=m;if(m=m+v+"F"+AxActiveDc,isEvalGrid=!1,"username"==(u=m.indexOf("_referimages")>-1||m.indexOf("dc"+g+"_image")>-1||m.indexOf("dc"+g+"_imagepath")>-1?GetReferExpr(m,v,c):Evaluate(m,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(m,u),AxActiveDc==g&&(isSumTillGrid||isEvalGrid)){O="";if(isEvalGrid)try{var h=regVarFldExp.filter(function(e){return e.startsWith(w.toLowerCase()+"♦")});if(h.length>0){var x=h[0].split("♦")[1];-1!=x&&(O=x)}else{var b=FNames.filter(function(e){return e.toLowerCase()=="rvar_"+w.toLowerCase()});if(""!=b){var A=GetFldNamesIndx(b),C=Expressions[A].toString();regVarFldExp.push(w+"♦"+b+"♠"+C),O=b+"♠"+C}else regVarFldExp.push(w+"♦-1")}}catch(_){}var y=1;isSumTillGrid&&!isEvalGrid&&(y=parseInt(AxActiveRowNo)+1),isEvalGrid=!1,isSumTillGrid=!1;I=0;I=parseInt(GetDcRowCount(g),10);for(T=y;T<=I;T++){k=GetClientRowNo(T,g);AxActiveRowNo=GetDbRowNo(k,g);G=w+k+"F"+g;if(("username"!=(u=Evaluate(G,k,c,"expr"))||"usergroup"!=u||u!=undefined||"undefined"!=u.toString())&&(Assignfldval(G,u),""!=O))try{var D=O.split("♠"),N=D[0]+k+"F"+g;Evaluate(N,k,D[1],"expr")}catch(_){}}isEvalGrid=!1}}}else if("PG"==d&&"PG"==p){v=GetClientRowNo(AxActiveRowNo,AxActiveDc);"username"==(u=EvalPrepared(m=m+v+"F"+AxActiveDc,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(m,u)}else if("PG"==d&&"GR"==p){var F=GetFieldsDcNo(t);AxActivePRow=AxActiveRowNo,AxActiveDc=f,AxActivePDc=F;var S=GetClientRowNo(AxActivePRow,AxActivePDc),R=GetPopRows(AxActivePDc,S,AxActiveDc).split(","),P=m;for(T=0;T<R.length;T++)""!=R[0]&&(AxActiveRowNo=GetDbRowNo(R[T],AxActiveDc),"username"==(u=EvalPrepared(m=P+R[T]+"F"+f,R[T].toString(),c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(m,u))}else if("GR"==d&&"PG"==p){f!=(F=GetFieldsDcNo(t))&&(AxActiveRowNo=AxActivePRow,AxActiveDc=f);var j=GetClientRowNo(AxActiveRowNo,AxActiveDc);"username"==(u=EvalPrepared(m=m+j+"F"+AxActiveDc,j,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(m,u)}}else{var I=0;I=parseInt(GetDcRowCount(f),10);for(var T=1;T<=I;T++){var k=GetRowNoHelper(T);AxActiveRowNo=GetDbRowNo(k,f);var G=m+k+"F"+f;if(isEvalGrid=!1,"username"==(u=Evaluate(G,k,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||Assignfldval(G,u),isEvalGrid){var O="";try{var $=regVarFldExp.filter(function(e){return e.startsWith(m.toLowerCase()+"♦")});if($.length>0){var V=$[0].split("♦")[1];-1!=V&&(O=V)}else{var L=FNames.filter(function(e){return e.toLowerCase()=="rvar_"+m.toLowerCase()});if(""!=L){var E=GetFldNamesIndx(L),B=Expressions[E].toString();regVarFldExp.push(m+"♦"+L+"♠"+B),O=L+"♠"+B}else regVarFldExp.push(m+"♦-1")}}catch(_){}if(isEvalGrid=!1,""!=O)try{var W=O.split("♠"),U=W[0]+k+"F"+f;Evaluate(U,k,W[1],"expr")}catch(_){}}}}isSumTillGrid!=undefined&&(isSumTillGrid=!1),AxActiveRowNo=i,AxActivePRow=r,AxActiveDc=o,AxActivePDc=l,FldOldValue=n}}function EvaluateAxFunctionPerf(e,t,a){var i=AxActiveRowNo,r=AxActivePRow,o=AxActiveDc,l=AxActivePDc,n=FldOldValue,s=GetFldNamesIndx(e),d="",c="";if(-1!=s&&(d=GetExpressionType(e,s),c=Expressions[s].toString()),CheckExpFunctions(c.toLowerCase()))return isDepForceCallOnExp="true",void GetDependents(t,"");var p=GetFieldGridType(t),m=e,f=GetDcNo(m);if(-1!=s&&""!=c){var u="";if("NG"==d&&"NG"==p)"axpattachmentpath"==m?(m=m+"000F"+f,"username"==(u=c.substring(1,c.length-1))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(m,u)):"username"==(u=EvalPrepared(m=m+"000F"+f,"000",c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(m,u);else if("NG"==d&&"GR"==p){"username"==(u=EvalPrepared(m=m+(v=GetClientRowNo(AxActiveRowNo,f))+"F"+f,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(m,u)}else if("GR"!=d&&"PG"!=d||"NG"!=p){if("GR"==d&&"GR"==p){var v=GetClientRowNo(AxActiveRowNo,AxActiveDc),g=GetDcNo(m);if(AxActiveDc!=g){D=0;D=parseInt(GetDcRowCount(g),10);for(N=1;N<=D;N++){S=GetClientRowNo(N,g);AxActiveRowNo=GetDbRowNo(S,g);F=m+S+"F"+g;"username"==(u=Evaluate(F,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(F,u)}}else{var w=m;if("username"==(u=(m=m+v+"F"+AxActiveDc).indexOf("_referimages")>-1||m.indexOf("dc"+g+"_image")>-1||m.indexOf("dc"+g+"_imagepath")>-1?GetReferExpr(m,v,c):Evaluate(m,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(m,u),AxActiveDc==g&&isSumTillGrid){isSumTillGrid=!1;var h=parseInt(AxActiveRowNo)+1;D=0;D=parseInt(GetDcRowCount(g),10);for(N=h;N<=D;N++){S=GetClientRowNo(N,g);AxActiveRowNo=GetDbRowNo(S,g);F=w+S+"F"+g;"username"==(u=Evaluate(F,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(F,u)}}}}else if("PG"==d&&"PG"==p){"username"==(u=EvalPrepared(m=m+(v=GetClientRowNo(AxActiveRowNo,AxActiveDc))+"F"+AxActiveDc,v,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(m,u)}else if("PG"==d&&"GR"==p){var x=GetFieldsDcNo(t);AxActivePRow=AxActiveRowNo,AxActiveDc=f,AxActivePDc=x;var b=GetClientRowNo(AxActivePRow,AxActivePDc),A=GetPopRows(AxActivePDc,b,AxActiveDc).split(","),C=m;for(N=0;N<A.length;N++)""!=A[0]&&(AxActiveRowNo=GetDbRowNo(A[N],AxActiveDc),"username"==(u=EvalPrepared(m=C+A[N]+"F"+f,A[N].toString(),c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(m,u))}else if("GR"==d&&"PG"==p){f!=(x=GetFieldsDcNo(t))&&(AxActiveRowNo=AxActivePRow,AxActiveDc=f);var y=GetClientRowNo(AxActiveRowNo,AxActiveDc);"username"==(u=EvalPrepared(m=m+y+"F"+AxActiveDc,y,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(m,u)}}else{var D=0;D=parseInt(GetDcRowCount(f),10);for(var N=1;N<=D;N++){var F,S=GetRowNoHelper(N);AxActiveRowNo=GetDbRowNo(S,f),"username"==(u=EvalPrepared(F=m+S+"F"+f,S,c,"expr"))&&"usergroup"==u&&u==undefined&&"undefined"==u.toString()||AssignfldvalPerf(F,u)}}isSumTillGrid!=undefined&&(isSumTillGrid=!1),AxActiveRowNo=i,AxActivePRow=r,AxActiveDc=o,AxActivePDc=l,FldOldValue=n}}function GetFldNamesIndx(e){for(var t=-1,a=0;a<ExpFldNames.length;a++){if(ExpFldNames[a].split(".")[1]==e){t=a;break}}return t}function GetExpressionType(e,t){var a=ExpFldNames[t].split(".")[2].substring(1);return IsDcPopGrid(a)?"PG":IsDcGrid(a)?"GR":"NG"}function GetFieldGridType(e){var t=GetFieldsDcNo(e);return IsDcPopGrid(t)?"PG":IsDcGrid(t)?"GR":"NG"}function Assignfldval(e,t){if("MessageSetAxFont"!=t){var a="",i=$j("#"+e);if(i.length>0){if("***"==i[0].value)return;$j("#"+("img~"+e)).length>0&&(isFocusFrmPickList=!0);var r=GetFieldsName(e),o=GetFieldsRowNo(e),l=GetFieldsDcNo(e),n=GetDbRowNo(o,l);TstructHasPop&&IsParentField(r,l)&&UpdatePopUpParents(e);for(var s=0,d=0;d<FNames.length;d++)if(FNames[d]==r){s="True"==FCustDecimal[d]&&"undefined"!=typeof gloAxDecimal&&gloAxDecimal>-1?gloAxDecimal:FDecimal[d],a=FDataType[d];break}if("numeric"==a.toLowerCase())t=fixit(t,s),UpdateFieldArray(e,n,t,"parent",""),t=CommaFormatted(fixit(t,s)),CallSetFieldValue(e,t);else if("text"==i[0].type||"hidden"==i[0].type)if("''"==t&&(t=""),t||(t=""),"Date/Time"==a){var c=t;if(0==t)t="",c="";else if(""!=c){(p=callParentNew("glCulture"))!=undefined&&"en-us"==p&&(c=GetDateStr(c,"mm/dd/yyyy","dd/mm/yyyy"))}UpdateFieldArray(e,n,c,"parent",""),CallSetFieldValue(e,t)}else if(""!=t){c=t;try{var p,m=t.split("/");if(2==m[0].length&&"undefined"!=typeof m[1]&&2==m[1].length&&"undefined"!=typeof m[2]&&4==m[2].length)(p=callParentNew("glCulture"))!=undefined&&"en-us"==p&&(c=GetDateStr(c,"mm/dd/yyyy","dd/mm/yyyy"))}catch(u){}UpdateFieldArray(e,n,c,"parent",""),CallSetFieldValue(e,t)}else UpdateFieldArray(e,n,t,"parent",""),CallSetFieldValue(e,t);else"character"==a.toLowerCase()&&(t=t.toString()),UpdateFieldArray(e,n,t,"parent",""),CallSetFieldValue(e,t);if(-1!=r.indexOf("axpvalid")&&DoFormControlPrivilege(e,t),-1!=e.indexOf("axpcurrencydec")&&UpdateAxpCurrDec(t,"GetDep"),""!=l&&IsDcGrid(l)){var f=!1;gridDummyRowVal.map(function(e){e.split("~")[0]==l&&(f=!0)}),f&&UpdateAxpRowVldInArray(l,o,n)}}}}function AssignfldvalPerf(e,t){if("MessageSetAxFont"!=t){var a="",i=GetFieldsName(e),r=GetFieldsRowNo(e),o=GetFieldsDcNo(e),l=GetDbRowNo(r,o);TstructHasPop&&IsParentField(i,o)&&UpdatePopUpParents(e);for(var n=0,s=0;s<FNames.length;s++)if(FNames[s]==i){n="True"==FCustDecimal[s]&&"undefined"!=typeof gloAxDecimal&&gloAxDecimal>-1?gloAxDecimal:FDecimal[s],a=FDataType[s];break}if("numeric"==a.toLowerCase()?(t=fixit(t,n),UpdateFieldArray(e,l,t,"parent",""),t=CommaFormatted(fixit(t,n)),CallSetFieldValue(e,t)):"Date/Time"==a?(0==t&&(t=""),UpdateFieldArray(e,l,t,"parent",""),CallSetFieldValue(e,t)):("character"==a.toLowerCase()&&(t=t.toString()),UpdateFieldArray(e,l,t,"parent",""),CallSetFieldValue(e,t)),-1!=i.indexOf("axpvalid")&&DoFormControlPrivilege(e,t),-1!=e.indexOf("axpcurrencydec")&&UpdateAxpCurrDec(t,"GetDep"),""!=o&&IsDcGrid(o)){var d=!1;gridDummyRowVal.map(function(e){e.split("~")[0]==o&&(d=!0)}),d&&UpdateAxpRowVldInArray(o,r,l)}}}function CallFileUploadAction(actionName,Title,ftype,confirmmsg){if(confirmmsg&&""!=confirmmsg){var glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var CallFileUploadActionCB=$.confirm({theme:"modern",title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:"false",rtl:isRTL,escapeKey:"buttonB",content:confirmmsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"btn btn-primary",action:function(){CallFileUploadActionCB.close(),CallFileUploadActionAfterConfirm()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}})}function CallFileUploadActionAfterConfirm(){Title="File Upload",gActionname=actionName,gConfirmmsg=confirmmsg,BootstrapDialogFileUpload()}CallFileUploadActionCB===undefined&&CallFileUploadActionAfterConfirm()}function CallAfterFileUploadAction(){var e=$j("#cb_sactbu").val();CallAction(gActionname,e,gConfirmmsg)}function GetCancelRemarks(e,t,a,i,r){ShowPrompt(e,t,a,!0,i,r)}function ShowPrompt(actionName,fileup,manRemarks,isRemarksEntered,dsignaction,isScript){var msgStatus=!0,i=0;try{var AxHeader=AxBeforeShowPrompt()}catch(ex){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"})}var cutMsg=eval(callParent("lcm[38]")),cutMsgEnter=eval(callParent("lcm[39]")),cutMsgChar=eval(callParent("lcm[40]")),titleHead=void 0===AxHeader?cutMsgEnter:AxHeader,CancelTransaction=$.confirm({theme:"modern",title:titleHead,animation:"scale",closeAnimation:"scale",animateFromElement:!1,columnClass:"medium",escapeKey:"cancel",content:'<form action="" class="formName"><div class="form-group"><label></label><textarea type="text" placeholder="'+titleHead+'" class="remarksCancel form-control" required ></textarea></div></form>',buttons:{formSubmit:{text:eval(callParent("lcm[392]")),btnClass:"btn btn-primary",action:function(){var e=this.$content.find(".remarksCancel").val();if(!e)return $.alert(titleHead+" is mandatory."),!1;CallActionExt(actionName,fileup,e,dsignaction,isScript)}},cancel:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),EnableToolBarBtns(),disableBackDrop("destroy")}}},onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .btn-primary").focus();var e=this;this.$content.find("form").on("submit",function(t){t.preventDefault(),e.$$formSubmit.trigger("click")})}});ShowDimmer(!1)}function EnableToolBarBtns(){$j("#icons").length>0&&$j("#icons").prop("disabled")&&$j("#icons").prop("disabled",!1)}function CheckDisabledActionBtn(e){var t=!1;return $j(".action").each(function(){var a=$j(this).html().toLowerCase(),i=a.substring(a.indexOf("callaction")+11).indexOf("&quot;"+e+"&quot;");if(-1==i&&(i=a.substring(a.indexOf("callaction")+11).indexOf('"'+e+'"')),-1!=i&&"disabled"==$j(this).attr("disabled"))return t=!0,!1}),t}function CallAction(e,t,a,i,r,o,l){if(actionCallFlag==actionCallbackFlag){actionCallFlag=Math.random(),$("#icons,#btnSaveTst,.BottomToolbarBar a").css({"pointer-events":"auto"});try{clickedButtonCaption=$(this.event.currentTarget).find("span").length>1?$($(this.event.currentTarget).find("span")[1]).text():this.event.currentTarget.text}catch(f){}if($j("#hdnActionName").val(e),o==undefined&&(o=""),AxActiveAction=e,CheckDisabledActionBtn(e)||AxIsTstructLocked)return actionCallbackFlag=actionCallFlag,void $("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"});ShowDimmer(!0),""!=currentCK&&ShowdivContentCK($("#"+currentCK),!1);var n=!0;try{n=AxBeforeCallAction(e)}catch(f){}if(n==undefined&&(n=!0),n){if("undefined"!=typeof AxRulesBtnConMsg&&"true"==AxRulesBtnConMsg&&!AxRulesBtnConMsgParser(event.currentTarget))return ShowDimmer(!1),AxWaitCursor(!1),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),GetProcessTime(),void GetTotalElapsTime();try{var s=$j.inArray(e,tstActionName);if("undefined"!=typeof actSaveTask&&"save"==actSaveTask[s]){if("undefined"!=typeof tstructCachedsave&&"T"==tstructCachedsave&&(""==recordid||"0"==recordid))return void 0!==callParentNew("signalRNotifications")&&"true"==callParentNew("signalRNotifications")?void SaveTransactionJSON():void showAlertDialog("error","ARM is not setup for cached save.");if("true"==AxRulesDefComputescript&&AxRulesDefParser("compute script onsave","","computescript"),"true"==AxRulesDefValidation&&!AxRulesDefParser("validate onsave","","validate"))return ShowDimmer(!1),AxWaitCursor(!1),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),GetProcessTime(),void GetTotalElapsTime();if("true"==AxRulesDefAllowdup&&AxRulesDefParser("allowduplicate","","allowduplicate"),!ValidateBeforeSubmit())return ShowDimmer(!1),AxWaitCursor(!1),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),GetProcessTime(),void GetTotalElapsTime();if("undefined"!=typeof AxpForceValidation&&""!=AxpForceValidation&&!ForceFieldValidation())return ShowDimmer(!1),AxWaitCursor(!1),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),GetProcessTime(),void GetTotalElapsTime()}if(s>-1&&"undefined"!=typeof actScriptTask&&actScriptTask[s].startsWith("doformdesign♠")){var d=JSON.parse(EvaluateDirectScript(actScriptTask[s].split("♠")[1]).replace(/(^"|"$)/g,""));try{callAxpertConfigStudio("designform",d[0],d[1]||"")}catch(f){}return EnableToolBarBtns(),actionCallbackFlag=actionCallFlag,ShowDimmer(!1),AxWaitCursor(!1),void $("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"})}if(s>-1&&"undefined"!=typeof actScriptTask&&(actScriptTask[s].startsWith("loadform♠")||actScriptTask[s].startsWith("loadformanddata♠")||actScriptTask[s].startsWith("loadiview♠")||actScriptTask[s].startsWith("loadpage♠")||actScriptTask[s].startsWith("openpage♠"))){var c=actScriptTask[s];return c=c.split("♠")[1],EvaluateScriptFormControl(c),EnableToolBarBtns(),actionCallbackFlag=actionCallFlag,ShowDimmer(!1),AxWaitCursor(!1),void $("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"})}var p=$j.inArray(e,SFCActionName);if(p>-1&&"undefined"!=typeof SFormControls&&"undefined"!=typeof SFormControls[p]&&(SFormControls[p].toLowerCase().startsWith("loadform(")||SFormControls[p].toLowerCase().startsWith("loadformanddata(")||SFormControls[p].toLowerCase().startsWith("loadiview(")||SFormControls[p].toLowerCase().startsWith("loadpage(")||SFormControls[p].toLowerCase().startsWith("openpage(")))return EvaluateScriptFormControl(SFormControls[p]),EnableToolBarBtns(),actionCallbackFlag=actionCallFlag,ShowDimmer(!1),AxWaitCursor(!1),void $("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"});if(s>-1&&"undefined"!=typeof actScriptCancel&&actScriptCancel[s].startsWith("canceltransaction♠")){if("true"==AxRulesDefComputescript&&AxRulesDefParser("compute script oncancel","","computescript"),"true"==AxRulesDefValidation&&!AxRulesDefParser("validate oncancel","","validate"))return ShowDimmer(!1),AxWaitCursor(!1),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),GetProcessTime(),void GetTotalElapsTime();var m=EvaluateDirectScript(actScriptCancel[s].split("♠")[1]);""==m||"y"!=m.toLowerCase()&&"t"!=m.toLowerCase()||(i="y")}}catch(f){}if("y"==i){if("0"==$j("#recordid000F0").val())return showAlertDialog("warning",2009,"client"),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),void ShowDimmer(!1);if("cancelled"==tstructCancelled.toLowerCase())return showAlertDialog("error",2024,"client"),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),void ShowDimmer(!1);if(!AxAllowCancel)return actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),ShowDimmer(!1),showAlertDialog("error",2025,"client")}if($j("#icons").length>0&&$j("#icons").prop("disabled"))return actionCallbackFlag=actionCallFlag,void $("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"});if($j("#icons").length>0&&$j("#icons").prop("disabled",!0),a==undefined&&(a=""),""!=a&&!confrm&&!confirm(a))return EnableToolBarBtns(),actionCallbackFlag=actionCallFlag,ShowDimmer(!1),AxWaitCursor(!1),void $("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"});"y"==i?(GetCancelRemarks(e,t,r,o,l),ShowDimmer(!1)):CallActionExt(e,t,"",o,l)}}else $("#icons,#btnSaveTst,.BottomToolbarBar a").css({"pointer-events":"none"})}function CallActionExt(e,t,a,i,r){var o=arguments.length>5&&arguments[5]!==undefined&&arguments[5];GetCurrentTime("Tstruct load on Action button click(ws call)");var l=$j("#recordid000F0").val();ArrActionLog="CallAction-"+e+"Recordid-"+l,AxWaitCursor(!0);var n="";if(""!=t&&t!=undefined)if(":"==t.substring(0,1)){var s=t.substring(1,t.length);if(1==IsGridField(s));else n=$j("#"+(s+"000F0")).val()}else n=t.toString();var d,c=transid,p="",m=(l=$j("#recordid000F0").val(),0),f=0,u=e;if(-1!=e.indexOf("_")&&(-1!=$j.inArray(GetFieldsName(e),FNames)&&(d=e.lastIndexOf("_"),e=e.substring(d+1)),-1!=e.indexOf("F"))){f=parseInt(GetActiveRow(u),10)+1;var v=e.lastIndexOf("F");m=parseInt(e.toString().substring(v+1)),e=e.substring(0,v-3)}var g=traceSplitStr+"Action-"+e+traceSplitChar,w="";if(""!=n){var h=(w=n).lastIndexOf("\\");-1!=h&&(w=w.substring(h+1))}var x=GetOpenTabDcs(),b=UploadFiles(),A=GetDeletedRows(),C=GetChangedRows(),y="";a!=undefined&&(y="<cancelremarks>"+(a=CheckSpecialCharsInXml(a))+"</cancelremarks>");var D="";D="undefined"!=typeof headerAttachDir&&"true"==headerAttachDir.toLowerCase()?"undefined"!=typeof AxtstAttachFSDB&&"true"==AxtstAttachFSDB?b:"":b,p=p+'<root axpapp="'+proj+'" trace="'+g+'" recordid="'+l+'"  fno="'+m+'" afiles="'+D+'"  dcname="'+x+'" actrow="'+f+'" sessionid="'+sid+'"  stype="tstructs" sname="'+c+'" actname="'+e+'" __file="'+w+'" options="true" dsignstatus="'+i+'">'+y+"<varlist><row>",void 0===r&&(r=!1),void 0===o&&(o=!1);try{var N="";AxRulesFlds.length>0&&(N=AxRulesFlds.join("♥")),0!=r&&"false"!=r||(N=""),callBackFunDtls="CallActionExt♠"+e+"♠"+t+"♠"+a+"♠"+i,GetProcessTime(),ASB.WebService.CallActionWS(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,DeletedFieldValue,ArrActionLog,x,p,n,"t",A,C,tstDataId,b,r,N,o,resTstHtmlLS,SuccessCallbackAction,OnException)}catch(S){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),AxWaitCursor(!1);var F=S.name+"^♠^"+S.message;showAlertDialog("error",2030,"client",F),UpdateExceptionMessageInET("ActionWS exception : "+S.message),GetProcessTime(),GetTotalElapsTime()}}function SuccessCallbackAction(e,t){if(""!=e)if(e.split("♠*♠").length>1&&(tstDataId=e.split("♠*♠")[0],e=e.split("♠*♠")[1]),e.split("*♠*").length>1){var a=e.split("*♠*")[0],i=e.split("*♠*")[1];e=e.split("*♠*")[2],WireElapsTime(a,i)}else UpdateExceptionMessageInET("Error : "+e);if(""!=e){var r=!1;if(-1==e.indexOf('{"msg":"This proces taking time is more than expected. You will get a notification once completed"}')?(actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a:not(.btndis),.wizardNextPrevWrapper").css({"pointer-events":"auto"}),ArrActionLog=""):r=!0,CheckSessionTimeout(e))return;resTstHtmlLS="";var o=e.split("*#*")[1];void 0!==o&&""!=o&&(console.log("Clearing cache in action"),ClearRedisKeys(o)),e.indexOf("*#*")>-1&&(e=e.substring(0,e.indexOf("*#*"))),ChangedFields.length=0,ChangedFieldDbRowNo.length=0,ChangedFieldValues.length=0,DeletedDCRows.length=0,DeletedFieldValue.length=0,EnableToolBarBtns();try{if(AxProcessObjCallAction(e))return SetFormDirty(!1),AxWaitCursor(!1),void ShowDimmer(!1)}catch(l){}try{if(AxAftertstCallAction(e))return SetFormDirty(!1),AxWaitCursor(!1),void ShowDimmer(!1)}catch(l){}ParseServiceResult(e,"Action");try{AxAfterCallAction()}catch(l){}"undefined"!=typeof transid&&("pgv2a"==transid&&callBackFunDtls.indexOf("CallActionExt♠script16♠")>-1||callBackFunDtls.indexOf("CallActionExt♠script17♠")>-1||"pgv2m"==transid&&callBackFunDtls.indexOf("CallActionExt♠script16♠")>-1||callBackFunDtls.indexOf("CallActionExt♠script17♠")>-1||"pgv2c"==transid&&callBackFunDtls.indexOf("CallActionExt♠script18♠")>-1||callBackFunDtls.indexOf("CallActionExt♠script19♠")>-1)&&AxProcessObjSaveRedirectAction(e),1==AxActionSave&&parent.axMainPageReload==transid&&(parent.doPageUnload="false",parent.window.location.href="../aspx/mainnew.aspx"),SetFormDirty(!1),AxWaitCursor(!1),ShowDimmer(!1),r&&(actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper,.toolbarRightMenu a:not([title=Search],[onclick*=CallListView]),.toolbarRightMenu button").css({"pointer-events":"none"}),ArrActionLog="")}else window.document.location.href.indexOf("tstruct.aspx")>-1?DataReloadDuringActionError():($("#dvlayout").hide(),AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show())}function DataReloadDuringActionError(){var errorMsg=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";"undefined"!=typeof clickedButtonCaption&&""!=clickedButtonCaption||(clickedButtonCaption="Task");var glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var CallAvActionCB=$.confirm({theme:"modern",closeIcon:!1,title:eval(callParent("lcm[155]")),rtl:isRTL,onContentReady:function(){disableBackDrop("bind")},escapeKey:"buttonB",content:""==errorMsg?clickedButtonCaption+" not completed due to an unexpected error.":clickedButtonCaption+" not completed due to "+errorMsg,buttons:{buttonA:{text:"Retry",btnClass:"btn btn-primary",action:function(){CallAvActionCB.close(),clickedButtonCaption="",actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),ArrActionLog="",AxWaitCursor(!1),ShowDimmer(!1)}},buttonB:{text:"Abort",btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){clickedButtonCaption="",window.location.href=window.location.href}}}})}function EvaluateRapidExpressions(e){var t=e.split(","),a=0;for(a=0;a<t.length;a++)EvaluateAxFunction(GetFieldsName(t[a]),t[a])}var AxFormLoadSkipped=!1;function AssignLoadValues(resultJson,calledFrom,actnName,navigationURL){if(actnName=void 0!==actnName?actnName:"","This proces taking time is more than expected. You will get a notification once completed"!=resultJson){for(var resval=resultJson.split("*$*"),ind=0;ind<resval.length;ind++)if("FDCache"!=resval[ind]){var strSingleLineText=resval[ind].toString().replace(new RegExp("\\n","g"),"");if(strSingleLineText=strSingleLineText.replace(new RegExp("\\t","g"),"&#9;"),strSingleLineText=strSingleLineText.replace(/\\/g,";bkslh"),strSingleLineText=strSingleLineText.replace(new RegExp("&lt","g"),"<"),strSingleLineText=strSingleLineText.replace(new RegExp("&gt","g"),">"),""!=strSingleLineText){try{var myJSONObject=$j.parseJSON(strSingleLineText)}catch(ex){continue}if(myJSONObject.error)ExecErrorMsg(myJSONObject.error,calledFrom);else if(myJSONObject.data&&"Iview"!=calledFrom)ExecData(myJSONObject.data,calledFrom);else if(myJSONObject.evalexpr)EvaluateRapidExpressions(myJSONObject.flds);else if(myJSONObject.fastdata)ExecData(myJSONObject.fastdata,calledFrom);else if(myJSONObject.pickdata)ExecPickData(myJSONObject.pickdata,calledFrom);else if(myJSONObject.command){if(ExecCommand(myJSONObject.command,actnName,navigationURL,calledFrom),"undefined"!=typeof isCopyTrans&&isCopyTrans)try{var _CopytrData=resval[0].toString().replace(new RegExp("\\n","g"),"");_CopytrData=_CopytrData.replace(new RegExp("\\t","g"),"&#9;"),_CopytrData=_CopytrData.replace(/\\/g,";bkslh"),TstCopyTransRes=_CopytrData,window.opener?GetCloneFormLoadData("AxIsPop=true"):GetCloneFormLoadData("")}catch(ex){}}else if(myJSONObject.formcontrol)try{ExecFormControl(myJSONObject.formcontrol,calledFrom)}catch(ex){console.log(ex.message)}else if(myJSONObject.message)("undefined"==typeof pickListRowCount||pickListRowCount>0||-1==pickListRowCount)&&(1!=iViewRefresh?ExecMessage(myJSONObject.message,calledFrom):eval(callParent("ivCmdRefresh")+"= '"+myJSONObject.message[0].msg+"'"));else if(myJSONObject.wfnode)"undefined"!=typeof tstructCancelled&&"cancelled"!=tstructCancelled.toLowerCase()&&ExecWorkflow(myJSONObject.wfnode);else if(myJSONObject.attachment&&"Iview"!=calledFrom&&"iview"!=document.title.toLowerCase())ExecAttachments(myJSONObject.attachment);else if(myJSONObject.memvar)ExecMemVars(myJSONObject.memvar,calledFrom);else if(myJSONObject.timetaken)ExecTimetaken(myJSONObject.timetaken);else if(myJSONObject.result&&"Iview"!=calledFrom&&"iview"!=document.title.toLowerCase()){if(myJSONObject.result[0].action){var erMsg="";try{for(var resvalRetry=resultJson.split("*$*"),indR=0;indR<resvalRetry.length;indR++){var strSingleLineTextRetry=resvalRetry[indR].toString().replace(new RegExp("\\n","g"),"");strSingleLineTextRetry=strSingleLineTextRetry.replace(new RegExp("\\t","g"),"&#9;"),strSingleLineTextRetry=strSingleLineTextRetry.replace(/\\/g,";bkslh");var myJSONObjectRetry="";if(""!=strSingleLineTextRetry)try{myJSONObjectRetry=$j.parseJSON(strSingleLineTextRetry)}catch(ex){}""!=myJSONObjectRetry&&myJSONObjectRetry.error&&(erMsg=myJSONObjectRetry.error[0].msg)}}catch(ex){}DataReloadDuringActionError(erMsg);break}}else if(myJSONObject.rowrefresh&&"true"==myJSONObject.rowrefresh&&myJSONObject.row&&"iview"==document.title.toLowerCase())ExecRefreshIviewRows(myJSONObject.row);else{if(resultJson.indexOf("dsignresult")>-1){if(myJSONObject.dsignresult){Execdsignresult(myJSONObject.dsignresult);break}continue}if(resultJson.indexOf("dsignmsg")>-1){if(myJSONObject.dsignmsg){ExecDsignMsg(myJSONObject.dsignmsg);break}continue}myJSONObject.axpeg?("true"==myJSONObject.axpeg[0].readonlytrans&&ReadonlyformPeg(),""!=myJSONObject.axpeg[0].status&&PEGStatusBar(myJSONObject.axpeg)):myJSONObject.axamend&&("true"==myJSONObject.axamend[0].readonlytrans&&(ReadonlyformPeg(),AxAmendmentReadOnly="true"),""!=myJSONObject.axamend[0].status&&AxAmendStatusBar(myJSONObject.axamend))}"undefined"!=typeof GridDispHead&&GridDispHead&&(grDisObj!=undefined&&displayGfirstcol(grDisObj,grDisname),grDisObj="",grDisname="")}}else AxFormLoadSkipped=!0;try{AxAfterFormLoad(calledFrom)}catch(ex){}AxWaitCursor(!1),WrkflFlag||ShowDimmer(!1),myJSONObject=null}else showAlertDialog("info",appGlobalVarsObject.lcm[491])}function AssignWsPerfExprValues(e){if("undefined"!=typeof formParamFlds&&""!=formParamFlds){var t=0;formParamFlds.forEach(function(e){""!=e&&"transid"!=e&&GetActualFieldName(e).split(",").forEach(function(e){if(""!=e)try{var a=ReplaceUrlSpecialChars(formParamVals[t]);SetFieldValue(e,a);var i=GetFieldsRowNo(e),r=GetFieldsDcNo(e),o=GetDbRowNo(i,r);UpdateFieldArray(e,o,a,"parent")}catch(l){}}),t++})}"undefined"!=typeof wsPerfEvalExpClient&&""!=wsPerfEvalExpClient&&wsPerfEvalExpClient.forEach(function(e){""!=e&&GetActualFieldName(e).split(",").forEach(function(t){""!=t&&EvaluateAxFunction(e,t)})})}function AssignLoadValuesDesignMode(e,t){for(var a=e.split("*$*"),i=0;i<a.length;i++){var r=a[i].toString().replace(new RegExp("\\n","g"),"");if(""!=(r=(r=r.replace(new RegExp("\\t","g"),"&#9;")).replace(/\\/g,";bkslh"))){try{var o=$j.parseJSON(r)}catch(l){continue}if(o.formcontrol)try{ExecFormControlDesignMode(o.formcontrol,t)}catch(l){console.log(l.message)}o=null}}}function Execdsignresult(e){for(var t="",a="",i=0;i<e.length;i++)t=t+","+e[i].docname,a=a+","+e[i].docuser;dsignconfirmation(t,a)}function dsignconfirmation(documentname,users){var cutMsg=eval(callParent("lcm[41]")),cutMsgWd=eval(callParent("lcm[42]")),cutMsgOw=eval(callParent("lcm[43]")),msg="Document("+documentname+") "+cutMsg+"</br>";msg+="now pending with "+users+"  </br>",msg+="<a onclick='CallActionForDsign(\"withdraw\");'>"+cutMsgWd+"</br></br></a>",msg+="<a onclick='CallActionForDsign(\"overwrite\");'>"+cutMsgOw+"</br></a>",$j.msgBox({content:msg,type:"info"},100)}function CallActionForDsign(e){CallAction($j("#hdnActionName").val(),"","","","",e)}function ExecDsignMsg(e){showAlertDialog("info",e.msg)}function ExecTimetaken(e){ASBDbTime="",ASBTotal="";for(var t=0;t<e.length;t++)e[t].total&&(ASBTotal=e[t].total),e[t].dbtime&&(ASBDbTime=e[t].dbtime)}function ExecRefreshIviewRows(e){({apply:function(){ivirDataTableApi&&_this.getRows().length==_this.rowData.length&&_this.rows.forEach(function(e,t){var a=parseInt(e||"1");ivDatas[a-1]=_this.rowData[t],ivDatas[a-1][getPropertyAccess("rowno")]=a.toString(),refreshRow(ivirDataTableApi.row(a-1),ivDatas[a-1])})},getRows:function(){switch(_this.rows=$j("#hdnSRows").val().split("♣").filter(function(e){return e}),0==_this.rows.length&&(_this.rows=["1"]),_this.getActionEvent()){case"Current Row":case"":_this.rows=[_this.rows[0]];break;case"Each Selected Rows":_this.rows=[_this.rows[_this.rows.length-1]];break;case"All Selected Rows":default:break;case"All Rows":_this.rows=ivDatas.map(function(e){return e[getPropertyAccess("rowno")]})}return _this.rows},getActionEvent:function(){return _this.event=(eventObj="undefined"!=typeof ivActions&&ivActions[$j("#hdnAct").val().substr(4)]||"undefined"!=typeof ivScripts&&ivScripts[$j("#hdnAct").val().substr(4)])&&eventObj["@apply"]||"Current Row",_this.event},process:function(e){_this=this,_this.rowData=e,_this.apply()}}).process(e)}function CheckSpCharsInFldValue(e){for(var t=e.indexOf("^^dq");-1!=t;)t=(e=e.replace("^^dq",'"')).indexOf("^^dq");return-1!=e.indexOf(";bkslh")&&(e=e.replace(new RegExp(";bkslh","g"),"\\")),e=e.replace(new RegExp("<br>","g"),"\n")}function ExecMemVars(e,t){for(var a="",i="",r=0;r<e.length;r++){a="",i="",e[r].n&&(a=e[r].n),e[r].v&&(i=e[r].v);for(var o=-1,l=0;l<Parameters.length;l++){if(Parameters[l].split("~")[0].toString().toLowerCase()==a.toLowerCase()){o=l;break}}-1!=o?Parameters[o]=a+"~"+i:Parameters[Parameters.length]=a+"~"+i}}function ExecPickData(e,t){for(var a="",i=0,r="",o="no",l=0;l<e.length;l++)e[l].rcount?i=e[l].rcount:e[l].idupdate?o=e[l].idupdate:e[l].fname?a=e[l].fname:e[l].fvalue&&(r=e[l].fvalue);if("yes"==o&&"1"==i&&""!=a&&""!=r){var n=AxActDepFld.lastIndexOf("F"),s=AxActDepFld.substring(0,n-3),d=AxActDepFld.substring(n-3,n),c=AxActDepFld.substring(n+1);if(d=GetDbRowNo(d,c),-1!=r.indexOf("~"))r=r.split("~")[0];if(r=(r=CheckSpCharsInFldValue(r)).replace("^","¿"),isPKItemSelected=!0,s==a){UpdateFieldArray(AxActDepFld,d,r,"parent");var p=r;-1!=r.indexOf("¿")&&(p=r.substring(r.indexOf("¿")+1)),GetFieldValue(AxActDepFld)!=p&&SetFieldValue(AxActDepFld,p)}}}function ClearChecklistOnGetDep(e){var t=ClearSqlChkList(e);if(IsDcGrid(GetDcNo(GetFieldsName(e)))){var a,i="<input type='checkbox' class='multiFldChk' id='"+e+"' name='"+e+"' title='"+t+"' value='' disabled='disabled' style='display:none'> ";$j(".multiChkSpan").each(function(){if($j(this).attr("name")==e)return a=$j(this),!1});var r=$j("#chkAll_"+e);r.prop("checked")&&(r.removeAttr("checked"),r.prop("checked",!1)),r.attr("disabled","disabled"),a.append(i)}}function ExecData(dataJsonObj,calledFrom){var isExcelImp=arguments.length>2&&arguments[2]!==undefined&&arguments[2];FillGridFillRows=0,FillGridCurrentDC=0;var dcNo="0",fldName="",fldValue="",fldType="",fldDbRowNo="",masterRow=0,delRows="",tmpActiveRow="",tmpActiveDc="",isDcFormatGrid=!1,formatGridIdx=-1,dcKeyColumn="",fName="",rid=$j("#recordid000F0").val(),axActiveDc=AxActiveDc,prevFldType="",expDepArray=new Array;if("GetDep"==calledFrom&&IsDcGrid(AxActiveDc)){var dcIdx=$j.inArray(AxActiveDc,DCFrameNo);expDepArray=DCExpDeps[dcIdx].toString().split(",")}for(var comboFld="",comboVal="",comboRowNo="",depFlds="",idCol="",isPopGrid=!1,curRowNo="",dcOldHasData="",dcOldRowCount=0,isChkCleared=!1,i=0;i<dataJsonObj.length;i++){if(fldName=dataJsonObj[i].n,fldValue=dataJsonObj[i].v,fldType=dataJsonObj[i].t,fldDbRowNo=dataJsonObj[i].r,masterRow=dataJsonObj[i].mr,fldValue=CheckSpCharsInFldValue(fldValue),dataJsonObj[i].idcol&&(idCol=dataJsonObj[i].idcol),delRows=dataJsonObj[i].cr?dataJsonObj[i].cr:"","dc"==fldType){var dcHasRows="";dcHasRows=dataJsonObj[i].hasdatarows,dcNo=fldName.substring(2);var dcCaption="";dcCaption=dataJsonObj[i].c;var fgName="";if(fgName=dataJsonObj[i].fg?dataJsonObj[i].fg:"",""!=dcCaption&&SetDcCaption(dcNo,dcCaption),formatGridIdx=GetFormatGridIndex(dcNo),-1!=formatGridIdx?(isDcFormatGrid=!0,dcKeyColumn=DcKeyColumns[formatGridIdx]):(isDcFormatGrid=!1,dcKeyColumn=""),isPopGrid=!!IsDcPopGrid(dcNo),"GetDep"==calledFrom&&isPopGrid&&IsParentDc(axActiveDc)&&(DeletePopRowsAfterGetDep(),AxSubWsRows=new Array,AxSubDsRows=new Array),IsDcGrid(dcNo)){var dcIdx=$j.inArray(dcNo,DCFrameNo);dcOldHasData=DCHasDataRows[dcIdx],""!=dcHasRows&&("yes"==dcHasRows?(DCHasDataRows[dcIdx]="True","False"==dcOldHasData&&("GetDep"==calledFrom&&""==delRows||(delRows="d*,"+delRows))):"no"==dcHasRows&&(DCHasDataRows[dcIdx]="False"))}if(IsDcGrid(dcNo)&&IsDcVisible(dcNo)){if("LoadData"==calledFrom){if("0"!=recordid&&isDcFormatGrid)continue;UpdateDcRowArrays(dcNo,"001","Add")}var ind=0;if(ind=""==fgName?$j.inArray("dc"+dcNo,FillParamDCs):$j.inArray(fgName,FillGridName),-1!=ind&&""!=delRows){var fillCond=FillCondition[ind];if("INIT"==fillCond||"AOWE"==fillCond)-1==delRows.indexOf("d*")&&(delRows="d*,"+delRows),0==$("#gridHd"+dcNo+" tbody tr").length&&"GetDep"==calledFrom&&"no"==dcHasRows&&(delRows="d*");else if("APPEND"==fillCond){var existingRec=$("#gridHd"+dcNo+" tbody tr").length;existingRec>0?$("#gridHd"+dcNo).data("fg-append-rec",existingRec):0==existingRec&&"Action"==calledFrom&&-1==delRows.indexOf("d*")?(delRows="d*,"+delRows,$("#gridHd"+dcNo).removeData("fg-append-rec")):$("#gridHd"+dcNo).removeData("fg-append-rec")}}if(tmpActiveRow=AxActiveRowNo,tmpActiveDc=AxActiveDc,AxDepRows=new Array,"GetDep"==calledFrom&&isPopGrid&&IsParentDc(axActiveDc)){dcOldRowCount=GetDcRowCount(dcNo);continue}"CallAdd"!=calledFrom&&(SetRows(dcNo,fldValue,delRows,calledFrom,dcOldHasData,dcHasRows),"LoadData"==calledFrom&&fillgridColOptVisibility(dcNo)),AxActiveRowNo=tmpActiveRow,AxActiveDc=tmpActiveDc}"yes"==dcHasRows&&SetHdnRowCount(dcNo,calledFrom)}else{if(0==rid&&fldName!=undefined&&fldName==AxAutoGenFld){var hdnAutogenerateFld=$j("#hdnShowAutoGenFldValue").val();"true"==hdnAutogenerateFld.toLowerCase()||(fldValue="Auto")}if("GetDep"==calledFrom&&"cl"==prevFldType&&"dv"!=fldType&&""!=comboFld&&(ClearChecklistOnGetDep(comboFld),comboFld="",comboVal=""),"dv"==fldType)fldName=comboFld;else{if("axpcurrencydec"==fldName.toLowerCase()&&UpdateAxpCurrDec(fldValue,calledFrom),"PopGridCombos"==calledFrom&&""!=AxPopRowNo&&(fldDbRowNo=AxPopRowNo),"GetDep"==calledFrom&&IsDcPopGrid(dcNo)&&IsParentDc(axActiveDc)){var wsRowNo=fldDbRowNo,sIdx=-1;"True"!=dcOldHasData&&"1"==wsRowNo||(sIdx=$j.inArray(wsRowNo,AxSubWsRows),fldDbRowNo=GetSubDsRowNo(fldDbRowNo,dcNo)),-1==sIdx&&(AxActiveDc=dcNo,AddRowAfterGetDep(fldDbRowNo,dcNo,dcOldHasData),curRowNo=fldDbRowNo)}if("0"==dcNo&&(dcNo=GetDcNo(fldName)),fillParamId=$j.inArray("dc"+dcNo,FillParamDCs),"-1"!=fillParamId&&(fillCond=FillCondition[fillParamId],"APPEND"==fillCond)){var recCount=$("#gridHd"+dcNo).data("fg-append-rec");recCount!=undefined&&"LoadData"!=calledFrom&&"Action"!=calledFrom&&"GetDep"!=calledFrom&&(fldDbRowNo=parseInt(fldDbRowNo)+recCount)}fldName=ConstructFieldName(fldName,dcNo,fldDbRowNo),comboFld=""}if(""==fldName)continue;var fld=$j("#"+fldName),fName=GetFieldsName(fldName);if(("undefined"!=typeof AutosaveDraft&&"true"==AutosaveDraft&&"false"==checkIsdraft||"undefined"!=typeof AutosaveDraft&&(""==AutosaveDraft||"false"==AutosaveDraft)&&"false"==checkIsdraft)&&((-1!=fName.indexOf("axp_gridattach_")||fName.toLowerCase()=="dc"+dcNo+"_image"||fName.startsWith("axp_nga_")||fName.toLowerCase().startsWith("axpfile_"))&&(fName.startsWith("axp_nga_")||fName.toLowerCase().startsWith("axpfile_")||SetGridAttValue(fldName,fldValue),fldName.toLowerCase().startsWith("axpfile_")?ConstructAxpAttachHTML(fldValue,fldName):ConstructAttachHTML(fldValue,fldName),showAttachmentPopover()),-1!=fldName.toLowerCase().indexOf("dc"+dcNo+"_referimages")&&SetGridRefValue(fldName,fldValue)),"LoadData"==calledFrom&&isDcFormatGrid){var fIndx=fldName.lastIndexOf("F"),fRNo=GetFieldsRowNo(fldName);if(dcKeyColumn==fName){if("0"==recordid){var oldKeyVal=$j("#"+fldName).val();CallSetFieldValue(fldName,oldKeyVal);continue}continue}}if(fld.length>0){var fArrayIdx=-1;if(fArrayIdx=$j.inArray(GetFieldsName(fldName),FNames),"m"==fldType)CallSetFieldValue(fldName,fldValue);else if("cl"==fldType||"rg"==fldType)comboFld=fldName,comboVal=fldValue,isChkCleared=!1,CallSetFieldValue(fldName,fldValue),"GetDep"==calledFrom&&i+1==dataJsonObj.length&&"cl"==prevFldType&&"dv"!=fldType&&""!=comboFld?(ClearChecklistOnGetDep(comboFld),comboFld="",comboVal=""):"GetDep"==calledFrom&&$("#"+comboFld).removeData("valuelist");else if("i"==fldType)if(""!=fldValue)if(-1!=fldValue.indexOf("//"))$j("#"+fldName).attr("src",fldValue);else{var fileName=fldValue.split("\\\\"),hdnScriptsUrlPath=$j("#hdnScriptsUrlpath"),fldValuePath="";fldValuePath=fileName.length>1?hdnScriptsUrlPath[0]!=undefined?hdnScriptsUrlPath.val()+"axpert/"+sid+"/"+fileName[fileName.length-2]+"/"+fileName[fileName.length-1]:"../scripts/axpert/"+sid+"/"+fileName[fileName.length-2]+"/"+fileName[fileName.length-1]:hdnScriptsUrlPath[0]!=undefined?hdnScriptsUrlPath.val()+"axpert/"+sid+"/"+fileName[fileName.length-1]:"../scripts/axpert/"+sid+"/"+fileName[fileName.length-1],GetDateTime(),$j("#"+fldName).attr("src",fldValuePath+"?"+imageSuffix),$j("#"+fldName).parents(".image-input").find(".imageFileUpload").addClass("d-none"),$j("#"+fldName).parents(".image-input").find(".profile-pic").removeClass("d-none")}else $j("#"+fldName).hasClass("signaturePad")?$j("#"+fldName).attr("src","../AxpImages/signature.png"):$j("#"+fldName).parents(".image-input").find(".imageFileUpload").addClass("d-none"),$j("#"+fldName).parents(".image-input").find(".profile-pic").removeClass("d-none"),$j("#"+fldName).parents(".image-input").length>0&&($j("#"+fldName).parents(".image-input").find(".imageFileUpload").removeClass("d-none"),$j("#"+fldName).parents(".image-input").find(".profile-pic").addClass("d-none"));else if("b"==fldType){if(-1!=fldName.indexOf("axpbutton")){var fIndx=fldName.lastIndexOf("F"),uIndx=fldName.lastIndexOf("_");fld.val(fldName.substring(uIndx+1,fIndx-3))}}else if("c"==fldType)if("hidden"==fld.attr("type"))CallSetFieldValue(fldName,fldValue),comboFld="";else if("checkbox"==fld.attr("type"))comboFld="","yes"==fldValue.toLowerCase()?(fld.prop("checked",!0),fld.attr("checked",!0)):(fld.prop("checked",!1),fld.attr("checked",!1));else{comboFld=fldName,comboVal=fldValue;var fIndx=fldName.lastIndexOf("F"),fName=GetFieldsName(fldName),fldApiInd=GetFieldIndex(fName),fldIsAutoComp=!1;$j("#"+fldName).hasClass("fldFromSelect")&&(fldIsAutoComp=!0);var fldIsMultiSelect=!1;if($j("#"+fldName).hasClass("fldmultiSelect")&&(fldIsMultiSelect=!0),fldIsAutoComp||fldIsMultiSelect||ClearComboBox(fld,fName,fldValue),dataJsonObj[i].dpm){var depFldsStr=dataJsonObj[i].dpm;depFlds=depFldsStr.split(",")}masterRow!=undefined&&0!=masterRow?("1"!=fldDbRowNo&&"PopGridCombos"!=calledFrom&&(fldIsAutoComp||fldIsMultiSelect||CopyFromMasterRow(fldName,dcNo,masterRow,calledFrom,isPopGrid)),MasterRow.push(fName),CallSetFieldValue(fldName,fldValue)):fldIsAutoComp||fldIsMultiSelect?CallSetFieldValue(fldName,fldValue):void 0===masterRow&&!fldIsAutoComp&&!fldIsMultiSelect&&fldApiInd>-1&&"true"==FldIsAPI[fldApiInd]&&CallSetFieldValue(fldName,fldValue),UpdateAssignedFld(comboFld),comboFld=""}else if("dv"==fldType&&""!=comboFld){var comboField=$j("#"+comboFld);if(comboField!=undefined)if("select-one"==comboField.prop("type")){var comboItems=fldValue.split("~"),depValue=fldValue,fldIdVal="";"yes"==idCol?(fldIdVal=comboItems[0],fldValue=comboItems[1]):fldValue=comboItems[0];var optHtml="",htmlFldVal=fldValue.replace(/ /g,"&nbsp;"),tmpVal=fldValue.replace(/ /g,String.fromCharCode(160)),comboFldnm=GetFieldsName(comboFld);if(fldValue==comboVal||comboVal==tmpVal?(optHtml="<option selected value='"+fldIdVal+"'>"+fldValue+"</option>",comboField.append(optHtml),CallSetFieldValue(comboFld,fldValue,!1,calledFrom),"001"==GetFieldsRowNo(comboFld)&&"LoadData"==calledFrom&&"0"!=rid&&$j.inArray(comboFldnm,MasterRow)>-1&&SetEditRowComboValues(comboFld,optHtml.replace("selected",""),dcNo,comboFldnm)):(optHtml="<option value='"+fldIdVal.replace(/"/g,"&quot;")+"'>"+fldValue+"</option>",comboField.append(optHtml),"001"==GetFieldsRowNo(comboFld)&&"LoadData"==calledFrom&&"0"!=rid&&$j.inArray(comboFldnm,MasterRow)>-1&&SetEditRowComboValues(comboFld,optHtml,dcNo,comboFldnm)),null!=dataJsonObj[i].dp)for(var dependentValues=dataJsonObj[i].dp.toString().split("¿"),tmpCmoboFld=GetFieldsName(comboFld),cnt=0;cnt<dependentValues.length;cnt++)for(var strDepVals=dependentValues[cnt].split("~"),depInd=0;depInd<strDepVals.length;depInd++)ComboParentField.push(tmpCmoboFld),ComboParentValue.push(fldValue),ComboDepField.push(depFlds[depInd]),ComboDepValue.push(strDepVals[depInd])}else if(!("checkbox"!=comboField.attr("type")&&"checkbox"!=comboField.data("type")&&"radio"!=comboField.attr("type")||"undefined"!=typeof IsObjCustomHtml&&"False"!=IsObjCustomHtml)){var spanClass="",align="",strChecked="",fldClass="",fldHint="",IsChkList="checkbox"==comboField.attr("type")||"checkbox"==comboField.data("type"),tmpFld;if(IsChkList){spanClass=".multiChkSpan",align="<div class='clear'></div>";var chkValSep=GetChkSeparator(GetFieldsName(comboFld)),arrChkItems=comboVal.split(chkValSep);-1!=$j.inArray(fldValue,arrChkItems)&&(strChecked="checked=checked"),0==isChkCleared&&(comboField.hasClass("multiFldChk")||(fldHint=ClearSqlChkList(comboFld),isChkCleared=!0)),fldClass="type=checkbox class='multiFldChk'"}else spanClass=".multiRgrpSpan,.multiFldRdg",align="&nbsp;&nbsp;&nbsp;&nbsp;","v"==FldAlignType[fArrayIdx].toLowerCase()&&(align="<div class='clear'></div>"),comboVal==fldValue&&(strChecked="checked=checked"),0==isChkCleared&&(fldHint=ClearRadioGrp(comboFld),isChkCleared=!0),fldClass="type=radio class='form-control p-0 form-check-input h-30px w-30px opacity-100 multiFldRdg'";var tmpID="";try{tmpFld=$j(spanClass+"[name="+comboFld+"]"),tmpID=tmpFld.attr("name")}catch(ex){}var radioDisabled="";tmpFld!=undefined&&tmpFld.hasClass("flddis")&&(fldClass+=" disabled",radioDisabled=" disabled=disabled");var chkId=tmpID;fldValue=CheckSpecialCharsInStr(fldValue),""!=fldValue&&(fldValue=fldValue.replace(/&amp;/g,"&"),fldValue=fldValue.replace("/&apos;/g","'"));var fldclText="",fldclValue="";"yes"==idCol?(fldclValue=fldValue.split("~")[0],fldclText=fldValue.split("~")[1]):(fldclValue=fldValue,fldclText=fldValue);var chkHtml="";if(chkHtml=IsChkList?"<span><input "+fldClass+" id='"+(IsChkList?chkId:fldName)+"' onchange='CallMainBlur(this)'  name='"+(IsChkList?chkId:fldName)+"' title='"+fldHint+"' value='"+fldclValue+"' "+strChecked+" ></input>"+fldclText+align+"</span>":'<div class="agform form-check form-check-custom px-1 col-md-2 align-self-end"><input '+fldClass+" id='"+(IsChkList?chkId:fldName)+"' onchange='CallMainBlur(this)'  name='"+(IsChkList?chkId:fldName)+"' title='"+fldHint+"' value='"+fldclValue+"' "+strChecked+radioDisabled+' /><label class="form-check-label form-label col-form-label pb-1 fw-boldest opacity-100" for="'+(IsChkList?chkId:fldName)+'">'+fldclValue+"</label></div>",IsDcGrid(dcNo)||"radio"==comboField.attr("type"));else{var tokenData=$("#"+tmpID).data("valuelist"),tokens=[];tokens="object"==_typeof(tokenData)?tokenData:$("#"+tmpID).data("valuelist").split($("#"+tmpID).data("separator")).map(function(e){return{value:e,label:e}}).filter(function(e){return e.value&&e.label}),tokens.push({value:fldclValue,label:fldclText}),tokens=_toConsumableArray(new Set(tokens)),$("#"+tmpID).data("valuelist",tokens);try{$("#"+tmpID).data("bs.tokenfield").$input.autocomplete({source:tokens})}catch(ex){}}if(IsChkList){var chkAllObj=$j("#chkAll_"+chkId);chkAllObj.hasClass("flddis")||chkAllObj.removeAttr("disabled");var hideAllObj=$j("#hideAll_"+chkId);if(hideAllObj.removeAttr("disabled"),chkAllObj.length>0){var itemLength=$j("input[name='"+chkId+"']").length;arrChkItems.length<itemLength?(chkAllObj.removeAttr("checked"),chkAllObj.prop("checked",!1)):""!=comboVal&&arrChkItems.length==itemLength&&(chkAllObj.attr("checked","checked"),chkAllObj.prop("checked",!0))}}else $j("div[id*='"+fName+"']").find("input[data-dummyradio=true]").remove(),"radio"==comboField.attr("type")?$j("#dv"+fName).find(".input-group").append(chkHtml):$j("#dv"+fName).append(chkHtml)}}if("dc"!=fldType&&"dv"!=fldType){try{if(fldName.toLowerCase().startsWith("axpfilepath_")){var prevafpval=GetFieldValue(fldName);""!=prevafpval&&(axpfilepathold=GetFieldValue(fldName))}}catch(ex){}if("s"==fldType||"m"==fldType||"cb"==fldType||"rg"==fldType){CallSetFieldValue(fldName,fldValue,!1,calledFrom);var dwbfieldName=GetFieldsName(fldName),dwbfldInd=GetFieldIndex(dwbfieldName),fldDType=GetDWBFieldType(fldName,dwbfldInd);if(fldName.startsWith("axptm_")||fldName.startsWith("axpdbtm_")||""!=fldDType&&"time"==fldDType.toLowerCase()){var glType=eval(callParent("gllangType")),dtpkrRTL=!1;dtpkrRTL="ar"==glType;var dvId=$("#"+fldName).parents("[id^='divDc']").attr("id");TimePickerEvent("#"+dvId,dtpkrRTL)}}("PopGridCombos"==calledFrom||"Action"==calledFrom||"GetDep"==calledFrom||void 0!==isExcelImp&&1==isExcelImp)&&UpdateFieldArray(fldName,fldDbRowNo,fldValue,"parent");var glCulture=eval(callParent("glCulture"));if(glCulture!=undefined&&"en-us"==glCulture){var fdName=GetFieldsName(fldName),fldDIndex=$j.inArray(fdName,FNames),fldDType=GetFieldType(fdName,fldDIndex);if(fldDType!=undefined&&"date/time"==fldDType.toLowerCase()){var fldDValue=DateDisplayFormat(fldValue);CallSetFieldValue(fldName,fldDValue,!1,calledFrom)}}fldName.toLowerCase().startsWith("axpfilepath_")&&AxpFilePathChange(fldName)}}var grfdName=GetFieldsName(fldName);!axInlineGridEdit&&"form"==AxpGridForm&&IsGridField(grfdName)&&formGridRowBlur($("#"+fldName))}-1!=fldName.indexOf("axpvalid")&&DoFormControlPrivilege(fldName,fldValue),"dc"!=fldType&&"dv"!=fldType&&UpdateOldValues(fldName,fldValue),prevFldType=fldType}if("LoadData"==calledFrom&&"0"==recordid&&AxAutoGenFld!=undefined&&SetAutoGenerateValue(calledFrom),"LoadData"==calledFrom&&"0"!=recordid||1==IsDraftLoad?(UpdatePopGridInfo(),GetHtmlForFormatGrids()):"LoadData"!=calledFrom&&("GetDep"==calledFrom&&(AxActiveDc=axActiveDc),AssignPopGridRows(),ArrPopNewDcs=new Array,ArrPopNewRows=new Array),"LoadData"==calledFrom&&1==isGridFileUploadOnLoad){isGridFileUploadOnLoad=!1;for(var i=0;i<DCName.length;i++){var _dvId=DCName[i],dvDcNo=_dvId.substr(2);IsDcGrid(dvDcNo)&&(DropzoneInit("#divDc"+dvDcNo),DropzoneGridInit("#divDc"+dvDcNo))}}CallEvalExpOnFormSkip()}function SetAutoGenerateValue(e){var t=GetDcNo(AxAutoGenFld),a="";a=IsDcGrid(t)?ConstructFieldName(AxAutoGenFld,t,"001"):ConstructFieldName(AxAutoGenFld,t,"000"),"false"==$j("#hdnShowAutoGenFldValue").val().toLowerCase()&&CallSetFieldValue(a,"Auto",!1,e)}function CallEvalExpOnFormSkip(){if(AxFormLoadSkipped){AxFormLoadSkipped=!1;for(var e=0;e<FNames.length;e++){var t=GetFldNamesIndx(FNames[e]),a="";if(-1!=t&&(a=Expressions[t].toString()),""!=a){var i="";i=IsGridField(FNames[e])?FNames[e]+"001F"+FldFrameNo[e]:FNames[e]+"000F"+FldFrameNo[e],EvaluateAxFunction(FNames[e],i),UpdateFieldArray(i,1,GetFieldValue(i),"parent","FormLoad"),UpdateAllFieldValues(i,GetFieldValue(i))}}}}function SetHdnRowCount(e,t){if("GetTabData"==t&&$j("#hdnRCntDc"+e).length>0){var a=parseInt($j("#hdnRCntDc"+e).val(),10)+1;$j("#hdnRCntDc"+e).val(a),UpdateDcRowArrays(e,GetRowNoHelper(a),"Add")}}function SetEditRowComboValues(e,t,a,i){var r=GetDcRowCount(a),o=GetRowNoHelper(r);$j("#"+i+o+"F"+a).append(t)}function CallMainBlur(e){var t=e.id;MainBlur($j("#"+t))}function RedrawField(e,t,a){if(""!=e&&(window.navigator.userAgent.indexOf("MSIE ")>0?($j("#"+e).css("background-color","white"),$j("#"+e).focus()):$j("#"+e).hide().show(),"LoadData"==t&&!IsDraftLoad&&$j("#"+e).length>0)){if(a)return;$j("#"+e).width($j("#"+e).width()+2)}}function GetHtmlForFormatGrids(){var e=$j("#dvFormatDc").html();$j("#dvFormatDc").html(""),AssignHTML(e,"LoadData","")}function UpdateOldValues(e,t){var a=$j.inArray(FldLoadedFields,e);-1==a?(FldLoadedFields.push(e),FldLoadedValues.push(t)):FldLoadedValues[a]=t}function UpdateNewPopInfo(e,t){var a=$j.inArray(e,ArrPopNewDcs);if(-1!=a)if(""!=ArrPopNewRows[a]){-1==ArrPopNewRows[a].indexOf(t)&&(ArrPopNewRows[a]+=","+t)}else ArrPopNewRows[a]=ArrPopNewRows[a];else ArrPopNewDcs.push(e),ArrPopNewRows.push(t)}function AssignPopGridRows(){if(TstructHasPop)for(var e=0;e<ArrPopNewDcs.length;e++){var t=$j.inArray(ArrPopNewDcs[e],PopGridDCs),a=PopGridDCs[t].toString(),i=PopParentDCs[t].toString(),r=$j.inArray(i,DCFrameNo);if("false"!=DCHasDataRows[r].toString().toLowerCase()&&(r=$j.inArray(ArrPopNewDcs[e],DCFrameNo),"false"!=DCHasDataRows[r].toString().toLowerCase()))for(var o=ArrPopNewRows[e].split(","),l=0;l<o.length;l++){var n=o[l],s=PopParentFlds[t].split(","),d="";for(ind=0;ind<s.length;ind++){var c=GetSubFieldId("sub"+a+"_"+s[ind],n,a),p=GetFieldValue(c);-1!=p.indexOf(",")&&(p=removeCommas(p)),""==d?d=p:d+="¿"+p}UpdateParentStr(i,a,d,n)}}}function ClearPopRowsArray(){for(var e=0;e<PopRows.length;e++)PopRows[e]=""}function UpdatePopGridInfo(){if(TstructHasPop){ClearPopRowsArray();for(var e=0;e<PopGridDCs.length;e++){var t=PopGridDCs[e].toString(),a=GetDcRowCount(t),i=PopParentDCs[e].toString(),r=PopParentFlds[e].split(","),o=$j.inArray(i,DCFrameNo);if("false"!=DCHasDataRows[o].toString().toLowerCase()&&(o=$j.inArray(t,DCFrameNo),"false"!=DCHasDataRows[o].toString().toLowerCase()))for(var l=1;l<=a;l++){var n=GetClientRowNo(l,t),s="";for(ind=0;ind<r.length;ind++){var d=GetSubFieldId("sub"+t+"_"+r[ind],n,t),c=GetFieldValue(d);""==s?s=c:s+="¿"+c}UpdateParentStr(i,t,s,n)}}}}function UpdateParentStr(e,t,a,i){for(var r=0;r<ParentDcNo.length;r++){var o=PopParentsStr[r].toLowerCase(),l=a.toLowerCase();if(o=ReplaceCharsInParStr(o),l=ReplaceCharsInParStr(l),ParentDcNo[r]==e&&PopGridDcNo[r]==t&&o==l){var n=PopRows[r].toString();if(""==n)n=i;else{var s=n.split(",");-1==$j.inArray(i,s)&&(n+=","+i)}PopRows[r]=n;break}}}function ReplaceCharsInParStr(e){return e=(e=e.replace(/,/g,"")).replace(/\./g,"")}function ExecAttachments(e){for(var t=0;t<e.length;t++){for(var a=e[t].att,i=(a=a.split(",")).length,r=($j("#recordid000F0").val(),0);r<i;r++)-1==fileonloadarray.indexOf(a[r].toString())&&fileonloadarray.push(a[r].toString());fileonloadarray.length>0&&$j("#attachment-overlay").removeClass("d-none")}}function ExecWorkflow(e){var t=!1,a="",i="";getComntWf(!1);for(var r=0;r<e.length;r++){if($j("#workflowoverlay").removeClass("d-none"),e[r].btn){var o=e[r].btn,l=new Array;if(""!=o){l=o.split("~"),ReadonlyWfButtons();for(var n=0;n<l.length;n++)"a"==l[n]?($j("#btntabapprove").prop("disabled",!1),$j("#btntabapprove").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<div class="Selectboxlist menu-item px-3" id="Approve"><a href="javascript:void(0);"  onclick="SlectBoxWrf(\'Approve\')" class="menu-link px-3">Approve</a></div>')):"r"==l[n]?($j("#btntabreject").prop("disabled",!1),$j("#btntabreject").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<div class="Selectboxlist menu-item px-3" id="Reject"><a href="javascript:void(0);" onclick="SlectBoxWrf(\'Reject\')" class="menu-link px-3">Reject</a></div>')):"t"==l[n]?($j("#btntabreturn").prop("disabled",!1),$j("#btntabreturn").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<div class="Selectboxlist menu-item px-3" id="Return"><a href="javascript:void(0);"  onclick="SlectBoxWrf(\'Return\')" class="menu-link px-3">Return</a></div>')):"v"==l[n]&&($j("#btntabreview").prop("disabled",!1),$j("#btntabreview").removeClass("disablewfbuttons").addClass("enablewfbuttons"),$j("#selectbox").append('<div class="Selectboxlist menu-item px-3" id="Review"><a href="javascript:void(0);" onclick="SlectBoxWrf(\'Review\')" class="menu-link px-3">Review & Forward</a></div>')),t=!0}else $("#selectbox").attr("disabled","disabled"),$(".wrkflwinline").addClass("hide"),ReadonlyWfButtons()}else if(0==t)$("#selectbox").attr("disabled","disabled"),$(".wrkflwinline").addClass("hide"),ReadonlyWfButtons();else{var s=$j("#txtCommentWF");s.length>0&&s.prop("disabled",!1)}if(e[r].status&&$j("#lblStatus").text(e[r].status),e[r].lno&&$j("#hdnWfLno").val(e[r].lno),e[r].elno){$j("#hdnWfELno").val(e[r].elno);var d=e[r].elno}if(e[r].appstatus&&(appstatus=e[r].appstatus,("Approved"==appstatus&&1==AxOnApproveDisable||"Rejected"==appstatus&&1==AxOnRejectDisable)&&Readonlyform()),e[r].readonlyform&&"true"==e[r].readonlyform&&Readonlyform(),e[r].allowcancel&&(AxAllowCancel="true"==e[r].allowcancel.toString().toLowerCase()),e[r].maxlevel&&(i=e[r].maxlevel),e[r].pdcomments&&(tstWFpdcomments=e[r].pdcomments),e[r].wkid&&(tstWorkFlowId=e[r].wkid),e[r].levels){var c,p=getWfUsrName(i,e[r].levels),m=getWfStatus(i,e[r].levels);if(0==e[r].levels.length)continue;e[r].levels[0].lno;-1==$.inArray("",p)?(a=constructWrkHtml(i,p,m,d,e[r].levels),$(a).insertAfter($(".icobtn")),$("#stratWrkf").after($(".workflowMsg").detach()),0!=$("#workflowdropdown").length?($("#workflowdropdown").append($("#selectbox").detach()),$("#selectbox").removeClass("initialized"),$(".wfselectbox").hasClass("d-none")?$(".wfselectbox").removeClass("d-none"):$(".wfselectbox").addClass("d-none")):$(".icobtn").append($(".dropbox").detach()),popoverWrkFl()):(getWfLevelUSsrs($.inArray("",p),i,p,m,d,e[r].levels),0!=$("#workflowdropdown").length&&($("#workflowdropdown").append($("#selectbox").detach()),$("#selectbox").removeClass("initialized")),$(".wfselectbox").hasClass("d-none")?$(".wfselectbox").removeClass("d-none"):$(".wfselectbox").addClass("d-none")),null===(c=KTMenu)||void 0===c||c.init()}}d>0&&($(".wrkflwPending").addClass("wrkflwPendingCls"),$(".downArr").addClass("workflowdropdownCls"),$(".icobtn").addClass("iconbtnCls")),"true"==AxIsTstructLocked&&($("#selectbox").attr("disabled","disabled"),$(".wrkflwinline").addClass("hide"))}function ExecMessage(messageJsonObj,calledFrom){for(var i=0;i<messageJsonObj.length;i++){var msgs=messageJsonObj[i].msg;if(!(void 0!==$j("#middle1",parent.document).attr("src")&&0===$j("#middle1",parent.document).attr("src").indexOf("tstruct.aspx")&&"iview"!=document.title.toLowerCase()&&IsPickListField(AxActDepFld)&&msgs.indexOf("Invalid selection")>-1&&"GetDep"==calledFrom)){if(msgs.indexOf("recordid")>-1){var msgsArray=msgs.split(",");msgs="";for(var x=0;x<msgsArray.length;x++)-1==msgsArray[x].indexOf("recordid=")&&(x==msgsArray.length-1?msgs+=msgsArray[x]:msgs+=msgsArray[x]+",")}msgs.indexOf("errfld")>-1&&(msgs=msgs.substring(0,msgs.lastIndexOf("errfld")-2)),msgs=msgs.split(",");for(var responsemsgFlds=msgs.length,msg="",mm=0;mm<responsemsgFlds;mm++){msg+=msgs[mm]+",";var stPos=msg.indexOf("["),endPos=msg.indexOf("]"),errFld=msg.substring(stPos+1,endPos);if(""!=errFld){var nerr=msg.substring(stPos,endPos+2);msg=msg.replace(nerr,""),alertType="error"}for(var index=msg.indexOf("^^dq");-1!=index;)msg=msg.replace("^^dq",'"'),index=msg.indexOf("^^dq")}if(""!=msg){if("Action"==calledFrom&&msg.indexOf("recordid")>0&&(msg=msg.substr(0,msg.indexOf("recordid"))),1==saveActRecSuccess&&(alertType="success",saveActRecSuccess=!1),"Transaction has been canceled"==msg)msg=eval(callParent("lcm[44]")),alertType="error";else if("Action"!=calledFrom&&"Iview"!=calledFrom||-1==msg.indexOf("`"))-1!=msg.toLowerCase().indexOf("invalid")||-1!=msg.indexOf("cannot be left empty")?alertType="error":-1!=msg.toLowerCase().indexOf("is completed")||-1!=msg.toLowerCase().indexOf("saved successfully")?alertType="success":alertType="info";else{var alType=msg.split("`")[0].toLowerCase();alType.indexOf(",")>-1&&(alType=alType.split(",")[1]),"simple"==alType||""==alType?alertType="info":"warning"==alType?alertType="warning":"confirmation"==alType?alertType="success":"exceptions"==alType&&(alertType="error"),msg=msg.split("`")[1].slice(0,-1)}if(-1!=msg.indexOf("cannot be left empty")){var cutMsg=eval(callParent("lcm[45]"));msg=msg.replace("cannot be left empty",cutMsg)}if(blurDisabled=!0,"GetDep"==calledFrom&&1==IsPickListField(AxActDepFld))if(""!=msg&&""==AxPickResult){if(AxActionSave?(showAlertDialog(alertType,msg,"","","function~redirectOnSaveAction()",undefined,undefined,"true"),disableBtnBeforeReload()):showAlertDialog(alertType,msg,undefined,undefined,undefined,undefined,undefined,"true"),errFrompickfld=msg,""!=AxActDepFld){var rowNo=GetClientRowNo(AxActiveRowNo,AxActiveDc),fldName=AxActDepFld+rowNo+"F"+AxActiveDc,focusFld=$j("#"+fldName);focusFld.length>0&&focusFld.focus()}}else currentPickList=AxActDepFld,SuccGetSearchResult(AxPickResult);else if(AxActionSave&&_iscmdOpenIview&&"undefined"!=typeof AxCustomTranSaveSuccess&&"true"==AxCustomTranSaveSuccess?(_iscmdOpenIview=!1,AxActionSave?"New"==AxActiveAction?showAlertDialog(alertType,msg,"","","",undefined,undefined,"true"):(showAlertDialog(alertType,msg,"","","",undefined,undefined,"true"),disableBtnBeforeReload()):showAlertDialog(alertType,msg,undefined,undefined,undefined,undefined,undefined,"true")):AxActionSave?"New"==AxActiveAction?showAlertDialog(alertType,msg,"","","",undefined,undefined,"true"):(showAlertDialog(alertType,msg,"","","function~redirectOnSaveAction()",undefined,undefined,"true"),disableBtnBeforeReload()):showAlertDialog(alertType,msg,undefined,undefined,undefined,undefined,undefined,"true"),errFrompickfld=msg,""!=AxActiveField){var rowNo=GetClientRowNo(AxActiveRowNo,AxActiveDc),fldName=AxActiveField+rowNo+"F"+AxActiveDc,focusFld=$j("#"+fldName);focusFld.length>0&&focusFld.focus()}}}}var curFrame=$(window.frameElement);"axpiframe"===curFrame.attr("id")&&0==axFramReload&&ReloadMiddleIframe(),0!=axFramReload&&(axFramReload=!1)}function ExecFormControl(e,t){for(var a=e.length,i=0;i<a;i++){if(e[i].dc){var r,o="";o=e[i].dc,r=e[i].dcact;var l=parseInt(o.substr(2,o.length));if("hide"==r){"undefined"!=typeof isWizardTstruct&&isWizardTstruct?ToggleWizardDc(l,"hide"):ShowingDc(l,"hide");var n=$.inArray(l.toString(),VisibleDCs);-1!=n&&VisibleDCs.splice(n,1)}else if("show"==r){"undefined"!=typeof isWizardTstruct&&isWizardTstruct?ToggleWizardDc(l,"show"):ShowingDc(l,"show"),-1==$.inArray(l.toString(),VisibleDCs)&&VisibleDCs.push(l.toString())}else"disable"==r?ShowingDc(l,"Disable",t):ShowingDc(l,"Enable")}if(e[i].readonlytrans)if("no"!=e[i].readonlytrans){var s=document.getElementById("breadcrumb");if(s){var d=s.innerHTML;d=d.substring(0,d.length-11),s.innerHTML=d+" - Read Only</h3></div>"}tstReadOnly=!0,Readonlyform()}if(e[i].btnname){var c,p="";p=e[i].btnname,c=e[i].btnact;GetExactFieldName(p);var m=!1;A=null,-1!=p.indexOf(".")&&p.replace(".","\\."),"remove"==p.toLowerCase()?p="delete":"list view"==p.toLowerCase()?p="listview":"new"==p.toLowerCase()&&(p="add"),$j(":button").each(function(){$j(this).attr("id")!=p&&$j(this).attr("value")!=p||(m=!0,A=$j(this))}),m||$j(".action img").each(function(){if($j(this).attr("id")==p)return A=$j(this),m=!0,!1}),m||$j(".axpBtn").each(function(){if($j(this).attr("id")==p)return A=$j(this),m=!0,!1}),m||$j(".axpBtnCustom").each(function(){if($j(this).attr("id")==p)return A=$j(this),m=!0,!1}),m||$j("#icons").find("a").each(function(){($j(this).attr("class")==p.toLowerCase()||void 0!==p&&$j(this).text()==p)&&(A=$j(this),m=!0)}),m||$j("#nextprevicons").find("a").each(function(){$j(this).attr("class")==p.toLowerCase()&&(A=$j(this),m=!0)}),m||$j("#icons").find("a").each(function(){return void 0!==$j(this).attr("title")&&$j(this).attr("class")==p.toLowerCase()||void 0!==p&&$j(this).text()==p?(m=!0,A=$j(this),!1):void 0!==$j(this).attr("title")&&$j(this).attr("title").toLowerCase()==p.toLowerCase()||void 0!==p&&$j(this).text()==p?(m=!0,A=$j(this),!1):void 0}),m||$j(".toolbarRightMenu").find("a").each(function(){if(void 0!==$j(this).attr("title")&&$j(this).attr("title").toLowerCase()==p.toLowerCase()||void 0!==p&&$j(this).text()==p)return m=!0,A=$j(this),!1}),m||$j("#nextprevicons").find("a").each(function(){if($j(this).attr("class")==p.toLowerCase())return m=!0,A=$j(this),!1}),m||$j(".tstructMainBottomFooter").find("a").each(function(){if($j(this).attr("id").toLowerCase()==p.toLowerCase())return m=!0,A=$j(this),!1}),m||$(".toolbarRightMenu .menu-item a").each(function(){if(void 0!==$j(this).attr("id")&&$j(this).attr("id").toLowerCase()==p.toLowerCase()||void 0!==$j(this).attr("title")&&$j(this).attr("title").toLowerCase()==p.toLowerCase()||void 0!==p&&$j(this).text()==p)return m=!0,A=$j(this),!1}),"disable"==c?CallProcessFormControl(p,"","2",""):"enable"==c?CallProcessFormControl(p,"","1",""):(null!=A&&A.length>0?m=!0:$j("#"+p.toLowerCase()).length>0?(m=!0,A=$j("#"+p.toLowerCase())):"Save"==p?$j("#imgSaveTst")&&(m=!0,A=$j("#imgSaveTst")):(A=p+"000F0",$j("#"+A).length>0&&(m=!0,A=$j("#"+A))),m&&A.length>0&&("hide"==c?("li"==A.parent()[0].tagName.toLowerCase()&&A.parent().css({display:"none"}),"add"==p?$j("#New").length>0&&$j("#New").css({display:"none"}):("reject"==p.toLowerCase()||"approve"==p.toLowerCase())&&$j("#icons").find("a#actbtn_"+p).length>0&&$j("#icons").find("a#actbtn_"+p).parent().css({display:"none"}),A.css({display:"none"}),A.addClass("d-none")):"show"==c?("li"==A.parent()[0].tagName.toLowerCase()&&A.parent().css({display:"inline-block"}),"add"==p&&$j("#New").length>0&&$j("#New").css({display:"inline-block"}),A.css({display:"block"}),A.removeClass("d-none")):"disable"==c?(FadeImage(A.attr("id"),1),A.attr("disabled","disabled"),A.addClass("btndis"),SetAutoCompAccess("disabled",A),A.prop("disabled",!0),A.addClass("disabled"),A.css("cursor","default"),A.attr("tabindex",-1),A.hasClass("menu-link")&&A.addClass("btn")):"enable"==c&&(A.prop("disabled",!1),SetAutoCompAccess("enabled",A),A.removeClass("btndis"),A.prop("disabled",!1),A.removeClass("disabled"),A.css("cursor",""),A.css("cursor","hand"),A.removeAttr("tabindex"),A.hasClass("menu-link")&&A.removeClass("btn")),m=!1))}if(e[i].fldname){var f,u,v="";v=e[i].fldname,f=e[i].fldact,u=e[i].setcaption;var g=GetFieldsRowFrameNo(v),w=GetFieldsName(v),h=g.substring(4);if("000F0"==g&&""!=w){var x=GetDcNo(w);v=IsDcGrid(x)?w+"001F"+x:w+"000F"+x}if(u!=undefined&&g==v){var b=GetDcNo(v);v=IsDcGrid(b)?v+"001F"+b:v+"000F"+b}var A=$j("#"+v),C=!1;if(u!=undefined||f!=undefined){if(u!=undefined)-1==$j.inArray(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+u,AxFormContSetCapFldsGrid)&&AxFormContSetCapFldsGrid.push(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+u),SetCaptionFormControl(v,u);if("setfocus"==f)-1==$j.inArray(GetDcNo(v)+"~"+v+"~"+f,AxFormContFldSetFocus)&&AxFormContFldSetFocus.push(GetDcNo(v)+"~"+v+"~"+f);else if(f!=undefined){-1==$j.inArray(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+f,AxFormContSetFldActGrid)&&IsDcGrid(h)&&AxFormContSetFldActGrid.push(GetDcNo(GetFieldsName(v))+"~"+GetFieldsName(v)+"~"+f)}}if(A.length>0){if(IsDcGrid(h)&&(C=!0),"hide"==f)if(C)$j("#th-"+w).hide(),$j("tfoot #tf-"+w).addClass("d-none"),A.hide(),A.parent().hide();else{A.css("visibility","hidden");var y=GetFieldsName(v);$j("#dv"+y).hide(),$j("#dv"+y).addClass("d-none")}else C?($j("#th-"+w).show(),$j("tfoot #tf-"+w).removeClass("d-none"),A.show(),A.parent().show()):A.css("visibility","visible");"disable"==f?ProcessFormControl(v,"2",""):ProcessFormControl(v,"1","")}else{if("hide"==f||"show"==f)-1==$j.inArray(w+"~"+f,AxFormContHiddenFlds)&&AxFormContHiddenFlds.push(w+"~"+f);else if(u!=undefined){-1==$j.inArray(v+"~"+u,AxFormContSetCapFlds)&&AxFormContSetCapFlds.push(v+"~"+u)}}}}SetFormContFldActGrid("")}function ExecFormControlDesignMode(e,t){for(var a=e.length,i=0;i<a;i++)if(e[i].fldname){var r,o="";if(o=e[i].fldname,(r=e[i].setcaption)!=undefined){var l=GetFieldsRowFrameNo(o);if("000F0"==l&&(o=o.substring(0,o.length-1)+"1"),r!=undefined&&l==o){var n=GetDcNo(o);o=IsDcGrid(n)?o+"001F"+n:o+"000F"+n}-1==$j.inArray(GetDcNo(GetFieldsName(o))+"~"+GetFieldsName(o)+"~"+r,AxFormContSetCapFldsGrid)&&AxFormContSetCapFldsGrid.push(GetDcNo(GetFieldsName(o))+"~"+GetFieldsName(o)+"~"+r),SetCaptionFormControl(o,r)}}}function ConstructParams(e,t){-1!=e.indexOf("###")&&(e=e.replace(/###/g,"¿")),-1!=t.indexOf("###")&&(t=t.replace(/###/g,"¿"));e=e.split("¿");var a=t.split("¿"),i="",r=e.length;if(0!=r)for(var o=0;o<r;o++)i=i+"&"+(e[o]+"="+CheckUrlSpecialChars(a[o])).replace(/%26/g,"--.--");return i}function CheckUrlSpecialChars(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/%/g,"%25")).replace(/#/g,"%23")).replace(/&/g,"%26")).replace(/'/g,"%27")).replace(/"/g,"%22")).replace("+","%2b")).replace(/ /g,"%20")).replace(/\\/g,"%5C")).replace(/</g,"%3C")).replace(/>/g,"%3E")}function ReplaceUrlSpecialChars(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/%25/g,"%")).replace(/%26/g,"&")).replace(/%27/g,"'")).replace(/%23/g,"#")).replace(/%22/g,'"')).replace(/%2b/g,"+")).replace(/%20/g," ")).replace(/%5C/g,"\\")).replace(/%3C/g,"<")).replace(/%3E/g,">")}function closeRemodalwindow(){try{callParentNew("loadPopUpPage","id").dispatchEvent(new CustomEvent("close"))}catch(e){}$j("#popupIframeRemodal",parent.document).attr("src")!=undefined&&$j(".remodal-close",parent.document).click()}function ExecCommand(cmdJsonObj,actnName,axpConfigNavType){var calledFrom=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";try{AxBeforeExecCommand(cmdJsonObj,actnName,axpConfigNavType,calledFrom)}catch(ex){}actnName=void 0!==actnName?actnName:"";for(var popup="",pgname="",cmdName="",cmdVal="",multipleDocs,saveAction=!1,lockedBy="",parFrm=$j("#axpiframe",parent.document),curFrame=$(window.frameElement),openIviewCmdIndex=cmdJsonObj.reduce(function(e,t,a){return"openiview"==t.cmd&&e.push(a),e},[]),saveAndPopupExist=!1,i=0;i<cmdJsonObj.length;i++){try{saveAndPopupExist="action"==cmdJsonObj[i].cmd&&"save"==cmdJsonObj[i].cmdval&&cmdJsonObj.findIndex(function(e){return"pop"==e.showin})>-1,saveAndPopupExist&&eval(callParent("isSuccessAlertInPopUp")+"= true")}catch(ex){}if(!("printfile"==cmdJsonObj[i].cmd&&""!=cmdName&&""!=cmdVal&&cmdName==cmdJsonObj[i].cmd&&cmdVal==cmdJsonObj[i].cmdval||"openiview"==cmdJsonObj[i].cmd&&openIviewCmdIndex.length>0&&openIviewCmdIndex[0]!=i||saveAndPopupExist))if(cmdName=cmdJsonObj[i].cmd,cmdVal=cmdJsonObj[i].cmdval,multipleDocs=cmdJsonObj[i].multiprintdocs,cmdJsonObj[i].lockedby&&(lockedBy=cmdJsonObj[i].lockedby),"openfile"==cmdName||"printfile"==cmdName){var docID,fldPath;UpdateExceptionMessageInET("Action printfile/openfile result. Command name:"+cmdName+" Command Val:"+cmdVal);var filepath="",compressValue="",dirName="";cmdVal=CheckUrlSpecialChars(cmdVal);var fldPrintDirective=GetFieldValue("axp_printdirective000F1");""!=fldPrintDirective&&(fldPath=fldPrintDirective.split("~"),compressValue=fldPath[0].toString(),docID=GetFieldValue(fldPath[1]+"000F1"),(docID=undefined)&&(docID=""),fldPath.length>2&&(filepath=fldPath[2].toString()));var left=screen.width/2-200,top=screen.height/2-100;if(saveAction&&(void 0===cmdVal||""==cmdVal)){setTimeout(function(){showAlertDialog("warning","Transaction saved successfully and there is an error while print. kindly load record from listview and print again.")},10);continue}if("yes"==multipleDocs){dirName=cmdJsonObj[i].directory;var na="./OpenFiles.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}var windobj=window.open(na,"_blank");windobj.focus(),windobj.close()}catch(ex){UpdateExceptionMessageInET("openfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else try{if(cmdVal.toLowerCase().indexOf("pdf")>-1){dirName="PDF",compressValue=compressValue||"";var isAttPDF="F";if(isAttPDF=cmdJsonObj[i].isatt,"true"==compressValue.toLowerCase()){var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}if(isMobile)cmdVal=ReplaceUrlSpecialChars(cmdVal),OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else{var windobj=window.open(na,"_blank");windobj.focus()}}catch(ex){UpdateExceptionMessageInET("openfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if("T"==isAttPDF){isSelfOpened=!0,cmdVal==undefined&&(cmdVal=""),compressValue==undefined&&(compressValue=""),filepath==undefined&&(filepath=""),docID==undefined&&(docID=""),dirName==undefined&&(dirName="");var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName+"&Imp=t",curWin;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}"function"==typeof fixUnloadOnWindowSelfDownloads&&fixUnloadOnWindowSelfDownloads(window),isMobile?(cmdVal=ReplaceUrlSpecialChars(cmdVal),OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction)):curWin=window.open(na,"_self")}catch(ex){UpdateExceptionMessageInET("openfile exception : "+ex.message),"function"==typeof BeforeWindowClose&&(window.onbeforeunload=BeforeWindowClose)}}else if(1==cmdJsonObj.length)if(iframeindex>-1&&null!=iframeindex){var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}if(isMobile)cmdVal=ReplaceUrlSpecialChars(cmdVal),OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else{var windobj=window.open(na,"axpiframe");windobj.focus(),callParentNew("closeFrame()","function")}}catch(ex){UpdateExceptionMessageInET("openfile exception : "+ex.message),callParentNew("closeFrame()","function"),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if("printfile"==cmdJsonObj[0].cmd)OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else if(isMobile)cmdVal=ReplaceUrlSpecialChars(cmdVal),OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else{var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(","),winobj=window.open(na,"",params);winobj.moveTo(0,0),winobj.focus()}catch(ex){UpdateExceptionMessageInET("openfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(cmdJsonObj.filter(function(e){return"printfile"===e.cmd}).length>0)OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else if(3==cmdJsonObj.length&&"action"==cmdJsonObj[0].cmd&&"openfile"==cmdJsonObj[2].cmd)OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else{var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");if(isMobile)cmdVal=ReplaceUrlSpecialChars(cmdVal),OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction);else{var winobj=window.open(na,"",params);winobj.moveTo(0,0),winobj.focus()}}catch(ex){UpdateExceptionMessageInET("openfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}}else{isSelfOpened=!0,cmdVal==undefined&&(cmdVal=""),compressValue==undefined&&(compressValue=""),filepath==undefined&&(filepath=""),docID==undefined&&(docID=""),dirName==undefined&&(dirName="");var na="./openfile.aspx?fpath="+cmdVal+"&compress="+compressValue+"&path="+filepath+"&docid="+docID+"&dirName="+dirName+"&Imp=t",curWin;try{try{var tempUrl=axSetTstructPrint({obj:cmdJsonObj[i],url:na,multipleDocs:multipleDocs,fileName:cmdVal,compressValue:compressValue,filepath:filepath,docID:docID,dirName:dirName,isAttPDF:isAttPDF})||na;if(!0===tempUrl)continue;na=tempUrl}catch(ex){}"function"==typeof fixUnloadOnWindowSelfDownloads&&fixUnloadOnWindowSelfDownloads(window),isMobile?(cmdVal=ReplaceUrlSpecialChars(cmdVal),OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction)):curWin=window.open(na,"_self")}catch(ex){UpdateExceptionMessageInET("openfile exception : "+ex.message),"function"==typeof BeforeWindowClose&&(window.onbeforeunload=BeforeWindowClose)}}}catch(ex){UpdateExceptionMessageInET("openfile/printfile outer exception : "+ex.message),1==saveAction?showAlertDialog("warning","Transaction saved successfully and there is an error while print. kindly load record from listview and print again."+ex.message):showAlertDialog("warning",ex.message);continue}}else if("recordlocked"==cmdName){AxIsTstructLocked=cmdVal;var cutMsg=eval(callParent("lcm[46]"));ShowInfoDialog(cutMsg+" - "+lockedBy),"admin"==user&&$("#dvMessage table tr").append('<a href="javascript:void(0)" id="lnkUnlockTstruct" onclick="javascript:forceUnlockTstruct();" title="Unlock" class="handCur">Unlock</a>').find("td").width("100%")}else if("done"==cmdName)showAlertDialog("success",2026,"client");else if("new"==cmdName)try{if(UpdateExceptionMessageInET("Action new result. Command name:"+cmdName+" Command Val:"+cmdVal),AxActiveAction="New",GetFldSetCarryValue(),SetCarryFlds.length>0){var querySCFld="";SetCarryFlds.forEach(function(e){var t=e.split("♠")[0];t=t.substring(0,t.lastIndexOf("F")-3);var a=e.split("♠")[1];querySCFld+="&"+t+"="+a}),querySCFld+="&act=open",AvoidPostBackAfterSave("tstruct.aspx?transid="+transid+querySCFld+"&openerIV=".concat("undefined"!=typeof isListView?iName:transid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")))}else AvoidPostBackAfterSave("tstruct.aspx?transid="+transid+"&openerIV=".concat("undefined"!=typeof isListView?iName:transid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")))}catch(ex){UpdateExceptionMessageInET("Command new exception : "+ex.message)}else if("close"==cmdName)closeRemodalwindow();else if("refreshpage"==cmdName)try{var url="./tstruct.aspx?&transid="+tst+"&openerIV=".concat("undefined"!=typeof isListView?iName:tst,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab"));window.document.location.href=url,"axpiframe"===curFrame.attr("id")&&(axFramReload=!0,ReloadMiddleIframe())}catch(ex){window.document.location.href=window.document.location.href}else if("refreshparent"==cmdName)window.opener.location.reload();else if("refresh"==cmdName){SetSession({key:"IsFromChildWindow",val:"true"}),iViewRefresh=!0;var localIviewName=findGetParameter("ivname",window.document.location.href);if(null!=localIviewName)try{var historyIviewLink=callParentNew("appLinkHistory")[callParentNew("curPageIndex")],historyIviewName=findGetParameter("ivname",historyIviewLink);window.document.location.href=null!=historyIviewName&&historyIviewName==localIviewName?historyIviewLink:window.document.location.href}catch(ex){window.document.location.href=window.document.location.href}else window.document.location.href=window.document.location.href}else if("canceled"==cmdName){if("no"!=cmdVal){var canReason=cmdJsonObj[i].reason;ShowInfoDialog(cancelMsg+" "+canReason),tstructCancelled="Cancelled",Readonlyform();var imgSave=$j("#imgSaveTst");imgSave.length>0&&(imgSave.prop("disabled",!0),imgSave.attr("disabled","disabled"),imgSave.css("cursor","default"));var btnSave=$j("#btnSaveTst");btnSave.length>0&&btnSave.attr("disabled","disabled")}}else if("opentstruct"==cmdName||"clear"==cmdName){"opentstruct"==cmdName&&1==AxActionSave&&(AxActionSave=!1);var tstid=cmdVal;"clear"==cmdName&&(tstid=transid);var popname="openPop"+tstid;popup=cmdJsonObj[i].showin;var tparams="";cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue));var designParam="";if(actnName.startsWith("axpdesign_")&&(designParam="&theMode=design"),axpConfigNavType!=undefined&&""!=axpConfigNavType||!parFrm.hasClass("frameSplited")?axpConfigNavType&&""!=axpConfigNavType&&(popup="split"==axpConfigNavType?"split":"popup"==axpConfigNavType?"pop":"newpage"==axpConfigNavType?"newpage":""):popup="split","pop"==popup){tparams+="&AxPop=true","undefined"!=typeof cmdJsonObj[i].parentrefresh&&"true"==cmdJsonObj[i].parentrefresh&&eval(callParent("isRefreshParentOnClose")+"= true");var openpopup="tstruct.aspx?act=open&transid="+tstid+tparams+designParam+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab"));createPopup(openpopup,!0)}else if("newpage"==popup)popupFullPage("tstruct.aspx?act=open&transid="+tstid+tparams+designParam+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")));else if("split"!=popup){var _thisDummyLoad=GetTstHtmlLsKey(tstid),_tstURI="tstruct.aspx?act=open&transid="+tstid+tparams+designParam+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad);_tstURI=_tstURI.replace(/♠/g,"%e2%99%a0"),callParentNew("lastLoadtstId=",_tstURI);var redirectionLink="tstruct.aspx?act=open&transid="+tstid+tparams+designParam+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad),customCalled=!1;try{customCalled=loadInMiddle1(redirectionLink)}catch(ex){}customCalled||(window.document.location.href=redirectionLink)}else"split"==popup&&callParentNew("OpenOnPropertyBase(".concat("tstruct.aspx?act=open&transid="+tstid+tparams+designParam+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")),")"),"function")}else if("loadtstruct"==cmdName){1==AxActionSave&&(AxActionSave=!1);var tstid=cmdVal,popname="loadPop"+tstid;popup=cmdJsonObj[i].showin;var tparams="";if(cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)),axpConfigNavType!=undefined&&""!=axpConfigNavType||!parFrm.hasClass("frameSplited")?axpConfigNavType&&""!=axpConfigNavType&&(popup="split"==axpConfigNavType?"split":"popup"==axpConfigNavType?"pop":"newpage"==axpConfigNavType?"newpage":""):popup="split","pop"==popup){tparams+="&AxPop=true","undefined"!=typeof cmdJsonObj[i].parentrefresh&&"true"==cmdJsonObj[i].parentrefresh&&eval(callParent("isRefreshParentOnClose")+"= true");var loadpopup="tstruct.aspx?act=load&transid="+tstid+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab"));createPopup(loadpopup,!0)}else if("newpage"==popup)popupFullPage("tstruct.aspx?act=load&transid="+tstid+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")));else if("split"!=popup){var _thisDummyLoad2=GetTstHtmlLsKey(tstid),_tstURI2="tstruct.aspx?act=load&transid="+tstid+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad2);_tstURI2=_tstURI2.replace(/♠/g,"%e2%99%a0"),callParentNew("lastLoadtstId=",_tstURI2),window.document.location.href="tstruct.aspx?act=load&transid="+tstid+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad2)}else"split"==popup&&callParentNew("OpenOnPropertyBase(".concat("tstruct.aspx?act=load&transid="+tstid+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:tstid,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")),")"),"function")}else if("openiview"==cmdName){var ivn=cmdJsonObj[i].cmdval,popname="ivewPop"+ivn;popup=cmdJsonObj[i].showin;var tparams="";if(cmdJsonObj[i].pname){try{tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)}catch(ex){}"Iview"!=document.title&&(tparams+=tparams?"&":"")}$j("#axp_ivname000F1").length>0&&(ivn=$j("#axp_ivname000F1").val()),axpConfigNavType!=undefined&&""!=axpConfigNavType||!parFrm.hasClass("frameSplited")?axpConfigNavType&&""!=axpConfigNavType&&(popup="split"==axpConfigNavType?"split":"popup"==axpConfigNavType?"pop":"newpage"==axpConfigNavType?"newpage":""):popup="split";var _parentIview="";try{_parentIview=callParentNew("iName")}catch(ex){_parentIview=""}if("pop"==popup){var pop="true";if(tparams+="&AxIsPop=true",null!=ivn&&""!=ivn||""==_parentIview)if(""!=_parentIview&&""!=ivn&&ivn==_parentIview){ivn=callParentNew("iName");var loadpopup="iview.aspx?ivname="+ivn+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")),popname;createPopup(loadpopup,!0)}else{var loadpopup="ivtoivload.aspx?ivname="+ivn+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")),popname;createPopup(loadpopup,!0)}else{ivn=callParentNew("iName");var loadpopup="iview.aspx?ivname="+ivn+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")),popname;createPopup(loadpopup,!0)}}else if("newpage"==popup)null!=ivn&&""!=ivn||(ivn=callParentNew("iName")),popupFullPage("ivtoivload.aspx?ivname="+ivn+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")));else if("split"!=popup){var loadMiddle1URL="ivtoivload.aspx?ivname="+ivn+"&"+tparams+"&AxOpenAct=true&isDupTab=".concat(callParentNew("isDuplicateTab"));try{"middle1"==window.frameElement.id&&callParentNew("middle1URL=",loadMiddle1URL)}catch(ex){}var srcUrl="ivtoivload.aspx?ivname="+ivn+"&"+tparams+"&AxOpenAct=true&isDupTab=".concat(callParentNew("isDuplicateTab")),linkParams=tparams,_callParentNew,_window,_window$frameElement,_window2,_window2$frameElement;if(linkParams=linkParams.replace(/~/g,"="),linkParams=linkParams.replace(/¿/g,"&"),linkParams=ReplaceUrlSpecialChars(linkParams),""!=linkParams)setIviewNavigationData(linkParams,ivn),null===(_callParentNew=callParentNew("updateAppLinkObj"))||void 0===_callParentNew||_callParentNew(srcUrl,1,"axpiframe"==(null===(_window=window)||void 0===_window?void 0:null===(_window$frameElement=_window.frameElement)||void 0===_window$frameElement?void 0:_window$frameElement.id),_objectSpread({},null===(_window2=window)||void 0===_window2?void 0:null===(_window2$frameElement=_window2.frameElement)||void 0===_window2$frameElement?void 0:_window2$frameElement.dataset));null!=ivn&&""!=ivn||""==_parentIview?""!=_parentIview&&""!=ivn&&ivn==_parentIview?(ivn=callParentNew("iName"),callParentNew("LoadIframe(".concat("iview.aspx?ivname="+ivn+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")),")"),"function")):window.document.location.href=srcUrl:(ivn=callParentNew("iName"),callParentNew("LoadIframe(".concat("iview.aspx?ivname="+ivn+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")),")"),"function")),"Iview"==calledFrom&&callParentNew("loadFrame()","function"),_iscmdOpenIview=!0}else"split"==popup&&callParentNew("OpenOnPropertyBase(".concat("ivtoivload.aspx?ivname="+ivn+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")),")"),"function")}else if("openpage"==cmdName){pgname=cmdVal;var tparams="";if(cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)),""!=pgname&&pgname.toLowerCase().startsWith("pagets")){pgname=pgname.substring(6);var _thisDummyLoad3=GetTstHtmlLsKey(pgname),_tstURI3="tstruct.aspx?act=open&transid="+pgname+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:pgname,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad3);_tstURI3=_tstURI3.replace(/♠/g,"%e2%99%a0"),callParentNew("lastLoadtstId=",_tstURI3),window.document.location.href="tstruct.aspx?act=open&transid="+pgname+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:pgname,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad3)}else""!=pgname&&pgname.toLowerCase().startsWith("pageiv")&&(pgname=pgname.substring(6),window.document.location.href="ivtoivload.aspx?ivname="+pgname+"&"+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:pgname,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")))}else if("openpdf"==cmdName){var pdfpath=cmdVal,len=pdfpath.length,filepos=InStrPath(pdfpath)+1;pdfpath=pdfpath.substring(filepos,len),window.location.href="../"+pdfpath}else if("pageload"==cmdName||"loadpage"==cmdName){pgname=cmdVal;var tparams="";if(cmdJsonObj[i].pname&&(tparams=ConstructParams(cmdJsonObj[i].pname,cmdJsonObj[i].pvalue)),""!=pgname&&pgname.toLowerCase().startsWith("pagets")){pgname=pgname.substring(6);var _thisDummyLoad4=GetTstHtmlLsKey(pgname),_tstURI4="tstruct.aspx?act=load&transid="+pgname+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:pgname,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad4);_tstURI4=_tstURI4.replace(/♠/g,"%e2%99%a0"),callParentNew("lastLoadtstId=",_tstURI4),window.document.location.href="tstruct.aspx?act=load&transid="+pgname+tparams+"&openerIV=".concat("undefined"!=typeof isListView?iName:pgname,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(_thisDummyLoad4)}else""!=pgname&&pgname.toLowerCase().startsWith("pageiv")&&(pgname=pgname.substring(6),window.document.location.href="ivtoivload.aspx?ivname="+pgname+"&"+tparams+"&isDupTab=".concat(callParentNew("isDuplicateTab")))}else if("action"==cmdName&&"save"==cmdVal)saveAction=!0,AxActionSave=!0;else if("recid"==cmdName){if(1==saveAction){UpdateExceptionMessageInET("Action save result. Command Val:save RecordId:"+cmdVal),$j("#recordid000F0").val(cmdVal);var recIdVal=$j("#recordid000F0").val();"0"!=recIdVal&&(saveActRecSuccess=!0,eval(callParent("isSuccessAlertInPopUp")+"= true"),"axpiframe"===curFrame.attr("id")&&(axFramReload=!0,ReloadMiddleIframe()))}}else if("newtrans"==cmdName)$j("#recordid000F0").val("0"),recordid="0";else if("filepath"==cmdName)try{var curWin;try{"function"==typeof fixUnloadOnWindowSelfDownloads&&fixUnloadOnWindowSelfDownloads(window),curWin=window.open("download.aspx","_self","width=400,height=300,scrollbars=yes,resizable=yes")}catch(ex){"function"==typeof BeforeWindowClose&&(window.onbeforeunload=BeforeWindowClose)}}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}else"copytrans"==cmdName&&"true"==cmdVal&&($j("#recordid000F0").val("0"),recordid="0",isCopyTrans=!0)}}function forceUnlockTstruct(){var e=$j("#recordid000F0").val();if("0"!=e&&AxIsTstructLocked&&callParentNew("isLockOnRead")){try{ASB.WebService.UnlockTStructRecord(tst,e,!0,function(e,t){location.reload()})}catch(t){}}}function redirectOnSaveAction(){var e=$j("#recordid000F0").val(),t="";if(void 0!==callParentNew("axpiframe","id")&&(t="&AxSplit=true"),"true"!=findGetParameter("AxPop")&&"true"!=findGetParameter("AxIsPop")||(t+="&AxPop=true"),""==e||"0"==e){GetProcessTime();var a=GetTstHtmlLsKey(tst),i="tstruct.aspx?act=load&transid="+tst+t+"&hdnbElapsTime="+callParentNew("browserElapsTime")+"&openerIV=".concat("undefined"!=typeof isListView?iName:tst,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(a);i=i.replace(/♠/g,"%e2%99%a0"),callParentNew("lastLoadtstId=",i),window.location.href="tstruct.aspx?act=load&transid="+tst+t+"&hdnbElapsTime="+callParentNew("browserElapsTime")+"&openerIV=".concat("undefined"!=typeof isListView?iName:tst,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(a)}else if("axcal"==transid)callParentNew("isSuccessAlertInPopUp=",!0),callParentNew("closeModalDialog()","function");else if(saveActRecSuccess=!0,AxIsTstructCached)SaveInCache(e,"SaveAction");else{GetProcessTime();var r=GetTstHtmlLsKey(tst),o="tstruct.aspx?act=load&transid="+tst+"&recordid="+e+t+"&hdnbElapsTime="+callParentNew("browserElapsTime")+"&openerIV=".concat("undefined"!=typeof isListView?iName:tst,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(r);o=o.replace(/♠/g,"%e2%99%a0"),callParentNew("lastLoadtstId=",o),window.location.href="tstruct.aspx?act=load&transid="+tst+"&recordid="+e+t+"&hdnbElapsTime="+callParentNew("browserElapsTime")+"&openerIV=".concat("undefined"!=typeof isListView?iName:tst,"&isIV=").concat("undefined"!=typeof isListView?!isListView:"false","&isDupTab=").concat(callParentNew("isDuplicateTab")).concat(r)}}function SetRows(e,t,a,i,r,o){AxActiveDc=e;var l=GetDcRowCount(e);t=parseInt(t,10);var n=$j(".wrapperForGridData"+e+" tbody tr").length,s=!1;if(TstructHasPop&&(s=IsDcPopGrid(e))&&"GetDep"==i){for(var d=GetPopRows(AxActivePDc,GetClientRowNo(AxActivePRow,AxActivePDc),e).split(","),c=new Array,p=0;p<d.length;p++)c.push(d[p]);c.sort()}if(""!=a){var m;m=a.split(",");for(var f=0;f<m.length;f++){var u=m[f].substring(0,1),v=m[f].substring(1);if("d"==u)if("*"==v){GetDcRowCount(e);"no"!=o&&(SetRowsInDc(e,l,i),(!axInlineGridEdit&&"form"==AxpGridForm||isMobile&&"none"!=mobileCardLayout)&&DeleteFromGridRow(e,v,this,i),"d*,"==a&&gridDummyRowVal.length>0&&gridDummyRowVal.map(function(t){t.split("~")[0]==e&&gridDummyRowVal.splice($.inArray(t,gridDummyRowVal),1)}))}else DeleteDbRow(e,v,i);else if(TstructHasPop){var g=$j.inArray(e,DCFrameNo);"LoadData"!=i&&("GetDep"!=i||0!=n)||"0"==$j("#recordid000F0").val()&&"True"!=DCHasDataRows[g]?"i1"!=m[f].toString()||s&&"GetDep"==i&&"True"==r?(AddRow(e,i),AxDepRows.push(v+"~"+GetDcRowCount(e))):(AxDepRows.push(v+"~1"),1==s?"LoadData"!=i&&($j("#sp"+e+"R001F"+e).show(),UpdateNewPopInfo(e,"001"),UpdatePopUpArrays(e,"001",!0,"Add"),UpdateDcRowArrays(e,"001","Add")):(UpdatePopUpArrays(e,"001",!1,"Add"),UpdateDcRowArrays(e,"001","Add"))):"no"!=o&&(axInlineGridEdit?addNewInlineGridRow(e,i):AddNewRowInDc(e,i))}else{g=$j.inArray(e,DCFrameNo);"LoadData"!=i&&("GetDep"!=i||0!=n)||"0"==$j("#recordid000F0").val()&&"True"!=DCHasDataRows[g]?"i1"!=m[f].toString()&&""!=m[f].toString()||"i1"==m[f].toString()&&-1!=a.indexOf("i2")?(axInlineGridEdit?addNewInlineGridRow(e,i):axInlineGridEdit||"form"!=AxpGridForm?AddNewRowInDc(e,i):AddNewFormRowInDc(e,i),"GetDep"!=i&&"Action"!=i||"i1"!=m[f].toString()||-1==a.indexOf("d*")||"yes"!=o||gridDummyRowVal.length>0&&gridDummyRowVal.map(function(t){t.split("~")[0]==e&&gridDummyRowVal.splice($.inArray(t,gridDummyRowVal),1)})):"GetDep"!=i&&"Action"!=i||"i1"!=m[f].toString()||-1!=a.indexOf("i2")||-1==a.indexOf("d*")||"yes"!=o||(axInlineGridEdit?addNewInlineGridRow(e,i):axInlineGridEdit||"form"!=AxpGridForm?AddNewRowInDc(e,i):AddNewFormRowInDc(e,i),gridDummyRowVal.length>0&&gridDummyRowVal.map(function(t){t.split("~")[0]==e&&gridDummyRowVal.splice($.inArray(t,gridDummyRowVal),1)})):"GetDep"==i&&"i1"==m[f].toString()&&-1==a.indexOf("i2")&&"False"==DCHasDataRows[g]||"no"!=o&&(axInlineGridEdit?addNewInlineGridRow(e,i):axInlineGridEdit||"form"!=AxpGridForm?AddNewRowInDc(e,i):AddNewFormRowInDc(e,i))}}ResetSerialNo(e,"000F"+e,t,!0),swicthCompressMode("#divDc"+e)}}function DeletePopRows(e,t){for(var a=0;a<PopGridDcNo.length;a++)if(PopGridDcNo[a]==e){for(var i=PopRows[a].toString().split(","),r="",o=0;o<i.length;o++)i[o]!=t&&(""==r?r=i[o]:r+=","+i[o]);PopRows[a]=r}}function DeleteDbRow(e,t,a){var i=GetClientRowNo(t,e);if(IsSingleRow(e))"LoadData"!=a&&ClearDeletedFields(e,i);else{if(UpdateChangedDbRow(e,t,"Delete"),DeleteRowHtml(e,i),TstructHasPop)1==IsDcPopGrid(e)&&(DeletePopRows(e,i),"1"==t&&UpdatePopUpArrays(e,"001",!0,"Delete"));var r=GetDcRowCount(e);r=parseInt(r,10)-1,SetRowCount(e,r);var o=GetSerialNoCnt(e);o=parseInt(o,10)-1,SetSerialNoCnt(e,o)}}function UpdateChangedDbRow(e,t,a,i){for(var r=!1,o=-1,l=0;l<RowDcNo.length;l++)if(RowDcNo[l]==e&&DbRowNo[l]==t){o=l,r=!0;break}"Delete"==a?r&&-1!=o&&(RowDcNo.splice(o,1),DbRowNo.splice(o,1),ClientRowNo.splice(o,1),ResetDbRowNo(e,t,a)):r&&-1!=o&&(RowDcNo.insert(o,e),DbRowNo.insert(o,t),ClientRowNo.insert(o,i),ResetDbRowNo(e,t,a))}function DeleteRowHtml(e,t){$j("#sp"+e+"R"+t+"F"+e).remove()}function SetRowsInDc(e,t,a){if($j("#hdnRCntDc"+e).length>0){if(("LoadData"==a&&t>0?parseInt(t,10):axInlineGridEdit?t:parseInt(t,10)-1)>0)ClearRowsInGrid(e,a);else{var i=GetClientRowNo("1",e);ClearDeletedFields(e,i,"",!0)}}}function ClearRowsInGrid(e,t){document.getElementById("Frame"+e);var a=0;if(a=GetDcRowCount(e),a=parseInt(a,10),"LoadData"==t?a+=1:a=axInlineGridEdit?a+1:a,a>=1){for(var i=a-1;i>=1;i--){var r=GetClientRowNo(i,e),o=r+"F"+e,l="sp"+e+"R"+r+"F"+e;$j("tr#"+l).length>0?($j("tr#"+l).hasClass("inEditMode")&&$j("#editCancelButton"+e).click(),$j("tr#"+l).remove()):$j("div#"+l).hasClass("editWrapTr"),UpdateDcRowArrays(e,r,"Delete");for(var n=0;n<RowDcNo.length;n++)RowDcNo[n]==e&&parseInt(ClientRowNo[n],10)==i+1&&(i==a-1&&IsRowDupInDcArray(e,"001")?(ClientRowNo[n]="001",UpdateDcRowArrays(e,ClientRowNo[n],"Delete")):i==a-1&&(ClientRowNo[n]="001"));for(var s=GetGridFields(e),d=0;d<s.length;d++){var c=s[d]+o;RemoveDeletedFields(c)}}var p=GetClientRowNo("1",e);UpdateDcRowArrays(e,p,"Delete"),UpdateDcRowArrays(e,"001","Add");var m=GetGridFields(e);for(i=0;i<m.length;i++){c=m[i]+"001F"+e;CallSetFieldValue(c,"")}}changeEditLayoutIds(0,e),SetRowCount(e,"1",undefined,t),SetSerialNoCnt(e,"1")}function IsRowDupInDcArray(e,t){for(var a=0,i=0;i<RowDcNo.length;i++)RowDcNo[i]==e&&ClientRowNo[i]==t&&a++;return a>1}function ConstructFieldName(e,t,a){return e+GetClientRowNo(a,t)+"F"+t}function GetFirstRow(e){new Array;return GetDcClientRows(e).getMinVal()}function CopyFromMasterRow(e,t,a,i,r,o){var l=GetFieldsName(e),n="";if(IsDcGrid(t)){if(-1!=GetFormatGridIndex(t)){if(r&&""!=r){var s="gridDc"+t,d=GetFormatRowIndex(s,t,r,"header"),c=$j("#"+s+" tbody>tr:eq("+(d+1)+")").attr("id"),p=c.lastIndexOf("F");a=c.substring(p-3,p)}}else a=GetFirstRow(t);n=l+GetRowNoHelper(a)+"F"+t;var m=$j("#"+e);if("select-one"==m.attr("type")||"select-one"==m.prop("type")){$j("#"+e+" option").length>0&&$j("#"+e+" option").remove(),$j("#"+n+" option").each(function(){var t=$j(this);$j("#"+e).append($j("<option>",{value:t.val(),text:t.text()}))});var f=$j("#"+n)[0].selectedIndex;if(2==$j("#"+e+" option").length){var u=$j.inArray(l,FNames);"True"==FldAutoSelect[u]&&1==f?$j("#"+e)[0].selectedIndex=1:$j("#"+e)[0].selectedIndex=0}else $j("#"+e)[0].selectedIndex=0;o==undefined&&(o=IsDcPopGrid(t))}else $j("#"+e).hasClass("fldFromSelect")||$j("#"+e).hasClass("fldmultiSelect")||$j("#"+e).val($j("#"+n).val())}}function DoFormControlPrivilege(e,t){if("Approved"!=appstatus&&"Rejected"!=appstatus){var a,i;if(a=GetFieldsRowNo(e),i=GetFieldsDcNo(e),null!=e&&e!=undefined&&-1!=e.indexOf("axpvalid")&&""!=t&&t!=undefined){var r=t.toString().toUpperCase();if("B"==r)DisableDeleteBtn("grdchkItemTd"+a+"F"+i,r,i);else if("A"==r)DisableDeleteBtn("grdchkItemTd"+a+"F"+i,r,i);else if("C"==r){DisableDeleteBtn("grdchkItemTd"+a+"F"+i,r,i);for(var o=GetGridFields(i),l=0;l<o.length;l++){e=o[l]+a+"F"+i;(n=$j("#"+e)).length>0&&n.prop("disabled",!0),$j("#sp"+i+"R"+a+"F"+i).find(".pickimg").each(function(){$j(this).prop("disabled",!0),$j(this).css("cursor","default")})}}else if("D"==r){DisableDeleteBtn("grdchkItemTd"+a+"F"+i,r,i);for(o=GetGridFields(i),l=0;l<o.length;l++){var n;e=o[l]+a+"F"+i;(n=$j("#"+e)).length>0&&n.prop("disabled",!0),$j("#sp"+i+"R"+a+"F"+i).find(".pickimg").each(function(){$j(this).prop("disabled",!0),$j(this).css("cursor","default")})}}DisNewGridDelBtn(i,a,r)}}}function DisNewGridDelBtn(e,t,a){try{"B"==a||"C"==a?($("#sp"+e+"R"+t+"F"+e+" td:first").find(".glyphicon.glyphicon-remove icon-arrows-remove").addClass("disabled").prop("disabled",!0),$("#sp"+e+"R"+t+"F"+e+" td:first").find(".glyphicon.glyphicon-trash").addClass("disabled").prop("disabled",!0),"C"==a&&$("#sp"+e+"R"+t+"F"+e+" td:first").find(".glyphicon.glyphicon-pencil.icon-software-pencil").addClass("disabled").prop("disabled",!0)):"D"==a&&($("#sp"+e+"R"+t+"F"+e+" td:first").find(".glyphicon.glyphicon-trash").removeClass("disabled").prop("disabled",!1),$("#sp"+e+"R"+t+"F"+e+" td:first").find(".glyphicon.glyphicon-trash").parent().removeClass("disabled").prop("disabled",!1))}catch(i){}}function DisableDeleteBtn(e,t,a){delImg=$j("#"+e),delImg.length>0&&("C"==t||"B"==t?($j("#"+e).prop("disabled",!0),$j("#"+e).unbind("click"),$j("#chkallgridrow"+a).prop("disabled",!0),$j("#chkallgridrow"+a).unbind("click")):($j("#"+e).prop("disabled",!1),$j("#"+e).bind("click"),$j("#chkallgridrow"+a).prop("disabled",!1),$j("#chkallgridrow"+a).bind("click")))}function AttachFiles(){tstReadOnly||("undefined"==typeof AxRulesBtnConMsg||"true"!=AxRulesBtnConMsg||AxRulesBtnConMsgParser(event.currentTarget))&&$j("#attachment-overlay").removeClass("d-none")}function callAfterFileAttach(){var e=$j("#attachfname").val();SetFormDirty(!0),FindDuplicate(e)?showAlertDialog("warning",2027,"client"):(filenamearray.push(e),ConstructAttachments())}function ConstructAttachments(){var e=0,t=0;if($j("#recordid000F0").length>0&&(t=$j("#recordid000F0").val()),fileonloadarray.length>0)for(var a=0;a<fileonloadarray.length;a++){var i='"'+fileonloadarray[a].toString()+'"';e=parseInt(a,10)+1,0==a?'<div class="row attachmentData"><div class="col-md-4 col-sm-6"><div class="attachments"><a class=\'linkrem\' alt=\'Remove File\' onclick=\'javascript:RemoveFile('+i+","+t+");'><img  class='close pull-right' src='../axpimages/icons/16x16/cross.png' alt='delete' /></a>&nbsp;<a id=loadattach"+e+' class="pull-left Attachlink flagcount" style="cursor:pointer;" onclick=\'javascript:OpenAttachment('+i+","+t+");'>"+fileonloadarray[a].toString()+"</a></div></div>":"<div class=\"col-md-4 col-sm-6\"><div class=\"attachments\"><a class='linkrem' alt='Remove File' onclick='javascript:RemoveFile("+i+","+t+");'><img class='close pull-right' src='../axpimages/icons/16x16/cross.png' alt='delete' /></a>&nbsp;<a id=loadattach"+e+' class="pull-left Attachlink flagcount" style="cursor:pointer;" onclick=\'javascript:OpenAttachment('+i+","+t+");'>"+fileonloadarray[a].toString()+"</a></div></div>"}if(filenamearray.length>0){for(var r=0;r<filenamearray.length;r++){i='"'+(i=CheckUrlSpecialChars(i=filenamearray[r].toString()))+'"';0==e?(e=1,'<div class="row attachmentData"><div class="col-md-4 col-sm-6"><div class="attachments"> <a class="pull-left Attachlink flagcount"  id=loadattach" + attcount + " style="cursor:pointer;" onclick=\'javascript:OpenAttachment('+i+","+t+(t>0?",true":"")+" );' >"+filenamearray[r].toString()+"</a> <a class=linkrem alt=Remove File onclick='javascript:RemoveNewFiles("+i+');\'> <img class="close pull-right" src="../axpimages/icons/16x16/cross.png"  alt=""> </a><div class="clear"></div></div></div>'):(e=parseInt(e,10)+1,'<div class="col-md-4 col-sm-6"><div class="attachments"> <a class="pull-left Attachlink flagcount"  id=loadattach" + attcount + " style="cursor:pointer;"  onclick=\'javascript:OpenAttachment('+i+","+t+(t>0?",true":"")+");' >"+filenamearray[r].toString()+"</a> <a class=linkrem alt=Remove File onclick='javascript:RemoveNewFiles("+i+');\'> <img class="close pull-right" src="../axpimages/icons/16x16/cross.png"  alt=""> </a><div class="clear"></div></div></div>')}"</div>"}if("<input id=hdncount type=hidden value="+e+">",e>0&&$j("#attachment-overlay").removeClass("d-none"),-1!=GetFieldIndex("axp_attachedfiles")){var o=GetActualFieldName("axp_attachedfiles"),l=filenamearray.join(","),n=GetFieldsDcNo(o),s=GetDbRowNo(GetFieldsRowNo(o),n);GetFieldsRowNo(o);UpdateFieldArray(o,s,l,"parent"),CallSetFieldValue(o,l)}}function RemoveNewFiles(e){e=ReplaceUrlSpecialChars(e);try{ASB.WebService.RemoveNewFiles(e,sid)}catch(t){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}RemoveArrVal(e,filenamearray),$j("#attachment-overlay").hide(),ConstructAttachments(),adjustwin("100",window)}var attFileName="",delFiles="";function RemoveFile(fname,rid,delFileObj){if("undefined"==typeof tstructCancelled||"cancelled"!==tstructCancelled.toLowerCase()){delFiles=delFileObj,attFileName=ReplaceUrlSpecialChars(fname);var cutMsg=eval(callParent("lcm[47]")),glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var RemoveFileCB=$.confirm({theme:"modern",title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:"false",rtl:isRTL,escapeKey:"buttonB",content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"btn btn-primary",action:function(){RemoveFileCB.close(),RemoveFileAfterConfirm()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}})}else showAlertDialog("warning",eval(callParent("lcm[303]")));function RemoveFileAfterConfirm(){var e='<root axpapp="'+proj+'"  sessionid="'+sid+'"  filename="'+fname+'" transid="'+tst+'"  recordid="'+rid+'"   trace="'+trace+'">';try{ASB.WebService.RemoveAttachment(e,tstDataId,resTstHtmlLS,SuccessRemAttFile)}catch(t){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}}}function SuccessRemAttFile(e,t){if(e.split("♠*♠").length>1&&(tstDataId=e.split("♠*♠")[0],e=e.split("♠*♠")[1]),!CheckSessionTimeout(e)){resTstHtmlLS="";var a=$j.parseJSON(e);if(a.message){var i=a.message[0].msg;if("done"==i){RemoveArrVal(attFileName,fileonloadarray);var r=document.querySelector("#attachment-overlay");Dropzone.forElement(r).removeFile(delFiles),SetFormDirty(!0)}else showAlertDialog("error",i)}}}function RemoveArrVal(e,t){for(var a=0;a<t.length;a++)if(e==t[a]){t.splice(a,1);break}}function OpenAttachment(e,t,a){e=ReplaceUrlSpecialChars(e);var i='<root axpapp="'+proj+'"  sessionid="'+sid+'"  filename="'+e+'" transid="'+tst+'"  recordid="'+t+'"   trace="♦♦GetAttachedFile♦">';try{var r=$j(".attachmentData a").length/2;if(0==t||""==t||$j(".attachmentData .flagcount").length!=r||a){var o='{"command":[{"cmd":"openfile","cmdval":';SuccChoicesOpenAtt(o=o+'"'+e+'","isatt":"T"}]}',null)}else ASB.WebService.ViewAttachment(i,tstDataId,resTstHtmlLS,SuccChoicesOpenAtt)}catch(l){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}}function SuccChoicesOpenAtt(e,t){e.split("♠*♠").length>1&&(tstDataId=e.split("♠*♠")[0],e=e.split("♠*♠")[1]),CheckSessionTimeout(e)||(resTstHtmlLS="",AssignLoadValues(e,""))}function FindDuplicate(e){for(var t=0;t<fileonloadarray.length;t++)if(e==fileonloadarray[t])return!0;for(var a=0;a<filenamearray.length;a++)if(e==filenamearray[t])return!0;return!1}function EvalPrepared(fldName,rowNo,exprStr,exprType){""!=exprStr&&(exprStr=exprStr.replace(/♦/g,","));var fName=GetFieldsName(fldName);wordlist=new Array;var fldIdx=$j.inArray(fName,FNames),posStr="";-1!=fldIdx&&(posStr=ExprPosArray[fldIdx]);var estr=CheckEval(exprStr,rowNo);estr!=exprStr&&(posStr=""),exprStr=estr,""==posStr&&(posStr=PrepareExpression(fName,exprStr,exprType),ExprPosArray[fldIdx]=posStr),wordlist=new Array;var startPos=posStr.toString().substring(0,posStr.toString().indexOf(",")),endPos=posStr.toString().substring(posStr.toString().indexOf(",")+1);startPos=parseInt(startPos,10),endPos=parseInt(endPos,10);for(var i=startPos;i<=endPos;i++){var strExp=EWords[i],ch=strExp.split(""),firstchar=ch[0];if("v"==firstchar){var fName=strExp.substring(1),fldVal=PrepareField(fName,rowNo);strExp=fldVal}else if("c"==firstchar){var fName=strExp.substring(1);fName=GetExactFieldName(fName),strExp="c"+fName}wordlist.push(strExp)}for(var fun=!0,i=0;i<wordlist.length;i++)"sFIELDCHANGED"!=wordlist[i]&&"sfieldchanged"!=wordlist[i].toString().toLowerCase()||(fun=!1);if(fun){EvalFun();var s=GetExprString();if(""==s)return"";try{var res="";""!=s&&isNaN(s)&&s.indexOf("\\")>-1?(s=s.replace(/\\/g,";bkslh"),res=eval(s),res=res.replace(/;bkslh/g,"\\")):res=eval(s)}catch(ex){try{s=s.replace(/\\/g,";bkslh");var res=eval("'"+s+"'");res=res.replace(/;bkslh/g,"\\")}catch(exp){res=""}}return"Infinity"==res&&(res=0),void 0!==res&&null!=res&&""!=res&&res.toString().indexOf("♠♥")>-1&&(res=res.replace(/♠♥/g,'"')),res}return!0}function PrepareField(e,a){var i="",r="";if("activerow"==e.toString().toLowerCase())i=GetClientRowNo(AxActiveRowNo,AxActiveDc);else if("activeprow"==e.toString().toLowerCase())i=GetClientRowNo(AxActivePRow,AxActivePDc);else{var o=GetDcNo(e);if(e=GetExactFieldName(e),r=IsDcGrid(o)?e+GetClientRowNo(a,o)+"F"+o:e+"000F"+o,document.getElementById(r))chrstate=!1,r=r;else{chrstate=!1;o=GetDcNo(e);if(r=IsDcPopGrid(o)?e+GetClientRowNo(AxActiveRowNo,AxActiveDc)+"F"+AxActiveDc:TstructHasPop&&IsDcParentGrid(o)?""!=AxActivePRow&&""!=AxActivePDc?e+GetClientRowNo(AxActivePRow,AxActivePDc)+"F"+AxActivePDc:e+GetClientRowNo(AxActiveRowNo,AxActiveDc)+"F"+AxActiveDc:IsDcGrid(o)&&"000"==a?e+GetClientRowNo(AxActiveRowNo,o)+"F"+o:e+a+"F"+o,document.getElementById(r))r=r;else{-1!=$j.inArray(e,FNames)?fldv="":i=e;for(var l=0;l<axMemVarList.length;l++){if(i==axMemVarList[l].toLowerCase())chrstate=!0,2==(s=(i=axMemVarValue[l]).split("/"))[0].length&&"undefined"!=typeof s[1]&&2==s[1].length&&"undefined"!=typeof s[2]&&4==s[2].length?i="d"+i:isNaN(i)?i="s"+i:(""==i&&(i=0),1==(i="n"+(i=i)).length&&(i="n0"))}if(!chrstate)for(var n=0;n<varlist.length;n++){var s;if(i==varlist[n].toLowerCase())chrstate=!0,2==(s=(i=valuelist[n]).split("/"))[0].length&&"undefined"!=typeof s[1]&&2==s[1].length&&"undefined"!=typeof s[2]&&4==s[2].length?i="d"+i:isNaN(i)?i="s"+i:(""==i&&(i=0),1==(i="n"+(i=i)).length&&(i="n0"))}}}if(!chrstate)if(document.getElementById(r)){i=GetFieldValue(r),e==AxAutoGenFld&&"Auto"==i&&(i=""),void 0!==i&&null!=i&&""!=i&&i.toString().indexOf('"')>-1&&(i=i.replace(/"/g,"♠♥"));var d=$j.inArray(e,FNames),c="";-1!=d&&(c=FDataType[d].toString()),""!=c?"Date/Time"==c?i="d"+i:"Character"==c||"Text"==c?i="s"+i:(i.length>3&&-1!=i.indexOf(",")&&(i=removeCommas(i)),""==i&&(i=0),1==(i="n"+i).length&&(i="n0")):isNaN(i)?i="s"+i:(i.length>3&&-1!=i.indexOf(",")&&(i=removeCommas(i)),""==i&&(i=0),1==(i="n"+i).length&&(i="n0"))}else r=e,""!=i&&(isNaN(i)?t="s":t="n",i=t+i)}for(var p=0;p<funclist.length;p++)if(r.toLowerCase()==funclist[p].toString().toLowerCase()){i="f"+funclist[p],chrstate=!0;break}return i}function CheckSpecialCharInGlobalVar(e){return e=e.replace(/;bkslh/g,"\\")}function PrepareExpression(e,t,a){expressiontype=a;var i=0;varlist=new Array,valuelist=new Array,axMemVarList=new Array,axMemVarValue=new Array,wordlist=new Array;var r=0;expFldname=e;transid,e.lastIndexOf("F");var o=t;if(Parameters.length>1)for(var l=0;l<Parameters.length;l++){d=(d=Parameters[l].toString()).split("~"),varlist[r]=d[0].toString(),valuelist[r]=CheckSpecialCharInGlobalVar(d[1].toString()),r++}if(varlist[r]="activerow",valuelist[r]=AxActiveRowNo,AxMemParameters.length>1)for(var n=0;n<AxMemParameters.length;n++){var d;d=(d=AxMemParameters[n].toString()).split("~"),axMemVarList[n]=d[0].toString(),axMemVarValue[n]=d[1].toString().replace(/&quot;/g,'"')}new Array,new Array;o=TrimAll(o);for(var c=(o+=" ").split(""),p=0;p<c.length;p++){if("{"!=c[p])if("}"!=c[p])if(constword)wordstring+=c[p];else if((isDelimiter(c[p])||isOperator(c[p]))&&(""!=wordstring&&(wordstring="v"+wordstring,wordlist[i]=wordstring,i++),wordstring=""),"("!=c[p])")"!=c[p]?isOperator(c[p])?(wordlist[i]="o"+c[p],i++):" "!=c[p]&&(","!=c[p]?wordstring+=c[p]:(wordlist[i]="l,",i++,wordstring="")):("("==brackets.charAt(brackets.length-1)?(wordlist[i]="b)",i++):(wordlist[i]="e",i++),brackets=brackets.slice(0,-1));else{if(wordlist.length>0){var m=wordlist[wordlist.length-1];m=m.substr(0,1),brackets+="f"==m||"v"==m?"v":"("}else brackets+="(";wordlist[i]="b(",i++}else 1==bcount?(constword=!1,s="c"+wordstring,wordlist[i]=s,i++,bcount=0,wordstring=""):(bcount--,wordstring+=c[p]);else bcount>0?wordstring+=c[p]:(constword=!0,wordstring=""),bcount++}for(var f=EWords.length,u=0;u<wordlist.length;u++)EWords.push(wordlist[u]);return f+","+(EWords.length-1)}function SaveAsDraft(){try{if(1==AxGlobalChange){var e=getTabDCStatus();ASB.WebService.SaveAsDraft(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,tst,tstDataId,e,resTstHtmlLS,SuccessCallbackDrafts,OnSaveDraftException)}}catch(t){ShowDimmer(!1),AxWaitCursor(!1)}}function getTabDCStatus(){var e="";for(i=0;i<TabDCs.length;i++)e+="DC"+TabDCs[i]+"-"+TabDCStatus[i]+",";return e.slice(0,-1)}function SuccessCallbackDrafts(e,t){""!=e&&e.split("♠*♠").length>1&&(tstDataId=e.split("♠*♠")[0],e=e.split("♠*♠")[1]),CheckSessionTimeout(e)||(resTstHtmlLS="",ShowDimmer(!1))}function OnSaveDraftException(e){AxWaitCursor(!1),ShowDimmer(!1)}function GetDependentArray(){var e=new Array;if("true"!=displayAutoGenVal&&$j(".autogen").length>0){var t=$j(".autogen")[0].id,a=GetFieldsName(t),i=GetFieldIndex(a),r="";AxAutoGenFld=a,-1!=i&&(r=FldDependents[i].toString().substring(1)),""!=r&&(e=r.split(","))}return e}function ClearImageSrc(e){IsFormDirty||SetFormDirty(!0);var t=e.id.replace("del-","").trim();$("#"+t).parents(".image-input").find(".delete-button").addClass("d-none"),$("#"+t).parents(".image-input").find(".imageFileUpload").removeClass("d-none"),$("#"+t).parents(".image-input").find(".profile-pic").addClass("d-none");var a=$("#"+t).parents(".image-input").find("img.profile-pic").attr("src");$("#"+t).parents(".image-input").find("img.profile-pic").attr("src","");var i=parseInt(GetFieldsRowNo(t),10);if(UpdateFieldArray(t,i,"","parent",""),UpdateAllFieldValues(t,""),"0"!=recordid){var r=a.split("/").pop();r.indexOf(recordid+".")>-1&&DeletedFieldValue.push(t+"~"+r)}}function CheckAllListItems(e){var t=e.id,a=!0;a=!!$j("#"+t).prop("checked");var i=t.replace("chkAll_","").trim(),r=$j("#hideAll_"+i),o=$j("#chkAll_"+i),l=GetChkSeparator(GetFieldsName(i));if(a){var n="";$j("input:checkbox[id='"+i+"']").each(function(){if(0==$j(this).prop("disabled")){$j(this).attr("checked","checked"),$j(this).prop("checked",!0);var e=$j(this).val();""==n?n=e:n+=l+e}}),""!=n&&UpdateAssignedFld(i)}else $j("input:checkbox[id='"+i+"']").each(function(){$j(this).removeAttr("checked"),$j(this).prop("checked",!1)});o.prop("checked")&&r.prop("checked")&&ShowSelectedChkItems("hideAll_"+i),!o.prop("checked")&&r.prop("checked")&&(r.removeAttr("checked"),r.prop("checked",!1));try{AxAfterCheckAll()}catch(s){}"undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?CheckDependencyPerf(i):CheckDependency(i)}function ShowSelectedChkItems(e){if(e!=undefined){var t=!0;t=!!$j("#"+e).prop("checked");var a=e.replace("hideAll_","").trim();$j("input:checkbox[id='"+a+"']").each(function(){t?$j(this).attr("checked")?$j(this).parent().show():$j(this).parent().hide():$j(this).parent().show()})}}function SetDcCaption(e,t){$j.inArray(e,TabDCs)>-1?$j("#ank"+e+" span.text").text(t):$j("#dcCaption"+e).text(t)}function SetDynamicDcCaptions(e){e=e||"";for(var t=0;t<DCFrameNo.length;t++)if(""==e||e==DCFrameNo[t]){var a=DCCaption[t].toString();if(-1!=a.indexOf("{")){for(var i=GetWordsBetweenCurlies(a),r=0;r<i.length;r++){var o=GetExactFieldName(i[r]),l="";if(-1!=GetFieldIndex(o)){var n=GetDcNo(o);l=IsGridField(o)?GetFieldValue(o+GetRowNoHelper(AxActiveRowNo)+"F"+n):GetFieldValue(o+"000F"+n)}else l=CheckGlobalVars(o);a=a.replace("{"+i[r]+"}",l)}SetDcCaption(DCFrameNo[t],a)}}}function GetWordsBetweenCurlies(e){for(var t,a=[],i=/{([^}]+)}/g;t=i.exec(e);)a.push(t[1]);return a}function EvaluateDcCaption(e,t){for(var a=e.split(","),i=0;i<a.length;i++)for(var r=0;r<DCFrameNo.length;r++)if(DCFrameNo[r].toString()==e){var o=DCCaption[r].toString();if(-1!=o.indexOf("{")){for(var l=GetWordsBetweenCurlies(o),n=0;n<l.length;n++){var s=GetExactFieldName(l[n]),d="";if(-1!=GetFieldIndex(s)){EvaluateAxFunction(s,s);var c=GetDcNo(s);d=GetFieldValue(s+GetRowNoHelper(AxActiveRowNo)+"F"+c)}else d=CheckGlobalVars(s);o=o.replace("{"+l[n]+"}",d)}SetDcCaption(DCFrameNo[r],o);break}}}var arrGlobalVars=new Array,arrGlobalVarValues=new Array;function CheckGlobalVars(e){var t=0;if(Parameters.length>1&&0==arrGlobalVars.length)for(var a=0;a<Parameters.length;a++){var i=Parameters[a].toString();i=i.split("~"),arrGlobalVars[t]=i[0].toString(),arrGlobalVarValues[t]=CheckSpecialCharInGlobalVar(i[1].toString()),t++}var r;return-1!=(r=$j.inArray(e,arrGlobalVars))?arrGlobalVarValues[r]:e}function UpdateAxpCurrDec(e,t){var a=new Array,i="";if((a=e.split(",")).length>0&&""!=e){i=a[0].toString();for(var r=-1,o=1;o<a.length;o++){var l=a[o];if(a[o].indexOf("~")>-1&&(l=a[o].toString().substr(0,a[o].indexOf("~"))),r=$j.inArray(l,FNames),FDecimal[r]=i,a[o].indexOf("~")>-1&&(i=a[o].toString().substring(a[o].toString().lastIndexOf("~")+1)),"GetDep"==t){if(currdecVal="",parseInt(i,10)>parseInt(FDupDecimals[r],10))return showAlertDialog("warning",2031,"client",FCaption[r]),void(currdecVal=FCaption[r]);var n="",s=FldFrameNo[r];if(IsGridField(l)){var d;d=parseInt(GetDcRowCount(s),10);for(var c=1;c<=d;c++){n=l+GetClientRowNo(c,s)+"F"+s;var p=NumericFldOnBlur(GetFieldValue(n),r);SetFieldValue(n,p),UpdateFieldArray(n,c,p,"parent")}}else{n=l+"000F"+s;p=NumericFldOnBlur(GetFieldValue(n),r);SetFieldValue(n,p);var m=GetFieldsRowNo(n),f=GetDbRowNo(m,s);UpdateFieldArray(n,f,p,"parent","")}}}}}function GetReferExpr(e,t,a){return a.indexOf("@")>-1?a.substring(1,a.indexOf("}")):a.startsWith("{")>-1?a.substring(1,a.indexOf("}")):Evaluate(e,t,a,"expr")}function OpenPdfFile(cmdVal,filepath,docID,dirName,saveAction){if(cmdVal=cmdVal||"",filepath=filepath||"",docID=docID||"",dirName=dirName||"",saveAction)return eval(callParent("isSaveAndPrintClick")+"= true"),eval(callParent("isSavePrintValues")+".push(cmdVal)"),eval(callParent("isSavePrintValues")+".push(filepath)"),eval(callParent("isSavePrintValues")+".push(docID)"),void eval(callParent("isSavePrintValues")+".push(dirName)");eval(callParent("isSaveAndPrintClick")+"= false"),eval(callParent("isSavePrintValues")+"=[]"),$j.ajax({url:"openfile.aspx/GetPdfFile",type:"POST",cache:!1,async:!1,data:JSON.stringify({urfpath:cmdVal,urdocid:docID,urpath:filepath,dirName:dirName}),dataType:"json",contentType:"application/json",beforeSend:function(){ShowDimmer(!0)},success:function success(data){if(null!=data.d||""!=data.d)if("error"!=data.d){if(jQBrowser.chrome||jQBrowser.opera||jQBrowser.safari)try{if(isMobile){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");callParentNew("SetUnload(false)","function"),callParentNew("isFileDownload=",!0),W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){UpdateExceptionMessageInET("printfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(openFastReportInNewWindow){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){UpdateExceptionMessageInET("printfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else printJS(data.d)}catch(ex){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");isMobile&&(callParentNew("SetUnload(false)","function"),callParentNew("isFileDownload=",!0)),W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){UpdateExceptionMessageInET("printfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.mozilla){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){UpdateExceptionMessageInET("printfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.msie){var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){UpdateExceptionMessageInET("printfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.msedge){var fileUrl=data.d,win;try{win=window.open("","fasrreport","width=600,height=400,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=auto,resizable=yes"),win.location.href=fileUrl,win.focus(),setTimeout(function(){win.print()},5e3)}catch(ex){UpdateExceptionMessageInET("printfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}else{var URL=data.d,W;try{var params=["height="+screen.height,"width="+screen.width,"fullscreen=yes","scrollbars=yes","resizable=yes"].join(",");W=window.open(URL,"",params),W.moveTo(0,0),W.window.focus()}catch(ex){UpdateExceptionMessageInET("printfile exception : "+ex.message),showAlertDialog("warning",eval(callParent("lcm[356]")))}}setTimeout(function(){deletepdffile(data.d)},1e3)}else UpdateExceptionMessageInET("printfile exception : "+data.d),ShowDimmer(!1),ShowDialog("warning",data.d);else UpdateExceptionMessageInET("printfile exception : 2022"),ShowDimmer(!1),ShowDialog("warning",2022,"client")},error:function(e,t,a){UpdateExceptionMessageInET("printfile exception : 2022"),ShowDimmer(!1),ShowDialog("warning",2022,"client")}})}function deletepdffile(e){$j.ajax({url:"openfile.aspx/DeletePrintPDF",type:"POST",cache:!1,data:JSON.stringify({pdfPath:e}),async:!1,dataType:"json",contentType:"application/json",success:function(e){ShowDimmer(!1)},error:function(e,t,a){ShowDimmer(!1)}})}function ExecErrorMsg(e,t){for(var a=0;a<e.length;a++){for(var i=e[a].msg,r="",o=i.indexOf("^^dq");-1!=o;)o=(i=i.replace("^^dq",'"')).indexOf("^^dq");if(null!=i&&i!=undefined&&""!=i){if(i.indexOf("errfld")>-1){var l=i.substring(i.lastIndexOf("errfld"));r=(l=l.split(":")[1]).replace('"',"").trim(),i=(i=i.substring(0,i.lastIndexOf("errfld")-2)).replace('",',"").replace('" ,',"")}if(UpdateExceptionMessageInET(t+" Error : "+i),"Action"==t&&(GetProcessTime(),GetTotalElapsTime()),showAlertDialog("error",i),"CancelTrans"==t)return;var n="";if(""!=r)try{var s=r.toString().split(",");n=s[0];var d=s[1],c=GetDcNo(n),p="000";if(IsGridField(n)){3==d.length?p=d:2==d.length?p="0"+d:1==d.length&&(p="00"+d);var m=n+p+"F"+c;if((g=$j("#"+m)).length>0){if(IsTabDc(c)&&!$("#ank"+c).hasClass("active")){var f=$("#ank"+c).parents("ul#myTab").find("a.active").attr("id");$("#"+f).removeClass("active");var u=f.substr(3);$("#tab-"+u).removeClass("show active"),$("#tab-"+c).addClass("show active"),$("#ank"+c).addClass("active")}var v=g.parents("td").index();$("#gridHd"+c+" tbody tr#sp"+c+"R"+p+"F"+c).hasClass("inline-edit")?g.focus():$("#gridHd"+c+" tbody tr#sp"+c+"R"+p+"F"+c+" td:eq("+v+")").click()}}else{m=n+p+"F"+c;(g=$j("#"+m)).length>0&&g.focus()}}catch(w){}else if(""!=AxActiveField){var g;p=GetClientRowNo(AxActiveRowNo,AxActiveDc),m=AxActiveField+p+"F"+AxActiveDc;(g=$j("#"+m)).length>0&&g.focus()}}}}function getComntWf(e){var t=$j("#recordid000F0").val();$.ajax({url:"tstruct.aspx/GetWrkFlwCmmt",type:"POST",cache:!1,async:!0,data:JSON.stringify({tid:tst,rid:t}),dataType:"json",contentType:"application/json",success:function(t){for(var a=JSON.parse(t.d),i=0;i<a.length;i++){var r=a[i];for(var o in r){var l=r[o];delete r[o],r[o.toLowerCase()]=l}a[i]=r}for(var n='<table class="table table-bordered firstble table-fixed"><thead><tr><th class="col-sm-4">Date</th><th class="col-sm-2">Status</th><th class="col-sm-4">Comments</th><th class="col-sm-2">User</th></tr></thead><tbody>',s=0;s<a.length;s++)n+='<tr class="tblrowcolor" tabindex="0">',n+='<td class="col-sm-4"> '+a[s].datetime+"</td>",n+='<td class="col-sm-2">'+("return"==a[s].status?"Returned":a[s].status)+"</td>",n+='<td class="col-sm-4">'+a[s].comments+"</td>",n+='<td class="col-sm-2">'+a[s].username+"</td>",n+="</tr>";if(n+="</tbody>",$("#tblWrk").addClass("d-none"),$("#tblWrk").html(n),$("#collapseOneTable").html(n),$("#consumergoods2").addClass("d-none"),$("#btnWrfSave").addClass("d-none"),$("#btnWrfCancel").addClass("d-none"),e){$("#tblWrk").removeClass("d-none");var d=new BSModal("modalIdWfHistory","History",$("#tblWrk").html(),function(){$("#tblWrk").addClass("d-none")},function(){});d.changeSize("lg"),d.hideFooter(),d.scrollableDialog()}},error:function(e){console.log(e)}}),isWizardTstruct&&$("body").append($("#consumergoods").detach())}function getWfUsrName(e,t){for(var a=[],i=1;i<parseInt(e)+1;i++){for(var r="",o=0;o<t.length;o++)if(t[o].lno==i&&"-1"!=$j("#hdnWfLno").val())r+=""==r?t[o].un:","+t[o].un;else if("-1"==$j("#hdnWfLno").val()&&""==r)try{r+=t[$j("#hdnWfELno").val()].un}catch(l){r+=t[o].un}a.push(r)}return a}function getWfStatus(e,t){for(var a=[],i=!1,r=1;r<parseInt(e)+1;r++){var o="";i||(o="Notapplicable");for(var l=0;l<t.length;l++)if(t[l].lno==r&&"-1"!=$j("#hdnWfLno").val())i||(o=""),i=!0,""==o?"forwarded"==t[l].st.toLowerCase()?o+="reviewed":o+=t[l].st:"forwarded"==t[l].st.toLowerCase()?o+=",reviewed":o+=","+t[l].st;else if("-1"==$j("#hdnWfLno").val()&&(i||(o=""),i=!0,""==o))try{"forwarded"==t[$j("#hdnWfELno").val()].st.toLowerCase()?o+="reviewed":o+=t[$j("#hdnWfELno").val()].st}catch(n){"forwarded"==t[l].st.toLowerCase()?o+="reviewed":o+=t[l].st}a.push(o)}return a}function getWfLevelUSsrs(e,t,a,i,r,o){WrkflFlag=!0,ShowDimmer(!0);$j("#recordid000F0").val();var l=constructWrkHtml(t,a,i,r,o);$(l).insertAfter($(".icobtn")),$("#stratWrkf").after($(".workflowMsg").detach()),popoverWrkFl()}function constructWrkHtml(e,t,a,i,r){for(var o="",l="",n=0,s=0;s<parseInt(e);s++)if(r.length>n&&"-1"==$j("#hdnWfLno").val()&&i!=r[n].lno&&n++,"undefined"==typeof r[n]||r[n].lno==s+1||"-1"==$j("#hdnWfLno").val()){var d=a[s].toLowerCase();if(d.indexOf(",")>-1&&(d=(d=d.split(",")).indexOf("pending")>-1?"pending":d[d.length-1]),"forwarded"==d.toLowerCase()&&(d="reviewed"),(d.indexOf("pending")>-1||""==d)&&(d="Pending"),d.indexOf("rejected")>-1&&(d="rejected"),""==a[s])"pending"==(d="Pending").toLowerCase()&&""!=t[s]&&t[s]==user?l="Approval pending with you. ":"pending"==d.toLowerCase()&&""!=t[s]&&t[s]!=user&&(l="Approval pending with "+t[s]+" ");else if("undefined"!=typeof r[n]&&r[n].lno==i&&parseInt(i)==s+1){!function(){c=$j("#lblStatus").text(),null!=(p=c.match(/'([^']+)'/g))&&p.forEach(function(e){if(e.indexOf(".")>-1){var t=e.replace(/[.]/gi,"♣");c=c.replace(e,t)}}),m=c.split(".");var e=user.replace(/[.]/gi,"♣");m.forEach(function(a){(a.startsWith("Pending ")||a.startsWith(" Pending "))&&(a.indexOf("'"+e+"'")>0||a.indexOf(" "+e)>0||a.indexOf(","+e)>0||a.indexOf(" "+e+",")>0||a.indexOf(e+",")>0||t[s].split(",").indexOf(user)>-1)?l="Approval pending with you. ":a.startsWith("Returned ")&&(a.indexOf("'"+e+"'")>0||a.indexOf(" "+e)>0||a.indexOf(","+e)>0||a.indexOf(" "+e+",")>0||a.indexOf(e+",")>0)?l=a.replace(/'/g,"").replace(/♣/g,"."):a.startsWith("Returned by ")&&(l=a.replace(/'/g,"").replace(/♣/g,"."))})}()}else{if("pending"==d.toLowerCase()&&t[s]==user)if(""!=(c=$j("#lblStatus").text())&&c.startsWith("Returned by "))try{null!=(p=c.match(/'([^']+)'/g))&&p.forEach(function(e){if(e.indexOf(".")>-1){var t=e.replace(/[.]/gi,"♣");c=c.replace(e,t)}}),(m=c.split(".")).forEach(function(e){e.startsWith("Returned by ")&&(l=e.replace(/'/g,"").replace(/♣/g,"."))})}catch(u){l="Approval pending with you. "}else l="Approval pending with you. ";else if("pending"==d.toLowerCase()&&t[s]!=user)l=(t[s].indexOf(","),"Approval pending with "+t[s]+" ");else if("approved"==d.toLowerCase()&&t[s]==user){var c,p,m;!function(){c=$j("#lblStatus").text(),null!=(p=c.match(/'([^']+)'/g))&&p.forEach(function(e){if(e.indexOf(".")>-1){var t=e.replace(/[.]/gi,"♣");c=c.replace(e,t)}}),m=c.split(".");var e=user.replace(/[.]/gi,"♣");m.forEach(function(a){""!=a&&(a.indexOf("'"+e+"'")>0||a.indexOf(" "+e+" ")||t[s].split(",").indexOf(user)>-1)&&(l=a.replace(/'/g,"").replace(/♣/g,"."))})}()}else"approved"==d.toLowerCase()&&t[s]!=user?l=$j("#lblStatus").text().replace(/'/g,""):"rejected"==d.toLowerCase()&&t[s]==user?l="Approval rejected by you. ":"rejected"==d.toLowerCase()&&t[s]!=user?l="Approval "+$j("#lblStatus").text().replace(/'/g,""):"reviewed"==d.toLowerCase()&&t[s]==user?l="Approval Forwarded by you. ":"reviewed"==d.toLowerCase()&&t[s]!=user?l="Approval "+$j("#lblStatus").text().replace(/'/g,""):"autoforwarded"==d.toLowerCase()&&"system"==t[s]&&(l=$j("#lblStatus").text().replace(/'/g,""))}"notapplicable"===d&&(d="NA");for(var f=0;f<r.length;f++)if(r[f].lno==i&&parseInt(i)==s+1&&"Pending"==d){o+='<div class="downArr workflowdisplayinline" id="workflowdropdown"><span class="workflowOptions btn btn-sm btn-icon btn-active-light-primary shadow-sm menu-dropdown" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end" data-kt-menu-flip="top-end"><span class="workflowOptionAction material-icons material-icons-style">more_vert</span></span></div>';break}n++}return(l='<div class="workflowMsg workflowdisplayinline d-flex flex-row-auto px-4 py-2 fst-italic fst-bolder" data-content="'+l+'" data-toggle="popoverone" data-trigger="hover" data-placement="bottom">'+l+"</div>")+o}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function popoverWrkFl(){$('[data-toggle="popoverone"]').popover(),$("div[aria-expanded='false']")?$("#togglearrow").attr("title","Expand"):$("#togglearrow").attr("title","Collapse")}function LimtCharacters(e,t,a){chars=e.value.length,t-chars<0?document.getElementById(a).innerHTML="0 of 250":document.getElementById(a).innerHTML=t-chars+" of 250",chars>t&&(e.value=e.value.substring(0,t))}function popupFullPage(e){callParentNew("splitfull()","function");var t=$j("#middle1",parent.document);try{t[0].contentWindow.location.href=e}catch(a){}}function setIviewNavigationData(e,t){if(""!=t)try{ASB.WebService.SetIviewNavigationData(e,t,function(){})}catch(a){}}function callExecuteScriptApi(e,t,a){if(actionCallFlag==actionCallbackFlag){actionCallFlag=Math.random(),$("#icons,#btnSaveTst,.BottomToolbarBar a").css({"pointer-events":"auto"}),AxWaitCursor(!0),ShowDimmer(!0);try{ASB.WebService.CallExecuteScriptAPI(e,tstDataId,t,a,resTstHtmlLS,SuccessCallbackExecuteScriptApi,OnException)}catch(r){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),AxWaitCursor(!1),ShowDimmer(!1);var i=r.name+"^♠^"+r.message;showAlertDialog("error",2030,"client",i)}}else $("#icons,#btnSaveTst,.BottomToolbarBar a").css({"pointer-events":"none"})}function SuccessCallbackExecuteScriptApi(e,t){if(""!=e&&e.split("♠*♠").length>1&&(tstDataId=e.split("♠*♠")[0],e=e.split("♠*♠")[1]),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.BottomToolbarBar a,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),!CheckSessionTimeout(e)){resTstHtmlLS="";var a=JSON.parse(e);"undefined"!=typeof a.result[0].error?"undefined"!=typeof a.result[0].error.msg?showAlertDialog("error",a.result[0].error.msg):showAlertDialog("error",a.result[0].error[0].msg):showAlertDialog("success",a.result[0].msg),ArrActionLog="",AxWaitCursor(!1),ShowDimmer(!1)}}function EvaluateDirectScript(e){return Evaluate("","",e,"exp")}function ReadonlyformPeg(){tstReadOnlyPeg=!0,$("[id^=DivFrame").find("input,textarea, img, select, a").attr("disabled",!0),$("[id^=DivFrame").find(".gridIconBtns a").addClass("disabled"),$("[id^=DivFrame").find(".gridIconBtns a").attr("disabled",!0),$("[id^=DivFrame").find(".gridRowChk,.gridHdrChk").attr("disabled",!0),$(".BottomToolbarBar").find("a").addClass("disabled"),$(".BottomToolbarBar").find("a").attr("disabled",!0),$(".BottomToolbarBar").find("a").attr("tabindex",-1),$(".toolbarRightMenu").find("a").addClass("disabled"),$(".toolbarRightMenu").find("a").attr("disabled",!0),$(".toolbarRightMenu").find("button").attr("disabled",!0),$(".toolbarRightMenu").find("button").addClass("disabled"),$(".toolbarRightMenu").find("a").attr("tabindex",-1),$(".toolbarRightMenu").find("button").attr("tabindex",-1),$(".tstructBottomLeftButton").find(".lnkPrev,.lnkNext,a").addClass("disabled"),$(".tstructBottomLeftButton").find(".lnkPrev,.lnkNext,a").attr("disabled",!0),$(".tstructBottomLeftButton").find(".lnkPrev,.lnkNext,a").attr("tabindex",-1),$(".dz-hidden-input").prop("disabled",!0),$(".fldImageCamera").addClass("disabled"),$(".fileuploadmore").prop("disabled",!0),$("[id*=colScroll]").removeClass("griddivColumn")}function PEGStatusBar(e){var t;if($("#PEGDiv").removeClass("d-none"),""!=e[0].status&&($("#lblpegtext").text(e[0].status),AxPegJSON=e,"undefined"!=typeof e[0].finalapproval&&"true"==e[0].finalapproval&&"undefined"!=typeof isPegEditMode&&"false"==isPegEditMode?AxPegFinalApproval="true":AxPegFinalApproval="false"),"undefined"!=typeof e[0].enableactions&&"true"==e[0].enableactions){"undefined"!=typeof e[0].data&&"undefined"!=typeof e[0].data.levelno&&""!=e[0].data.levelno&&(AxPegLevelNo=e[0].data.levelno);var a='<div class="d-flex align-items-center task-more-btns float-end">';"Check"==e[0].data.tasktype?a+='<div class="task-actions-sets d-flex"><a href="javascript:void(0)" title="Check" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center btn-sm px-0 py-1" onclick="axPegCheck();"><span class="material-icons material-icons-style material-icons-2" style="color: #47BE7D;">done_all</span></a></div>':(a+='<div class="task-actions-sets d-flex"><a href="javascript:void(0)" title="Approve" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center btn-sm px-0 py-1" onclick="axPegApprove();"><span class="material-icons material-icons-style material-icons-2" style="color: #47BE7D;">check_circle</span></a>',a+='<a id="btnAppPegMore" href="javascript:void(0)" title="Approve Reasons/Comments" data-popover="PegApprove" class="btn btn-white btn-color-gray-700 align-items-center btn-sm more-comments p-0 show menu-dropdown" data-kt-menu-trigger="click" data-kt-menu-placement="top" data-kt-menu-flip="top"><span class="comments-icons material-icons material-icons-style material-icons-2">more_vert</span></a>',a+='<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bolder w-400px Active_list_popover shadow-sm" data-kt-menu="true" data-popper-placement="top"><div class="card"><div class="card-body">',"undefined"!=typeof AxPegJSON[0].data.approvereasons&&""!=AxPegJSON[0].data.approvereasons&&(a+='<div class="row my-3">',a+='<div class="approval-controls" data-tasktype="Approve">',a+='<label class="form-label col-form-label">Approve reasons</label>',a+='<div class="input-group">',a+='<select class="form-control form-select" id="dllAppPegReason">',AxPegJSON[0].data.approvereasons.split(",").forEach(function(e){a+="<option value="+e+">"+e+"</option>"}),a+="</select>",a+="</div>",a+="</div>",a+="</div>"),"undefined"!=typeof AxPegJSON[0].data.approvalcomments&&"T"==AxPegJSON[0].data.approvalcomments&&(a+='<div class="row my-3 aaa">',a+='<div class="approval-controls" data-tasktype="Approve">',a+='<label class="form-label col-form-label required">Comments</label>',a+='<div class="input-group">',a+='<textarea id="txtPegComments" title="Approve comments" name="txtPegComments" class="tem Family memofam form-control">'+AxPegJSON[0].data.defapptext+"</textarea>",a+="</div>",a+="</div>",a+="</div>"),a+='<div class="text-center Approval-OK">',a+='<a href="javascript:void(0)" class="btn btn-sm btn-primary shadow-sm" onclick="axPegApprove(\'true\');">Approve</a>',a+="</div></div></div></div></div>"),"undefined"!=typeof AxPegJSON[0].data.returnable&&"T"==AxPegJSON[0].data.returnable&&(a+='<div class="task-actions-sets d-flex"><a href="javascript:void(0)" title="Return" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center btn-sm px-0 py-1" onclick="axPegReturn();"><span class="material-icons material-icons-style material-icons-2" style="color: blueviolet;">reply</span></a>',a+='<a id="btnReturnPegMore" href="javascript:void(0)" title="Return Reasons/Comments" data-popover="PegReturn" class="btn btn-white btn-color-gray-700 align-items-center btn-sm more-comments p-0 show menu-dropdown" data-kt-menu-trigger="click" data-kt-menu-placement="top" data-kt-menu-flip="top"><span class="comments-icons material-icons material-icons-style material-icons-2">more_vert</span></a>',a+='<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bolder w-400px Active_list_popover shadow-sm" data-kt-menu="true" data-popper-placement="top"><div class="card"><div class="card-body">',a+='<div class="row my-3">',a+='<div class="approval-controls" data-tasktype="Return">',a+='<label class="form-label col-form-label">Return To</label>',a+='<div class="input-group">',a+='<select class="form-control form-select" id="dllReturnPegLevel">',a+="<option value='0'>Initiator</option><option value='1'>Previous Level</option>",a+="</select>",a+="</div>",a+="</div>",a+="</div>","undefined"!=typeof AxPegJSON[0].data.returnreasons&&""!=AxPegJSON[0].data.returnreasons&&(a+='<div class="row my-3">',a+='<div class="approval-controls" data-tasktype="Approve">',a+='<label class="form-label col-form-label">Return reasons</label>',a+='<div class="input-group">',a+='<select class="form-control form-select" id="dllReturnPegReason">',AxPegJSON[0].data.returnreasons.split(",").forEach(function(e){a+="<option value="+e+">"+e+"</option>"}),a+="</select>",a+="</div>",a+="</div>",a+="</div>"),"undefined"!=typeof AxPegJSON[0].data.returncomments&&"T"==AxPegJSON[0].data.returncomments&&(a+='<div class="row my-3">',a+='<div class="approval-controls" data-tasktype="Approve">',a+='<label class="form-label col-form-label required">Comments</label>',a+='<div class="input-group">',a+='<textarea id="txtPegReturnComments" title="Return comments" name="txtPegReturnComments" class="tem Family memofam form-control">'+AxPegJSON[0].data.defrettext+"</textarea>",a+="</div>",a+="</div>",a+="</div>"),a+='<div class="text-center Approval-OK">',a+='<a href="javascript:void(0)" class="btn btn-sm btn-primary shadow-sm" onclick="axPegReturn(\'true\');">Return</a>',a+="</div></div></div></div></div>"),"Check"!=e[0].data.tasktype&&(a+='<div class="task-actions-sets d-flex"><a href="javascript:void(0)" title="Reject" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center btn-sm px-0 py-1" onclick="axPegReject();"><span class="material-icons material-icons-style material-icons-2" style="color: red;">cancel</span></a>',a+='<a id="btnRejectPegMore" href="javascript:void(0)" title="Reject Reasons/Comments" data-popover="PegReject" class="btn btn-white btn-color-gray-700 align-items-center btn-sm more-comments p-0 show menu-dropdown" data-kt-menu-trigger="click" data-kt-menu-placement="top" data-kt-menu-flip="top"><span class="comments-icons material-icons material-icons-style material-icons-2">more_vert</span></a>',a+='<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bolder w-400px Active_list_popover shadow-sm" data-kt-menu="true" data-popper-placement="top"><div class="card"><div class="card-body">',"undefined"!=typeof AxPegJSON[0].data.rejectreasons&&""!=AxPegJSON[0].data.rejectreasons&&(a+='<div class="row my-3">',a+='<div class="approval-controls" data-tasktype="Approve">',a+='<label class="form-label col-form-label">Reject reasons</label>',a+='<div class="input-group">',a+='<select class="form-control form-select" id="dllRejectPegReason">',AxPegJSON[0].data.rejectreasons.split(",").forEach(function(e){a+="<option value="+e+">"+e+"</option>"}),a+="</select>",a+="</div>",a+="</div>",a+="</div>"),"undefined"!=typeof AxPegJSON[0].data.rejectcomments&&"T"==AxPegJSON[0].data.rejectcomments&&(a+='<div class="row my-3">',a+='<div class="approval-controls" data-tasktype="Approve">',a+='<label class="form-label col-form-label required">Comments</label>',a+='<div class="input-group">',a+='<textarea id="txtPegRejectComments" title="Reject comments" name="txtPegRejectComments" class="tem Family memofam form-control">'+AxPegJSON[0].data.defregtext+"</textarea>",a+="</div>",a+="</div>",a+="</div>"),a+='<div class="text-center Approval-OK">',a+='<a href="javascript:void(0)" class="btn btn-sm btn-primary shadow-sm" onclick="axPegReject(\'true\');">Reject</a>',a+="</div></div></div></div></div>"),a+="</div>",a+="</div>",$("#lblpegtext").append(a)}else if("undefined"!=typeof e[0].withdraw&&"true"==e[0].withdraw){$("#lblpegtext").append('<div class="d-flex align-items-center task-more-btns float-end"><div class="task-actions-sets d-flex"><a href="javascript:void(0)" title="Discard" class="btn btn-primary d-inline-flex align-items-center btn-sm px-0 py-1" onclick="axPegWithdrw();"><span class="material-icons material-icons-style material-icons-2">undo</span></a></div></div>')}if("undefined"!=typeof e[0].readonlytrans&&"true"==e[0].readonlytrans&&$(".tstructMainBottomFooter").addClass("d-none"),"undefined"!=typeof e[0].comments&&""!=e[0].comments)if($("#lblPegComments").length>0)$("#lblPegComments").text("Comments: "+e[0].comments);else{var i='<label id="lblPegComments">Comments: '+e[0].comments+"</label>";$("#lblpegtext").parent().append(i)}null===(t=KTMenu)||void 0===t||t.init()}function AxAmendStatusBar(e){if($("#AxAmendDiv").removeClass("d-none"),""!=e[0].status&&($("#lblAxAmendtext").text(e[0].status),AxAmendmentJSON=e,$("#lblAxAmendtext").append('<span class="material-icons material-icons-style float-end amendmentOptions">view_module</span>'),"undefined"!=typeof e[0].comments&&""!=e[0].comments))if($("#lblAmdComments").length>0)$("#lblAmdComments").text("Comments: "+e[0].comments);else{var t='<label id="lblAmdComments">Comments: '+e[0].comments+"</label>";$("#lblAxAmendtext").parent().append(t)}}function AxProcessObjCallAction(e){try{var t,a;if(void 0!==(null===(t=parent)||void 0===t?void 0:t.axProcessObj)&&void 0!==(null===(a=parent)||void 0===a?void 0:a.axProcessBuilderObj)){var i=void 0!==e&&e.indexOf('{"result":[{"save": "success"}]}')>-1,r=void 0!==e&&e.indexOf('{"message":[{"msg":"Transaction has been deleted"}]}')>-1;if("rightIframe"==window.frameElement.id&&"undefined"!=typeof parent.axProcessBuilderObj&&(i||r))return i?ShowDialog("success","Saved successfully."):ShowDialog("success","Task is removed."),parent.axProcessBuilderObj.fetchProcessDefinition("Process"),!0;if("rightIframe"==window.frameElement.id&&"undefined"!=typeof parent.axProcessObj&&i)return ShowDialog("success","Saved successfully."),"NA"==parent.axProcessObj.keyValue?parent.axProcessObj.reloadProcess(axSaveRecId):(parent.axProcessObj.taskCompleted=!0,parent.axProcessObj.refreshProcess(parent.axProcessObj.keyValue)),!0}return!1}catch(o){return!1}}function GetTstHtmlLsKey(e){var t="";try{if("undefined"!=typeof Storage){var a=top.window.location.href.toLowerCase().substring("0",top.window.location.href.indexOf("/aspx/")),i=callParentNew("getKeysWithPrefix(tstHtml♠"+e+"-"+a+"♥)","function");void 0===(t=localStorage[i[0]])&&(t="")}}catch(o){}var r="";""!=t?r="&dummyload=true♠"+t.split("♠♠♠")[1].split("*$*")[11]:r="&dummyload=false♠";return r}