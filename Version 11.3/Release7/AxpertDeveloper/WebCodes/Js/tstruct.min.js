/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ReloadMiddleIframe(){var e=$j("#middle1",parent.document);if(e.length>0){SetSession({key:"IsFromChildWindow",val:"true"});var t=e[0],a=t.contentWindow?t.contentWindow:t.contentDocument.defaultView;if(callParentNew("isDWB")&&a.location.href.toLowerCase().indexOf("iview.aspx")>-1)e.attr("src","ivtoivload.aspx?ivname=".concat(findGetParameter("ivname",a.location.href),"&AxIvNav=true"));else{var i=a.location.href;-1==i.indexOf("&AxSplit=")&&(i+="&AxSplit=true"),e.attr("src",i)}}}var DesigntstructMessages={noNode:eval(callParent("lcm[363]")),designSaved:eval(callParent("lcm[364]")),designSaveFailed:eval(callParent("lcm[365]")),noModification:eval(callParent("lcm[366]")),saveBeforePublish:eval(callParent("lcm[367]")),designPublished:eval(callParent("lcm[368]")),designPublisgFailed:eval(callParent("lcm[369]")),resetSuccess:eval(callParent("lcm[370]")),alredayreset:eval(callParent("lcm[371]")),resetfailed:eval(callParent("lcm[372]")),structureChanged:eval(callParent("lcm[374]"))};function setDesignedLayout(e,t){if("design"==theMode)$(".grid-stack").addClass("tstructDesignMode"),$("div[id^=colScroll]").addClass("tstructDesignMode"),$(".grid-stack").addClass("staticRunMode").removeClass("dynamicRunMode"),$("#designModeToolbar").css("display","block"),$("#icons").css("display","none");else{$("#DivFrame1 .dcTitle").hide().nextAll("hr.hrline").hide();try{"undefined"!=typeof designObj&&null!=designObj[0]&&null!=designObj[0].selectedLayout&&""!=designObj[0].selectedLayout&&"tile"==designObj[0].selectedLayout&&$("#DivFrame1 .dcTitle").show().nextAll("hr.hrline").show()}catch(i){}$(".grid-stack").removeClass("tstructDesignMode"),$("div[id^=colScroll]").removeClass("tstructDesignMode")}"design"==theMode?("undefined"!=typeof designObj&&null!=designObj[0]&&null!=designObj[0].tstUpdatedOn&&""!=designObj[0].tstUpdatedOn&&designObj[0].tstUpdatedOn!=tstructUpdateOn&&showAlertDialog("info",DesigntstructMessages.structureChanged),$(".grdButtons,.newgridbtn [id^=gridAddBtn]:visible, .grdButtons .dropdown, .grdButtons li").hide(),$(".newgridbtn li").hide(),$(".tstructMainBottomFooter").hide(),$(".rightToolbarMain").hide(),$(".gridoptions").hide(),axInlineGridEdit||$(".grid-icons [id^=wrapperForEditFields]").show().removeClass("hide").find(".editLayoutFooter").hide(),unBindEvents(),$(e).find(".grid-stack").data("gridstack")?$(e).find(".grid-stack").each(function(e,t){$(t).data("gridstack").batchUpdate(),clearHiddenGridstack(t.id),$(t).data("gridstack").enableMove(!0,!0),$(t).data("gridstack").enableResize(!0,!0),$(t).data("gridstack").commit()}):("undefined"!=typeof designObj&&null!=designObj[0]&&null!=designObj[0].dcLayout&&""!=designObj[0].dcLayout&&"default"!=designObj[0].dcLayout&&(designGridOptions.disableDrag=!0,designGridOptions.disableResize=!0),$(e).find(".grid-stack").each(function(e,t){clearHiddenGridstack(t.id),$("#ckbStaticRunMode").prop("checked",staticRunMode),$(t).gridstack(designGridOptions)}))):$(e).find(".grid-stack").data("gridstack")?$(e).find(".grid-stack").each(function(e,t){staticRunMode&&$(t).data("gridstack").batchUpdate(),clearHiddenGridstack(t.id),staticRunMode&&($(t).data("gridstack").enableMove(!1,!0),$(t).data("gridstack").enableResize(!1,!0),$(t).data("gridstack").commit())}):$(e).find(".grid-stack").each(function(e,t){clearHiddenGridstack(t.id),staticRunMode?($(t).addClass("staticRunMode").removeClass("dynamicRunMode"),$(t).gridstack(renderGridOptions),$(t).data("gridstack").batchUpdate()):$(t).removeClass("staticRunMode").addClass("dynamicRunMode"),$("#ckbStaticRunMode").prop("checked",staticRunMode),staticRunMode&&(autoArrangeFillGap&&_.map($(t).data("gridstack").grid.nodes,function(e){var a=(e=e.el).data("_gridstack_node");a=generateRtlPos(a);for(var i=_objectSpread({},e.data("_gridstack_node")),r=0,n=a.y,l=0;l<=a.y;l++)n=l,$(t).data("gridstack").isAreaEmpty(r,n,renderGridOptions.width,1)&&$(t).data("gridstack").grid.nodes.filter(function(e){ells=e.el,e.y==n+1&&$(t).data("gridstack").move(ells,generateRtlPos(e).x,n)});for(;!$(t).data("gridstack").isAreaEmpty(r,n,a.width,a.height)&&(r!=a.x||a.y!=n)&&++r!=renderGridOptions.width;);i.x=r,i.y=n,$(t).data("gridstack").move(e,i.x,i.y)}),$(t).data("gridstack").commit())});var a=[];$(e).find("table[id^=gridHd]").length>0?$(e).find("table[id^=gridHd]").each(function(){a.push("#"+this.id)}):a.push(e),$(a).each(function(){if("design"==theMode){var e=$("table"+this+" th:first:visible, "+this+" table th:first:visible").height();clearHiddenGridstack(this,!0),$("table"+this+" th, "+this+" table th").resizable({handles:"e",minHeight:e,maxHeight:e,minWidth:40,resize:function(e,t){$(".grid-stack").addClass("dirty");var a="0";try{a=$(t)[0].element.parents("[id^=colScroll]").attr("id").substr(9)}catch(i){}1==$("#ckbGridStretch"+a).prop("checked")&&($("#ckbGridStretch"+a).prop("checked",!1),toggleGridStretch(a)),changeStatus("notSaved");var r=$(this).closest("table").css("width").replace("px","")-$(this).outerWidth()+t.size.width;$(this).css({width:t.size.width,"min-width":t.size.width}),$(this).closest("table").attr("style","width:"+r+"px")}})}else clearHiddenGridstack(this,!0),$("table"+this+" th, "+this+" table th").find(".ui-resizable-handle").length&&$("table"+this+" th, "+this+" table th").resizable("destroy")}),isMobile||CompressMode(compressedMode),toggleWizardDCOption("undefined"!=typeof designObj&&"undefined"!=typeof designObj[0]&&"undefined"!=typeof designObj[0].wizardDC&&designObj[0].wizardDC),changeDesignLayout("undefined"!=typeof designObj&&"undefined"!=typeof designObj[0]&&"undefined"!=typeof designObj[0].selectedLayout?designObj[0].selectedLayout:"default"),designLayoutProperties(),dynamicMobileResolution()}function unBindEvents(){$("#wBdr").find("input:not(.grdButtons .newgridbtn .tgl-ios),textarea").each(function(){$(this).prop("disabled",!0)}),$("#wBdr").find(".fa-paperclip").css("pointer-events","none"),$("#wBdr").find(".divImgBorder").css("pointer-events","none"),$("#wBdr").find("select").each(function(){$(this).parent().prepend('<div class="selectOverLay"></div>'),$(this).prop("disabled",!0)}),axInlineGridEdit||$("[id^=wrapperForEditFields]").removeClass("hide"),$("button[id^=gridAddBtn]").removeAttr("onclick").addClass("disabled"),$(".grdButtons,.newgridbtn button[id^=gridAddBtn]").removeAttr("onclick").addClass("disabled"),$("li[onclick*='javascript:FillGrid']").removeAttr("onclick").addClass("disabled"),$(".grdButtons,.newgridbtn li button").addClass("disabled").prop("disabled",!0),$(".editLayoutFooter button").removeAttr("onclick").addClass("disabled").prop("disabled",!0).attr("type","button"),$(".toolbardiv").addClass("disableToolIcon"),$(".editLayoutFooter").hide(),$("#wBdr [id^=divDc] tbody tr").hide()}function unionSets(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.reduce(function(e,t){return new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)))},new Set)}function clearHiddenGridstack(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],a=(e=e.concat()).startsWith("divDc")?parseInt(e.substr(5),10):e.startsWith("sp")?parseInt(e.substr(e.lastIndexOf("F")+1),10):e.startsWith("#gridHd")?parseInt(e.substr(7),10):e.startsWith("#tab-")?parseInt(e.substr(5),10):0;e=e.startsWith("#")?e.substr(1):e;try{if(null==designObj[0].dcLayout||"default"==designObj[0].dcLayout)var i=designObj[0].dcs.filter(function(e){return e.dc_id==a})[0];else i=designObj[0].newdcs.filter(function(e){return e.dc_id==a})[0]}catch(p){}if("True"==DCIsGrid[a-1]&&axInlineGridEdit&&"design"==theMode&&$("#wrapperForEditFields"+a).hide(),$.isEmptyObject(designObj))jsonText="";else try{compressedMode=designObj[0].compressedMode,isMobile||(staticRunMode="undefined"!=typeof designObj[0].staticRunMode&&designObj[0].staticRunMode);var r="axp_recid"+a,n={},l=new Set;if(t){if("design"==theMode&&$("#titleCkbGridStretch"+a).length<=0){var d;d='<div><span class="setTitle"><span id="titleCkbGridStretch'+a+'" for="usr">Stretch Grid Columns<i tabindex="-1" class="icon-arrows-question ui-draggable ui-draggable-handle" id="ico_cl'+a+'" data-trigger="hover" data-toggle="popover" data-content="Stretch and Preview Grid Columns" data-placement="right" data-original-title="" title=""></i></span></span><a href="javascript:void(0)" class="swtchDummyAnchr"><input class="tgl tgl-ios" name="optWrap" id="ckbGridStretch'+a+'" type="checkbox"><label class="tgl-btn togglecustom toggle_btn gridStretch" for="ckbGridStretch'+a+'" id="lblCkbGridStretch'+a+'" onclick="toggleGridStretch(\''+a+"')\"></label></a></div>",0!=$("#divDc"+a).find("#containerDc").find(".grdButtons").length?$("#divDc"+a).find("#containerDc").find(".grdButtons").find("ul.left").prepend(d):$("#divDc"+a).find("#containerDc").parent().prev(".newgridbtn").find("ul").prepend(d)}var s=0;i.tableDesign.filter(function(e,t){if("undefined"==typeof e.visibility&&(e.visibility=!0),!e.fld_id)return e.visibility;var i="";if(i=e.fld_id.startsWith("uniqueEditDeleteAct")||e.fld_id.startsWith("uniqueThHead")?"#"+e.fld_id:"#th-"+e.fld_id,$(i).parents("#divDc"+a).length)if(e.visibility)$(i).css("width",e.width),s+=parseInt(e.width);else if("render"==theMode){$(i).parents(".griddivColumn").find("thead th"+i).addClass("none").hide().attr("data-grid-visible",!1);var r="";try{var n=$(i).parents(".griddivColumn").find("tbody tr:eq(0)").attr("id");r=n.substr(n.lastIndexOf("F")-3,3)+"F"+a}catch(p){}if(i.startsWith("#uniqueThHead"))$(i).parents(".griddivColumn").find("tbody tr td label[id^=lblSlNo]").parent("td").hide();else if(i.startsWith("#uniqueEditDeleteAct"))$(i).parents(".griddivColumn").find("tbody tr td .gridEditDeleteBtns").parent("td").hide();else{var l=$(i).parents(".griddivColumn").find("tbody tr:eq(0) td").index($("[id^="+e.fld_id+r+"]").parents("tr:eq(0) td"));$(i).parents(".griddivColumn").find("tbody tr td:nth-child("+(l+1)+")").hide()}}return!e.visibility}),0!==s&&$(".wrapperForGridData"+a+" table").css("width",s+"px"),1==i.gridStretch&&(toggleGridStretch(a,!0,"firstLoad"),$("#ckbGridStretch"+a).prop("checked",!0))}else{var o="",c=0;i.fieldsDesign.filter(function(t,d){t=generateRtlPos(t);try{var s=i.fieldsDesign.filter(function(e){return e.y>=t.y&&e.y<=t.y+t.height-1});l.has(t.y)||s[0].fld_id!=t.fld_id||(l=unionSets(l,new Set(_.map(s,"y"))),n=s[0])}catch(p){}if("undefined"==typeof t.visibility&&(t.visibility=!0),t.fld_id.startsWith("uniqueEditDeleteAct")||t.fld_id.startsWith("uniqueThHead")?colID="#"+t.fld_id:colID="#th-"+t.fld_id,"T"==i.isGrid){if($(colID).length<1)return!1;try{var u="";try{var f=$(colID).parents(".griddivColumn").find("tbody tr:eq(0)").attr("id");u=f.substr(f.lastIndexOf("F")-3,3)+"F"+a}catch(p){}var h=$(colID).parents(".griddivColumn").find("tbody tr:eq(0) td").index($("[id^="+t.fld_id+u+"]").parents("tr:eq(0) td"));$(colID).endsWith("_image")&&-1!=h&&-1==c&&(h=-1),c=h;var v=$("#th-"+r).parents(".griddivColumn").find("tbody tr:eq(0) td").index($("[id^="+r+u+"]").parents("tr:eq(0) td"));axInlineGridEdit||axInlineGridEdit||"form"==AxpGridForm||i.dc_id!=a||!$(colID).parents("#divDc"+a).length||($("#th-"+r).after($(colID).detach()),$("#th-"+r).parents(".griddivColumn").find("tbody tr").each(function(){var e=$(this).find("td:nth-child("+(h+1)+")").detach();$(this).find("td:nth-child("+(v+(h<v?0:1))+")").after(e)}))}catch(p){}r=""+t.fld_id}var m="height",g="height",b=compressedMode?"compressedMode":"normalMode";if("render"==theMode&&!staticRunMode){var w=gsiPixels(t.height);if(m={height:w.toString()+"px"},g={height:w+gsConf[b].labelHeight+"px"},o!==t.y){var F=o;o=t.y;try{""!==F&&n!={}&&n.fld_id==t.fld_id&&($("div#"+e).append('<div class="clearfix"></div>'),n={})}catch(p){}}}if(t.visibility)if($("#"+e).data("gridstack"))if("T"==i.isGrid){x=$("#dvGrid"+t.fld_id);$("#"+e).data("gridstack").move(x,t.x,t.y),$("#"+e).data("gridstack").resize(x,t.width,t.height),x.find(".form-control").css(m),applyGridStackCalcHeight(x.find("textarea.gridstackCalc, div.divImgBorder, input[type=button].hotbtn.btn"),t,m,g)}else{x=$("#dv"+t.fld_id).parents(".grid-stack-item");$("#"+e).data("gridstack").move(x,t.x,t.y),$("#"+e).data("gridstack").resize(x,t.width,t.height),x.find(".form-control").css(m),applyGridStackCalcHeight(x.find("textarea.gridstackCalc, div.divImgBorder, input[type=button].hotbtn.btn"),t,m,g)}else"T"==i.isGrid?(!$("#"+e).hasClass("inEditMode")&&i.dc_id==a&&$("#dvGrid"+t.fld_id).parents("#divDc"+a).length&&(axInlineGridEdit||axInlineGridEdit||"form"==AxpGridForm||$("#"+e).append($("#dvGrid"+t.fld_id).detach())),(x=$("#dvGrid"+t.fld_id)).attr({"data-gs-x":t.x,"data-gs-y":t.y,"data-gs-width":t.width,"data-gs-height":t.height}),x.find(".form-control").css(m),applyGridStackCalcHeight(x.find("textarea.gridstackCalc, div.divImgBorder, input[type=button].hotbtn.btn"),t,m,g)):(!$("#"+e).hasClass("inEditMode")&&i.dc_id==a&&$("#dv"+t.fld_id).parents("#divDc"+a).length&&$("#"+e).append($("#dv"+t.fld_id).parents(".grid-stack-item").detach()),(x=$("#dv"+t.fld_id).parents(".grid-stack-item")).attr({"data-gs-x":t.x,"data-gs-y":t.y,"data-gs-width":t.width,"data-gs-height":t.height}),x.find(".form-control").css(m),applyGridStackCalcHeight(x.find("textarea.gridstackCalc, div.divImgBorder, input[type=button].hotbtn.btn"),t,m,g));else if("render"==theMode)$("#"+e).data("gridstack")?"T"==i.isGrid?($("#"+e).data("gridstack").removeWidget($("#dvGrid"+t.fld_id),!1),$("#dvGrid"+t.fld_id).hide().removeClass("grid-stack-item").attr("data-pop-visible",!1)):($("#"+e).data("gridstack").removeWidget($("#dv"+t.fld_id).parents(".grid-stack-item"),!1),$("#dv"+t.fld_id).parents(".grid-stack-item").hide().removeClass("grid-stack-item")):"T"==i.isGrid?$("#dvGrid"+t.fld_id).removeClass("grid-stack-item").hide().attr("data-pop-visible",!1):$("#dv"+t.fld_id).parents(".grid-stack-item").removeClass("grid-stack-item").hide();else if("T"==i.isGrid){if(!$("#dvGrid"+t.fld_id+".grid-stack-item").length){var x=$("#dvGrid"+t.fld_id);$("#"+e).data("gridstack").addWidget(x.show(),t.x,t.y,t.width,t.height),x.find(".form-control").css(m),applyGridStackCalcHeight(x.find("textarea.gridstackCalc, div.divImgBorder, input[type=button].hotbtn.btn"),t,m,g)}$("#dvGrid"+t.fld_id+".grid-stack-item").addClass("designHidden").find(".grid-stack-item-content").css("background-color","rgba(101, 97, 97, 0.4)")}else{if(!$("#dv"+t.fld_id).parents(".grid-stack-item").length){var x=$("#dv"+t.fld_id).parents("[id^=randomID]");$("#"+e).data("gridstack").addWidget(x.show(),t.x,t.y,t.width,t.height),x.find(".form-control").css(m),applyGridStackCalcHeight(x.find("textarea.gridstackCalc, div.divImgBorder, input[type=button].hotbtn.btn"),t,m,g)}$("#dv"+t.fld_id).parents(".grid-stack-item").addClass("designHidden").find(".grid-stack-item-content").css("background-color","rgba(101, 97, 97, 0.4)")}return!t.visibility})}}catch(p){}}function generateRtlPos(e){return(e=_objectSpread({},e)).x="ar"==gllangType?renderGridOptions.width-1-e.x-(e.width-1):e.x,e}function toggleStaticRunMode(){$(".grid-stack").addClass("dirty"),changeStatus("notSaved")}function goToDesignMode(){if(!AxIsTstructLocked){var e=0!=$("#breadcrumb-panel").length?$("#breadcrumb-panel").get(0).outerHTML:"";e+=0!=$("#tstToolBarBtn").length?"*@*"+$("#tstToolBarBtn").get(0).outerHTML:"*@*",e+=0!=$("#wbdrHtml").length?"*@*"+$("#wbdrHtml").get(0).outerHTML:"*@*",$("#dvFooter").length>0&&(e+=0!=$("#dvFooter").length?$("#dvFooter").get(0).outerHTML:""),callParentNew("tstructCustomHTML=",e),window.location.href="tstruct.aspx"+window.location.search.replace(/&theMode=design/g,"")+"&theMode=design"}}function DesignFormDcLayouts(){var e='<div class="container-fluid designTstruct-layout"><div class="row">';e+='<div class="column col-sm-12 col-md-3 col-lg-3 '.concat("default"==dcLayoutType?"active":"",'" onclick="setActiveDesignLayout(this);" data-layout="default"><div class="card "><span class="material-icons active-icon">check_circle</span><h4 class="layout-title">Default</h4><span class="layout-info"><span class="material-icons layout-info-icon">info</span>Drag&Drop and Resize</span><span class="material-icons layout-icon">assignment</span></div></div>'),e+='<div class="column col-sm-12 col-md-3 col-lg-3 '.concat("single"==dcLayoutType?"active":"",'" onclick="setActiveDesignLayout(this);" data-layout="single"><div class="card "><span class="material-icons active-icon">check_circle</span><h4 class="layout-title">Single Column</h4><span class="layout-info"><span class="material-icons layout-info-icon">info</span>No Drag&Drop and Resize</span><span class="material-icons layout-icon">table_rows</span></div></div>'),e+='<div class="column col-sm-12 col-md-3 col-lg-3 '.concat("double"==dcLayoutType?"active":"",'" onclick="setActiveDesignLayout(this);" data-layout="double"><div class="card "><span class="material-icons active-icon">check_circle</span><h4 class="layout-title">Double Column</h4><span class="layout-info"><span class="material-icons layout-info-icon">info</span>No Drag&Drop and Resize</span><span class="material-icons layout-icon">window</span></div></div>'),e+='<div class="column col-sm-12 col-md-3 col-lg-3 '.concat("triple"==dcLayoutType?"active":"",'" onclick="setActiveDesignLayout(this);" data-layout="triple"><div class="card "><span class="material-icons active-icon">check_circle</span><h4 class="layout-title">Triple Column</h4><span class="layout-info"><span class="material-icons layout-info-icon">info</span>No Drag&Drop and Resize</span><span class="material-icons layout-icon">grid_on</span></div></div>'),e+="</div></div>",displayBootstrapModalDialog("DC Layouts","md","200px","",e)}function setActiveDesignLayout(e){$(".column").removeClass("active"),$(e).addClass("active"),dcLayoutType=$(e).attr("data-layout"),isDcLayoutSelected=!0,SavePublishDesignerJSONWeb(!1)}function AddFormLabel(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";$("#designContextMenu").css({display:"none"}),$("#designContextMenuLabelEdit").css({display:"none"});var t="";if(""!=e){var a=JSON.parse(formLabelJSON);$.each(a,function(i,r){a[i].id!=e||(t=a[i].name)})}var i='<div class="container-fluid"><div class="row">';i+='<div class="column col-sm-12 col-md-12 col-lg-12"><textarea id="txtlblcaption" class="form-control" rows="2" style="resize: none;">'+t+"</textarea></div>",i+="</div>",i+="</div>";var r='<div class="modal-footer"><button id="btnlcOk" title="Ok" value="Ok" class="hotbtn btn" onclick="AddFormLabelCaption(\'label\',\''+e+"');\">Ok</button></div>";displayBootstrapModalDialog("Caption","sm","50px","",i,!1,function(){$(".modal-content").append(r)})}function AddFormLabelCaption(e,t){var a=$("#txtlblcaption").val();if(""==t){var i=$("#designContextMenu").attr("data-affld"),r=0;r=$j.inArray(i,FNames)>-1?GetDcNo(i):i.slice(5);var n=$(".gridstackCalc.formLabel").length+1;""!=formLabelJSON&&"[]"!=formLabelJSON?formLabelJSON=formLabelJSON.replace("}]",'},{"ftype":"'+e+'","id":"userFormLabel'+n+'","dc":"'+r+'","afterField":"'+i+'","name":"'+a+'","fontFamilly":"","fontFamillyCode":"","hyperlinkJson":""}]'):formLabelJSON='[{"ftype":"'+e+'","id":"userFormLabel'+n+'","dc":"'+r+'","afterField":"'+i+'","name":"'+a+'","fontFamilly":"","fontFamillyCode":"","hyperlinkJson":""}]'}else{var l=JSON.parse(formLabelJSON);$.each(l,function(e,i){l[e].id!=t||(l[e].name=a)}),formLabelJSON=JSON.stringify(l)}SavePublishDesignerJSONWeb(!1)}function ChangeFontAndColor(e,t){var a=[];"label"==t?(a=JSON.parse(formLabelJSON),jQuery.grep(a,function(t){if(t.id===e)return a=t})):buttonFieldFontJSON.length>0&&(a=JSON.parse(buttonFieldFontJSON),jQuery.grep(a,function(t){if(t.id===e)return a=t})),$("#designContextMenu").css({display:"none"}),$("#designContextMenuLabelEdit").css({display:"none"}),loadAndCall({files:{css:["/ThirdParty/seballot-spectrum/spectrum.css","/Css/fontColorPicker.min.css?v=2"],js:["/ThirdParty/seballot-spectrum/spectrum.js","/Js/fontColorPicker.js?v=1"]},callBack:function(){$("#designlblFontPicker").remove(),$("#designContextMenuLabelEdit").append('<input type="text" id="designlblFontPicker" style="display:none;" data-value="'+a.fontFamillyCode+'" class="form-control" value="'+a.fontFamillyCode+'" />');$("#designlblFontPicker").val();(new PropertySheet).generateFontPicker($("#designlblFontPicker")),setTimeout(function(){$("#filterBtn #btnFilter").hide(),$("#filterBtn").append('<input type="button" name="btnFilterReturn" value="Ok" onclick="callBackFontPicker(\''+e+"','"+t+'\')" id="btnFilterReturn" title="Ok" class="hotbtn btn handCursor allow-enter-key" style="">')},300)}})}function callBackFontPicker(e,t){var a,i,r,n,l,d,s,o,c=$("#fontPickerSampleText").attr("style"),p="[".concat((new PropertySheet).fontPickerObj.fontFamily,",").concat((null===(a=(new PropertySheet).fontPickerObj.Bold)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:i.toLowerCase())||"f",",").concat((null===(r=(new PropertySheet).fontPickerObj.Italic)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:n.toLowerCase())||"f",",").concat((null===(l=(new PropertySheet).fontPickerObj.Underline)||void 0===l?void 0:null===(d=l[0])||void 0===d?void 0:d.toLowerCase())||"f",",").concat((new PropertySheet).fontPickerObj.fontColor,",").concat((null===(s=(new PropertySheet).fontPickerObj.Strikeout)||void 0===s?void 0:null===(o=s[0])||void 0===o?void 0:o.toLowerCase())||"f",",").concat((new PropertySheet).fontPickerObj.fontSize,"]");if(this.fontPickerObj={},(new IviewBuilder).closeModalDialog(),c=c.replace(/"/g,""),"label"==t){var u=JSON.parse(formLabelJSON);$.each(u,function(t,a){if(u[t].id==e)return u[t].fontFamilly=c,void(u[t].fontFamillyCode=p)}),formLabelJSON=JSON.stringify(u)}else{var f=!1;if(buttonFieldFontJSON.length>0){var h=JSON.parse(buttonFieldFontJSON);$.each(h,function(t,a){if(h[t].id==e)return f=!0,h[t].fontFamilly=c,void(h[t].fontFamillyCode=p)}),buttonFieldFontJSON=JSON.stringify(h)}0==f&&(""!=buttonFieldFontJSON&&"[]"!=buttonFieldFontJSON?buttonFieldFontJSON=buttonFieldFontJSON.replace("}]",'},{"ftype":"'+t+'","id":"'+e+'","fontFamilly":"'+c+'","fontFamillyCode":"'+p+'","hyperlinkJson":""}]'):buttonFieldFontJSON='[{"ftype":"'+t+'","id":"'+e+'","fontFamilly":"'+c+'","fontFamillyCode":"'+p+'","hyperlinkJson":""}]')}SavePublishDesignerJSONWeb(!1)}function LabelHyperlink(e,t){var a=[];"label"==t?(a=JSON.parse(formLabelJSON),jQuery.grep(a,function(t){if(t.id===e)return a=t})):buttonFieldFontJSON.length>0&&(a=JSON.parse(buttonFieldFontJSON),jQuery.grep(a,function(t){if(t.id===e)return a=t})),$("#designContextMenu").css({display:"none"}),$("#designContextMenuLabelEdit").css({display:"none"});var i="";"undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson&&(i=JSON.parse(a.hyperlinkJson));var r='<div class="container-fluid"><div class="row">';if(r+='<div class="form-group col-sm-12 col-md-12 col-lg-12"><div class="col-sm-2 col-md-2 col-lg-2"><span>Name</span></div><div class="col-sm-4 col-md-4 col-lg-4">',"undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson?r+='<input type="textbox" id="txtHlName" class="form-control" value="'+i.name+'" readonly/>':r+='<input type="textbox" id="txtHlName" class="form-control"/>',r+="</div></div>",r+='<div class="form-group col-sm-12 col-md-12 col-lg-12"><div class="col-sm-2 col-md-2 col-lg-2"><span>Type</span></div><div class="col-sm-4 col-md-4 col-lg-4">',r+='<select name="ddlHlType" id="ddlHlType" class="form-control" onchange="labelHyperlinkType(this);" value="'+("undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson?i.type:"")+'">\n  <option value=""></option>\n        <option value="tstruct">tstruct</option>\n  <option value="iview">iview</option>\n  <option value="page">page</option>\n</select></div><div class="col-sm-2 col-md-2 col-lg-2"><span>Structure Name</span></div><div class="col-sm-4 col-md-4 col-lg-4"><select name="ddlStructName" id="ddlStructName" class="form-control" onchange="labelHyperlinkStructName(this);" value="'+("undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson?i.structName:"")+'"></select></div></div>',r+='<div class="form-group col-sm-12 col-md-12 col-lg-12"><div class="col-sm-2 col-md-2 col-lg-2"></div><div class="col-sm-4 col-md-4 col-lg-4"><input type="checkbox" class="" id="chkpivtst" '+("undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson&&"true"==i.ivtstpopup?"checked":"")+'> Popup iview/tstruct</input></div><div class="col-sm-4 col-md-4 col-lg-4"><input type="checkbox" class="" id="refreshparent" '+("undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson&&"true"==i.refreshparent?"checked":"")+"> Refresh parent on close</input></div></div>",r+='<div class="form-group col-sm-12 col-md-12 col-lg-12"><div class="col-sm-2 col-md-2 col-lg-2"></div><div class="col-sm-4 col-md-4 col-lg-4"><input type="radio" name="hyperlnikradio" value="load" '+("undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson&&"load"==i.loadType?"checked":"")+'> Load</input></div><div class="col-sm-4 col-md-4 col-lg-4"><input type="radio" name="hyperlnikradio" value="open" '+("undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson&&"open"==i.loadType?"checked":"")+"> Open</input></div></div>",r+='<div class="form-group col-sm-12 col-md-12 col-lg-12"><table class="table table-bordered designTableHyperlink">\n  <thead> \n    <tr>\n        <th class="col-fit"></th>\n        <th>Param Name</th>\n        <th>Value</th>\n    </tr>\n  </thead>\n  <tbody>',"undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson&&""!=i.paramNode){var n=i.paramNode.split("^");$.each(n,function(e,t){var a=e+1,i=t.split("~");r+='<tr><td><input type="checkbox" name="chkHlParam"></td><td><select name="ddlParamName'+a+'" id="ddlParamName'+a+'" class="form-control" value="'+i[0]+'"></select></td><td><input type="textbox" id="txtValue'+a+'" class="form-control" value="'+i[1]+'"/></td></tr>'})}else r+='<tr>\n        <td><input type="checkbox" name="chkHlParam"></td>\n        <td><select name="ddlParamName1" id="ddlParamName1" class="form-control"></select></td>\n        <td><input type="textbox" id="txtValue1" class="form-control"/></td>\n    </tr>';r+="</tbody></table></div>",r+='<div class="form-group col-sm-12 col-md-12 col-lg-12">\n    <button id="btnHlAdd" class="cardStyle designTableBtns" onclick="hlAddParam();"><span class="material-icons designTableIcons">add</span></button>\n    <button id="btnHlDelete" class="cardStyle designTableBtns" onclick="hlDeleteParam();"><span class="material-icons designTableIcons">delete</span></button>\n    <button id="btnlcOk" title="Ok" value="Ok" class="hotbtn btn pull-right" onclick="callBackHyperlink(\''+e+"','"+t+'\')">Ok</button>\n    <button id="btnlcDel" title="Delete Hyperlink" value="Delete" class="coldbtn btn pull-right hide" onclick="callBackHyperlinkDelete(\''.concat(e,"','").concat(t,"')\">Delete</button>\n    </div>"),r+="</div></div>",displayBootstrapModalDialog("Hyperlink","sm","400px","",r,"","undefined"!=typeof a.hyperlinkJson&&""!=a.hyperlinkJson?labelHyperlinkOnLoad():"")}function labelHyperlinkOnLoad(){setTimeout(function(){var e=$("#ddlHlType").attr("value");if(void 0!==e&&""!=e){$("#ddlHlType").val(e);var t=$("#ddlStructName").attr("value");labelHyperlinkType($("#ddlHlType"),t)}$("#btnlcDel").removeClass("hide")},300)}function hlAddParam(){$(".designTableHyperlink tbody tr:last");var e=$(".designTableHyperlink tbody tr:last").find("select").attr("id");e=e.replace("ddlParamName",""),e=parseInt(e)+1,$(".designTableHyperlink tbody").append('<tr>\n        <td><input type="checkbox" name="chkHlParam"></td>\n        <td><select name="ddlParamName'+e+'" id="ddlParamName'+e+'" class="form-control"></select></td>\n        <td><input type="textbox" id="txtValue'+e+'" class="form-control"/></td>\n    </tr>');var t=$("#ddlParamName1 > option").clone();$("#ddlParamName"+e).append(t)}function hlDeleteParam(){$(".designTableHyperlink tbody tr").filter(":has(:checkbox:checked)").remove(),0==$(".designTableHyperlink tbody tr").length&&$(".designTableHyperlink tbody").append('<tr><td><input type="checkbox" name="chkHlParam"></td><td><select name="ddlParamName1" id="ddlParamName1" class="form-control"></select></td><td><input type="textbox" id="txtValue1" class="form-control"/></td></tr>')}function callBackHyperlink(e,t){var a=$("#txtHlName").val();if(""!=a){var i=$("#ddlHlType").val();if(""!=i){var r=$("#ddlStructName").val();if(""!=r){var n=$("#chkpivtst").prop("checked"),l=$("#refreshparent").prop("checked"),d=void 0!==$('input[name="hyperlnikradio"]:checked').val()?$('input[name="hyperlnikradio"]:checked').val():"open",s="";$(".designTableHyperlink tbody tr").each(function(e,t){null!=$(t).find("select").val()&&""!=$(t).find("select").val()&&(s+=$(t).find("select").val(),s+="~"+$(t).find("input[type=textbox]").val()+"^")}),""!=s&&(s=s.slice(0,-1));var o='{"name":"'+a+'","type":"'+i+'","structName":"'+r+'","ivtstpopup":"'+n+'","refreshparent":"'+l+'","loadType":"'+d+'","paramNode":"'+s+'"}';if("label"==t){var c=JSON.parse(formLabelJSON);$.each(c,function(t,a){c[t].id!=e||(c[t].hyperlinkJson=o)}),formLabelJSON=JSON.stringify(c)}else{var p=!1;if(""!=buttonFieldFontJSON&&"[]"!=buttonFieldFontJSON&&buttonFieldFontJSON.length>0){var u=JSON.parse(buttonFieldFontJSON);$.each(u,function(t,a){if(u[t].id==e)return p=!0,void(u[t].hyperlinkJson=o)}),buttonFieldFontJSON=JSON.stringify(u)}if(0==p){""!=buttonFieldFontJSON&&"[]"!=buttonFieldFontJSON?buttonFieldFontJSON=buttonFieldFontJSON.replace("}]",'},{"ftype":"'+t+'","id":"'+e+'","fontFamilly":"","fontFamillyCode":"","hyperlinkJson":""}]'):buttonFieldFontJSON='[{"ftype":"'+t+'","id":"'+e+'","fontFamilly":"","fontFamillyCode":"","hyperlinkJson":""}]';var f=JSON.parse(buttonFieldFontJSON);$.each(f,function(t,a){f[t].id!=e||(f[t].hyperlinkJson=o)}),buttonFieldFontJSON=JSON.stringify(f)}}SavePublishDesignerJSONWeb(!1)}else showAlertDialog("warning","Structure Name should not be empty.")}else showAlertDialog("warning","Type should not be empty.")}else showAlertDialog("warning","Name should not be empty.")}function callBackHyperlinkDelete(e,t){var a=JSON.parse("label"==t?formLabelJSON:buttonFieldFontJSON);$.each(a,function(t,i){a[t].id!=e||(a[t].hyperlinkJson="")}),"label"==t?formLabelJSON=JSON.stringify(a):buttonFieldFontJSON=JSON.stringify(a),SavePublishDesignerJSONWeb(!1)}function labelHyperlinkStructName(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",a=$("#ddlHlType").val(),i=$(e).val();if(""!=i&&"page"!=a)try{$.ajax({url:"tstruct.aspx/GetLabelHlStrParams",type:"POST",cache:!1,async:!0,data:JSON.stringify({StrType:a,StructName:i}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var a=JSON.parse(e.d);if(""!=a&&""!=a.result.row){var i=[];i.push('<option value=""></option>'),$.each(a.result.row,function(e,t){""==(null==t?void 0:t.name)&&""==(null==t?void 0:t.pname)||i.push('<option value="'.concat((null==t?void 0:t.pname)||(null==t?void 0:t.name),'">').concat((null==t?void 0:t.pname)||(null==t?void 0:t.caption),"</option>"))}),$(".designTableHyperlink tbody tr").each(function(e,a){if($(a).find("select").empty().append(i.join("")),""!=t){var r=$(a).find("select").attr("value");void 0!==r&&""!=r&&$(a).find("select").val(r)}})}}else jsonVal=""},error:function(e){}})}catch(r){}}function labelHyperlinkType(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",a="",i=$(e).val();if(""!=i){""==t&&($(".designTableHyperlink tbody tr").remove(),$(".designTableHyperlink tbody").append('<tr><td><input type="checkbox" name="chkHlParam"></td><td><select name="ddlParamName1" id="ddlParamName1" class="form-control"></select></td><td><input type="textbox" id="txtValue1" class="form-control"/></td></tr>')),"page"==i?($("#chkpivtst,#refreshparent").prop("disabled",!0),$('input[name="hyperlnikradio"]').prop("disabled",!0),$("#ddlParamName1").prop("disabled",!0),$("#txtValue1").prop("disabled",!0),$("#btnHlAdd").removeAttr("onclick"),$("#btnHlDelete").removeAttr("onclick")):($("#chkpivtst,#refreshparent").prop("disabled",!1),$('input[name="hyperlnikradio"]').prop("disabled",!1),$("#ddlParamName1").prop("disabled",!1),$("#txtValue1").prop("disabled",!1),$("#btnHlAdd").attr("onclick")==undefined&&($("#btnHlAdd").attr("onclick","hlAddParam();"),$("#btnHlDelete").attr("onclick","hlDeleteParam();")));try{$.ajax({url:"tstruct.aspx/GetLabelHlStructures",type:"POST",cache:!1,async:!0,data:JSON.stringify({StrType:i}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var i=JSON.parse(e.d);if(""!=i&&""!=i.result.row){var r=[];r.push('<option value=""></option>'),$.each(i.result.row,function(e,t){""!=t.name&&r.push('<option value="'+t.name+'">'+t.caption+"</option>")}),$("#ddlStructName").empty().html(r.join("")),""!=t&&($("#ddlStructName").val(t),"page"!=$("#ddlHlType").val()&&labelHyperlinkStructName($("#ddlStructName"),t))}a="done"}else a="error"},error:function(e){a="error"}})}catch(r){a="error"}}else{$("#ddlStructName").html([].join("")),a="done"}return a}function RemoveLabelHyperlink(e){var t=JSON.parse(formLabelJSON);jQuery(t).each(function(a){if(t[a].id==e)return t.splice(a,1),!1}),formLabelJSON=JSON.stringify(t),SavePublishDesignerJSONWeb(!1)}function customTstHtml(){displayBootstrapModalDialog("Custom HTML","lg","370px",!0,"./tstructhtml.aspx",!0)}function goToRenderMode(){checkIfFormChanges(),isFormChange?confirmOnAction():window.location.href="tstruct.aspx"+window.location.search.replace(/&theMode=design/g,"")}function toggleDesignModeWBDR(e){"undefined"!=typeof isWizardTstruct&&isWizardTstruct&&"render"==theMode?goToDesignMode():("design"==theMode?theMode="render":theMode="design",setDesignedLayout("#wBdr",e))}function toggleCompressedMode(e){$(".grid-stack").addClass("dirty"),changeStatus("notSaved");designChanged=!0,$("#A5").removeClass("disableToolIcon"),1==$("#ckbCompressedMode").prop("checked")?($("#ckbCompressedMode").prop("checked",!1),$("#wBdr").find(".grid-stack").each(function(e,t){$(t).data("gridstack").cellHeight(gsConf.normalMode.cellHeight,!1),$(t).data("gridstack").verticalMargin(gsConf.normalMode.verticalMargin,!1)}),$("link[href='../Css/compressedTstruct.min.css?v=36']").length>0&&$('link[rel=stylesheet][href~="../Css/compressedTstruct.min.css?v=36"]').remove()):($("#ckbCompressedMode").prop("checked",!0),$("#wBdr").find(".grid-stack").each(function(e,t){$(t).data("gridstack").cellHeight(gsConf.compressedMode.cellHeight,!1),$(t).data("gridstack").verticalMargin(gsConf.compressedMode.verticalMargin,!1)}),1!=$("link[href='../Css/compressedTstruct.min.css?v=36']").length&&$("head").append($('<link rel="stylesheet" type="text/css" />').attr("href","../Css/compressedTstruct.min.css?v=36"))),SetGridElementsHeight()}function toggleWizardDCOption(e){$(".grid-stack").addClass("dirty"),1==$("#ckbWizardDC").prop("checked")||"undefined"!=e&&0==e?$("#ckbWizardDC").prop("checked",!1):$("#ckbWizardDC").prop("checked",!0)}function changeDesignLayout(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";e?($("#designLayoutSelector").val(e),"tile"==e&&$(".tileLayoutDiv").outerWidth(!0)<=renderGridOptions.minWidth&&$(".grid-stack").addClass("grid-stack-one-column-mode")):$(".grid-stack").addClass("dirty")}function designLayoutProperties(){"undefined"!=typeof designObj&&"undefined"!=typeof designObj[0]&&(designObj[0].compressedMode?($("#designControlHeightSelector").val(null==designObj[0].selectedControlHeight?"24":designObj[0].selectedControlHeight),$("#designControlHeightValue").val(null==designObj[0].selectedControlHeight?"24":designObj[0].selectedControlHeight)):($("#designControlHeightSelector").val(null==designObj[0].selectedControlHeight?"28":designObj[0].selectedControlHeight),$("#designControlHeightValue").val(null==designObj[0].selectedControlHeight?"28":designObj[0].selectedControlHeight)),$("#designForntSizeSelector").val(null==designObj[0].selectedFontSize?"14":designObj[0].selectedFontSize),$("#designForntSizeValue").val(null==designObj[0].selectedFontSize?"14":designObj[0].selectedFontSize),$("#designFormWidthSelector").val(null==designObj[0].formWidth?"100":designObj[0].formWidth),$("#designFormWidthValue").val(null==designObj[0].formWidth?"100":designObj[0].formWidth),$("#designFormAlignmentSelector").val(null==designObj[0].formAlignment?"default":designObj[0].formAlignment),$("#designFieldCaptionWidthSelector").val(null==designObj[0].fieldCaptionWidth?"30":designObj[0].fieldCaptionWidth),$("#designFieldCaptionWidthValue").val(null==designObj[0].fieldCaptionWidth?"30":designObj[0].fieldCaptionWidth),dcLayoutType=null==designObj[0].dcLayout?"default":designObj[0].dcLayout,formLabelJSON=null==designObj[0].formLabel?[]:JSON.stringify(designObj[0].formLabel),buttonFieldFontJSON=null==designObj[0].buttonFieldFont?[]:JSON.stringify(designObj[0].buttonFieldFont))}function applyGridStackCalcHeight(e,t,a,i){if("design"!=theMode){var r=compressedMode?"compressedMode":"normalMode",n=gsiPixels(t.height);({height:n.toString()+"px"}),i={height:n+gsConf[r].labelHeight+"px"},"undefined"!=typeof CKEDITOR.instances[$(e).attr("id")]?CKEDITOR.instances[$(e).attr("id")].on("instanceReady",function(){this.resize("100%",n)}):e.parent().css(i)}}function gsiPixels(e){var t=compressedMode?"compressedMode":"normalMode";return parseInt(e*gsConf[t].cellHeight+(e-1)*gsConf[t].verticalMargin-gsConf[t].labelHeight,10)}function getDesignerJSON(){var e="";if(this.form_serialized_data=_.map($("#wBdr"),function(t){this.dc_serialized_data=_.map($(".grid-stack"),function(t){t=$(t),dc_id=$(t).attr("id"),e=t.parents(".grid-icons").length>0?"T":"F";var a=0,i=0,r=1,n=!1,l=designGridOptions.width;this.serialized_data=_.map($("#"+dc_id+" > .grid-stack-item"),function(t){var d=(t=$(t)).data("_gridstack_node");if("single"==dcLayoutType&&"F"==e){d.width=l;var s=d.height;s!=r&&1!=r&&(i+=r-1),r=s,d.y=i,i++}else if("double"==dcLayoutType&&"F"==e)if(d.width=l/2,0==a){d.x=0;var o=d.height;o!=r&&1!=r?(i+=r-1,n=!0):(r=o,n=!1),d.y=i,a++}else{d.x=l/2;var c=d.height;n?(r=c,n=!1):c>r&&(r=c),d.y=i,i++,a=0}else if("triple"==dcLayoutType&&"F"==e)if(d.width=l/3,0==a){d.x=0;var p=d.height;p!=r&&1!=r?(i+=r-1,n=!0):(r=p,n=!1),d.y=i,a++}else if(1==a){d.x=l/3;var u=d.height;u>r&&(r=u),d.y=i,a++}else{d.x=l/3*2;var f=d.height;n?(r=f,n=!1):f>r&&(r=f),d.y=i,i++,a=0}return d=generateRtlPos(d),{fld_id:"F"==e?$(t).find("div[id]").attr("id").substr(2):$(t).attr("id").substr(6),x:d.x,y:d.y,width:d.width,height:d.height,visibility:!t.hasClass("designHidden")}},this),this.serialized_data_table=_.map($("#"+dc_id).parents(".grid-icons").next(".griddivColumn").children("table:eq(0)").find("th:not(.hide)"),function(e,t){(e=$(e)).attr("r_link");if(void 0!==$(e).attr("id"))return{fld_id:$(e).attr("id").startsWith("th-")?$(e).attr("id").substr(3):$(e).attr("id"),width:parseInt($(e).outerWidth(!0),10),visibility:!(1==e.hasClass("designHidden")?e.hasClass("designHidden"):"none"==e.css("display"))}},this);var d=this.serialized_data.length?GridStackUI.Utils.sort(this.serialized_data):null,s=this.serialized_data_table.length?this.serialized_data_table:null;return dc_id=dc_id.startsWith("divDc")?dc_id.substr(5):dc_id.substr(dc_id.lastIndexOf("F")+1),{dc_id:dc_id,isGrid:e,gridStretch:$("#ckbGridStretch"+dc_id).is(":checked"),fieldsDesign:d,tableDesign:s}},this);var a="undefined"==typeof dcLayoutType||""==dcLayoutType||"default"==dcLayoutType?1==isDcLayoutSelected?designObj[0].dcs:this.dc_serialized_data:designObj[0].dcs,i="undefined"!=typeof dcLayoutType&&""!=dcLayoutType&&"default"!=dcLayoutType?this.dc_serialized_data:designObj[0].newdcs;return{transid:transid,compressedMode:$("#ckbCompressedMode").is(":checked"),newDesign:!0,staticRunMode:$("#ckbStaticRunMode").prop("checked"),wizardDC:$("#ckbWizardDC").prop("checked"),selectedLayout:$("#designLayoutSelector").val(),selectedFontSize:$("#designForntSizeSelector").val(),selectedControlHeight:$("#designControlHeightSelector").val(),tstUpdatedOn:"undefined"!=typeof tstructUpdateOn?tstructUpdateOn:"",dcLayout:"undefined"!=typeof dcLayoutType&&""!=dcLayoutType?dcLayoutType:"default",formWidth:$("#designFormWidthSelector").val(),formAlignment:$("#designFormAlignmentSelector").val(),fieldCaptionWidth:$("#designFieldCaptionWidthSelector").val(),formLabel:"undefined"!=typeof formLabelJSON&&""!=formLabelJSON?JSON.parse(formLabelJSON):[],buttonFieldFont:"undefined"!=typeof buttonFieldFontJSON&&""!=buttonFieldFontJSON?JSON.parse(buttonFieldFontJSON):[],dcs:a,newdcs:i}},this),""==dcLayoutType||"default"==dcLayoutType){var t=form_serialized_data[0].dcs.map(function(e,t){return e.dc_id}),a=[];try{null!=designObj[0].dcs&&(a=designObj[0].dcs.filter(function(e,a){if(-1==t.indexOf(e.dc_id))return!0}))}catch(i){}form_serialized_data[0].dcs=_.sortBy([].concat(_toConsumableArray(form_serialized_data[0].dcs),_toConsumableArray(a)),"dc_id")}else{t=form_serialized_data[0].newdcs.map(function(e,t){return e.dc_id}),a=[];try{null!=designObj[0].newdcs&&(a=designObj[0].newdcs.filter(function(e,a){if(-1==t.indexOf(e.dc_id))return!0}))}catch(i){}form_serialized_data[0].newdcs=_.sortBy([].concat(_toConsumableArray(form_serialized_data[0].newdcs),_toConsumableArray(a)),"dc_id")}return JSON.stringify(this.form_serialized_data,null,"")}function SaveDesignerJSON(){var e=getDesignerJSON(),t=$("#SaveID").val();$("#PublishID").val();if(checkIfFormChanges(),isFormChange){$("#designModeToolbar").css("pointer-events","none"),$(".grid-stack").removeClass("dirty");var a=primaryApiSettings();a.url=callParentNew("nodeApi")+"setLayoutSave",a.data.transid=transid.toLowerCase(),a.data.module="TSTRUCT",a.data.content=e,t!=undefined&&t.length>0?(a.data.design_id=t,a.data.type="UPDATE"):a.data.type="SAVE",$.ajax(a).done(function(e){if($("#designModeToolbar").css("pointer-events",""),1==e.status){t=e.data,$("#IsPublish").val("N");$("#IsPublish").val();$("#SaveID").attr("value",t),$("#PublishDesign").css("opacity","1.0"),changeStatus("save"),showAlertDialog("success",DesigntstructMessages.designSaved)}else showAlertDialog("error",e.errMsg),valSessByApi(e)}).fail(function(e,t,a){$("#designModeToolbar").css("pointer-events",""),showAlertDialog("error",DesigntstructMessages.designSaveFailed)})}else showAlertDialog("warning",DesigntstructMessages.noModification)}function SaveDesignerJSONWeb(){var e=getDesignerJSON(),t=$("#SaveID").val();$("#PublishID").val();if(checkIfFormChanges(),isFormChange){$("#designModeToolbar").css("pointer-events","none"),$(".grid-stack").removeClass("dirty");try{$.ajax({url:"tstruct.aspx/SavePublishDesign",type:"POST",cache:!1,async:!0,data:JSON.stringify({Transid:transid,DesignType:"SAVE",Content:e,SavedId:""}),dataType:"json",contentType:"application/json",success:function(e){if($("#designModeToolbar").css("pointer-events",""),""!=e.d){t=e.d,$("#IsPublish").val("N");$("#IsPublish").val();$("#SaveID").attr("value",t),$("#PublishDesign").css("opacity","1.0"),changeStatus("save"),showAlertDialog("success",DesigntstructMessages.designSaved)}else showAlertDialog("error","Error while save design.")},error:function(e){$("#designModeToolbar").css("pointer-events",""),showAlertDialog("error",e)}})}catch(a){$("#designModeToolbar").css("pointer-events",""),showAlertDialog("error",a.message)}}else showAlertDialog("warning",DesigntstructMessages.noModification)}function PublishDesignerJSON(){if(checkIfFormChanges(),isFormChange)showAlertDialog("warning",DesigntstructMessages.saveBeforePublish);else if("Y"!=$("#IsPublish").val()){var e=$("#SaveID").val(),t=$("#PublishID").val();$("#designModeToolbar").css("pointer-events","none");var a=primaryApiSettings();a.url=callParentNew("nodeApi")+"setLayoutPublish",a.data.transid=transid.toLowerCase(),a.data.design_id=e,t!=undefined&&t.length>0&&(a.data.type="UPDATE"),$.ajax(a).done(function(a){if($("#designModeToolbar").css("pointer-events",""),1==a.status){showAlertDialog("success",DesigntstructMessages.designPublished),t=a.data,$("#PublishID").val(t),changeStatus("published"),$("#IsPublish").val("Y");var i=$("#IsPublish").val();$("#designModeToolbar").css("pointer-events","none"),ASB.WebService.SetSavedAndPublishedID(transid,"",e,t,i,function(e,t){$("#designModeToolbar").css("pointer-events","")},function(e){$("#designModeToolbar").css("pointer-events","")})}else showAlertDialog("error",a.errMsg),valSessByApi(a)}).fail(function(e,t,a){$("#designModeToolbar").css("pointer-events",""),showAlertDialog("error",DesigntstructMessages.designPublisgFailed)})}else showAlertDialog("warning",DesigntstructMessages.noModification)}function PublishDesignerJSONWeb(){if(checkIfFormChanges(),isFormChange)showAlertDialog("warning",DesigntstructMessages.saveBeforePublish);else if("Y"!=$("#IsPublish").val()){var e=$("#SaveID").val(),t=$("#PublishID").val();$("#designModeToolbar").css("pointer-events","none"),$.ajax({url:"tstruct.aspx/SavePublishDesign",type:"POST",cache:!1,async:!0,data:JSON.stringify({Transid:transid,DesignType:"PUBLISH",Content:"",SavedId:e}),dataType:"json",contentType:"application/json",success:function(e){$("#designModeToolbar").css("pointer-events",""),""!=e.d?(showAlertDialog("success",DesigntstructMessages.designPublished),t=e.d,$("#PublishID").val(t),changeStatus("published"),$("#IsPublish").val("Y")):showAlertDialog("error","Saved data not found.")},error:function(e){$("#designModeToolbar").css("pointer-events",""),showAlertDialog("error",DesigntstructMessages.designPublisgFailed)}})}else showAlertDialog("warning",DesigntstructMessages.noModification)}function SavePublishDesignerJSON(){var e=getDesignerJSON(),t=$("#SaveID").val(),a=$("#PublishID").val();if(checkIfFormChanges(),isFormChange){$("#designModeToolbar").css("pointer-events","none"),$(".grid-stack").removeClass("dirty");var i=primaryApiSettings();i.url=callParentNew("nodeApi")+"setLayoutSave",i.data.transid=transid.toLowerCase(),i.data.module="TSTRUCT",i.data.content=e,t!=undefined&&t.length>0?(i.data.design_id=t,i.data.type="UPDATE"):i.data.type="SAVE",$.ajax(i).done(function(i){if($("#designModeToolbar").css("pointer-events",""),1==i.status){t=i.data,$("#SaveID").attr("value",t);var r=primaryApiSettings();r.url=callParentNew("nodeApi")+"setLayoutPublish",r.data.transid=transid.toLowerCase(),r.data.design_id=t,a!=undefined&&a.length>0&&(r.data.type="UPDATE"),$.ajax(r).done(function(i){if(1==i.status){showAlertDialog("success",DesigntstructMessages.designSaved),a=i.data,$("#PublishID").val(a),$("#designModeToolbar").css("pointer-events","none"),$("#IsPublish").val("Y");var r=$("#IsPublish").val();ASB.WebService.SetSavedAndPublishedID(transid,e,t,a,r,function(e,t){$("#designModeToolbar").css("pointer-events","")},function(e){$("#designModeToolbar").css("pointer-events","")}),window.location.href="tstruct.aspx"+window.location.search.replace(/&theMode=design/g,"")}else showAlertDialog("error",i.errMsg),valSessByApi(i)}).fail(function(e,t,a){showAlertDialog("error",DesigntstructMessages.designPublisgFailed)})}else showAlertDialog("error",i.errMsg),valSessByApi(i)}).fail(function(e,t,a){$("#designModeToolbar").css("pointer-events",""),showAlertDialog("error",DesigntstructMessages.designSaveFailed)})}else showAlertDialog("warning",DesigntstructMessages.noModification)}function SavePublishDesignerJSONWeb(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0],t=getDesignerJSON(),a=$("#SaveID").val(),i=$("#PublishID").val();checkIfFormChanges(),isFormChange?($("#designModeToolbar").css("pointer-events","none"),$(".grid-stack").removeClass("dirty"),$.ajax({url:"tstruct.aspx/SavePublishDesign",type:"POST",cache:!1,async:!0,data:JSON.stringify({Transid:transid,DesignType:"SAVEPUBLISH",Content:t,SavedId:a}),dataType:"json",contentType:"application/json",success:function(t){if($("#designModeToolbar").css("pointer-events",""),""!=t.d)if(a=t.d.split("~")[0],i=t.d.split("~")[1],$("#SaveID").attr("value",a),e&&showAlertDialog("success",DesigntstructMessages.designSaved),$("#PublishID").val(i),$("#IsPublish").val("Y"),e)callParentNew("closeRemodalPopup()","function");else{var r=window.location.href;r=r.split("#")[0],window.location.href=r}else showAlertDialog("error","Error while save & publish design.")},error:function(e){$("#designModeToolbar").css("pointer-events",""),showAlertDialog("error",e)}})):showAlertDialog("warning",DesigntstructMessages.noModification)}function resetButtonClicked(){var SavedId=$("#SaveID").val(),PublishId=$("#PublishID").val(),ConfirmReset=$.confirm({title:eval(callParent("lcm[155]")),animation:"scale",closeAnimation:"scale",animateFromElement:!1,onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .hotbtn").focus()},backgroundDismiss:"false",escapeKey:"cancel",content:eval(callParent("lcm[373]")),buttons:{confirm:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){ConfirmReset.close(),$("#designModeToolbar").css("pointer-events","none");var e=primaryApiSettings();e.url=callParentNew("nodeApi")+"deleteLayout",e.data.transid=transid.toLowerCase(),e.data.design_id=SavedId,PublishId!=undefined&&(e.data.p_design_id=PublishId),$.ajax(e).done(function(e){if($("#designModeToolbar").css("pointer-events",""),1==e.status){ShowDimmer(!0),SavedId="",$("#SaveID").val(SavedId),PublishId="",$("#PublishID").val(PublishId),$("#designModeToolbar").css("pointer-events","none"),$("#IsPublish").val("N");var t=$("#IsPublish").val();ASB.WebService.SetSavedAndPublishedID(transid,"",SavedId,PublishId,t,function(e,t){$("#designModeToolbar").css("pointer-events","")},function(e){$("#designModeToolbar").css("pointer-events","")}),showAlertDialog("success",DesigntstructMessages.resetSuccess),goToDesignMode()}else 500===e.statusCode?showAlertDialog("warning",DesigntstructMessages.alredayreset):(showAlertDialog("error",e.errMsg),valSessByApi(e))}).fail(function(e,t,a){showAlertDialog("error",DesigntstructMessages.resetfailed)})}},cancel:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy"),parent.actionsClicked=""}}}})}function ResetButtonClickedWeb(){var SavedId=$("#SaveID").val(),PublishId=$("#PublishID").val(),Savetype="RESET",ConfirmReset=$.confirm({title:eval(callParent("lcm[155]")),animation:"scale",closeAnimation:"scale",animateFromElement:!1,onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .hotbtn").focus()},backgroundDismiss:"false",escapeKey:"cancel",content:eval(callParent("lcm[373]")),buttons:{confirm:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){ConfirmReset.close(),$("#designModeToolbar").css("pointer-events","none"),$.ajax({url:"tstruct.aspx/SavePublishDesign",type:"POST",cache:!1,async:!0,data:JSON.stringify({Transid:transid,DesignType:Savetype,Content:"",SavedId:SavedId}),dataType:"json",contentType:"application/json",success:function(e){$("#designModeToolbar").css("pointer-events",""),"reseted"==e.d?(ShowDimmer(!0),SavedId="",$("#SaveID").val(SavedId),PublishId="",$("#PublishID").val(PublishId),$("#IsPublish").val("N"),showAlertDialog("success",DesigntstructMessages.resetSuccess),goToDesignMode()):"500"===e.d?showAlertDialog("warning",DesigntstructMessages.alredayreset):showAlertDialog("error","Error while reset design.")},error:function(e){showAlertDialog("error",DesigntstructMessages.resetfailed)}})}},cancel:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy"),parent.actionsClicked=""}}}})}function setSelectedDesignElement(e){selectedDesignObject.elem=e,selectedDesignObject.parentElemId=$(selectedDesignObject.elem).parents(".tstructDesignMode").attr("id"),selectedDesignObject.isColumnDesigner=$(selectedDesignObject.elem).parents(".tstructDesignMode").is($("div[id^=colScroll]")),selectedDesignObject.isGrid=!(!selectedDesignObject.parentElemId.startsWith("sp")&&!selectedDesignObject.isColumnDesigner),selectedDesignObject.isGrid?($("#showTheField").css("opacity","1"),$("#hideTheField").css("opacity","1")):(!selectedDesignObject.isGrid&&$(selectedDesignObject.elem).hasClass("designHidden")?$("#showTheField").css("opacity","1"):$("#showTheField").css("opacity","0.5"),$("#hideTheField").css("opacity","0.5")),$(".ui-resizable").find(".thhead").css({border:"","border-right":""}),$(".grid-stack-item").find(".grid-stack-item-content").css("border",""),selectedDesignObject.isColumnDesigner?$($(selectedDesignObject.elem).find(".thhead").css("border","1px solid red")):$(selectedDesignObject.elem).find(".grid-stack-item-content.ui-draggable-handle").css("border","1px solid red")}function showHideGridStackField(e){(selectedDesignObject.isGrid||$(selectedDesignObject.elem).hasClass("designHidden"))&&($(".grid-stack").addClass("dirty"),changeStatus("notSaved"),"hide"==e?($(selectedDesignObject.elem).addClass("designHidden").find(".grid-stack-item-content").css("background-color","rgba(101, 97, 97, 0.4)"),$(selectedDesignObject.elem).is("th")&&0==$(selectedDesignObject.elem).find(".designHiddenTR").length&&$(selectedDesignObject.elem).append('<div class="designHiddenTR"></div>')):(!selectedDesignObject.isGrid&&$(selectedDesignObject.elem).hasClass("designHidden")&&$("#showTheField").css("opacity","0.5"),$(selectedDesignObject.elem).removeClass("designHidden").find(".grid-stack-item-content").css("background-color",""),$(selectedDesignObject.elem).is("th")&&$(selectedDesignObject.elem).find(".designHiddenTR").remove()))}var multiSelectID="",draftTimer="";function OnTstructLoad(){StartTime=(new Date).getTime();var e=new Date;0==isLoadDataCall&&setListviewButtons(),allRtfTextAreas(),AxAllowCancel=!0,SetMRForFromList(AxFromLstFlds),jsonText=$j("#designHidden").val();try{designObj=JSON.parse(jsonText),$.isEmptyObject(designObj)&&(jsonText="")}catch(c){jsonText=""}var t="";if("string"==typeof LoadResult){t=(t=LoadResult).replace(new RegExp("&quot;","g"),"'");try{UpdateDefaultDcRows(),AxAllowCancel=!0;var a=$("#hdnTabHtml").val();$("#hdnTabHtml").val(""),a!=undefined&&""!=a&&(AssignTabDcHtmlPerf(a),a="",DCFrameNo.forEach(function(e){"True"==DCIsGrid[e-1]&&(SetRows(e,"","d*","LoadData"),navValidator=!0,ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array),SetFormDirty(!1)})),"design"!=theMode?("undefined"!=typeof wsPerfFormLoadCall&&wsPerfFormLoadCall?AssignLoadValues(t,"LoadData"):AssignWsPerfExprValues("LoadData"),"0"==recordid&&(axInlineGridEdit||!axInlineGridEdit&&"form"==AxpGridForm)&&DCFrameNo.forEach(function(e){if("True"==DCIsGrid[e-1]){var t=!1;if("undefined"!=typeof wsPerfFGDcName&&-1!=jQuery.inArray("dc"+e,wsPerfFGDcName)&&(t=!0),0==t){var a=GetDcClientRows(e).getMaxVal();if(0==a||"001"==a){gridDummyRows=!0,a="001",axInlineGridEdit||"form"!=AxpGridForm?editTheRow("",e,a,"event"):editTheRow("",e,"",event),gridDummyRowVal.push(e+"~"+a),gridDummyRows=!1;try{AxAfterAddRow(e,a)}catch(c){}}}}})):AssignLoadValuesDesignMode(t,"LoadData"),DisplayImages(),closeParentFrame()}catch(c){AxWaitCursor(!1),$j("div#wBdr").show(),ShowDimmer(!1),showAlertDialog("error",c.message)}ShowHideNexPrev()}if(setDesignedLayout("#wBdr"),window.opener&&("List IView"==window.opener.document.title||"Iview"==window.opener.document.title)&&$j(".listview").length>0&&($j(".listview").parent().hide(),$j(".backbutton").length>0&&$j(".backbutton").children().hide()),SetBackForwardButtonProp(enableForwardButton,enableBackButton),LoadResult="",t="","Approved"==appstatus||"Rejected"==appstatus||AxExecFormControl||"design"==theMode||DoFormControlOnload(),AssignGridScript(),window.parent.enableDraft&&EnableDraftFeature(),$j(".flddis").length>0&&$j(".flddis").each(function(){"textarea"!=$j(this)[0].type&&($j(".flddis").prop("disabled")||$j(".flddis").prop("disabled",!0))}),"true"==AxLogTimeTaken){var i=(new Date).getTime()-e.getTime();AxStartTime=GetAxDate(AxStartTime),CreateTimeLog(AxStartTime,"0",i,ASBTotal,ASBDbTime,"TstructLoad")}if(DisableFileUplDSignFld(),$j.inArray("axp_refreshDcs",FNames)>-1){var r=$j('[id*="axp_refreshDcs"]').val();if(r!=undefined&&""!=r)for(var n=r.split(";"),l=0;l<n.length;l++)arrRefreshDcs.push(n[l].substring(0,n[l].indexOf("~"))),arrRefreshFlds.push(n[l].substring(n[l].indexOf("~")+1)),arrRefreshFldDirty.push(!1)}if(ParseJSON(),"0"!=recordid){applyFontListView=!0;for(l=0;l<DCFrameNo.length;l++)EvaluateSetFont(DCFrameNo[l]);applyFontListView=!1}for(l=0;l<DCFrameNo.length;l++)"false"==DCAllowChange[l].toLowerCase()&&disableDC(DCFrameNo[l]);SetDynamicDcCaptions(),"True"==isTstPop&&TstructTabEventsInPopUP(""),AxWaitCursor(!1),"TRUE"==isTstPop.toUpperCase()&&$("a#design").click(function(){openTstDesign()}),$(".lblgridactn").html(appGlobalVarsObject.lcm[301]),$(".lblcleargrid").html(appGlobalVarsObject.lcm[302]),$(".gridAddRow").html(appGlobalVarsObject.lcm[477]),$(".lblExportGrid").html(appGlobalVarsObject.lcm[486]).attr("title",appGlobalVarsObject.lcm[486]);var d=GetExactFieldName("axp_save_draft"),s=$("input[id^='"+d+"']:eq(0)");s.length;s.length>0&&GetFieldValue(s.attr("id")).toLowerCase(),"Y"==$("#IsPublish").val()?($("#PublishDesign").css("opacity","0.5"),changeStatus("published")):"N"==$("#IsPublish").val()&&($("#PublishDesign").css("opacity","1.0"),changeStatus("save")),customAlignTstructFlds(VisibleDCs),"undefined"!=typeof theModeDesign&&"false"==theModeDesign&&$("#icons").css("display","block");var o=(new Date).getTime()-StartTime;console.log("Get Structure & Form load:"+formLogTime+" ms"),console.log("Page Load Postback:"+pageLogTime+" ms"),console.log("JQuery Load:"+o+" ms"),FieldTypeOnLoad()}function customAlignTstructFlds(e,t,a){var i=$("#hdnFldAlgnProp").val();if(""!=i)try{var r=JSON.parse(i);$.each(r,function(i,r){var n=GetDcNo(r.fldName);if(-1!=e.indexOf(n)||t!=undefined)if(IsDcGrid(n)){var l=0;if(a!=undefined&&t==n)(s=$j("#"+r.fldName+GetClientRowNo(a,n)+"F"+n)).length>0&&(s.css("text-align",r.alignProp).closest(".edit-mode-content, .grid-stack-item").addClass("btextDir-"+("left"==r.alignProp?"ltr":"rtl")),s.is("select")&&s.css("direction","left"==r.alignProp?"ltr":"rtl"));else if(t!=undefined||-1!=e.indexOf(n)){l=GetDcRowCount(n);for(var d=1;d<=l;d++){(s=$j("#"+r.fldName+GetClientRowNo(d,n)+"F"+n)).length>0&&(s.css("text-align",r.alignProp).closest(".edit-mode-content, .grid-stack-item").addClass("btextDir-"+("left"==r.alignProp?"ltr":"rtl")),s.is("select")&&s.css("direction","left"==r.alignProp?"ltr":"rtl"))}}}else if(!IsDcGrid(n)){var s;if(-1!=e.indexOf(n)||t==n)(s=$("#"+GetComponentName(r.fldName,n))).length>0&&(s.css("text-align",r.alignProp).closest(".grid-stack-item").addClass("btextDir-"+("left"==r.alignProp?"ltr":"rtl")),s.is("select")&&s.css("direction","left"==r.alignProp?"ltr":"rtl"))}})}catch(n){console.warn(n.message)}}function AssignGridScript(){for(var e=0;e<VisibleDCs.length;e++){var t=$j.inArray(VisibleDCs[e],DCFrameNo);-1!=t&&"true"==DCIsGrid[t].toLowerCase()&&AssignGrdFreezeHdrScript(VisibleDCs[e])}}function SetMRForFromList(e){if(e&&""!=e)for(var t=e.split(","),a=0;a<t.length;a++)""!=t[a]&&MasterRow.push(t[a].toString())}function UpdateDefaultDcRows(){for(var e=0;e<DCFrameNo.length;e++)"true"==DCIsGrid[e].toLowerCase()&&UpdateDcRowArrays(DCFrameNo[e],"001","Add")}function DisplayImages(){for(var e=0;e<imgNames.length;e++){var t=GetComponentName(imgNames[e],""),a=$j("#"+t),i=imgSrc[e].toString(),r=(i=i.replace(new RegExp(";bkslh","g"),"/")).split("/"),n=$j("#hdnScriptsUrlpath");n.length>0&&(i=n.val()+"axpert/"+sid+"/"+imgNames[e].toString()+"/"+r[r.length-1]),a&&(a.attr("src",i),UpdateFieldArray(t,"0",r[r.length-1],"parent","LoadData"),navValidator=!0,SetFormDirty(!1))}}var fldObjHighlt="";function MainFocus(e){if("true"==$j("#HdnAxAdvPickSearch").val()&&window.chrome)$j("#HdnAxAdvPickSearch").val("false");else{e.hasClass("fldmultiSelectInput")||$(".dropdown-mul").removeClass("active");var t=e.attr("id");if(t!=undefined){var a=GetFieldsName(t),i=$j.inArray(a,FNames),r=GetFieldsDcNo(t),n=GetFieldsRowNo(t);if(fldObjHighlt=e,IsDcGrid(r)){var l=$("#"+t).parents("td").prevAll(":visible:first");$j(l).find("select").hasClass("fldmultiSelect")&&"absolute"==$j(l).find(".edit-mode-content").css("position")&&($j(l).find(".edit-mode-content").css("position",""),$j(l).find(".edit-mode-content").css("width",""),$j(l).find(".edit-mode-content").css("left","")),CheckGrdisplayHead(r,a,n)}var d=GetFieldType(a,i),s=GetFieldValue(t);AxActiveField=a,AxActiveFieldIndex=i,AxActiveRowNo=GetDbRowNo(n,r),AxActiveDc=r,TstructHasPop&&IsDcParentGrid(r)&&(AxActivePRow=AxActiveRowNo,AxActivePDc=AxActiveDc),IsDcGrid(r)&&CheckGrdisplayHead(r,a,n),"Numeric"==d?NumericFldOnfocus(e,s):"Date/Time"==d&&e.val()==dateString?e.val(""):"Text"==d&&IsDcGrid(r),AxDoBlur=!0,ShowTooltip(a,e),FldOldValue=s;try{if("ad__d"==transid&&"tablename000F1"==t){var o=GetFieldValue(t);dctableOnChange=""!=o?o:dctableOnChange}if("datawidth000F1"==t){var c=GetFieldValue(t);fldDataWidthChange=""!=c?c:fldDataWidthChange}}catch(p){}0==AxFromAssociated?"radio"==e.attr("type")?AxOldValue="":AxOldValue=s:AxFromAssociated=!1,DoFormControl(t),""==s&&HidePLDiv(!1),"undefined"!=typeof axpShowKeyboard&&"false"==axpShowKeyboard&&isMobile&&""!=t&&$("#"+t).hasClass("fldAutocomplete")&&!$("#"+t).hasClass("custmAutoSelect")&&($("#"+t).addClass("custmAutoSelect"),$("#"+t).parent().find(".autoClickddl").click());try{AxAfterMainFocus(t)}catch(u){}}isMobile||e.select()}}function BeforeBlurdateAutoGenerator(e){var t=e.attr("id"),a=GetFieldsName(t),i=$j.inArray(a,FNames);"Date/Time"==GetFieldType(a,i)&&(e.hasClass("dtRoundLast")?dateAutoGenerator(e,"true"):e.hasClass("dtRoundStart")&&dateAutoGenerator(e,"false"))}function MainBlur(fldObj){if(isAutoComSelected!=undefined&&0==isAutoComSelected||fldObj.hasClass("autoComSelWithTab")){var fldId=fldObj.attr("id");return $("#"+fldId).val(""),isAutoComSelWithTab=!1,void(isAutoComSelected=!0)}if(!fldObj.hasClass("multiFldChk")||!fldObj.attr("data-separator"))if($(fldObj).data("preventBlur"))$(fldObj).data("preventBlur",!1);else{BeforeBlurdateAutoGenerator(fldObj);try{AxBeforeBlur(fldObj)}catch(ex){}fldObj.hasClass("token-input")&&(fldObj=fldObj.siblings("input[data-type=checkbox]"));var fldId=fldObj.attr("id"),newFldValue="",fName=GetFieldsName(fldId),fldIndex=$j.inArray(fName,FNames),fldType=GetFieldType(fName,fldIndex),fieldID=fldId,fieldRowNo=GetFieldsRowNo(fieldID),fldDcNo=GetFieldsDcNo(fieldID),fldDbRowNo=GetDbRowNo(fieldRowNo,fldDcNo);if(IsDcGrid(fldDcNo),1==AxDoBlur){if(newFldValue=GetFieldValue(fldId),"Numeric"==fldType){newFldValue=NumericFldOnBlur(newFldValue,fldIndex),SetFieldValue(fldId,newFldValue);var oldValue=removeCommas(AxOldValue),newValue=removeCommas(newFldValue);if(oldValue==newValue)return}else"Text"==fldType&&IsDcGrid(fldDcNo);if(""!=AxOldValue&&""!=newFldValue||UpdateAssignedFld(fldId),fldObj.hasClass("initCapField")){var capitalizedString=fldObj.val().toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()});fldObj.val(capitalizedString),newFldValue=capitalizedString}if("select-one"!=fldObj.attr("type")&&"select-one"!=fldObj.prop("type")||ComboFillDependents(fieldID,newFldValue),"checkbox"!=fldObj.attr("type")&&"checkbox"!=fldObj.data("type")||(AxActiveRowNo=parseInt(fieldRowNo,10),TstructHasPop&&IsDcParentGrid(fldDcNo)&&(AxActivePRow=AxActiveRowNo,AxActivePDc=AxActiveDc),IsDcGrid(fldDcNo)?AxOldValue=GetChkValue(fldId,fldObj.prop("checked")):AxOldValue=$("#"+fldId).val()),AxOldValue==newFldValue&&"checkbox"!=fldObj.attr("type")&&"checkbox"!=fldObj.data("type"))return;SetFieldValue(fldId,newFldValue,!0),AxGlobalChange=!0;var dcIndx=GetFormatGridIndex(fldDcNo);if(-1!=dcIndx&&UpdateFormatGridTotal(fName,fldDcNo,fieldRowNo,dcIndx),errorFlag||(ValidateField(fldObj,fldDbRowNo,fldIndex,fldType,AxActiveField)?errorFlag=!1:(setTimeout(function(){fldObj.focus()},0),errorFlag=!0,errorField=fldId)),TstructHasPop&&IsParentField(AxActiveField,AxActiveDc)&&(RegisterActivePRow(fieldRowNo,AxActiveDc),UpdatePopUpParents(fieldID)),1==IsPickListField(fieldID)){AxBlurAction="ForceWebService",$j("#"+fldId).hasClass("fldAutocomplete")&&(AxBlurAction="Default");var pickIdFld=$j("#pickIdVal_"+fieldID),pickVal=newFldValue;if(""!=pickIdFld.val()&&(pickVal=pickIdFld.val()+"¿"+newFldValue),"plClear"==blurNextPreventId.substring(0,7))return $j("#"+blurNextPreventId.substring(7)).val(""),void(blurNextPreventId="");UpdateFieldArray(fieldID,fldDbRowNo,pickVal,"parent")}else AxBlurAction="Default";if(1==errorFlag)return void(errorFlag=!1);if(arrRefreshDcs.length>0)for(var i=0;i<arrRefreshDcs.length;i++){var arrDcNos=arrRefreshDcs[i].split(":");if(arrDcNos[1]=="dc"+fldDcNo&&arrRefreshFlds[i].indexOf(fName)>-1){arrRefreshFldDirty[i]=!0;break}}if(AxExecFormControl=!0,DoSetDependents(fieldID),AxExecFormControl&&""==AxFldFormControl&&DoFormControl(fldId),"Numeric"==fldType){var isPositive=GetFieldProp(fldIndex,"onlyPositive");"T"==isPositive.toUpperCase()&&parseInt(newFldValue)<0&&(showAlertDialog("warning",2052,"client",FCaption[fldIndex]),fldObj.select())}if(""!=newFldValue&&"date/time"==fldType.toLowerCase()){var glCulture=eval(callParent("glCulture"));glCulture!=undefined&&"en-us"==glCulture&&(newFldValue=GetDateStr(newFldValue,"mm/dd/yyyy","dd/mm/yyyy"),UpdateFieldArray(fieldID,fldDbRowNo,newFldValue,"parent"))}}axInlineGridEdit||"form"!=AxpGridForm||formGridRowBlur(fldObj),"axcad"==transid&&("cardtype000F1"==fldId&&cardFieldsShowHideLogic(),"cardbgclr000F1"==fldId&&cardBackgroundPickerLogic()),"ad_s"==transid&&"control_type000F1"==fieldID&&"T"==newFldValue&&($("#exp_editor_fcscript000F1").parent().find(".CodeMirror .CodeMirror-sizer").css("margin-left","30px"),$("#exp_editor_fcscript000F1").parent().find(".CodeMirror .CodeMirror-linenumbers").css("width","29px"));try{AxAfterBlur(fldObj)}catch(ex){}}}function blurThis(e){$(e).data("preventBlur",!0).blur()}function ValidateField(e,t,a,i,r){if("Date/Time"==i){var n="";return e.attr("title")!=undefined&&null!=e.attr("title")&&(n=e.attr("title")),n==dateString&&""==e.val()&&e.val(dateString),ValidateDate(e)?(UpdateFieldArray(e.attr("id"),t,e.val(),"parent"),!!ValidateReservedWord(e,"value.")&&(!!ValidateFieldPattern(e,r,a)&&(!!ValidateExpression(e,a)&&!!ValidateFieldTypeExpression(e,a)))):(UpdateFieldArray(e.attr("id"),t,"","parent"),!1)}return!!ValidateReservedWord(e,"value.")&&(!!ValidateFieldPattern(e,r,a)&&(!!ValidateExpression(e,a)&&!!ValidateFieldTypeExpression(e,a)))}function ValidateReservedWord(e,t){var a="",i=e.val();return 1==e.prop("disabled")||(-1!=i.indexOf("~")||(-1!=i.indexOf("***")?a="***":-1!=i.indexOf("**")?a="**":-1!=i.indexOf("###")?a="###":-1!=i.indexOf("`")?a="`":-1!=i.indexOf("*$*")&&(a="*$*")),""==a)||(showAlertDialog("error",2053,"client",t+"^♠^"+a),e.val(""),!1)}function ValidateFieldPattern(e,t,a){var i=e.attr("id"),r=i.lastIndexOf("F"),n="";-1!=r&&(n=i.substring(0,parseInt(r,10)-3));for(var l=0;l<PatternNames.length;l++)if(n==PatternNames[l].substring(3)){if(!EvaluatePattern(i,Patterns[l],a))return!1;break}return!0}function ValidateExpression(fldObj,fldno){var flname=fldObj.attr("id"),flval=GetFieldValue(flname),setOldVal=!1,indx=parseInt(fldno,10),vexpr="";if(FldValidateExpr[indx]!=undefined&&(vexpr=FldValidateExpr[indx].toString()),vexpr!=undefined&&""!=vexpr&&flval&&(""!=flval||flval!=dateString)){var fResult=Evaluate(flname,flval,vexpr,"vexpr");if("T"!=fResult&&"t"!=fResult&&1!=fResult){var cutMsg=eval(callParent("lcm[52]")),firstChar=fResult.substring(0,1),alertMsg=fResult.substring(1);if("_"!=firstChar){if("?"==firstChar)return showAlertDialog("error",alertMsg),fldVal=GetFieldValueFromArray(flname),SetFieldValue(flname,fldVal),UpdateFieldArray(flname,dRowNo,fldVal,"parent",""),!1;if("*"==firstChar)return showAlertDialog("error",alertMsg),!1;if("MessageSetAxFont"==fResult)return!0;if(confirm(fResult+". "+cutMsg)){SetFieldValue(flname,FldOldValue);var dRowNo=GetDbRowNo(GetFieldsRowNo(flname),GetFieldsDcNo(flname));return UpdateFieldArray(flname,dRowNo,FldOldValue,"parent",""),!1}return!0}showAlertDialog("error",alertMsg)}}return!0}function GetRandnumber(e){return Math.floor(Math.pow(10,e-1)+Math.random()*(Math.pow(10,e)-Math.pow(10,e-1)-1))}function FieldTypeOnLoad(){$(".randomnum").each(function(){ValidateFieldTypeExpression($(this))})}function ValidateFieldTypeExpression(e,t){var a=e.attr("id"),i=$j("#recordid000F0").val(),r=GetFieldValue(a),n=GetDWBFieldType(GetFieldsName(a));if(r!=undefined&&""!=r&&""!=n&&"Random Number"!=n){var l=validatedwbfieldtype(r,n,a);if("T"!=l&&"t"!=l&&1!=l){SetFieldValue(a,FldOldValue);var d=GetDbRowNo(GetFieldsRowNo(a),GetFieldsDcNo(a));return UpdateFieldArray(a,d,FldOldValue,"parent",""),!1}return!0}if("Random Number"==n&&"0"==i){var s=GetRandnumber(e.attr("maxlength")!=undefined?e.attr("maxlength"):"0");SetFieldValue(a,s);d=GetDbRowNo(GetFieldsRowNo(a),GetFieldsDcNo(a));UpdateFieldArray(a,d,s,"parent","")}return!0}function validatedwbfieldtype(value,dwbfldtype,flname){var vregex="",patternErrMsg="";if(""!=dwbfldtype){var tmpFldCaption="";if(tmpFldCaption=GetFieldCaption(flname),""!=value)switch(dwbfldtype){case"Email":if(vregex="^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:.[a-zA-Z0-9-]+)*$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[53]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"URL":if(vregex="^((https?)://)?([w|W]{3}.)+[a-zA-Z0-9-.]{3,}.[a-zA-Z]{2,}(.[a-zA-Z]{2,})?$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[1044]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"IP Address":if(vregex="^[0-9]+.[0-9]+.[0-9]+.[0-9]+$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[493]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"Password":if(vregex="^(?=(.*[a-z]){3,})(?=(.*[A-Z]){2,})(?=(.*[0-9]){2,})(?=(.*[!@#$%^&*()-__+.]){1,}).{8,}$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[450]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"Web site":if(vregex="^((https?|ftp|smtp)://)?(www.)?[a-z0-9]+.[a-z]+(/[a-zA-Z0-9#]+/?)*$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[494]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"Mobile Number":if(vregex="^([+][9][1]|[9][1]|[0]){0,1}([6-9]{1})([0-9]{9})$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[495]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"Phone Number":if(vregex="^[0-9]{5,10}$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[496]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"Pin Code":if(vregex="^[1-9][0-9]{5}$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[497]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"Zip Code":if(vregex="^[0-9]{5}(?:-[0-9]{4})?$",!CheckIsvalidfield(value,vregex)){var cutMsg=eval(callParent("lcm[498]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"Random Number":default:return!0}}return""==patternErrMsg||(showAlertDialog("error",patternErrMsg),!1)}function EvaluatePattern(fld,pattrn,fldIndex){var value="";if($j("#"+fld)&&(value=$j("#"+fld).val()),value==undefined||null==value||""==value)return!0;if(""!=value){var patternErrMsg="",tmpFldCaption="";switch(tmpFldCaption=GetFieldCaption(fld,fldIndex),pattrn){case"isemail":if(!CheckAxpEmail(value)){var cutMsg=eval(callParent("lcm[53]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"isalpha":if(!CheckAlpha(value)){var cutMsg=eval(callParent("lcm[54]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"isnumeric":if(!CheckIsNumeric(value)){var cutMsg=eval(callParent("lcm[55]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"isalphanumeric":if(!CheckAlphaNumeric(value)){var cutMsg=eval(callParent("lcm[56]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;case"isphone":if(!CheckIsPhone(value)){var cutMsg=eval(callParent("lcm[57]"));patternErrMsg=(""==tmpFldCaption?tmpFldCaption:tmpFldCaption+": ")+cutMsg}break;default:return!0}}if(""==patternErrMsg)return!0;var cutMsg=eval(callParent("lcm[58]"));return!!confirm(patternErrMsg+cutMsg)&&void 0}function CheckIsPhone(e){return new RegExp("^([0-9(),-]*)$").test(e)}function CheckIsvalidfield(e,t){return new RegExp(t).test(e)}function NumericFldOnfocus(e,t){""!=t&&t.length>3&&-1!=t.indexOf(",")&&(t=removeCommas(t)),document.getElementById(e.attr("id")).select(),AxOldValue=t,e.data("attr")!=undefined&&CallSetFieldValue(e.attr("id"),e.data("attr"),"fromNumFocus"),document.getElementById(e.attr("id")).select();try{if(!$j.browser.msie)e.select(),e.mouseup(function(){return e.unbind("mouseup"),!1})}catch(a){}}function NumericFldOnBlur(e,t){var a=fixit(e,FDecimal[t]);return"T"==GetFieldProp(t,"applyComma")&&Math.abs(a)>999&&(a=CommaFormatted(a).toString()),a}function fixit(e,t){var a=e.toString();if(""==a)return 0;if("0"==a)return parseFloat(a).toFixed(t);var i=parseInt(t,10),r=a.replace(/,/g,"");return isNaN(r)?0:0==i?Math.floor(r):(r=RoundOff(r,i),parseFloat(r).toFixed(i))}function ComboFillDependents(e,t){for(var a=GetFieldsName(e),i=GetFieldsRowFrameNo(e),r=GetFieldsDcNo(e),n=GetFieldsRowNo(e),l=GetDbRowNo(n,r),d=0;d<ComboParentField.length;d++)if(ComboParentField[d]==a&&ComboParentValue[d]==t){var s=ComboDepField[d],o=GetDcNo(s),c=ComboDepValue[d].toString();if(r==o){var p=ComboDepField[d]+i;$j("#"+p).length>0&&(CallSetFieldValue(p,c),UpdateFieldArray(p,l,c,"parent",""))}else for(var u=GetDcRowCount(o),f=1;f<=u;f++){p=s+(n=GetClientRowNo(f,o))+"F"+o;$j("#"+p).length>0&&(CallSetFieldValue(p,c),UpdateFieldArray(p,f,c,"parent",""))}}}function DoSetDependents(e){var t=!1;if("True"==isRapidLoad&&defaultDepFlds!=undefined&&""!=defaultDepFlds)if("*"==defaultDepFlds.trim())t=!0;else{var a=GetFieldsName(e);defaultDepFlds.split(",").indexOf(a)>-1&&(t=!0)}"ForceWebService"==AxBlurAction?"True"!=isRapidLoad||t?GetDependents(e):CheckRapidDependency(e):"Default"==AxBlurAction&&("True"!=isRapidLoad||t?"undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?CheckDependencyPerf(e):CheckDependency(e):CheckRapidDependency(e)),"ad__d"==transid&&"tablename000F1"==e&&DcTableExecuteSql(e),"mntss"==transid&&"savenormalized000F2"==e&&fldSNExecuteSql(e),"datawidth000F1"==e&&fldWidthChange(e)}function GetFastDataFlds(e){for(var t=e.split(","),a=rSFlds.split(","),i=new Array,r="",n=0;n<t.length;n++){var l=t[n].toString().substring(1);-1!=$j.inArray(l,a)&&-1==$j.inArray(l,i)&&(""==r?r=l:r+=","+l,i.push(l))}return r}function CheckFastOrDB(e,t){var a=t.split(",");if(e!=undefined)for(var i=0;i<e.length;i++){var r=e[i].toString(),n=r.substring(0,1),l=r.substring(1);if(("s"==n||"f"==n)&&-1==$j.inArray(l,a))return""}return t}function CheckRapidDependency(e,t){AxWaitCursor(!0);var a,i=!1,r=GetFieldsName(e),n=GetFieldsDcNo(e),l=GetFieldsRowNo(e),d=GetDbRowNo(l,n),s=GetFieldValue(e),o=GetFieldIndex(r);-1!=o&&("Numeric"==GetFieldType(r,o)&&(s=removeCommas(s)));UpdateFieldArray(e,d,s,"parent");var c="",p="";-1!=o&&(c=FldRapidDeps[o].toString(),p=FldRapidDepType[o].toString()),""!=c&&(a=c.split(","));var u="";if(""!=rSFlds&&(u=CheckFastOrDB(a,u=GetFastDataFlds(c))),"c"==p){var f=FldRapidExpDeps[o].toString().split(","),h=0,v=f.length;for(h=0;h<v;h++)EvaluateAxFunction(f[h].substring(1),e)}else if("w"==p){var m,g,b,w,F,x=0,$=a.length,C=!1,A=0;for(x=0;x<$;x++)if(g=(m=a[x].toString()).substring(0,1),b=m.substring(1),w=GetFieldIndex(b),F=GetDcNo(b),"accept"!=FMoe[o].toString().toLowerCase()||b!=r||"e"!=g){if("s"==g||"f"==g){if("true"==$j("#hdnAxIsPerfCode").val()&&"accept"!=FMoe[w].toString().toLowerCase()&&"True"!=FldAutoSelect[w]&&"select"!=FMoe[w].toString().toLowerCase()&&1!=depAddCheck){IsGridField(b)?n==F&&""==GetFieldValue(e)&&SetFieldValue(b+l+"F"+F,""):""==GetFieldValue(e)&&SetFieldValue(b+"000F"+F,"");continue}if("true"==$j("#hdnAxIsPerfCode").val()&&"accept"!=FMoe[w].toString().toLowerCase()){var D="";D=IsGridField(b)?b+l+"F"+F:b+"000F"+F;var y=$j("#"+D).attr("type");if("checkbox"!=y&&"radio"!=y)continue}if(C=!1,0==IsGridField(b))C=!0;else{A=0,A=GetDcRowCount(F);for(var S=1;S<=A;S++){if(C=IsRapidParentBound(b,GetRowNoHelper(GetClientRowNo(S,F))))break}}if(C){i=!0,AxExecFormControl=!0,GetRapidDependents(k=GetDependentFieldID(r,e,l),u);break}}else"e"==g&&EvaluateAxFunction(b,e);AxExecFormControl||DoFormControl(e),i||(AxWaitCursor(!1),ShowDimmer(!1))}}else if("g"==p){if(IsFGParamChanged(r)){i=!0,AxExecFormControl=!0;var k=GetDependentFieldID(r,e,l);if("AddRow"==t)return!0;GetDependents(k)}}else"$"==p&&EvaluateDcCaption(b,e)}function IsRapidParentBound(e,t){new Array;var a=!0,i="",r=GetDcNo(e),n=GetFieldIndex(e);if(-1!=n){var l,d,s,o,c=FldRapidParents[n].toString().split(","),p="";if(""!=c)for(var u=0;u<c.length;u++){if(l=GetDcNo(c[u]),IsParDcgrid=IsGridField(c[u]),d=GetExactFieldName(c[u]),isFldOldField=!1,"old"==d.substring(0,3)&&(isFldOldField=!0),l==r||0==IsParDcgrid){if(i=0==IsParDcgrid?d+"000F"+l:d+t+"F"+l,isFldOldField&&(p="#"+i.substring(3),$j(p).length>0&&(UpdateAssignedFld(i),isFldOldField=!1)),!CheckEmptyValue(i)){a=!1;break}}else{s=GetDcClientRows(l),o=IsDcPopGrid(r);for(var f=0;f<s.length;f++)if(i=d+s[f]+"F"+l,!(o&&parseInt(s[f],10)!=AxActivePRow||(isFldOldField&&(p="#"+i.substring(3),$j(p).length>0&&(UpdateAssignedFld(i),isFldOldField=!1)),!1,CheckEmptyValue(i)))){a=!1;break}}if(!a)break}}return a}function CheckDependency(e,t){AxWaitCursor(!0);var a,i=!1,r=GetFieldsName(e),n=GetFieldsDcNo(e),l=GetFieldsRowNo(e),d=GetDbRowNo(l,n),s=GetFieldValue(e),o=GetFieldIndex(r);-1!=o&&("Numeric"==GetFieldType(r,o)&&(s=removeCommas(s)));UpdateFieldArray(e,d,s,"parent");var c="";-1!=o&&(c=FldDependents[o].toString()),""!=c&&(a=c.split(","));var p="";if(""!=rSFlds&&(p=CheckFastOrDB(a,p=GetFastDataFlds(c))),a!=undefined)for(var u=0;u<a.length;u++){var f=a[u].toString(),h=f.substring(0,1),v=f.substring(1),m=GetFieldIndex(v),g=GetDcNo(v);if("accept"!=FMoe[o].toString().toLowerCase()||v!=r||"e"!=h)if("s"==h||"f"==h){if("true"==$j("#hdnAxIsPerfCode").val()&&"accept"!=FMoe[m].toString().toLowerCase()&&"True"!=FldAutoSelect[m]&&"select"!=FMoe[m].toString().toLowerCase()&&1!=depAddCheck){IsGridField(v)?n==g&&""==GetFieldValue(e)&&SetFieldValue(v+l+"F"+g,""):""==GetFieldValue(e)&&SetFieldValue(v+"000F"+g,"");continue}var b=!1;if(0==IsGridField(v))b="true"==$j("#hdnAxIsPerfCode").val()||ISBound(v,"000");else{var w;w=GetDcRowCount(g);for(var F=1;F<=w;F++){var x=GetRowNoHelper(GetClientRowNo(F,g));if(b=ISBound(v,x))break}}if(b){if("AddRow"==t)return!0;i=!0,AxExecFormControl=!0;var $=GetDependentFieldID(r,e,l);1==depAddCheck&&(depAddCheck=!1),GetDependents($,p);break}if("AddRow"==t)return AxWaitCursor(!1),!1}else if("$"==h)EvaluateDcCaption(v,e);else if("e"==h)EvaluateAxFunction(v,e);else if("r"==h)for(var C=parseInt(GetDcRowCount(n),10),A=parseInt(1,10);A<C;A++){var D=v+GetRowNoHelper(A)+"F"+n;EvaluateAxFunction(v,D)}else{if("d"==h||"a"==h){if(i=!0,AxExecFormControl=!0,"AddRow"==t)return!0;GetDependents(e,p);break}if("g"==h&&IsFGParamChanged(r)){i=!0,AxExecFormControl=!0;$=GetDependentFieldID(r,e,l);if("AddRow"==t)return!0;GetDependents($,p);break}}}AxExecFormControl||DoFormControl(e),i||("AddRow"!=t&&ShowDimmer(!1),AxWaitCursor(!1))}function CheckDependencyPerf(fieldID,calledFrom){AxWaitCursor(!0);var isServiceCalled=!1,fieldName=GetFieldsName(fieldID),dcNo=GetFieldsDcNo(fieldID),rowNo=GetFieldsRowNo(fieldID),fldDbRowNo=GetDbRowNo(rowNo,dcNo),fldValue=GetFieldValue(fieldID),fldInd=GetFieldIndex(fieldName),depArray;if(-1!=fldInd){var fldType=GetFieldType(fieldName,fldInd);if("Numeric"==fldType&&(fldValue=removeCommas(fldValue)),"date/time"==fldType.toLowerCase()&&""!=fldValue){var glCulture=eval(callParent("glCulture"));glCulture!=undefined&&"en-us"==glCulture&&(fldValue=GetDateStr(fldValue,"mm/dd/yyyy","dd/mm/yyyy"))}}UpdateFieldArray(fieldID,fldDbRowNo,fldValue,"parent");var depStr="";-1!=fldInd&&(depStr=FldDependents[fldInd].toString()),""!=depStr&&(depArray=depStr.split(","));var isSkipSqlFillFields=!1;if(depArray!=undefined)for(var di=0;di<depArray.length;di++){var dField=depArray[di].toString(),depFirstChar=dField.substring(0,1),depfName=dField.substring(1),dfldInd=GetFieldIndex(depfName),depFldDc=GetDcNo(depfName);if("accept"!=FMoe[fldInd].toString().toLowerCase()||depfName!=fieldName||"e"!=depFirstChar)if("s"!=depFirstChar&&"f"!=depFirstChar||0!=isSkipSqlFillFields)if("$"==depFirstChar)EvaluateDcCaption(depfName,fieldID);else if("e"==depFirstChar)EvaluateAxFunction(depfName,fieldID);else if("r"==depFirstChar)for(var rcount=parseInt(GetDcRowCount(dcNo),10),cnt=parseInt(1,10);cnt<rcount;cnt++){var expObjName=depfName+GetRowNoHelper(cnt)+"F"+dcNo;EvaluateAxFunction(depfName,expObjName)}else if("a"==depFirstChar){if("AddRow"==calledFrom)return!0;if(""!=wsPerfFields&&-1!=wsPerfFields.indexOf(depfName)){isServiceCalled=!0,AxExecFormControl=!0,AxFldFormControl=fieldID,GetDependentsPerf(fieldID,"");break}}else{if("d"==depFirstChar){if(isServiceCalled=!0,AxExecFormControl=!0,AxFldFormControl=fieldID,"AddRow"==calledFrom)return!0;GetDependentsPerf(fieldID,"");break}if("g"==depFirstChar){var CallService=IsFGParamChangedPerf(fieldName,depfName,fieldID);if(CallService){isServiceCalled=!0,AxExecFormControl=!0,AxFldFormControl=fieldID;var actualFieldID=GetDependentFieldID(fieldName,fieldID,rowNo);if("AddRow"==calledFrom)return!0;GetDependentsPerf(actualFieldID,"",depfName);break}}}else{if(""==fldValue){ClearFldValues(fieldID,rowNo,dcNo,depFldDc,depfName);continue}var callService=!1;if(""!=wsPerfFields&&(-1!=wsPerfFields.indexOf(depfName)&&"AddRow"!=calledFrom?callService=ISBoundPerf(fieldName,rowNo):-1==wsPerfFields.indexOf(depfName)&&"s"==depFirstChar&&(isSkipSqlFillFields=!0)),callService){if("AddRow"==calledFrom)return!0;isServiceCalled=!0,AxExecFormControl=!0,AxFldFormControl=fieldID;var actualFieldID=GetDependentFieldID(fieldName,fieldID,rowNo);1==depAddCheck&&(depAddCheck=!1),GetDependentsPerf(actualFieldID,"",depfName);break}if("AddRow"==calledFrom)return AxWaitCursor(!1),!1}}AxExecFormControl||DoFormControl(fieldID),isServiceCalled||("AddRow"!=calledFrom&&ShowDimmer(!1),AxWaitCursor(!1))}function ClearFldValues(e,t,a,i,r){if(IsGridField(r)){if(a==i)""==GetFieldValue(e)&&(UpdateFieldArray(r+t+"F"+i,t,"","parent","AutoComplete"),SetFieldValue(r+t+"F"+i,""));else if(a!=i&&""==GetFieldValue(e))for(var n=parseInt(GetDcRowCount(i),10),l=1;l<=n;l++){var d=GetClientRowNo(l,i);UpdateFieldArray(r+d+"F"+i,d,"","parent","AutoComplete"),SetFieldValue(r+d+"F"+i,"")}}else""==GetFieldValue(e)&&(UpdateFieldArray(r+"000F"+i,"000","","parent","AutoComplete"),SetFieldValue(r+"000F"+i,""))}function GetDependentFieldID(e,t,a){var i=IsGridField(e),r=GetDcNo(e);return 0==i?e+"000F"+r:e+a+"F"+r}function GetSubGridsForParentDc(e){for(var t="",a=0;a<PopParentDCs.length;a++)PopParentDCs[a]==e&&(""==t?t=PopGridDCs[a].toString():t+=","+PopGridDCs[a].toString());return t}function GetSubGridInfoForParent(e,t){for(var a="",i=GetSubGridsForParentDc(e).split(","),r=0;r<i.length;r++){var n=GetPopRows(e,t,i[r]);""!=(n=GetDbPopRows(n,i[r]))&&(a=""==a?i[r]+"~"+n:"¿"+i[r]+"~"+n)}return a}function GetRapidDependents(e,t){AxStartTime=new Date,AxStartTime=GetAxDate(AxStartTime);var a=new Date;ShowDimmer(!0),IsService=!0;var i,r=$j("#recordid000F0").val();ArrActionLog="GetDependents-FieldId-"+e+"-Recordid-"+r;var n=traceSplitStr+"GetRapidDep-"+transid+traceSplitChar,l=GetFieldsName(e),d=GetFieldsRowNo(e),s=GetFieldsDcNo(e),o=AxActiveRowNo;""==o&&(o=0);var c,p=CheckSpecialCharsInStr(AxOldValue);AxActDepFld=e,AxActDepFldVal=GetFieldValue(e),c=GetOpenTabDcs(),$j("#dvPickList").is(":visible")&&$j("#dvPickList").hide();var u="";IsParentDc(s)&&(u=GetSubGridInfoForParent(s,d),AxSubGridRows=u);var f="";""!=AxActivePRow&&""!=AxActivePDc&&(f=AxActivePDc+"~"+AxActivePRow,AxParStrFromDep=f),i='<sqlresultset activerow="'+o+'" prow="'+AxActivePRow+'" pdc="'+AxActivePDc+'" axpapp="'+proj+'" transid="'+transid+'" recordid="'+r+'" field="'+l+'" oldvalue="'+p+'" pageno="1" pagesize="10" frameno = "'+s+'" rowno ="'+d+'" dcname="'+c+'"  sessionid="'+sid+'" trace="'+n+'" >';try{var h=$j("#hdnAxIsPerfCode").val();""!=t&&"true"==h?(AxWaitCursor(!1),ShowDimmer(!1),console.log("This is fast data field and dependency's are there in fast data"+e)):ASB.WebService.GetRapidDepFlds(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,ArrActionLog,c,i,transid,tstDataId,s,GetRowNoHelper(o),l,u,f,SuccChoicesgetDep,OnException)}catch(m){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}var v=new Date;AxTimeBefSerCall=v-a}function GetDependents(e,t){AxStartTime=new Date,AxStartTime=GetAxDate(AxStartTime);var a=new Date;ShowDimmer(!0),IsService=!0;var i,r=$j("#recordid000F0").val();ArrActionLog="GetDependents-FieldId-"+e+"-Recordid-"+r;var n=traceSplitStr+"GetDependents-"+transid+traceSplitChar,l=GetFieldsName(e),d=GetFieldsRowNo(e),s=GetFieldsDcNo(e),o=AxActiveRowNo;""==o&&(o=0),AxActDepFld=e;var c,p=CheckSpecialCharsInStr(AxOldValue);AxActDepFldVal=GetFieldValue(e),c=GetOpenTabDcs(),$j("#dvPickList").is(":visible")&&$j("#dvPickList").hide();var u="";IsParentDc(s)&&(u=GetSubGridInfoForParent(s,d),AxSubGridRows=u);var f="";""!=AxActivePRow&&""!=AxActivePDc&&(f=AxActivePDc+"~"+AxActivePRow,AxParStrFromDep=f),i='<sqlresultset activerow="'+o+'" prow="'+AxActivePRow+'" pdc="'+AxActivePDc+'" axpapp="'+proj+'" transid="'+transid+'" recordid="'+r+'" field="'+l+'" oldvalue="'+p+'" pageno="1" pagesize="10" frameno = "'+s+'" rowno ="'+d+'" dcname="'+c+'"  sessionid="'+sid+'" trace="'+n+'" >';try{var h=$j("#hdnAxIsPerfCode").val();""!=t&&"true"==h?(AxWaitCursor(!1),ShowDimmer(!1),console.log("This is fast data field and dependency's are there in fast data"+e)):(callBackFunDtls="GetDependents♠"+e+"♠"+t,ASB.WebService.GetDepFlds(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,ArrActionLog,c,i,transid,tstDataId,s,GetRowNoHelper(o),l,u,f,SuccChoicesgetDep,OnException))}catch(m){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}var v=new Date;AxTimeBefSerCall=v-a}function GetDependentsPerf(e){arguments.length>1&&arguments[1]!==undefined&&arguments[1];var t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";StartTime=(new Date).getTime(),AxStartTime=new Date,AxStartTime=GetAxDate(AxStartTime);var a=new Date;ShowDimmer(!0),IsService=!0;var i,r=$j("#recordid000F0").val();ArrActionLog="GetDependents-FieldId-"+e+"-Recordid-"+r;var n=traceSplitStr+"GetDependents-"+transid+traceSplitChar,l=GetFieldsName(e),d=GetFieldsRowNo(e),s=GetFieldsDcNo(e),o=AxActiveRowNo;""==o&&(o=0),AxActDepFld=e;var c,p=CheckSpecialCharsInStr(AxOldValue);AxActDepFldVal=GetFieldValue(e),c=GetOpenTabDcs(),$j("#dvPickList").is(":visible")&&$j("#dvPickList").hide();var u="";IsParentDc(s)&&(u=GetSubGridInfoForParent(s,d),AxSubGridRows=u);var f="";""!=AxActivePRow&&""!=AxActivePDc&&(f=AxActivePDc+"~"+AxActivePRow,AxParStrFromDep=f),IsDcGrid(s)&&isGrdEditDirty&&!axInlineGridEdit&&UpdateFieldArray(axpIsRowValid+s+d+"F"+s,GetDbRowNo(d,s),"","parent","AddRow"),i='<sqlresultset activerow="'+o+'" prow="'+AxActivePRow+'" pdc="'+AxActivePDc+'" axpapp="'+proj+'" transid="'+transid+'" recordid="'+r+'" field="'+l+'" oldvalue="'+p+'" pageno="1" pagesize="10" frameno = "'+s+'" rowno ="'+d+'" dcname="'+c+'"  sessionid="'+sid+'" trace="'+n+'" >',void 0!==t&&""!=t&&$j("[id^="+t+"]").hasClass("fldmultiSelect")&&(fldmultiSelectdep=!0);try{callBackFunDtls="GetDependents♠"+e,ASB.WebService.GetDepFldsPerf(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,RegVarFldList,ArrActionLog,c,i,transid,tstDataId,s,GetRowNoHelper(o),t,l,u,f,SuccChoicesgetDep,OnException)}catch(v){fldmultiSelectdep=!1,AxFldFormControl="",AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}var h=new Date;AxTimeBefSerCall=h-a}function OnException(e){AxFldFormControl="",fldmultiSelectdep=!1,-1===e._message.toLowerCase().indexOf("access violation")?(actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),AxWaitCursor(!1),ShowDimmer(!1),FromSave&&(FromSave=!1,EnableSaveBtn(!0)),$j("#icons").length>0&&$j("#icons").prop("disabled")&&$j("#icons").removeProp("disabled"),window.clearInterval(draftTimer),showAlertDialog("error",e._message)):(AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide())}function SuccChoicesFastDatatDep(e,t){if(!CheckSessionTimeout(e)){"addrow"!=IsFunction&&"delrow"!=IsFunction&&(ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array);var a=e.split("*$*");if(a.length>1&&"*$*"!=e){for(var i=a[0].split(","),r=0;r<i.length;r++)$j("#"+i[r]).attr("list")||1!=$j(a[1])[r].options.length?SetFieldValue(i[r],""):SetFieldValue(i[r],$j(a[1])[r].options[0].value),$j("#axlist-"+i[r]).remove();$j("#wBdr").append(a[1])}AxWaitCursor(!1),ShowDimmer(!1)}}function SuccChoicesgetDep(e,t){if(-1===e.toLowerCase().indexOf("access violation")){var a=new Date;if(ArrActionLog="",CheckSessionTimeout(e))return;if("addrow"!=IsFunction&&"delrow"!=IsFunction&&(ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array),fldmultiSelectdep=!1,AxActiveDc=GetFieldsDcNo(AxActDepFld),ParseServiceResult(e,"GetDep"),"Approved"==appstatus||"Rejected"==appstatus||AxExecFormControl?AxExecFormControl&&""!=AxFldFormControl&&(DoFormControl(AxFldFormControl),AxFldFormControl=""):DoFormControlOnload(),axInlineGridEdit){var i=GetFieldsName(AxActDepFld);if(IsGridField(i)){var r=$("#"+AxActDepFld).closest("td").attr("data-focus-index");$("#"+AxActDepFld).closest("tr").attr("last-focus-index")!=r&&(r=parseInt(r)+1),setTimeout(function(){$("#"+AxActDepFld).parents("input:eq(0),body").find("td[data-focus-index='"+r+"']").find("input").focus()},30)}}EvaluateSetFontOnGetDep(AxActDepFld);try{AxAfterGetDependents()}catch(l){}if(AxParStrFromDep="",AxDepRows=new Array,"true"==AxLogTimeTaken){var n=(new Date).getTime()-a.getTime();CreateTimeLog(AxStartTime,AxTimeBefSerCall,n,ASBTotal,ASBDbTime,"GetDependents")}AxWaitCursor(!1),ShowDimmer(!1);try{"selectflddl000F2"==AxActDepFld&&"mntss"==callParentNew("transid")&&"change"==callParentNew("actionfldflag")&&"Select From Form"==GetFieldValue(GetComponentName("modeofentry",GetDcNo("modeofentry")))&&""!=$("#mastertstructddl000F2").val()&&""!=$("#masterflddl000F2").val()&&"T"==$("#savenormalized_form000F2").val()&&customExecuteSql()}catch(l){}try{""==callBackFunDtls?(1==isPKItemSelected||$j("#"+AxActDepFld).hasClass("fldAutocomplete")||$j("#"+AxActDepFld).hasClass("fldmultiSelect")||""!=blurNextPreventId&&$("#"+blurNextPreventId).is(".editLayoutFooter button")||!$.isEmptyObject(blurNextPreventElement)&&$(blurNextPreventElement).is(".editLayoutFooter button"))&&(isPKItemSelected=!1,CallNextActionPList()):!$.isEmptyObject(blurNextPreventElement)&&($(blurNextPreventElement).is("button, a")&&!$(blurNextPreventElement).is("a.ui-state-default")||"button"==$(blurNextPreventElement).attr("type")||"submit"==$(blurNextPreventElement).attr("type"))||""!=blurNextPreventId&&$("#"+blurNextPreventId).is("button, a")?(CallNextActionPList(),callBackFunDtls=""):callBackFunDtls=""}catch(l){}}else AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide();n=(new Date).getTime()-StartTime;console.log("GetDependency: "+n+" ms")}function AxAfterGetDependents(){try{AxAfterGetDependent()}catch(e){}document.activeElement.select()}function CallNextActionPList(){""!=blurNextPreventId?-1==blurNextPreventId.indexOf("addrow")&&-1==blurNextPreventId.indexOf("advancebtn")&&-1==blurNextPreventId.indexOf("gridAddBtn")&&-1==blurNextPreventId.indexOf("newRecordBtn")&&$j("[id="+blurNextPreventId+"]:visible").click():blurNextPreventElement.click(),blurNextPreventId="",blurNextPreventElement=new Object}function EvaluateExpressions(e){var t,a=GetFieldsName(e),i=GetFieldsDcNo(e),r=GetFieldsRowNo(e),n=(GetDbRowNo(r,i),GetFieldValue(e)),l=GetFieldIndex(a);-1!=l&&("Numeric"==GetFieldType(a,l)&&(n=removeCommas(n)));var d="";if(-1!=l&&(d=FldDependents[l].toString()),""!=d&&(t=d.split(",")),t!=undefined)for(var s=0;s<t.length;s++){var o=t[s].toString(),c=o.substring(0,1),p=o.substring(1),u=GetDcNo(p);if("e"==c)if(IsDcGrid(u)){var f=GetFldNamesIndx(p);-1!=Expressions[f].toString().indexOf("sumtill")&&EvaluateAxFunction(p,e)}else EvaluateAxFunction(p,e)}if(NonGridExpDepFlds.length>0){for(s=0;s<NonGridExpDepFlds.length;s++){var h,v=NonGridExpDepFlds[s].toString(),m=GetFieldIndex(v),g=FldDependents[m].toString();if(""!=g&&(h=g.split(",")),h!=undefined)for(var b=0;b<h.length;b++){var w=h[b].toString();c=w.substring(0,1),p=w.substring(1),u=GetDcNo(p);if("e"==c)if(IsDcGrid(u)){f=GetFldNamesIndx(p);-1!=Expressions[f].toString().indexOf("sumtill")&&EvaluateAxFunction(p,v)}else EvaluateAxFunction(p,v)}}NonGridExpDepFlds=new Array}}function CheckGrdisplayHead(e,t,a,i){var r="displayhead"+e+"000F1",n=new Array,l=new Array,d=$j("#"+r);if(d&&d.val()&&""!=d.val())for(var s=d.val().split("~"),o=0;o<s.length;o++){var c=s[o].split(":");n.push(c[0]),l.push(c[1])}if(0!=n.length){for(var p=new Array,u=0;u<l.length;u++){var f=l[u].toString()+a+"F"+e;if($j("#"+f))if("Clear"==i)p.push("");else{var h=GetFieldValue(f);h==undefined&&(h=""),p.push(h)}}if(n.length==p.length){for(var v="<table><tr>",m=0;m<n.length;m++)v+="<td class=labelcap>"+n[m].toString()+" : </td><td class=grdispcol>"+p[m].toString()+"&nbsp;&nbsp;&nbsp;&nbsp;</td>";v+="</tr></table>";var g="disgridhead"+e;$j("#"+g)&&$j("#"+g).css({position:"relative"}).html(v);var b=$j("#divDc"+e).scrollLeft();if(b>0){$j("#"+g).css("left");$j("#"+g).css("left",screen.width/b)}else $j("#"+g).css("left",0)}}}function Tstructhyperlink(e){for(var t=0;t<HLinkSource.length;t++)if(e.id==HLinkSource[t].toString()){TsructPopup(HLinkName[t].toString(),"&hltype="+HLinkLoad[t].toString(),HLinkPop[t].toString(),GetHyperLinkParamStr(t));break}}function TstructLabelhyperlink(e){var t="",a=JSON.parse($(e).attr("data-param"));if(""!=a.paramNode&&"~"!=a.paramNode){var i=a.paramNode.split("^");$.each(i,function(e,a){var i=a.split("~"),r=i[0],n="";if(""!=i[1]&&":"==i[1].substring(0,1).toString()){n=i[1];var l=GetDcNo(n.toString().substring(1)),d=$j.inArray(n.toString().substring(1),FNames),s=GetFieldType(n.toString().substring(1),d),o=n.toString().substring(1)+"000F"+l;n=GetFieldValue(o),"Numeric"==s&&n.length>3&&-1!=n.indexOf(",")&&(n=removeCommas(n))}else n=i[1];n=(n=CheckUrlSplChars(n)).replace(/&/g,"--.--"),t+="&"+r+"="+n}),t=a.paramNode}if("tstruct"==a.type){var r="tstruct.aspx?act="+a.loadType+"&transid="+a.structName+t;"true"==a.ivtstpopup?createPopup(r):window.document.location.href=r}else if("iview"==a.type){a.structName;if("true"==a.ivtstpopup){t+="&AxIsPop=true";r="ivtoivload.aspx?ivname="+a.structName+"&"+t;createPopup(r)}else{t+="&AxIsPop=false";var n="ivtoivload.aspx?ivname="+a.structName+"&"+t;window.document.location.href=n}}else{var l="htmlPages.aspx?load="+a.structName;window.document.location.href=l}}function GetHyperLinkParamStr(e){var t="";if(HLinkParamName[e]){var a=HLinkParamName[e],i=HLinkParamValue[e];if("-"==a&&"-"==i)return"";""!=a&&(a=a.split("~")),""!=i&&(i=i.split("~"));for(var r=0;r<a.length;r++){var n=a[r],l=i[r];if(l!=undefined){if(":"==(l=l.replace("::",":")).substring(0,1).toString()){var d=GetDcNo(l.toString().substring(1)),s=$j.inArray(l.toString().substring(1),FNames),o=GetFieldType(l.toString().substring(1),s),c=l.toString().substring(1)+"000F"+d;l=GetFieldValue(c),"Numeric"==o&&l.length>3&&-1!=l.indexOf(",")&&(l=removeCommas(l))}var p=n+"="+CheckUrlSplChars(l);t=t+"&"+(p=p.replace(/&/g,"--.--"))}}}return t}function CheckUrlSplChars(e){return e=(e=(e=(e=(e=(e=e.replace(/&amp;/g,"&")).replace(/%/g,"%25")).replace(/&/g,"%26")).replace(/'/g,"%27")).replace(/"/g,"%22")).replace(/#/g,"%23")}function TsructPopup(hl,hltype,isPop,params){var torecid="&torecid=false",poppath="",loadPop;if("p"==hl.toString().substring(0,1))poppath="Actionpage.aspx?name="+hl.toString().substring(1)+params+hltype;else if("t"==hl.toString().substring(0,1))poppath="tstruct.aspx?transid="+hl.toString().substring(1)+params+hltype+torecid;else if("i"==hl.toString().substring(0,1))poppath="ivtoivload.aspx?ivname="+hl.toString().substring(1)+params+hltype;else if(":"==hl.toString().substring(0,1)){var parDcNo=GetDcNo(hl.toString().substring(1)),parafield=hl.toString().substring(1)+"000F"+parDcNo,srcfieldvalue=GetFieldValue(parafield);if(""!=srcfieldvalue)return void TsructPopup(srcfieldvalue,hltype,isPop,params)}if("false"!=isPop.toString().toLowerCase())try{loadPop=window.open(poppath,"LoadPop","width=800,height=500,resizable=1,scrollbars=yes")}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}else window.location.href=poppath}function RefreshDc(e,t){ShowDimmer(!0);var a=$j("#recordid000F0").val();try{callBackFunDtls="RefreshDc♠"+e+"♠"+t,ASB.WebService.RefreshDc(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,e,tstDataId,a,t,SuccessRefreshDc,OnException)}catch(i){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}}function SuccessRefreshDc(e,t){if(-1===e.toLowerCase().indexOf("access violation")){if(CheckSessionTimeout(e))return;ParseServiceResult(e,"RefreshDc"),AxWaitCursor(!1),ShowDimmer(!1)}else AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}function GetTabData(e){if($("#myTab li#li"+e).hasClass("active"))return!1;$("#tabCollapseButton").attr("title","Hide Dc").removeClass("icon-arrows-down").addClass("icon-arrows-up"),$("[id^='tabsCont']").show(),AxTabStartTime=new Date,AxTabStartTime=GetAxDate(AxTabStartTime);var t=new Date;ShowDimmer(!0),AxWaitCursor(!0);trace=traceSplitStr+"GetTabData-"+e.toString()+traceSplitChar;var a=0;$j("#recordid000F0")&&(a=$j("#recordid000F0").val()),ArrActionLog="LoadTab-"+e+"-Recordid-"+a;updtxt='<sqlresultset axpapp="'+proj+'" transid="'+transid+'" recordid="'+a+'" dcname="dc'+e+'"  sessionid="'+sid+'" trace="'+trace+'" >',CurrTabNo=e;var i=0;for(i=0;i<PagePositions.length;i++)if(-1!=PagePositions[i].toString().indexOf(",")){var r=PagePositions[i].toString().split(","),n=0;for(n=0;n<r.length;n++)CurrTabNo==r[n]&&(VisibleDCs[i]=CurrTabNo.toString())}var l=0,d=0,s=0;for(l=0;l<TabDCs.length;l++)if(TabDCs[l]==e){d=TabDCStatus[l],s=l;break}if(1==$j("#"+("tab-"+e)).prop("disabled")&&(IsTabDisabled="true"),0==d&&""!=$j("#tab-"+e).html()&&(d=1,TabDCStatus[s]="1"),arrRefreshDcs.length>0)for(l=0;l<arrRefreshDcs.length;l++){var o=arrRefreshDcs[l].split(":");if(o[0]=="dc"+CurrTabNo&&1==arrRefreshFldDirty[l]){RefreshDc(o[0].replace("dc",""),o[1].replace("dc","")+","+o[0].replace("dc","")),arrRefreshFldDirty[l]=!1;break}}if(0==d){TabDCStatus[s]="1",isFill=1;try{callBackFunDtls="GetTabData♠"+e,ASB.WebService.CallLoadDcData(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,ArrActionLog,updtxt,e,!1,IsTabDisabled,tstDataId,SuccessGetTabData,OnException)}catch(p){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}}else{isFill=0;try{AxAfterLoadTab(CurrTabNo)}catch(u){}SetDynamicDcCaptions(CurrTabNo),"True"==isTstPop&&TstructTabEventsInPopUP(CurrTabNo),$("#divDc"+CurrTabNo).is(":visible")||"undefined"!=typeof TabDCAlignmentStatus[CurrTabNo-1]||($(document).off("shown.bs.tab").on("shown.bs.tab",'div[role="tabpanel"] .nav-tabs a[data-toggle="tab"]',function(e){"undefined"==typeof TabDCAlignmentStatus[CurrTabNo-1]&&AlignDcElements("divDc"+CurrTabNo)}),$(document).on("click","#myTab li",function(e){$("#myTab li").removeClass("active"),$(this).addClass("active"),$(".tab-content").find(".tab-pane").removeClass("active in"),$(".tab-content").find($(this).find("a").attr("href")).addClass("active in")})),AxWaitCursor(!1),ShowDimmer(!1),focusOnFirstInputOnTabClick(CurrTabNo,!0)}var c=new Date;AxTimeBefSerCall=c-t}function focusOnFirstInputOnTabClick(e,t){setTimeout(function(){var a=$("#divDc"+e).find('button[tabindex!="-1"],a[tabindex!="-1"],input[tabindex!="-1"],textarea[tabindex!="-1"],select[tabindex!="-1"],table tbody tr[tabindex!="-1"]').filter(":visible").not(":disabled");$(a).first().focus(),!0===t&&refreshEditor(e)},200)}function SuccessGetTabData(e,t){if(-1===e.toLowerCase().indexOf("access violation")){var a=new Date;if(ArrActionLog="",CheckSessionTimeout(e))return;var i=e.split("*♠*"),r=i[0].split("*♦*");""!=r[0]&&$j("#DivFrame1").append("<script type='text/javascript'>"+r[0]+"<\/script>"),"Ax-NA"!=r[1]&&SetMRForFromList(r[1]),e=e.replace(i[0]+"*♠*",""),ParseServiceResult(e,"GetTabData"),UpdatePopGridInfo(),CheckFormControlPriv(CurrTabNo),CheckDisabledDcs(CurrTabNo),CheckShowHideFlds(),CheckEnableDiableFlds(),"Approved"!=appstatus&&"Rejected"!=appstatus||ShowingDc(CurrTabNo,"Disable"),FocusOnFirstField(CurrTabNo),DeletedDCRows=new Array,"True"==isTstPop&&TstructTabEventsInPopUP(CurrTabNo),allRtfTextAreasTab(CurrTabNo),SetGridBtnAccess();var n=$j("#axp_colmerge_"+CurrTabNo+"000F1");null!=(n=n.val())&&""!=n&&n!=undefined&&GetGridDcTable(n,CurrTabNo);try{AxAfterLoadTab(CurrTabNo)}catch(p){}if("true"==AxLogTimeTaken){var l=(new Date).getTime()-a.getTime();CreateTimeLog(AxTabStartTime,AxTimeBefSerCall,l,ASBTotal,ASBDbTime,"LoadDcCombos")}if(arrRefreshDcs.length>0)for(var d=0;d<arrRefreshDcs.length;d++){var s=arrRefreshDcs[d].split(":");if(s[0]=="dc"+CurrTabNo&&0==arrRefreshFldDirty[d]){RefreshDc(s[0].replace("dc",""),s[1].replace("dc","")),arrRefreshFldDirty[d]=!1;break}}theMode,setDesignedLayout("#tab-"+CurrTabNo);var o=$j.inArray(CurrTabNo.toString(),DCFrameNo),c=$("#gridHd"+CurrTabNo+" tbody tr").length;IsDcGrid(CurrTabNo)&&"True"==DCHasDataRows[o]&&c>0&&changeEditLayoutIds("",CurrTabNo,"tabListView"),makeFieldInitCap(CurrTabNo),SetDynamicDcCaptions(CurrTabNo),$(".gridFocusable").removeClass("gridFocusable").off("keydown.tabRot"),$("#myTab .active").addClass("gridFocusable"),$(".gridFocusable").on("keydown.tabRot",function(e){9!==e.which||e.shiftKey||(e.preventDefault(),$("#gridAddBtn"+CurrTabNo).focus(),$(".gridFocusable").removeClass("gridFocusable").off("keydown.tabRot"))}),CheckShowHideFldsGrid(CurrTabNo.toString()),focusOnFirstInputOnTabClick(CurrTabNo),customAlignTstructFlds([],CurrTabNo),ShowDimmer(!1)}else AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}function AssignTabDcHtmlPerf(e){if(!CheckSessionTimeout(e))for(var t=e.split("*♠♠*"),a=0;a<t.length;a++){var i=t[a].split("*♠*"),r=i[0].split("*♦*");""!=r[0]&&$j("#DivFrame1").append("<script type='text/javascript'>"+r[0]+"<\/script>"),"Ax-NA"!=r[1]&&SetMRForFromList(r[1]);var n=i[2].split("♣")[0];e=(e=t[a]).replace(i[0]+"*♠*",""),ParseServiceResult(e,"GetTabData"),UpdatePopGridInfo(),CheckFormControlPriv(n),CheckDisabledDcs(n),CheckShowHideFlds(),CheckEnableDiableFlds(),"Approved"!=appstatus&&"Rejected"!=appstatus||ShowingDc(n,"Disable"),FocusOnFirstField(n),DeletedDCRows=new Array,"True"==isTstPop&&TstructTabEventsInPopUP(n),allRtfTextAreasTab(n),SetGridBtnAccess();var l=$j("#axp_colmerge_"+n+"000F1");null!=(l=l.val())&&""!=l&&l!=undefined&&GetGridDcTable(l,n);try{AxAfterLoadTab(n)}catch(p){}if("true"==AxLogTimeTaken){var d=(new Date).getTime()-stTime.getTime();CreateTimeLog(AxTabStartTime,AxTimeBefSerCall,d,ASBTotal,ASBDbTime,"LoadDcCombos")}if(arrRefreshDcs.length>0)for(a=0;a<arrRefreshDcs.length;a++){var s=arrRefreshDcs[a].split(":");if(s[0]=="dc"+n&&0==arrRefreshFldDirty[a]){RefreshDc(s[0].replace("dc",""),s[1].replace("dc","")),arrRefreshFldDirty[a]=!1;break}}var o=$j.inArray(n.toString(),DCFrameNo),c=$("#gridHd"+n+" tbody tr").length;IsDcGrid(n)&&"True"==DCHasDataRows[o]&&c>0&&changeEditLayoutIds("",n,"tabListView"),makeFieldInitCap(n),SetDynamicDcCaptions(n)}}function applyDesignJsonAgain(e){var t,a=!1;try{t=$j("#divDc"+e+" [id^=wrapperForEditFields]")[0].id,$j("#"+t).hasClass("hide")&&(a=!0,$j("#"+t).removeClass("hide"))}catch(i){}AlignDcElements("divDc"+e);try{1==a&&($j("#"+t).addClass("hide"),a=!1)}catch(i){}}function CheckEnableDiableFlds(){for(var e=0;e<AxFormContDisableFlds.length;e++)if(""!=AxFormContDisableFlds[e]){var t=AxFormContDisableFlds[e].split("~");EnableDisableField(t[0],t[1],"1")}}function CheckDisabledDcs(e){for(var t=0;t<DisabledDcs.length;t++)if(""!=DisabledDcs[t]){var a=DisabledDcs[t].split("~");e==a[0]&&ShowingDc(a[0],a[1])}}function CheckShowHideFlds(){for(var e=0;e<AxFormContHiddenFlds.length;e++)if(""!=AxFormContHiddenFlds[e]){var t=AxFormContHiddenFlds[e].split("~");HideShowField(t[0],t[1])}for(var a=0;a<AxFormContSetCapFlds.length;a++){if(""!=AxFormContSetCapFlds[a])SetCaptionFormControl((t=AxFormContSetCapFlds[a].split("~"))[0],t[1])}}function CheckShowHideFldsGrid(e){for(var t=0;t<AxFormContSetCapFldsGrid.length;t++)if(""!=AxFormContSetCapFldsGrid[t]){var a=AxFormContSetCapFldsGrid[t].split("~");IsDcGrid(e)?a[0]==e&&SetCaptionFormControlOnGrid(a[1],a[2],e):a[0]==e&&SetCaptionFormControl(a[1]+"000F"+a[0],a[2])}SetFormContFldActGrid(e)}function SetFormContFldActGrid(e){for(var t=0;t<AxFormContSetFldActGrid.length;t++)if(""!=AxFormContSetFldActGrid[t]){var a=AxFormContSetFldActGrid[t].split("~"),i=a[0];if(""==e||i==e){"hide"==a[2]?HideShowField(a[1],"hide"):HideShowField(a[1],"show");var r="";if(IsDcGrid(i)){var n;n=GetDcRowCount(i);for(var l=1;l<=n;l++)r=a[1]+GetClientRowNo(l,i)+"F"+i,"disable"==a[2]?EnableDisableField(r,"2","1"):EnableDisableField(r,"1","1")}else r=a[1]+"000F"+i,"disable"==a[2]?EnableDisableField(r,"2","1"):EnableDisableField(r,"1","1")}}}function SetFocusFormControl(){for(var e=0;e<AxFormContFldSetFocus.length;e++)if(""!=AxFormContFldSetFocus[e]){var t=AxFormContFldSetFocus[e].split("~"),a=t[0];if("setfocus"==t[2]){if(!IsDcGrid(a)){var i=t[1]+"000F"+a;if(isMobile&&$("#"+i).hasClass("fldAutocomplete"))continue;$j("#"+i).focus()}return}}}function SetCaptionFormControlOnGrid(e,t,a){IsDcGrid(a)&&($("#gridHd"+a+" th[id='th-"+e+"']").text(t),$("#wrapperForEditFields"+a+" label[for='"+e+"']").text(t),$("#wrapperForEditFields"+a).find("#dvGrid"+e+" label").text(t))}function SetCaptionFormControl(e,t){var a=GetFieldsDcNo(e);if(IsDcGrid(a)){var i=GetFieldsName(e);$("#gridHd"+a+" th[id='th-"+i+"']").text(t),$("#wrapperForEditFields"+a+" label[for='"+i+"001F"+a+"']").text(t)}else"checkbox"==$j("#"+e).attr("type")?$("label[for='"+e+"'] span").text(t):$("label[for='"+e+"']").text(t)}function CheckFormControlPriv(e){for(var t=GetGridFields(e),a=GetDcRowCount(e),i=!1,r=t.length-1;r>=0;r--){if("axpvalid"==t[r].substring(0,8))for(var n=1;n<=a;n++){var l=t[r]+GetRowNoHelper(n)+"F"+e,d=$j("#"+l).val();DoFormControlPrivilege(l,d),i=!0}if(i)break}}function AssignJQueryEvents(dcArray){CKEDITOR.on("instanceReady",function(e){e.editor.on("change",function(){currentCK=this.name})}),createEditors(),$('[data-toggle="popover"]').popover({container:"body"});for(var i=0;i<dcArray.length;i++){var dvId=dcArray[i];if($j(dvId).length>0){createAutoComplete(dvId+" .fldAutocomplete"),$j(dvId).find(".fldAutocomplete").autocomplete(),$j(dvId).find(".dropdown-main").remove(),$j(dvId).find(".dropdown-display-label").remove();var jsonData=JSON.parse('{"data":[]}');$j(dvId).find(".dropdown-mul").dropdown({data:jsonData.data,multipleMode:"label",choice:function(){MultiGroupSelectChoice(this)}}),multiSelectLoadVals.length>0&&$.each(multiSelectLoadVals,function(e,t){var a=t.split("♦")[0],i=t.split("♦")[1],r=a.substring(0,a.lastIndexOf("F")-3),n="";n=0==axInlineGridEdit&&void 0!==$j(dvId).find(".editWrapTr").attr("id")?$j(dvId).find(".editWrapTr").attr("id").substring($j(dvId).find(".editWrapTr").attr("id").lastIndexOf("F"),$j(dvId).find(".editWrapTr").attr("id").lastIndexOf("F")-3):$j(dvId).attr("id").substring($j(dvId).attr("id").lastIndexOf("F"),$j(dvId).attr("id").lastIndexOf("F")-3);var l=a.substring(a.lastIndexOf("F"),a.lastIndexOf("F")-3);if(IsGridField(r)&&n==l){var d="",s=$("#"+a).attr("data-sep");$.each(i.split(s),function(e,t){d+='<span class="dropdown-selected">'+t+'<i class="del" data-id="'+t+'"></i></span>'}),$("#"+a).next(".dropdown-display-label").find(".dropdown-chose-list").prepend(d),$("#"+a).parents(".dropdown-mul").click()}}),$j(dvId).find("input,select,textarea:not(#txtCommentWF)").unbind("focus"),$j(dvId).find("input:not([class=AxAddRows],[class=AxSearchField]),select:not(#selectbox),textarea:not(#txtCommentWF):not(.labelInp)").focus(function(){MainFocus($j(this))}),$j(dvId+" .date").removeClass("hasDatepicker"),$j(dvId+" .tstOnlyTime").removeClass("hasDatepicker");var glType=eval(callParent("gllangType")),dtpkrRTL=!1;dtpkrRTL="ar"==glType;var glCulture=eval(callParent("glCulture")),dtFormat="dd/mm/yy";"en-us"==glCulture&&(dtFormat="mm/dd/yy"),$j(dvId+" .date").datepicker({isRTL:dtpkrRTL,dateFormat:dtFormat,changeMonth:!0,changeYear:!0}),TimePickerEvent(dvId,dtpkrRTL),$j(dvId).find("textarea:not(#txtCommentWF),:text,:password").unbind("blur"),$j(dvId).find("textarea:not(#txtCommentWF):not(.labelInp),[id]:text:not([class=AxAddRows],[class=AxSearchField]),:password").blur(function(){if(MainBlur($j(this)),axInlineGridEdit){var e=$j(this),t=e.attr("id"),a=GetFieldsName(t),i=$j.inArray(a,FNames),r=GetFieldProp(i,"allowEmpty"),n=e.val();if("F"===r)"Numeric"==FDataType[i]&&0==parseFloat(n)||""===n?(e.css("border","1px solid red"),e.closest("td").attr("data-fld-mandatory","")):(e.css("border","1px solid rgb(204, 204, 204)"),e.closest("td").removeAttr("data-fld-mandatory"))}}),$j(dvId).find("select:not(#selectbox),:checkbox,:radio").unbind("change"),$j(dvId+" select").change(function(){-1==$j(this).find(":selected").text().indexOf("+ Add")&&(MainBlur($j(this)),$j(this).blur(),$j(this).focus())}),$j(dvId).find(":checkbox:not([class=chkAllList]):not(.tokenSelectAll),:radio").not(".chkShwSel").change(function(){MainBlur($j(this))}),$j(dvId+" textarea").unbind("keydown"),$j(dvId+" textarea:not(.labelInp)").keydown(function(e){LimitText($j(this))}),$j(dvId+" textarea").unbind("keyup"),$j(dvId+" textarea:not(.labelInp)").keyup(function(){LimitText($j(this))}),$j(dvId+" .number").unbind("keypress"),$j(dvId+" .number").keypress(function(e){return CheckNumeric(e,$j(this).val())}),$j(dvId+" .pickimg").unbind("click"),$j(dvId+" .pickimg").click(function(){DisplayPickList($j(this))}),$j(dvId+" .picklisttxtclear").hover(function(e){1==$j(this).parent(".picklist").find("input").prop("disabled")&&$j(this).css("cursor","no-drop")}),$j(dvId+" .picklisttxtclear").unbind("click"),$j(dvId+" .picklisttxtclear").click(function(e){1!=$j(this).parent(".picklist").find("input:visible").prop("disabled")&&1!=$j(this).parent(".picklist").find("input:visible").prop("readonly")&&""!=$j(this).parent(".picklist").find("input:visible").val()&&($j(this).parent(".picklist").find("input:visible").val(""),MainFocus($j(this).parent(".picklist").find("input:visible")),$j(this).parent(".picklist").find("input:visible").trigger("blur"))}),$j(dvId+" .autoinputtxtclear").unbind("click"),$j(dvId+" .autoinputtxtclear").click(function(e){var t=$j(this).parent(".autoinput-parent").find(".fldAutocomplete");if(1!=t.prop("disabled")&&1!=t.prop("readonly")&&""!=t.val()){MainFocus(t),t.val("");var a=t.attr("id"),i=a.substring(0,a.lastIndexOf("F")-3);AutoFillFlds[i]==undefined?$(t).addClass("blurme").autocomplete("search",""):t.trigger("blur")}}),$j(dvId+" .inputClass2").keydown(function(e){13==e.keyCode&&1==pickStatus&&DisplayPickList($j(this)),pickStatus=!0}),$j(dvId+" .axpImg").click(function(){UploadImg($j(this)[0].id)}),$(dvId+" .axpBtn").off("click.axpBtn").on("click.axpBtn",function(){var e=$j(this);CallAction(e[0].id)}),$j(dvId+" .rowdelete").click(function(){DeleteCurrentRow($j(this))}),$j(dvId+" .subGrid").click(function(){ShowPopUp($j(this))}),$j(".rowdelete img").hover(function(){$j(this).attr("src","../axpimages/icons/16x16/delete.png")},function(){$j(this).attr("src","../axpimages/icons/16x16/delete-fade.png")}),$j(".achklist").click(function(){$j(this).parent().next(".chkListBdr").toggle()}),$j(".spandate").click(function(){$j(this).prev().focus()}),$j(".spanTime").click(function(){$j(this).prev().find("input").focus()}),$(document).on("keypress",dvId+" .form-group span.fa-paperclip",function(e){"13"==e.which&&$(this).click()}),$j(dvId+" input.number").on("input",function(){var e=$j(this).val(),t=$j(this).attr("id");if(t!=undefined){var a=GetFieldsName(t),i=$j.inArray(a,FNames);if(i!=undefined&&i>-1){var r=FMaxLength[i],n=FDecimal[i];if("Numeric"==FDataType[i]&&n!=undefined&&n>0){var l=r-n-1;if(-1==e.indexOf("."))e.length>l&&$j(this).val(e.slice(0,l));else if(-1!=e.indexOf(".")){var d=e.substring(0,e.indexOf(".")),s=e.substring(e.indexOf(".")+1,e.length);d.length>l&&(d=d.slice(0,l)),s.length>n&&(s=s.slice(0,n)),$j(this).val(d+"."+s)}}}}})}$j(".gridoptions").off("click.gridoptionsa"),$j(".gridoptions").on("click.gridoptionsa",function(e){var t;void 0!==$(this).closest("a")&&$(this).closest("a").length>0?(t=$(this).closest("a").attr("id").substring(3),$("#divDc"+t+" .grdButtons").css("left",$("#"+$(this).closest("a").attr("id")).offset().left-20)):void 0===$(this).closest("div").attr("id")||isWizardTstruct?(t=$(this).parent().next(".dvdcframe").attr("id").substring(8),$("#divDc"+t+" .grdButtons").css("left",$(this).parent().next("div").offset().left+20)):(t=$(this).closest("div").attr("id").substring(4),$("body").hasClass("btextDir-ltr")?$("#divDc"+t+" .grdButtons").css({left:$("#"+$(this).closest("div").attr("id")).offset().left-20+"px"}):$("#divDc"+t+" .grdButtons").css({right:$("#"+$(this).closest("div").attr("id")).offset().right+20+"px"})),$("#divDc"+t+" .grdButtons").hasClass("hide")?$("#divDc"+t+" .grdButtons").removeClass("hide"):$("#divDc"+t+" .grdButtons").addClass("hide")}),$("#heightframe").off("keydown.heightframeb"),$("#heightframe").on("keydown.heightframeb",function(e){if(40==e.keyCode&&$(this).find(".grdUlButtons").not(".hide").length>0){var t=$(this).find(".grdUlButtons").not(".hide").closest(".mainIframe").attr("id");if($("#"+t+" .grdUlButtons ul li").hasClass("grdliHover")){var a=$("#"+t+" .grdUlButtons ul li.grdliHover").index();$("#"+t+" .grdUlButtons ul li").removeClass("grdliHover"),$("#"+t+" .grdUlButtons ul li:not([style*='display:none']):eq("+a+")").addClass("grdliHover"),$("#"+t+" .grdUlButtons ul li.grdliHover").children().focus()}else $("#"+t+" .grdUlButtons ul li:not([style*='display:none'])").first().addClass("grdliHover"),$("#"+t+" .grdUlButtons ul li.grdliHover").children().focus()}else if(38==e.keyCode&&$(this).find(".grdUlButtons").not(".hide").length>0){t=$(this).find(".grdUlButtons").not(".hide").closest(".mainIframe").attr("id");if($("#"+t+" .grdUlButtons ul li").hasClass("grdliHover")){var i=$("#"+t+" .grdUlButtons ul li.grdliHover").index()-$("#"+t+" .grdUlButtons ul li:hidden").length;$("#"+t+" .grdUlButtons ul li").removeClass("grdliHover"),$("#"+t+" .grdUlButtons ul li:not([style*='display:none']):eq("+(i-1)+")").addClass("grdliHover"),$("#"+t+" .grdUlButtons ul li.grdliHover").children().focus()}else $("#"+t+" .grdUlButtons ul li:not([style*='display:none'])").last().addClass("grdliHover"),$("#"+t+" .grdUlButtons ul li.grdliHover").children().focus()}}),$j(document).on("click","body",function(e){var t;"gridoptions glyphicon glyphicon-chevron-down"!=e.target.className&&$(".gridoptions").length>0&&!isMobile&&(void 0!==$(".gridoptions").closest("a")&&$(".gridoptions").closest("a").length>0?$(".gridoptions").closest("a").each(function(){t=$(this).attr("id").substring(3),$("#divDc"+t+" .grdButtons").addClass("hide")}):void 0===$(".gridoptions").closest("div").attr("id")||isWizardTstruct?$(".gridoptions").closest("div").each(function(){void 0!==$(this).next(".dvdcframe").attr("id")&&(t=$(this).next(".dvdcframe").attr("id").substring(8),$("#divDc"+t+" .grdButtons").addClass("hide"))}):$(".gridoptions").closest("div").each(function(){t=$(this).attr("id").substring(4),$("#divDc"+t+" .grdButtons").addClass("hide")}));"workflowOptions icon-arrows-down downarrow"!=e.target.className&&$(".workflowOptions").length>0&&$(".wfselectbox").addClass("hide")}),$j(dvId).find(".dropdown-mul").off("click.dropdown-mula"),$j(dvId).find(".dropdown-mul").on("click.dropdown-mula",function(e){("undefined"==typeof fldmultiSelectdep||"undefined"!=typeof fldmultiSelectdep&&0==fldmultiSelectdep)&&MultiGroupSelectClk(e,this)}),$j(dvId).find(".glyphicon-th").off("click.glyphicon-tha"),$j(dvId).find(".glyphicon-th").on("click.glyphicon-tha",function(e){FieldTypeTable(e,this)}),$j(dvId).find(".fldCustTable ").off("keydown.fldtblA"),$j(dvId).find(".fldCustTable ").on("keydown.fldtblA",function(e){13==e.keyCode&&FieldTypeTable(e,this)})}1==parent.MainNewEdit&&$j("html").addClass("makeFullHeight");try{$j("#middle1",parent.document).attr("src")!=undefined&&-1!==$j("#middle1",parent.document).attr("src").indexOf("ParamsTstruct.aspx")||$j(document).off("keydown").on("keydown",function(e){if(13==e.which&&$j("#dvPickList").is(":visible")&&$j("#tblPickData tr.active").length>0)if(initialSrchVal==$j("#"+$j("#tblPickData").attr("data-pick")).val()){e.stopPropagation();var t=$j("#tblPickData tr.active td").attr("onclick");t=t.substring(23,t.length-2),SetPickVal(t),pickStatus=!1,selectedRow=0,e.which=-1,initialSrchVal=""}else DisplayPickList($j("#"+$j("#tblPickData").attr("data-pick")));return 40==e.which&&$j("#dvPickList").is(":visible")&&$j("#tblPickData tr.active").length>0?(e.preventDefault(),e.stopPropagation(),pickDownn(),($("#dvPickHead .active").offset().top-$("#dvPickHead").offset().top+$("#dvPickHead .active").outerHeight()>=$("#dvPickHead").height()||$("#dvPickHead .active").offset().top-$("#dvPickHead").offset().top<0)&&$("#dvPickHead").animate({scrollTop:$("#dvPickHead .active").offset().top-$("#dvPickHead").offset().top+$("#dvPickHead .active").height()},100),!1):38==e.which&&$j("#dvPickList").is(":visible")&&$j("#tblPickData tr.active").length>0?(e.preventDefault(),e.stopPropagation(),pickUpp(),$("#dvPickHead").animate({scrollTop:$("#dvPickHead .active").offset().top-$("#dvPickHead").offset().top-$("#dvPickHead .active").height()},100),!1):void 0}),"function"==typeof commonReadyTasks&&commonReadyTasks()}catch(ex){console.log(ex.message)}$==undefined&&($=$j),jQuery.browser={},jQuery.browser.msie=!1,jQuery.browser.version=0,navigator.userAgent.match(/MSIE ([0-9]+)\./)&&(jQuery.browser.msie=!0,jQuery.browser.version=RegExp.$1),$j(".clsPrps").length>0?$j("#tgPurpose").css("display","inline-block"):$j("#tgPurpose").css("display","none")}function ConvertFieldID(e,t){if(e){if("I"==e.prop("tagName")){var a="data-clk";if((r=e.attr(a))==undefined&&(a="data-fldname",r=e.attr(a)),r==undefined&&(a="data-refresh",r=e.attr(a)),r==undefined&&(a="data-ids",r=e.attr(a)),r!=undefined){var i=GetFieldsName(r)+t+"F"+(n=GetFieldsDcNo(r));e.attr(a,i)}}var r=e.attr("id");if(r!=undefined){var n;i=GetFieldsName(r)+t+"F"+(n=GetFieldsDcNo(r));e.attr("id",i),i.indexOf("grdRefLink_hlnk__")>-1&&e.attr("onclick")!=undefined&&(e=UpdateGridReferFunc(e,i,t,n)),"IMG"!=e.attr("tagname")&&e.attr("name",i)}}}function UpdateGridReferFunc(e,t,a,i){var r=e.attr("onclick");e.removeAttr("onclick");var n=r.lastIndexOf(","),l=r.indexOf(")"),d=r.indexOf("("),s=r.substr(d+2,r.indexOf(",")-d-1),o=GetFieldsName(s)+a+"F"+i,c=r.substr(n+2,l-n-3);return e.attr("onclick","DeleteFileFromRow('"+o+"', '"+a+"F"+i+"', '"+c+"')"),e}function SetSerialNo(e,t){var a=$j("#hdnSlNoCnt"+e),i=parseInt(a.val(),10)+1;a.val(i),$j("#lblSlNo"+t+"F"+e).text(i)}function UpdateFieldsInNewRow(e,t,a){var i=GetDbRowNo(t,e);if("000"!=t){for(var r=GetGridFields(e),n=0;n<r.length;n++){var l=r[n]+t+"F"+e;UpdateFieldArray(l,i,"","parent","")}}}function AddInlineRow(e,t,a,i){if(!(t==undefined&&$j("#addrow"+e).length>0&&-1!=$j("#addrow"+e).attr("class").indexOf("disableadd"))){if(!IsDcPopGrid(e)){ShowDimmer(!0),IsAddRowCalled=!1;if($j("#hdnRCntDc"+e).length>0){var r=GetDcClientRows(e).getMaxVal();0==r&&(r=1);var n=parseInt(r,10),l=GetRowNoHelper(n);t;$j("#hdnRCntDc"+e).val();t="AddRow",RegisterActiveRow(l,e),AxActiveDc=e,UpdateDcRowArrays(e,l,"Add");var d=l+"F"+e,s=$j.inArray(d,DeletedDCRows);-1!=s&&DeletedDCRows.splice(s,1),CheckScroll(e);var o=GetGridFields(e);if(FillNewRowComboValues(e,l,o,a),TstructHasPop)IsDcParentGrid(e)&&UpdatePopUpArrays(e,l,!1,"Add");t!=undefined&&"newRow"!=t&&"AddRow"!=t||"GetDep"!=i&&"Action"!=i&&("undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?CallEvaluateOnAddPerf(e,l,o,t):CallEvaluateOnAdd(e,l,o,t)),IsAddRowCalled||t!=undefined&&"newRow"!=t||UpdateRowInDataObj(),t!=undefined&&"newRow"!=t||FocusOnLastField(e,l);try{AxAfterAddRow(e,l)}catch(c){}SetDynamicDcCaptions(e),axpBtnClickEvent("sp"+e+"R"+d)}return"True"==isTstPop&&TstructTabEventsInPopUP(""),!1}AddSubGridRow(e,t)}}function AddRow(dcNo,calledFrom,keyColValue){var srcCalledFrom;if(!(calledFrom==undefined&&$j("#addrow"+dcNo).length>0&&-1!=$j("#addrow"+dcNo).attr("class").indexOf("disableadd"))){if(!IsDcPopGrid(dcNo)){ShowDimmer(!0),IsAddRowCalled=!1;var tableName="gridDc"+dcNo,newRow="",sTRowIndx=-1,hdnRowCount=$j("#hdnRCntDc"+dcNo);if(hdnRowCount.length>0){var dcClientRows=GetDcClientRows(dcNo),lastRow=dcClientRows.getMaxVal();0==lastRow&&(lastRow=1);var rowCount=$j("#hdnRCntDc"+dcNo).val(),newCnt=parseInt(lastRow,10)+1,newRowNo=GetRowNoHelper(newCnt);srcCalledFrom=calledFrom,("AddInlineRow"==calledFrom||isMobileGridRowEdit)&&(isMobileGridRowEdit=!1,newCnt-=1,newRowNo=GetRowNoHelper(newCnt),calledFrom="AddRow");var rid=$j("#recordid000F0").val();if(ArrActionLog="AddRow-DcNo-"+dcNo+"-rowno-"+newRowNo+"-Recordid-"+rid,RegisterActiveRow(newRowNo,dcNo),AxActiveDc=dcNo,"form"!=AxpGridForm){$j("#wrapperForEditFields"+dcNo+" .date").datepicker("destroy");var glType=eval(callParent("gllangType")),dtpkrRTL=!1;dtpkrRTL="ar"==glType;var glCulture=eval(callParent("glCulture")),dtFormat="dd/mm/yy";"en-us"==glCulture&&(dtFormat="mm/dd/yy"),$j("#wrapperForEditFields"+dcNo+" .date").datepicker({isRTL:dtpkrRTL,dateFormat:dtFormat,changeMonth:!0,changeYear:!0,yearRange:"-100:+100"}),TimePickerEvent("#wrapperForEditFields"+dcNo,dtpkrRTL)}axpBtnClickEvent("sp"+dcNo+"R"+rowFrameNo),UpdateDcRowArrays(dcNo,newRowNo,"Add"),calledFrom==undefined||"newRow"==calledFrom?SetRowCount(dcNo,parseInt(rowCount,10)+1,"i"+(parseInt(rowCount,10)+1)):"FillGrid"==calledFrom&&axInlineGridEdit?SetRowCount(dcNo,rowCount,"",calledFrom):SetRowCount(dcNo,newCnt,"",calledFrom);var rowFrameNo=newRowNo+"F"+dcNo,ind=$j.inArray(rowFrameNo,DeletedDCRows);-1!=ind&&DeletedDCRows.splice(ind,1),CheckScroll(dcNo),calledFrom==undefined&&UpdateFieldsInNewRow(dcNo,newRowNo,newRow),keyColValue?SetFGSerialNo(dcNo,newRowNo,oldRowNo):SetSerialNo(dcNo,newRowNo);var fields=GetGridFields(dcNo);if(FillNewRowComboValues(dcNo,newRowNo,fields,keyColValue),calledFrom==undefined&&FillAcceptSqlFlds(dcNo,newRowNo,keyColValue),TstructHasPop){var IsParentGrid=IsDcParentGrid(dcNo);IsParentGrid&&UpdatePopUpArrays(dcNo,newRowNo,!1,"Add")}calledFrom!=undefined&&"newRow"!=calledFrom&&"AddRow"!=calledFrom||("undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?CallEvaluateOnAddPerf(dcNo,newRowNo,fields,calledFrom):CallEvaluateOnAdd(dcNo,newRowNo,fields,calledFrom)),keyColValue?(SetKeyColValue(dcNo,newRowNo,keyColValue),newCnt=parseInt(newRowNo,10)+1,newRowNo=GetRowNoHelper(newCnt),ResetRowStyle(newRowNo,dcNo)):ResetRowStyle(newRowNo,dcNo),IsFunction="",calledFrom==undefined&&CheckAxpvalid(dcNo,newRowNo,fields),IsAddRowCalled||calledFrom!=undefined&&"newRow"!=calledFrom||UpdateRowInDataObj(),IsUpdateRowcalled||IsAddRowCalled||ShowDimmer(!1),calledFrom!=undefined&&"newRow"!=calledFrom||FocusOnLastField(dcNo,newRowNo);try{AxAfterAddRow(dcNo,newRowNo)}catch(ex){}SetDynamicDcCaptions(dcNo)}return"True"==isTstPop&&TstructTabEventsInPopUP(""),!1}AddSubGridRow(dcNo,calledFrom)}}function UpdateRowInDataObj(){IsUpdateRowcalled=!0;try{ASB.WebService.AppendRowToDataObj(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,ArrActionLog,tstDataId,SuccessUpdateRow)}catch(e){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array}function SuccessUpdateRow(e){CheckSessionTimeout(e)||(ArrActionLog="",ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,IsUpdateRowcalled=!1,ShowDimmer(!1))}function CallAddRowWS(e,t){AxWaitCursor(!0),ShowDimmer(!0);var a=GetOpenTabDcs(),i=GetDbRowNo(t,e),r=$j("#recordid000F0").val(),n=traceSplitStr+"AddRow-"+transid+traceSplitChar;IsAddRowCalled=!0;var l='<sqlresultset axpapp="'+proj+'" transid="'+transid+'" recordid="'+r+'" dcname="'+e+'" rowno="'+i+'" dcnames="'+a+'" sessionid="'+sid+'" trace="'+n+'" >';try{ASB.WebService.AddRowWS(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,l,e,tstDataId,SuccessCalAddData,ErrorAddRowWS)}catch(d){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}AxWaitCursor(!1)}function CallAddRowPerfWS(e,t){StartTime=(new Date).getTime(),AxWaitCursor(!0),ShowDimmer(!0);var a=GetOpenTabDcs(),i=GetDbRowNo(t,e),r=$j("#recordid000F0").val(),n=traceSplitStr+"AddRow-"+transid+traceSplitChar;IsAddRowCalled=!0;var l='<sqlresultset axpapp="'+proj+'" transid="'+transid+'" recordid="'+r+'" dcname="'+e+'" rowno="'+i+'" dcnames="'+a+'" sessionid="'+sid+'" trace="'+n+'" >';try{ASB.WebService.AddRowPerfWS(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,l,e,tstDataId,SuccessCalAddData,ErrorAddRowWS)}catch(d){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}AxWaitCursor(!1)}function SuccessCalAddData(e,t){if(!CheckSessionTimeout(e)){ArrActionLog="",ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,AssignLoadValues(e,"CallAdd");var a=e;""!=a&&(a=a.replace(/\\/g,";bkslh"));var i=JSON.parse(a).data;i[0].n=="DC"+AxActiveDc&&"dc"==i[0].t&&(axInlineGridEdit?UpdateFieldArray(ConstructFieldName(axpIsRowValid+AxActiveDc,AxActiveDc,i[0].v),i[0].v,"","parent","AddRow"):UpdateFieldArray(ConstructFieldName(axpIsRowValid+AxActiveDc,AxActiveDc,i[0].v),i[0].v,"false","parent","AddRow")),ShowDimmer(!1);var r=(new Date).getTime()-StartTime;console.log("Addrow :"+r+" ms")}}function CallEvaluate(e,t,a){for(var i=0;i<a.length;i++){var r=a[i]+t+"F"+e,n=GetFieldValue(r);if(ISBound(a[i],t)){EvaluateAxFunction(a[i],r,t+"F"+e);var l=GetFieldValue(r);GetDbRowNo(t,e);if(IsService=!1,n==parseInt(l,10))continue}}}function CallEvaluateOnAdd(e,t,a,i){IsDcGrid(e);for(var r=!1,n=0;n<a.length;n++){GetFieldIndex(a[n]);var l=a[n],d=a[n]+t+"F"+e,s=($j("#"+d).attr("type"),GetFieldValue(d));if(ISBound(a[n],t)){"newRow"==i||"AddRow"==i?(EvaluateAxFunction(a[n],d,t+"F"+e),EvaluateExpressions(d)):EvaluateAxFunction(a[n],d,t+"F"+e);var o=GetFieldValue(d),c=GetDbRowNo(t,e);if(UpdateFieldArray(d,c,o,"parent","AddRow"),IsService=!1,s==parseInt(o,10))continue;if(s!=o&&1==CheckDependency(d,"AddRow")&&0==r&&"Delete"!=i&&(r=!0),0==r&&("newRow"==i||"AddRow"==i||"ToCheckAddRow"==i)){var p=GetFieldIndex(l);-1!=p&&"accept"==FMoe[p].toString().toLowerCase()&&"true"==FldIsSql[p].toString().toLowerCase()&&(r=!0,$("#"+d).addClass("addServiceCallMade"))}}}UpdateAxpRowVldInArray(e,t,c),r?(r=!1,ShowDimmer(!0),CallAddRowWS(e,GetRowNoHelper(parseInt(t,10)))):"FillGrid"!=i&&UpdateFieldArray(ConstructFieldName(axpIsRowValid+e,e,parseInt(t,10)),t,"","parent","AddRow")}function CallEvaluateOnAddPerf(e,t,a,i){IsDcGrid(e);new Array;for(var r=!1,n=0;n<a.length;n++){GetFieldIndex(a[n]);var l=a[n],d=a[n]+t+"F"+e,s=($j("#"+d).attr("type"),GetFieldValue(d));if(ISBoundPerf(a[n],t)){"newRow"==i||"AddRow"==i?(EvaluateAxFunction(a[n],d,t+"F"+e),EvaluateExpressions(d)):EvaluateAxFunction(a[n],d,t+"F"+e);var o=GetFieldValue(d),c=GetDbRowNo(t,e);if(UpdateFieldArray(d,c,o,"parent","AddRow"),IsService=!1,s==parseInt(o,10))continue;if(s!=o&&1==CheckDependencyPerf(d,"AddRow")&&0==r&&"Delete"!=i&&(r=!0),0==r&&("newRow"==i||"AddRow"==i||"ToCheckAddRow"==i)){var p=GetFieldIndex(l);-1!=p&&"accept"==FMoe[p].toString().toLowerCase()&&"true"==FldIsSql[p].toString().toLowerCase()&&(r=!0,$("#"+d).addClass("addServiceCallMade"))}}}UpdateAxpRowVldInArray(e,t,c),r?(r=!1,ShowDimmer(!0),CallAddRowPerfWS(e,GetRowNoHelper(parseInt(t,10)))):"FillGrid"!=i&&(!isMobile||isMobile&&axInlineGridEdit)&&UpdateFieldArray(ConstructFieldName(axpIsRowValid+e,e,parseInt(t,10)),t,"","parent","AddRow")}function FillAcceptSqlFlds(e,t,a){var i=$j.inArray(e,DCFrameNo),r=!0;if(-1!=i)for(var n=DcAcceptMRFlds[i].toString().split(","),l=0;l<n.length;l++){var d=GetFieldIndex(n[l]),s=n[l]+t+"F"+e;if(-1!=d){var o=FldParents[d].toString().split(",");if(""!=o)for(var c=0;c<o.length;c++){if(GetDcNo(o[c])==e){r=!1;break}}r&&CopyFromMasterRow(s,e,"","AddRow",a)}}}function FillNewRowComboValues(e,t,a,i){for(var r=0;r<a.length;r++){var n=IsInMasterRow(a[r]),l="#"+a[r]+t+"F"+e,d=(a[r],$j(l));if(d.length>0){var s=d.prop("type");1==n?("select-one"==s?($j(l+" option:selected").removeAttr("selected"),$j(l).val("")):"checkbox"==s&&$j(l).removeAttr("checked").prop("checked",!1),(d.hasClass("fldAutocomplete")||d.hasClass("fldmultiSelect"))&&$j(l).val("")):"select-one"==s?$j(l+" option:gt(0)").remove():"checkbox"==s?$j(l).removeAttr("checked").prop("checked",!1):($j(l).val(""),d[0]&&(d[0].defaultValue=""))}}}function IsInMasterRow(e){for(var t=0;t<MasterRow.length;t++)if(e==MasterRow[t])return!0;return!1}function DeleteCurrentRow(e){var t=e.parent().parent().attr("id");DeleteRow(t.substring(2,t.indexOf("R")),t.split("R")[1])}function DeleteRow(dcNo,rowFrmNo,elem){if(elem!=undefined&&$(elem).hasClass("disabled"))return!1;if(axInlineGridEdit&&$(".inline-edit").length&&$(".inline-edit").attr("id")!=$(elem).closest("tr").attr("id")&&updateInlineGridRowValues(),-1==$j("#del"+rowFrmNo).attr("class").indexOf("disabledelete")){var glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var cutMsg=eval(callParent("lcm[5]"));if($.confirm({title:eval(callParent("lcm[155]")),content:cutMsg,escapeKey:"buttonB",rtl:isRTL,onContentReady:function(){disableBackDrop("bind")},buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"hotbtn",action:function(){try{axInlineGridEdit&&updateInlineGridRowValues(),DeleteGridRow(dcNo,rowFrmNo,undefined)}catch(e){AxWaitCursor(!1)}}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"coldbtn",action:function(){}}}}),arrRefreshDcs.length>0)for(var i=0;i<arrRefreshDcs.length;i++){var arrDcNos=arrRefreshDcs[i].split(":");if(arrDcNos[1]=="dc"+dcNo){arrRefreshFldDirty[i]=!0;break}}OnRowChangeSetHeight(dcNo),checkTableBodyWidths(dcNo),"True"==isTstPop&&TstructTabEventsInPopUP("")}}function SetFormDirty(e){IsFormDirty=e,window.parent.globalChange=e}function DeleteGridRow(e,t,a){ShowDimmer(!0),IsFormDirty||SetFormDirty(!0),AxActiveDc=e,IsFunction="",IsService=!1;var i="",r=t.split("F")[0],n=$j("#hdnRCntDc"+e).val();n=parseInt(n,10);GetDbRowNo(r,e);i="dc"+e;var l=GetFormatGridIndex(e),d=$j("#recordid000F0").val();if(ArrActionLog="DeleteRow-DcNo-"+e+"-rowno-"+t+"-Recordid-"+d,-1!=l){if(IsOnlyFormatGridRow(e,r,l)){UpdateSubTotalOnDelRow(l,e,r);var s=DcKeyColumns[l].toString();ClearDeletedFields(e,r,s,!0),AddDeletedRowsToArray(e,r),CallEvaluate(e,r,GetGridFields(e)),SetRowCount(e,n-1,"d");var o=GetFieldValue(s+r+"F"+e);if(a==undefined&&"cleared"!=GetGrpCntValue(e,o))SetGrpCntValue(e,GetFieldValue(s+r+"F"+e)),"undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?CallDeletePerfWS(i):CallDeleteWS(i);else"group"!=a&&(DeletedDCRows=new Array),ShowDimmer(!1),AxWaitCursor(!1);return}UpdateSubTotalOnDelRow(l,e,r)}var c=IsSingleRow(e);TstructHasPop&&IsDcParentGrid(e)&&(i+=","+GetPopGridDcNo(e),DeletePopRowsForDc(e,r));var p=!1;if(TstructHasPop&&(p=IsDcPopGrid(e)),c){AddDeletedRowsToArray(e,r),ClearDeletedFields(e,r),CallEvaluate(e,r,GetGridFields(e)),"0"!=d&&changeEditLayoutIds(0,e)}else{var u=GetSerialNoCnt(e);u=parseInt(u,10)-1,-1!=l&&ResetFormatGridSlNo(e,r,l),axInlineGridEdit||SetRowCount(e,n-1,"d"),SetSerialNoCnt(e,u),AddDeletedRowsToArray(e,r);var f="sp"+e+"R"+r+"F"+e;if($j("#"+f).hasClass("editWrapTr")||$j("#"+f).remove(),axInlineGridEdit&&SetRowCount(e,n-1,"d"),-1==l)for(var h=1;h<=n;h++){ResetRowStyle(GetRowNoHelper(h),e)}CheckScroll(e),p&&UpdatePopUpArrays(e,r,p,"Delete"),UpdateDcRowArrays(e,r,"Delete",l)}a==undefined&&("undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?CallDeletePerfWS(i):CallDeleteWS(i)),navValidator=!1}function CallDeleteWS(e){AxWaitCursor(!0);var t=GetOpenTabDcs(),a=$j("#recordid000F0").val(),i=traceSplitStr+"DeleteRow-"+transid+traceSplitChar,r=new Array;r=DeletedDCRows.slice(),DeletedDCRows=new Array;var n=e.toString().substring(2),l="",d="";IsDcPopGrid(n)&&(l=AxActivePRow,d=AxActivePDc);var s='<sqlresultset axpapp="'+proj+'" transid="'+transid+'" recordid="'+a+'" dcname="'+e+'"  dcnames="'+t+'" sessionid="'+sid+'" trace="'+i+'" prow="'+l+'" pdc="'+d+'">';try{ASB.WebService.DeleteRowWS(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,r,ArrActionLog,s,tstDataId,n,SuccessDelData,OnException)}catch(o){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}AxWaitCursor(!1)}function CallDeletePerfWS(e){AxWaitCursor(!0);var t=GetOpenTabDcs(),a=$j("#recordid000F0").val(),i=traceSplitStr+"DeleteRow-"+transid+traceSplitChar,r=new Array;r=DeletedDCRows.slice(),DeletedDCRows=new Array;var n=e.toString().substring(2),l="",d="";IsDcPopGrid(n)&&(l=AxActivePRow,d=AxActivePDc);var s='<sqlresultset axpapp="'+proj+'" transid="'+transid+'" recordid="'+a+'" dcname="'+e+'"  dcnames="'+t+'" sessionid="'+sid+'" trace="'+i+'" prow="'+l+'" pdc="'+d+'">';try{ASB.WebService.DeleteRowPerfWS(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,r,ArrActionLog,s,tstDataId,n,SuccessDelData,OnException)}catch(o){AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",ServerErrMsg)}AxWaitCursor(!1)}function SuccessDelData(e,t){CheckSessionTimeout(e)||(ArrActionLog="",ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,AssignLoadValues(e,"Delete"),IsDcPopGridCleared&&(IsDcPopGridCleared=!1,axInlineGridEdit||UpdateDcRowArrays(AxActiveDc,"001","Add")),ShowDimmer(!1))}function ErrorAddRowWS(){ArrActionLog="",ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,AxWaitCursor(!1),ShowDimmer(!1)}function IsSingleRow(e){return 0===$("#gridHd"+e+" tbody tr").length}function ClearDeletedFields(e,t,a,i){for(var r=GetGridFields(e),n=(GetDbRowNo(t,e),0);n<r.length;n++){var l=r[n]+t+"F"+e,d=document.getElementById(l);if(!a||a!=r[n]){if(r[n]=="axp_gridattach_"+e)$j("#grdAtt_hlnk_"+t+"F"+e).text("");if(d){if(l.toString().toLowerCase().startsWith("sub"+e+"_"))continue;"select-one"==d.type?d.options[0].selected=!0:"checkbox"==d.type?d.checked=!1:d.value=""}}}CheckGrdisplayHead(e,"",t,"Clear"),$j("#lblSlNo"+t+"F"+e).text("1"),SetSerialNoCnt(e,"1")}function GetGrpCntValue(e,t){var a="hdn"+e+t,i=GetFormatRowIndex("gridDc"+e,e,t,"strow"),r=$j("#gridDc"+e+" tbody>tr:eq("+i+")"),n="";return r.find("input").each(function(){if($j(this).attr("id")==a)return n=$j(this).val(),!1}),n}function SetGrpCntValue(e,t){var a="hdn"+e+t,i=GetFormatRowIndex("gridDc"+e,e,t,"strow");$j("#gridDc"+e+" tbody>tr:eq("+i+")").find("input").each(function(){if($j(this).attr("id")==a)return $j(this).val("cleared"),!1})}function RemoveDeletedFields(e){for(var t=0;t<ChangedFields.length;t++)ChangedFields[t]==e&&(ChangedFields.splice(t,1),ChangedFieldDbRowNo.splice(t,1),ChangedFieldValues.splice(t,1))}function DeletePopRowsForDc(e,t){for(var a=GetPopGrids(e).split(","),i=0;i<a.length;i++)if(GetParentFields(a[i])!=undefined){var r=GetPopRows(e,t,a[i]).split(",");r.sort();for(var n=r.length-1;n>=0;n--)""!=r[n]&&(AddDeletedRowsToArray(a[i],r[n]),UpdateDcRowArrays(a[i],r[n],"Delete",-1));ClearPopRows(e,t,a[i])}}function AddDeletedRowsToArray(e,t){var a="axp_recid"+e+t+"F"+e;a=GetFieldValue(a);t=GetDbRowNo(t,e);var i="dc"+e;if("0"!=a)if(DeletedDCs.length>0){var r=$j.inArray(i,DeletedDCs);if(-1!=r){var n=DeletedRows[r].toString()+","+a;DeletedRows[r]=n}else DeletedDCs.push(i),DeletedRows.push(a)}else DeletedDCs.push(i),DeletedRows.push(a);var l=t+"F"+e;DeletedDCRows.push(l)}function ResetSerialNo(e,t,a,i){var r=t.substring(0,t.indexOf("F")),n="#lblSlNo"+t,l=0;$j(n).length>0&&(l=$j(n).text(),parseInt(l,10)),0==(l=parseInt(l,10))&&(l=1);for(var d=(r=parseInt(r,10))+1;d<=a;d++){var s=GetRowNoHelper(d);i&&(s=GetClientRowNo(d,e));var o="#lblSlNo"+s+"F"+e;(o=$j(o)).length>0&&(o.text(l),l+=1)}}function ResetGridRowsStyle(e){$j("#gridDc"+e+" tr").each(function(){$j(this).attr("rowindex")%2==0?$j(this).addClass("grey1"):$j(this).removeClass("grey1")})}function ResetRowStyle(e,t){var a=$j("#lblSlNo"+e+"F"+t).text();a=parseInt(a,10);var i="#sp"+t+"R"+e+"F"+t;$j(i).attr("rowindex")%2==0?$j(i).addClass("grey1"):$j(i).removeClass("grey1")}function FormSubmit(){if(actionCallFlag==actionCallbackFlag){actionCallFlag=Math.random(),$("#icons").css({"pointer-events":"auto"}),""!=currentCK&&ShowdivContentCK($("#"+currentCK),!1);var e=new Date;AxStartTime=GetAxDate(e);var t=$j("#imgSaveTst");if(1==t.prop("disabled")||AxIsTstructLocked)return actionCallbackFlag=actionCallFlag,void $("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"});t.prop("disabled",!0),EnableSaveBtn(!1);var a=!0;try{a=AxBeforeSave()}catch(c){a=!0}if(a==undefined&&(a=!0),a){if(ShowDimmer(!0),AxWaitCursor(!0),!ValidateBeforeSubmit())return ShowDimmer(!1),AxWaitCursor(!1),actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),void EnableSaveBtn(!0);parent.window.name;FromSave=!0;var i=0;$j("#recordid000F0").length>0&&(i=$j("#recordid000F0").val());var r=UploadFiles(),n=GetDeletedRows(),l=GetChangedRows();try{if(CheckPattern()){var d=!1;try{d=AxSummaryDisplay()}catch(c){}d||ASB.WebService.SaveDataXML(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,DeletedFieldValue,r,i,n,l,tstDataId,SucceededCallback,OnException)}else actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1)}catch(p){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),ShowDimmer(!1),AxWaitCursor(!1),EnableSaveBtn(!0);var s=p.name+"^♠^"+p.message;showAlertDialog("error",2030,"client",s)}}else actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1);var o=new Date;AxTimeBefSerCall=o-e}else $("#icons").css({"pointer-events":"none"})}function refreshiframe(){var e=callParentNew("middle1","id"),t=callParentNew("axpiframe","id");-1!=e.src.indexOf("tstruct.aspx")&&t!=undefined?t.src=t.src:-1!=t.src.indexOf("tstruct.aspx")&&e!=undefined&&(e=e.src)}function ValidateBeforeSubmit(e){e=e||"";for(var t=0;t<FNames.length;t++){var a=GetFieldProp(t,"allowEmpty"),i=GetFieldProp(t,"visible");if(dcNo=GetDcNo(FNames[t]),""==e||e==dcNo){if(FNames[t].toString().toLowerCase().indexOf("axpcurrencydec")&&""!=currdecVal)return showAlertDialog("warning",2031,"client",currdecVal),!1;if("f"==a.toLowerCase()&&"f"==i.toLowerCase()){var r=0,n=IsGridField(FNames[t]);if(dcNo=GetDcNo(FNames[t]),1==n){var l;l=IsDcPopGrid(dcNo);var d=$j.inArray(dcNo,DCFrameNo);if(!l&&"False"==DCHasDataRows[d]){if("False"==DCAllowEmpty[d]){var s=GetDcCaption(dcNo);return showAlertDialog("warning",2054,"client",s),!1}continue}var o;dcNo;o=GetDcRowCount(dcNo);var c="";if(l&&(c=GetParentFields(dcNo))==undefined&&(c=new Array),!axInlineGridEdit&&1==o&&0==$("#gridHd"+dcNo+" tbody tr").length){s=GetDcCaption(dcNo);return showAlertDialog("warning",2054,"client",s),!1}for(var p=1;p<(axInlineGridEdit?o+1:o);p++){p=GetRowNoHelper(p);var u=!1;if(l){r=dcNo;for(var f=0;f<c.length;f++){var h=GetSubFieldId("sub"+r+"_"+c[f],p,r);if($j("#"+h).length>0&&(""==GetFieldValue(h)||"***"==GetFieldValue(h))){u=!0;break}}}if(!u&&!$j("#sp"+dcNo+"R"+p+"F"+dcNo).hasClass("editWrapTr")){if(gridDummyRowVal.length>0){var v=!1;if(gridDummyRowVal.map(function(e){e.split("~")[0]==dcNo&&e.split("~")[1]==p&&(v=!0)}),v)return v}if(0==IsAxFldEmpty(t,p,dcNo))return!1}}}else if(0==IsAxFldEmpty(t,"000",dcNo))return!1}var m;if(FNames[t].toString().toLowerCase().indexOf("validate_")>-1&&"image"==FDataType[t].toString().toLowerCase())if(FNames[t].indexOf("validate_gridattach_")>-1){if("true"==(m=$j("#"+FNames[t]+"001F"+dcNo).val()).toString().toLowerCase())for(var g=1;g<GetDcRowCount(dcNo)+1;g++){var b=$j("#axp"+FNames[t].toString().replace("validate","")+"00"+g+"F"+dcNo);if(null==b||b==undefined||""==b.val()){showAlertDialog("warning",2055,"client",FCaption[FNames.indexOf("axp"+FNames[t].toString().replace("validate",""))]);FldFrameNo[t];return SetFocusOnField(dcNo,FNames[t]+"000F"+dcNo),!1}}}else if(""==(m=$j("#"+FNames[t].toString().replace("validate_","")+"000F"+dcNo))[0].src||null==m[0].src||m[0].src.indexOf("/AxpImages/upload.png")>-1){showAlertDialog("warning",2055,"client",FCaption[FNames.indexOf(FNames[t].toString().replace("validate_",""))]);FldFrameNo[t];return SetFocusOnField(dcNo,FNames[t]+"000F"+dcNo),!1}}}return!0}function ClearFieldsInDC(e){var t=IsDcGrid(e);if(t)ClearRowsInGrid(e);else for(var a=GetGridFields(e),i=0;i<a.length;i++)fld=t?a[i]+"001F"+e:a[i]+"000F"+e,CallSetFieldValue(fld,""),UpdateFieldArray(fld,1,"","parent")}function IsAxFldEmpty(e,t,a,i){var r=!1,n=GetClientRowNo(t,a);if($j("#"+FNames[e]+n+"F"+a).length>0){var l=FDataType[e],d=GetFieldValue(FNames[e]+n+"F"+a);if(("Numeric"==l&&0==parseFloat(d)||""==d)&&(r=!0),r){if("Edit"==i&&(t=GetDbRowNo(t,a),t=GetRowNoHelper(t)),IsDcGrid(a))if(axInlineGridEdit){var s=50;$("[inline-grid-warning]").removeAttr("inline-grid-warning"),showAlertDialog("warning",2056,"client",FCaption[e]+"^♠^"+parseInt(t,10)),$("#li"+a).hasClass("active")||(s=300,$("#ank"+a).click()),setTimeout(function(){$("#"+FNames[e]+n+"F"+a).closest("td").attr("inline-grid-warning","").click()},s)}else showAlertDialog("warning",2056,"client",FCaption[e]+"^♠^"+parseInt(t,10));else showAlertDialog("warning",2055,"client",FCaption[e]);return SetFocusOnField(a,FNames[e]+t+"F"+a),!1}}return!0}function createInlineErrorInGrid(fld,rowNo,dcNo,idx){var cutMsg=eval(callParent("lcm[60]")),errorMessage=FCaption[idx]+" "+cutMsg,errorMessageHtml='<p id="FEE'+FNames[idx]+GetRowNoHelper(rowNo)+"F"+dcNo+'" class="IlError text-danger">'+errorMessage+"</p>";$("#wrapperForEditFields"+dcNo+" .IlError").remove(),fld.parents("div.gridElement ").append(errorMessageHtml)}function EnableSaveBtn(e){var t=$j("#imgSaveTst");EnableDisableBtns(t,e),e&&t.removeProp("disabled"),EnableDisableBtns($j("#imgDraftSaveTst"),e),EnableDisableBtns($j("#dvsubmitCancelBtns #btnSaveTst"),e),EnableDisableBtns($j("#dvsubmitCancelBtns #New"),e),EnableDisableBtns($j("#dvsubmitCancelBtns #btnDraftSave"),e)}function UploadFiles(){for(var e="",t=0;t<filenamearray.length;t++)e+=""==e?filenamearray[t]:","+filenamearray[t];return e}function CheckPattern(){for(var e="",t="",a=0;a<Patterns.length;a++){t=Patterns[a];var i=PatternNames[a].substring(0,3);e=PatternNames[a].substring(3);var r=GetDcNo(e);if("ng_"==i){if(!EvaluatePattern(e=e+"000F"+r,t))return!1}else if("gr_"==i){var n=parseInt(GetDcRowCount(r),10);for(k=1;k<=n;k++){var l=k+"",d=l.length;if(2==d?nrno="0"+l:1==d?nrno="00"+l:3==d&&(nrno=l),e=e+nrno+"F"+r,$j("#"+e).length>0&&!EvaluatePattern(e,t))return!1}}}try{return AxValidSave()}catch(s){}return!0}var recordidax="",printWindow;function SucceededCallback(resultJson,eventArgs){var stTime=new Date,grdMsg="";if(AxActiveAction="Save",!CheckSessionTimeout(resultJson)){GetFldSetCarryValue(),resultJson=resultJson.replace(new RegExp("\\n","g"),"");var clrCacheKeys=resultJson.split("*#*")[1];void 0!==clrCacheKeys&&""!=clrCacheKeys&&(console.log("Clearing cache in save"),ClearRedisKeys(clrCacheKeys)),resultJson.indexOf("*#*")>-1&&(resultJson=resultJson.substring(0,resultJson.indexOf("*#*")));var strResult1=resultJson.split("♣"),hold=!1;fldMsg=GetSaveDirectiveValue();for(var i=0;i<strResult1.length;i++){strResult=strResult1[i].split("*$*");for(var j=0;j<strResult.length;j++){try{var resJson=$j.parseJSON(strResult[j])}catch(ex){ShowDimmer(!1)}var recIdDetails="",restxt="",result="";if(resJson!=undefined){if(resJson.message!=undefined){for(var k=0;k<resJson.message.length;k++)if(result=resJson.message[0].msg,-1!=result.indexOf(",")){var strMsg=result.split(",");recIdDetails=strMsg.pop(strMsg.length),result=strMsg.join(",")}}else resJson.error!=undefined?(restxt=ErrStr,result=resJson.error[0].msg):resJson.timetaken!=undefined?ExecTimetaken(resJson.timetaken):resJson.GridAttachments!=undefined&&(grdMsg=resJson.GridAttachments[0].Message);if("Dataloss"==result)return ShowDialog("error",2001,"client"),EnableSaveBtn(!0),AxWaitCursor(!1),void ShowDimmer(!1);if(-1!=result.indexOf(";bkslh")&&(result=result.replace(new RegExp(";bkslh","g"),"\\")),""!=result)if(""!=grdMsg&&(result=result+" :"+grdMsg),fldMsg!=undefined&&""!=fldMsg&&(result.indexOf("(")>-1&&(result=result.substring(0,result.indexOf("("))),result=result+" , ("+fldMsg+") "),ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,DeletedFieldValue=new Array,restxt!=ErrStr){window.status=eval(callParent("lcm[76]"));for(var n=0;n<filenamearray.length;n++)fileonloadarray.push(filenamearray[n]),RemoveArrVal(filenamearray[n],filenamearray);ConstructAttachments(),recordidax=recIdDetails.substring(recIdDetails.indexOf("=")+1),axSaveRecId=recIdDetails.substring(recIdDetails.indexOf("=")+1);var recidIdx=result.toString().lastIndexOf("~");if(-1!=recidIdx){var presentFrame=$(window.frameElement);"homePageDynamicFrame"===presentFrame.attr("id")?parent.reloadTheWidget&&parent.reloadTheWidget({widgetTarget:presentFrame.data("calledElemntId")}):"axpiframe"===presentFrame.attr("id")&&ReloadMiddleIframe(),ShowDialog("success",result.toString().substring(0,recidIdx))}else if(!callParentNew("isDWB")||"sect"!=transid&&"ad_ih"!=transid)try{AxCustomSaveRedirect()}catch(ex){var _presentFrame=$(window.frameElement);"homePageDynamicFrame"===_presentFrame.attr("id")?parent.reloadTheWidget&&parent.reloadTheWidget({widgetTarget:_presentFrame.data("calledElemntId")}):"axpiframe"===_presentFrame.attr("id")&&ReloadMiddleIframe();var src=$(eval(callParent("popupIframeRemodal"))).attr("src");src!=undefined&&-1!=src.indexOf("AxPop=true")&&eval(callParent("isRefreshParentOnClose")+"= true"),ShowDialog("success",result),eval(callParent("isSuccessAlertInPopUp")+"= true"),SetFormDirty(!1)}else try{dwbCustomSaveRedirect()}catch(ex){}if(AxIsTstructCached&&""!=recIdDetails){var recId=recIdDetails.substring(recIdDetails.indexOf("=")+1);SaveInCache(recId,"Save")}if(IsDraftLoad&&0!=window.parent.draftsWin&&window.parent.draftsWin!=undefined)try{window.parent.draftsWin.$j("#btnGetDrafts").click()}catch(ex){}recordidax&&"axcad"==transid&&clearCardCache(recordidax)}else{if(restxt==ErrStr){EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1),ShowDialog("error",result);try{AxAfterSaveOnError()}catch(ex){}return}var reslen=result.length,endpt=reslen-8,finalerr=result.substring(7,endpt),stPos=finalerr.indexOf("["),endPos=finalerr.indexOf("]"),tempStr="",tempStr1="",errFld;if(stPos<0&&endPos<0);else{if(tempStr=finalerr.substring(0,stPos),tempStr1=finalerr.substring(endPos+2),errFld=finalerr.substring(stPos+1,endPos),""!=errFld){var nerr=finalerr.substring(stPos,endPos+2);finalerr=finalerr.replace(nerr,"")}finalerr=tempStr1.indexOf(tempStr)>-1?tempStr1:tempStr+tempStr1}ShowDialog("error",finalerr);var errDcNo=GetDcNo(errFld);errFld=errFld+"000F"+errDcNo;var focusFld=$j("#"+errFld);focusFld.length>0&&focusFld.focus()}}}}if("true"==AxLogTimeTaken){var edTime=new Date,diff=edTime.getTime()-stTime.getTime();CreateTimeLog(AxStartTime,AxTimeBefSerCall,diff,ASBTotal,ASBDbTime,"SaveData")}ShowDimmer(!1),AxWaitCursor(!1)}}function GetSaveDirectiveValue(){var e,t,a,i,r="";return(a=$j("#axp_savedirective000F1").val())!=undefined&&a.indexOf("display")>-1&&(e=a.split("~")).length>1&&(t=e[1],i=GetActualFieldName(t),r=t+" : "+GetFieldValue(i)),r}function OpenPdfDocList(){if(recID=parseInt(recordid),"0"!=recID){var e=$j("#pdfFName").children("option").length;0==e?showAlertDialog("error",2003,"client"):e>1?displaypdfdiv("dvPDFDocList","PDF"):CallPDFws()}else showAlertDialog("error",2002,"client")}function OpenSearch(e){var t=null,a,i;displaysearchDiv("searchoverlay","Search")}function NewTstruct(){if(window.opener?window.opener.parent.disableNavigation=!0:window.parent.disableNavigation=!0,$(".lnkPrev").addClass("hide"),$(".lnkNext").addClass("hide"),window.parent.globalChange){var cutMsg=eval(callParent("lcm[31]")),glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var NewTstructCB=$.confirm({closeIcon:!1,rtl:isRTL,title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:!0,escapeKey:"buttonB",content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){NewTstructCB.close(),window.parent.loadFrame(),SetFormDirty(!1),window.parent.isSessionCleared=!0,AxWaitCursor(!0),ShowDimmer(!0),window.opener?GetFormLoadData("AxIsPop=true"):GetFormLoadData("")}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){ShowDimmer(!1),closeParentFrame(),disableBackDrop("destroy"),window.parent.isSessionCleared=!0}}}})}else window.parent.loadFrame(),window.parent.isSessionCleared=!0,SetFormDirty(!1),AxWaitCursor(!0),ShowDimmer(!0),window.opener?GetFormLoadData("AxIsPop=true"):GetFormLoadData("")}function GetFormLoadData(e,t){var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"false";void 0===t&&(t="false"),checkIsdraft=t;try{$.ajax({url:"tstruct.aspx/GetFormLoadValues",type:"POST",cache:!1,async:!0,data:JSON.stringify({key:tstDataId,tstQureystr:e,isDraft:t,forceRefresh:a}),dataType:"json",contentType:"application/json",success:function(e){var t=e.d;if(Closediv(),-1===t.toLowerCase().indexOf("access violation")){if(ArrActionLog="",CheckSessionTimeout(t))return;if(actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),isReadyCK=!1,DCFrameNo.forEach(function(e){ClearFieldsInDC(e)}),ExprPosArray.forEach(function(e,t){""!=e&&(ExprPosArray[t]="")}),navValidator=!0,SetFormDirty(!1),blurNextPreventId="",document.title="Tstruct",recordid="0",$j("#recordid000F0").val("0"),RegVarFldList=new Array,ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,AxExecFormControl=!1,DisabledDcs=new Array,AxFormContHiddenFlds=new Array,AxFormContSetCapFlds=new Array,AxFormContSetCapFldsGrid=new Array,AxFormContSetFldActGrid=new Array,AxFormContFldSetFocus=new Array,multiSelectflds=new Array,multiSelFldParents=new Array,multiSelFldResult=new Array,multiSelectLoadVals=new Array,imgNames=new Array,imgSrc=new Array,changeFillGridDc=0,isMobile&&OnMobileNewTst(),""!=t){var a=t.split("*$*");if(""==a[0])return void window.location.reload();$("#tblWrk").html(""),$("#collapseOneTable").html(""),$j(".workflow").remove(),$j(".wrkflwinline").remove(),$j(".workflowMsg").remove(),$j(".downArr").remove(),$j(".Selectboxlist").remove(),$j("#workflowoverlay").css("display","none"),$j("#dvMessage").html(""),$j("#dvMessage").removeClass("AXinfo").addClass("success hide"),$j("#file").css("display","none").addClass("hide"),$j("#attachment-overlay").html(""),$j("#attachfname").val(""),attachments="",filenamearray=new Array,fileonloadarray=new Array,$("#hdnTabHtml").val(a[2]);var r=a[3];""!=r&&(wsPerfFormLoadCall="true"==r.split(";")[0],wsPerfEvalExpClient=r.split(";")[1].split(","),headerAttachDir=r.split(";")[2]);var n=a[4];if(""!=n)for(n=n.split("♠"),i=0;i<n.length;i++)imgNames[i]=n[i].split("♦")[0],imgSrc[i]=n[i].split("♦")[1],""!=imgSrc[i]&&(imgSrc[i]=imgSrc[i].replace("%20"," "));if(""!=a[5])a[5].split(",").forEach(function(e,t){TabDCStatus[t]=e});displayAutoGenVal=a[6],$j("#hdnShowAutoGenFldValue").val(displayAutoGenVal),tstructCancelled=a[7],tstDataId=a[8],$j("#hdnDataObjId").val(tstDataId),LoadResult=t,isLoadDataCall=!1,ReloadJqueryReference(),isTstPostBackVal=a[0]+"*$*"+a[1]}}else blurNextPreventId="",actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1),SetFormDirty(!1),$("#reloaddiv").show(),$("#dvlayout").hide()},error:function(e){Closediv(),blurNextPreventId="",actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1),SetFormDirty(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}})}catch(r){Closediv(),blurNextPreventId="",actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1),SetFormDirty(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}}function GetLoadData(e,t){try{$.ajax({url:"tstruct.aspx/GetLoadDataValues",type:"POST",cache:!1,async:!0,data:JSON.stringify({key:tstDataId,recordid:e,tstQureystr:t}),dataType:"json",contentType:"application/json",success:function(t){var a=t.d;if(Closediv(),-1===a.toLowerCase().indexOf("access violation")){if(ArrActionLog="",CheckSessionTimeout(a))return;if(""!=a){actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),isReadyCK=!1,DCFrameNo.forEach(function(e){ClearFieldsInDC(e)}),ExprPosArray.forEach(function(e,t){""!=e&&(ExprPosArray[t]="")}),navValidator=!0,SetFormDirty(!1),blurNextPreventId="",RegVarFldList=new Array,ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,AxExecFormControl=!1,DisabledDcs=new Array,AxFormContHiddenFlds=new Array,AxFormContSetCapFlds=new Array,AxFormContSetCapFldsGrid=new Array,AxFormContSetFldActGrid=new Array,AxFormContFldSetFocus=new Array,multiSelectflds=new Array,multiSelFldParents=new Array,multiSelFldResult=new Array,multiSelectLoadVals=new Array,changeFillGridDc=0,imgNames=new Array,imgSrc=new Array,isMobile&&OnMobileNewTst(),document.title="Load Tstruct",recordid=e,$j("#recordid000F0").val(e);var r=a.split("*$*");if(""==r[0])return void window.location.reload();$("#tblWrk").html(""),$("#collapseOneTable").html(""),$j(".workflow").remove(),$j(".wrkflwinline").remove(),$j(".workflowMsg").remove(),$j(".downArr").remove(),$j(".Selectboxlist").remove(),$j("#workflowoverlay").css("display","none"),$j("#dvMessage").html(""),$j("#dvMessage").removeClass("AXinfo").addClass("success hide"),$j("#file").css("display","none").addClass("hide"),$j("#attachment-overlay").html(""),$j("#attachfname").val(""),attachments="",filenamearray=new Array,fileonloadarray=new Array,$("#hdnTabHtml").val(r[2]);var n=r[3];""!=n&&(wsPerfFormLoadCall="true"==n.split(";")[0],wsPerfEvalExpClient=n.split(";")[1].split(","),headerAttachDir=n.split(";")[2]);var l=r[4];if(""!=l)for(l=l.split("♠"),i=0;i<l.length;i++)imgNames[i]=l[i].split("♦")[0],imgSrc[i]=l[i].split("♦")[1],""!=imgSrc[i]&&(imgSrc[i]=imgSrc[i].replace("%20"," "));if(""!=r[5])r[5].split(",").forEach(function(e,t){TabDCStatus[t]=e});tstructCancelled=r[6],tstDataId=r[7],$j("#hdnDataObjId").val(tstDataId),LoadResult=a,Closediv(),isLoadDataCall=!0,ReloadJqueryReference(),isTstPostBackVal=r[0]+"*$*"+r[1]}}else blurNextPreventId="",actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1),SetFormDirty(!1),$("#reloaddiv").show(),$("#dvlayout").hide()},error:function(e){Closediv(),blurNextPreventId="",actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1),SetFormDirty(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}})}catch(a){Closediv(),blurNextPreventId="",actionCallbackFlag=actionCallFlag,$("#icons,#btnSaveTst,.wizardNextPrevWrapper").css({"pointer-events":"auto"}),FromSave&&(FromSave=!1),EnableSaveBtn(!0),AxWaitCursor(!1),ShowDimmer(!1),SetFormDirty(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}}function DeleteTstruct(){if(AxIsTstructLocked)showAlertDialog("warning",2008,"client");else{AxStartTime=new Date,AxStartTime=GetAxDate(AxStartTime);var stTime=new Date,rid="0";if(rid=($j("#recordid000F0").val(),$j("#recordid000F0").val()),trace=traceSplitStr+"DeleteData-"+tst+traceSplitChar,"0"==rid)showAlertDialog("warning",2009,"client");else{if("cancelled"==tstructCancelled.toLowerCase())return void showAlertDialog("warning",2010,"client");var cutMsg=eval(callParent("lcm[5]")),glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var DeleteTstructCB=$.confirm({closeIcon:!1,title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:!0,escapeKey:"buttonB",rtl:isRTL,content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){DeleteTstructCB.close();var e="";if("0"==rid)showAlertDialog("warning",2011,"client");else{e=e+'<Transaction axpapp="'+proj+'" transid="'+tst+'" recordid="'+rid+'" action="delete" trace="'+trace+'" sessionid="'+sid+'" allowCancel="'+AxAllowCancel+'"> ';try{ASB.WebService.DeleteDataXML(rid,e,tstDataId,AxAllowCancel,SucceededCallbackDelTst)}catch(a){AxWaitCursor(!1);var t=a.name+"^♠^"+a.message;showAlertDialog("error",2030,"client",t)}}}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy")}}}})}var edTime=new Date;AxTimeBefSerCall=edTime-stTime}}function SucceededCallbackDelTst(result,eventArgs){var stTime=new Date,isLogCalled=!1;if(!CheckSessionTimeout(result)){var clrCacheKeys=result.split("*#*")[1];void 0!==clrCacheKeys&&""!=clrCacheKeys&&(console.log("Clearing cache in delete"),ClearRedisKeys(clrCacheKeys)),result.indexOf("*#*")>-1&&(result=result.substring(0,result.indexOf("*#*")));for(var resval=result.split("*$*"),ind=0;ind<resval.length;ind++){var strSingleLineText=resval[ind].toString().replace(new RegExp("\\n","g"),"");if(""==strSingleLineText)return;var myJSONObject=$j.parseJSON(strSingleLineText);if(myJSONObject.error)ExecErrorMsg(myJSONObject.error,"Delete");else if(myJSONObject.timetaken)ExecTimetaken(myJSONObject.timetaken);else{if("true"==AxLogTimeTaken){var edTime=new Date,diff=edTime.getTime()-stTime.getTime();CreateTimeLog(AxStartTime,AxTimeBefSerCall,diff,ASBTotal,ASBDbTime,"DeleteData"),isLogCalled=!0}if(showAlertDialog("success",2012,"client"),recordid&&"axcad"==transid&&clearCardCache(recordid,!0),window.frameElement&&window.frameElement.id&&"popupIframeRemodal"===window.frameElement.id){if(callParentNew("isDWB")&&"ad_ih"==transid)try{dwbCustomDeleteRedirect()}catch(ex){}eval(callParent("isSuccessAlertInPopUp")+"= true"),SetFormDirty(!1),$j("#axpertPopupWrapper .remodal-close",window.parent.document).click()}else if(callParentNew("isDWB")&&"sect"==transid)try{dwbCustomDeleteRedirect()}catch(ex){}else window.location.href="tstruct.aspx?transid="+tst;window.parent.isSessionCleared=!0,ResetNavGlobalVariables()}}if("true"==AxLogTimeTaken&&0==isLogCalled){var edTime=new Date,diff=edTime.getTime()-stTime.getTime();CreateTimeLog(AxStartTime,AxTimeBefSerCall,diff,ASBTotal,ASBDbTime,"DeleteData")}var presentFrame=$(window.frameElement);"0"!=recordid&&"axpiframe"===presentFrame.attr("id")&&ReloadMiddleIframe()}}function OpenPrint(e){try{ASB.WebService.GetPrintDocs(tst,SuccessGetDocs)}catch(a){AxWaitCursor(!1);var t=a.name+"^♠^"+a.message;showAlertDialog("error",2030,"client",t)}}function SuccessGetDocs(e,t){var a='<div><label id="lblSelect">Select Print Form</label><select id="ddlPrintForms" class="combotem Family  form-control " >';if(e.length>0){var i=0;for(i=0;i<e.length;i++){var r=e[i].split("♣");a+="<option value="+r[0]+">"+r[1]+"</option>"}}a+='</select><br /><div class="pull-right"><input type="button" class="hotbtn btn" value="Open" onclick="javascript:AddPrintDoc();" /></div></div>',displayBootstrapModalDialog("Print Docs","","200px","",a)}function AddPrintDoc(){var e=$j("#recordid000F0").val(),t=$j("#ddlPrintForms").find("option:selected").text(),a=$j("#ddlPrintForms").val();if("-- Select --"!=t)try{"doc"==a?ASB.WebService.AddPrintDoc(tst,t,e,tstDataId,a,SuccessAddPrintDoc):ASB.WebService.CreateFastReportDoc(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,tst,t,e,tstDataId,SuccessFastReportDoc)}catch(r){var i=r.name+"^♠^"+r.message;showAlertDialog("error",2030,"client",i)}else showAlertDialog("warning",2013,"client")}function SuccessFastReportDoc(e,t){CheckSessionTimeout(e)||AssignLoadValues(e,"")}function SuccessAddPrintDoc(e,t){if(!CheckSessionTimeout(e)){try{$j("#dvPrintDoc").dialog("close")}catch(a){}parent.RefreshPrintDocs()}}function CancelTstruct(){if("Cancelled"!=tstructCancelled){var rid="0";if("0"!=$j("#recordid000F0").val()&&(rid=$j("#recordid000F0").val()),0==AxAllowCancel)return showAlertDialog("warning",2014,"client");if(trace=traceSplitStr+"CancelData-"+tst+traceSplitChar,"0"==rid)showAlertDialog("warning",2009,"client");else{var cutMsg=eval(callParent("lcm[61]")),glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var CancelTstructCB=$.confirm({closeIcon:!1,rtl:isRTL,title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:!0,escapeKey:"buttonB",content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function action(){CancelTstructCB.close();var txt="";if("0"==rid)showAlertDialog("warning",2015,"client");else{var left=screen.width/2-175,top=screen.height/2-75,newWindow;try{newWindow=window.open("cancel.aspx?transid="+tst+"&rid="+rid,"MyPopUp","width=550,height=170,scrollbars=no,resizable=yes,top="+top+",left="+left)}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy")}}}})}}}function CancelData(){var e=$j("#comments").val();if(""==e||0==e.length)showAlertDialog("warning",2016,"client");else{trace=traceSplitStr+"CancelData-"+tst+traceSplitChar;var t="";t=(t=t+'<Transaction axpapp="'+proj+'" transid="'+tst+'" recordid="'+recordid+'" action="cancel" trace="'+trace+'" sessionid="'+sid+'" allowCancel="'+AxAllowCancel+'"> ')+"<comments>"+document.getElementById("comments").value+"</comments>";var a=window.opener.tstDataId;try{ASB.WebService.DeleteDataXML(recordid,t,a,AxAllowCancel,SucceededCallbackOnCancel)}catch(r){AxWaitCursor(!1);var i=r.name+"^♠^"+r.message;showAlertDialog("error",2030,"client",i)}}}function SucceededCallbackOnCancel(e,t){if(!CheckSessionTimeout(e))if(e.substring(0,7)==ErrStr){var a=e.substring(7,e.length-8);showAlertDialog("error",a)}else{e=e.replace(new RegExp("\\n","g"),"");var i=$j.parseJSON(e);i.error?(ExecErrorMsg(i.error,"CancelTrans"),window.close()):(showAlertDialog("info",2017,"client"),window.close(),window.opener.location.href="tstruct.aspx?transid="+tst)}}function ShowDc(e){var t=$("#dcButspan"+e),a=document.getElementById("divDc"+e);if(t){var i=t.data("type");"hide"==i?(t.data("type","show"),t.attr("title","Show Dc"),t.removeClass(" glyphicon-chevron-down icon-arrows-up").addClass(" glyphicon-chevron-down icon-arrows-down"),a&&(a.style.display="none")):"show"==i&&(t.data("type","hide"),t.attr("title","Hide Dc"),t.removeClass(" glyphicon-chevron-down icon-arrows-down").addClass(" glyphicon-chevron-down icon-arrows-up"),a&&(a.style.display="block"))}}function showHideTabbedDc(e){"Hide Dc"==$(e).attr("title")?($(e).attr("title","Show Dc").removeClass("icon-arrows-up").addClass("icon-arrows-down"),$("[id^='tabsCont']").hide()):($(e).attr("title","Hide Dc").removeClass("icon-arrows-down").addClass("icon-arrows-up"),$("[id^='tabsCont']").show())}function ProcessRow(){var recid="";if(recid=$j("#recordid000F0").val(),"0"==recid)showAlertDialog("warning",2009,"client");else{var left=screen.width/2-175,top=screen.height/2-75,newWindow;try{newWindow=window.open("pdfparams.aspx?sname="+tst+"&recid="+recid+"&stype=tstructs","_self","width=350,height=150,resizable=yes,top="+top+",left="+left)}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}}function CallListView(tid){if(window.parent.globalChange){var cutMsg=eval(callParent("lcm[31]")),glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var CallListViewCB=$.confirm({closeIcon:!1,title:eval(callParent("lcm[155]")),rtl:isRTL,onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:!0,escapeKey:"buttonB",content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){CallListViewCB.close(),ShowDimmer(!0),window.parent.listViewPage="0",window.document.location.href="./iview.aspx?ivname=".concat(tid,"&tstcaption=").concat(tstructCaption),SetFormDirty(!1),window.parent.isSessionCleared=!0}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){ShowDimmer(!1),disableBackDrop("destroy"),closeParentFrame(),window.parent.isSessionCleared=!0}}}})}else window.parent.listViewPage="0",ShowDimmer(!0),window.document.location.href="./iview.aspx?ivname=".concat(tid,"&tstcaption=").concat(tstructCaption),window.parent.isSessionCleared=!0}function UploadImg(e){IsFormDirty||SetFormDirty(!0);var t=$("#isAxpImagePathHidden").val();"true"==t?displayBootstrapModalDialog("Image Upload","xs","150px",!0,"./imageUpload.aspx?tid="+tst+"&recordid=0&fldname="+e+"&isAxpImagePath="+t+"&AxpCameraOption="+AxpCameraOption):displayBootstrapModalDialog("Image Upload","xs","150px",!0,"./imageUpload.aspx?tid="+tst+"&recordid=0&fldname="+e+"&AxpCameraOption="+AxpCameraOption)}function ViewComments(){var e=$j("#recordid000F0").val(),t="./Comments.aspx?transid="+tst+"&recordid="+e;window.open(t,"SaveWindow","width=840,height=600,scrollbars=yes,resizable=yes")}function ValidateComments(e,t){return""==e.toString().trim()&&"approve"!=t.toLowerCase()?($("#lblreject").text("Please enter the comments."),$("#comment").focus(),!1):!0}function HideTaskList(e){var t=$j("#taskListPopUp");if("true"==e&&t.hide(),1==IsTaskBtnCliked&&(IsTaskBtnCliked=!1,t.hide()),"paget"==transid&&""==AxActiveAction){var a="",i="";if(window.location.search.split("?").length>1)for(var r=window.location.search.split("?")[1].split("&"),n=0;n<r.length;n++){var l=r[n].split("=")[0];"oldrecid"==l||"oldferecid"==l?a=r[n].split("=")[1]:"structname"==l&&(i=r[n].split("=")[1])}""!=i&&(window.location.href="tstruct.aspx?act=load&transid="+i+"&recordid="+a+"&AxSplit=true")}}function OpenHistory(e){var t=$j("#recordid000F0").val();screen.width,screen.height;displayBootstrapModalDialog("View History","xs","180px",!0,"./ViewHistory.aspx?tid="+e+"&rid="+t)}function AlertNoAction(){showAlertDialog("warning",2018,"client")}function SearchOpen(e){window.chrome&&$j("#HdnAxAdvPickSearch").val("true");var t;if(t=e.attr("id").split("~")[1].toString(),fldPk=$j("#"+t),fldPk.length>0&&(AxOldValue=fldPk.val()),1!=fldPk.prop("disabled")){var a=GetFieldsDcNo(t),i=GetFieldsName(t),r=GetFieldsRowNo(t),n="";""!=AxActivePRow&&""!=AxActivePDc&&(n=AxActivePDc+"~"+AxActivePRow);var l="";IsParentField(i,a)&&(l=GetSubGridInfoForParent(a,r));var d="";-1!=(d=$j("#"+t).val()).indexOf("#")&&(d=d.replace(/#/,"hash;")),AxActiveRowNo=GetDbRowNo(r,a);var s=tstDataId;if($j("#"+t).hasClass("fldAutocomplete")){var o="./AutoComplete.aspx?search="+d+"&fldname="+t+"&transid="+tst+"&activeRow="+AxActiveRowNo+"&frameno="+a+"&key="+s+"&parStr="+n+"&subStr="+l;createPopup(o,"73vw")}else{o="./srchComponent.aspx?search="+d+"&fldname="+t+"&transid="+tst+"&activeRow="+AxActiveRowNo+"&frameno="+a+"&key="+s+"&parStr="+n+"&subStr="+l;window.open(o,"SaveWindow","width=800,height=530,scrollbars=no,resizable=yes").focus()}}}function SetSelectedValue(e,t){if(AxWaitCursor(!0),ShowDimmer(!0),-1!=e[e.selectedIndex].value){var a=document.form1.fname.value;if(null==window.opener)var i=$j("#"+a,parent.window.document),r=$j("#pickfld000F0",parent.window.document);else i=$j("#"+a,window.opener.document),r=$j("#pickfld000F0",window.opener.document);var n=a.lastIndexOf("F"),l=(a.substring(0,n-3),GetFieldsRowNo(a)),d=GetFieldsDcNo(a),s=parent.GetDbRowNo(l,d),o=a.substring(n-3,a.length),c=e[e.selectedIndex].value;"*"==c&&(c="");var p="";-1!=c.indexOf("¿")&&(p=c.substring(0,c.indexOf("¿")),c=c.substring(c.indexOf("¿")+1)),i.val(c),r&&r.val(a),UpdateFieldArray(a,s,c,"popup"),null==window.opener?(frSearchFld=$j("#pickIdVal_"+a,parent.window.document),frSearchFld.length>0&&(frSearchFld.val(p),parent.window.document.AxFromAssociated=!0)):(frSearchFld=$j("#pickIdVal_"+a,window.opener.document),frSearchFld.length>0&&(frSearchFld.val(p),window.opener.AxFromAssociated=!0));var u=document.getElementById(t);if(u.options.length>0&&-1!=u[e.selectedIndex].value){var f=u[e.selectedIndex].value;f=f.split("~");for(var h=0;h<f.length;h++)if(""!=f[h]){var v=f[h].toString(),m=(v=v.split("***"))[0]+o;null==window.opener?fillfield=parent.window.document.getElementById(m):fillfield=window.opener.document.getElementById(m),fillfield&&"radio"!=fillfield.type&&("*"==v[1]&&(v[1]=""),UpdateFieldArray(m,s,v[1],"popup"),fillfield.value=v[1])}}UpdateParentArray();try{i&&!i.disabled&&i.focus()}catch(g){}null==window.opener?parent.closeRemodalPopup():window.close()}AxWaitCursor(!1),ShowDimmer(!1)}function UpdateParentArray(){if(fldNewNameArr.length>0)for(var e=0;e<fldNewNameArr.length;e++)null==window.opener?(parent.window.ChangedFields.push(fldNewNameArr[e].toString()),parent.window.ChangedFieldDbRowNo.push(fldNewDbRowNo[e].toString()),parent.window.ChangedFieldValues.push(fldNewValueArr[e].toString()),parent.window.ChangedFieldOldValues.push("")):(window.opener.ChangedFields.push(fldNewNameArr[e].toString()),window.opener.ChangedFieldDbRowNo.push(fldNewDbRowNo[e].toString()),window.opener.ChangedFieldValues.push(fldNewValueArr[e].toString()),window.opener.ChangedFieldOldValues.push(""));null==window.opener?AxBlurAction="Default":window.opener.AxBlurAction="Default"}function CheckSpecialCharsInXml(e){return e=(e=(e=(e=(e=(e=e).replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")}var actname="",wfButStatus;function CheckFields(e){try{AxBeforeWFAction()}catch(p){}var t="",a=transid,i=(FNames.length,$j("#recordid000F0").val()),r=$j("#comment").val(),n=traceSplitStr+"Workflow-"+a+traceSplitChar,l=ValidateComments(r,actname=e.value);wfButStatus=GetWFButStatus(),DisableWFButtons(),l&&("btntabreject"==e.id&&0==AxOnRejectSave||"btntabreturn"==e.id&&0==AxOnReturnSave)&&(AxGlobalChange=!1);var d="";$j("#hdnWfLno").length>0&&(d=$j("#hdnWfLno").val());var s="";if($j("#hdnWfELno").length>0&&(s=$j("#hdnWfELno").val()),"Approve & Forward"==actname&&(actname="Review"),r=(r=CheckSpecialCharsInXml(r)).replace(/%20/g," "),l){var o=UploadFiles();t='<root axpapp="'+proj+'" trace="'+n+'"  sessionid="'+sid+'" transid="'+a+'"   recordid="'+i+'" actname="'+actname+'" comments="'+r+'" changed="'+AxGlobalChange+'" lno="'+d+'"  elno="'+s+'">';try{AxGlobalChange?ASB.WebService.ProcessWFActionChanges(ChangedFields,ChangedFieldDbRowNo,ChangedFieldValues,DeletedDCRows,o,i,t,tstDataId,SuccessWFCAction):ASB.WebService.ProcessWFAction(t,SuccessWFAction),AxGlobalChange=!1}catch(u){AxWaitCursor(!1);var c=u.name+"^♠^"+u.message;showAlertDialog("error",2030,"client",c),EnableWFBut()}}else EnableWFBut()}function SuccessWFAction(e,t){SucceededCallbackAction(e)}function SuccessWFCAction(e,t){CheckSessionTimeout(e)||SucceededCallbackAction(e,"WithChanges")}function SucceededCallbackAction(result,calledFrom){if(!CheckSessionTimeout(result)){try{AxAfterWFAction(result)}catch(ex){}if(AxGlobalChange=!1,"Approve"==actname&&(actname+="d"),"Reject"==actname&&(actname+="ed"),"Review"==actname&&(actname="Forwarded"),"Return"==actname&&(actname+="ed"),"done"==result)"Approved"==actname&&Readonlyform(),null!=findGetParameter("AxPop")&&callParentNew("isSuccessAlertInPopUp=",!0),showAlertDialog("info",2051,"client",actname),window.location.href=window.location.href;else{var resSplit1=result.split(","),reslen=result.length,restxt=result.substring(reslen-20,reslen);if("Transaction commited"==restxt)window.status=eval(callParent("lcm[76]")),null!=findGetParameter("AxPop")&&callParentNew("isSuccessAlertInPopUp=",!0),showAlertDialog("info",2051,"client",actname),DisableWFButtons(),"pwda"==tst?window.document.location.href="./mid1.aspx":"loadqs"==tstType?window.location.href=window.location.href:window.document.location.href="./tstruct.aspx?transid="+tst;else{var restxt=result.substring(0,7);if(restxt==ErrStr){calledFrom!=undefined&&"WithChanges"==calledFrom&&(AxGlobalChange=!0);var nres=result.substring(7,result.length-8);return showAlertDialog("error",nres),void EnableWFBut()}var reslen=result.length,endpt=reslen-8,finalerr=result.substring(7,endpt),stPos=finalerr.indexOf("["),endPos=finalerr.indexOf("]"),tempStr="",tempStr1="",errFld="";if(stPos<0&&endPos<0);else{if(tempStr=finalerr.substring(0,stPos),tempStr1=finalerr.substring(endPos+2),errFld=finalerr.substring(stPos+1,endPos),""!=errFld){var nerr=finalerr.substring(stPos,endPos+2);finalerr=finalerr.replace(nerr,"")}finalerr=tempStr1.indexOf(tempStr)>-1?tempStr1:tempStr+tempStr1}showAlertDialog("error",finalerr),EnableWFBut();var errDcNo=GetDcNo(errFld);if(errFld=errFld+"000F"+errDcNo,focusFld=$j("#"+errFld),focusFld.length>0)try{focusFld.focus()}catch(ex){}}}}}function GetWFButStatus(){var e=0;return 0==$j("#btntabapprove").prop("disabled")&&(e+=1),0==$j("#btntabreject").prop("disabled")&&(e+=2),0==$j("#btntabreview").prop("disabled")&&(e+=4),0==$j("#btntabreturn").prop("disabled")&&(e+=8),e}function EnableWFBut(){0!=wfButStatus?($j("#txtCommentWF").prop("disabled",!1),$("#slectbox").attr("disabled",!1),$j("#btntabapprove").prop("disabled",1!=(1&wfButStatus)),$j("#btntabreject").prop("disabled",2!=(2&wfButStatus)),$j("#btntabreview").prop("disabled",4!=(4&wfButStatus)),$j("#btntabreturn").prop("disabled",8!=(8&wfButStatus))):$j("#txtCommentWF").prop("disabled",!0)}function DisableWFButtons(){$j("#btntabapprove").prop("disabled",!0),$j("#btntabreject").prop("disabled",!0),$j("#btntabreview").prop("disabled",!0),$j("#btntabreturn").prop("disabled",!0),$j("#txtCommentWF")&&$j("#txtCommentWF").prop("disabled",!0),$("#slectbox").attr("disabled",!0)}function AssignHTML(e,t,a){for(var i=e.split("*Tab*"),r="",n=0,l=new Array,d=!1,s="",o="0",c=0;c<i.length;c++){var p=i[c].split("*?*"),u=p[0].toString().split("♣");if(r=u[0],n=u[1],isNaN(n)||(n=parseInt(n,10)),""!=r){if(d||(d=IsDcPopGrid(r)),d||(s=r,o=n),0==c){var f="tab-"+r;if(f,(h=$j("#"+f)).length>0)0==h.find("#DivFrame"+r).length&&$("#DivFrame"+r).length?$("#DivFrame"+r).replaceWith($(p[1]).find("#DivFrame"+r)):h.html(p[1]);else f="DivFrame"+r,(h=$j("#"+f)).html(p[1])}else{var h;f="DivFrame"+r,(h=$j("#"+f)).html(p[1])}if(IsDcGrid(r)){if("0"!=$j("#recordid000F0").val()&&"FillGrid"==t)for(var v=1;v<=parseInt(o,10);v++){var m=GetRowNoHelper(v);UpdateChangedRows(m+"F"+s,v)}ClearDcRowArrays(r),UpdateDcArrays(r,n),ResetGridRowsStyle(r,n),CheckScroll(r),AssignGrdFreezeHdrScript(r);var g=$j.inArray(r,DCFrameNo);"True"==DCHasDataRows[g]&&SetHdnRowCount(r,a)}l.push("#"+f)}"GetTabData"==a&&isWizardTstruct&&wizardObj.tabCallback&&wizardObj.successRequestFreshTabData("DivFrame"+r)}$j(".axpvalid").each(function(){DoFormControlPrivilege($j(this).attr("id"),$j(this).val())}),"LoadData"!=t&&(d&&UpdatePopGridInfo(),LoadGridScript(),AssignJQueryEvents(l)),"FillGrid"==t&&(FillGridFillRows=o,FillGridCurrentDC=s)}function AssignGrdFreezeHdrScript(e){var t=$j("#contentScroll"+e),a=$j("#colScroll"+e);t.scroll(function(){a.scrollLeft(t.scrollLeft())})}function CheckAxpvalid(e,t,a){AxWaitCursor(!0);for(var i="",r=0;r<a.length;r++){var n=a[r]+t+"F"+e;if(-1!=n.indexOf("axpvalid")){i=GetFieldValue(n);break}}""!=i&&GridRowBehave(i,t,e,a),AxWaitCursor(!1)}function GridRowBehave(e,t,a,i){var r=!0,n=!0;""==e.toString()||"A"==e.toString().toUpperCase()?(r=!1,n=!1):"B"==e.toString().toUpperCase()?(r=!0,n=!1):"C"==e.toString().toUpperCase()&&(r=!0,n=!0),r&&$("#sp"+a+"R"+t+"F"+a+" td:first").find(".glyphicon.glyphicon-trash").addClass("disabled").prop("disabled",!0),n&&$("#sp"+a+"R"+t+"F"+a+" td:first").find(".glyphicon.glyphicon-pencil.icon-software-pencil").addClass("disabled").prop("disabled",!0),delImg=$j("#del"+t+"F"+a),delImg.length>0&&($j(this).prop("disabled",r),delImg.css("cursor","hand"),r||(delImg.removeClass("disabledelete"),delImg.unbind("click"),$j("#del"+t+"F"+a).bind("click",function(){DeleteCurrentRow($j(this))})));for(var l=0;l<i.length;l++){var d=i[l]+t+"F"+a,s=$j("#"+d),o=parseInt(t)-1,c=GetRowNoHelper(o);$j("#"+i[l]+c+"F"+a);s.length>0&&"C"==e.toString().toUpperCase()?s.prop("disabled",!0):s.hasClass("flddis")||s.prop("disabled",n),$j("#sp"+a+"R"+t+"F"+a).find(".pickimg").each(function(){$j(this).prop("disabled",n),$j(this).css("cursor","hand")})}}function EnableDisableBtns(e,t){if(e.length>0){if("a"==e[0].tagName.toLowerCase()){var a=e.children()[0];if(a!=undefined){a.id;!0,0==t?("handCur"==a.className&&(a.className="handCurDis"),a.disabled=!0,$j(a).is("img")&&($j(a).css("opacity","0.5"),$j(a).css("cursor","no-drop"))):(a.disabled=!1,"handCurDis"==a.className&&(a.className="handCur"),$j(a).is("img")&&($j(a).css("opacity","1"),$j(a).css("cursor","pointer")))}}0==t?(e.prop("disabled",!0),e.css("cursor","default")):(e.prop("disabled",!1),e.css("cursor",""),e.css("cursor","hand"));e.attr("id")&&e.attr("id").toLowerCase().startsWith("axptstbtn_")&&!0}}function SaveInCache(e,t){var a="";try{if(""!=(a=TabDCs[0]))if($j("#ank"+a).click(),"Save"==t)$j("#dvMessage").show()}catch(n){}var i=$j("#wBdr").html(),r="<script type='text/javascript'>"+GetJsArrays()+"<\/script>";try{"SaveAction"==t?ASB.WebService.AddToDataCache(i,tstDataId,r,e,SuccessSaveActionCache):ASB.WebService.AddToDataCache(i,tstDataId,r,e)}catch(l){AxWaitCursor(!1),showAlertDialog("error",ServerErrMsg)}}function SuccessSaveActionCache(e,t){CheckSessionTimeout(e)||(ShowDimmer(!0),AxWaitCursor(!0),-1==e.indexOf("error:")&&(window.location.href="tstruct.aspx?act=load&transid="+tst+"&recordid="+e))}function GetJsArrays(){for(var e="",t=0;t<RowDcNo.length;t++)e+="RowDcNo["+t+"]='"+RowDcNo[t]+"';DbRowNo["+t+"]='"+DbRowNo[t]+"';ClientRowNo["+t+"]='"+ClientRowNo[t]+"';";for(var a=0;a<MasterRow.length;a++)e+="MasterRow["+a+"]='"+MasterRow[a]+"';";for(var i=0;i<ComboParentField.length;i++)e+="ComboParentField["+i+"]='"+ComboParentField[i]+"';ComboParentValue["+i+"]='"+ComboParentValue[i]+"';",e+="ComboDepField["+i+"]='"+ComboDepField[i]+"';ComboDepValue["+i+"]='"+ComboDepValue[i]+"';";return e}function GetRecord(e){AxWaitCursor(!0),ShowDimmer(!0);var t="",a=-1,i=!1;if(window.opener&&!window.opener.closed?(window.opener.parent.isParentIview&&(i=window.opener.parent.isParentIview),window.opener.parent.clickedColumn&&(t=window.opener.parent.clickedColumn),window.opener.parent.dataRowIndex&&(a=window.opener.parent.dataRowIndex)):(window.parent.isParentIview&&(i=window.parent.isParentIview),window.parent.clickedColumn&&(t=window.parent.clickedColumn),window.parent.dataRowIndex&&(a=window.parent.dataRowIndex)),!IfUnSavedChanges()){var r=$j("#recordid000F0").val();try{ASB.WebService.GetRecord(e,r,tst,t,a,i,NextPrevTstructResult,OnException)}catch(n){}}}function NextPrevTstructResult(e,t){if(-1!=e.indexOf("This"))return AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("info",e);if(e==$j("#recordid000F0").val()||""==e)return AxWaitCursor(!1),ShowDimmer(!1),showAlertDialog("error",2019,"client");if(CheckSessionTimeout(e))return AxWaitCursor(!1),void ShowDimmer(!1);if(-1!=e.indexOf("ivtstload.aspx")){var a=e.split("*¿*")[0];return window.opener&&!window.opener.closed?window.opener.parent.dataRowIndex=e.split("*¿*")[1]:window.parent.dataRowIndex=e.split("*¿*")[1],window.location.href=a}if(-1!=e.indexOf("transid=")){a="tstruct.aspx?"+e.split("*¿*")[0];return window.opener&&!window.opener.closed?window.opener.parent.dataRowIndex=e.split("*¿*")[1]:window.parent.dataRowIndex=e.split("*¿*")[1],window.location.href=a}a="tstruct.aspx?transid="+tst+"&recordid="+e;return window.location.href=a}function ShowHideNexPrev(){var e="",t=-1,a=!1;if(window.parent.disableNavigation||window.opener&&!window.opener.closed&&window.opener.parent.disableNavigation||window.opener&&!window.opener.closed&&document.referrer.indexOf("iview.aspx?")>-1)return ShowHideNexPrevResult(!1),void(window.opener?window.opener.parent.disableNavigation=!1:window.parent.disableNavigation=!1);!window.opener&&document.referrer.indexOf("iview.aspx?")>-1?document.referrer.indexOf("&homeicon=true")>-1&&(window.parent.homeHref=document.referrer):!window.opener&&document.referrer.indexOf("iview.aspx?")>-1&&document.referrer.indexOf("&tstcaption")>-1&&(document.referrer.indexOf("&homeicon=true")>-1?window.parent.homeHref=document.referrer:window.parent.homeHref=document.referrer+"&homeicon=true"),window.opener&&!window.opener.closed?(window.opener.parent.isParentIview&&(a=window.opener.parent.isParentIview),window.opener.parent.clickedColumn&&(e=window.opener.parent.clickedColumn),window.opener.parent.dataRowIndex&&(t=window.opener.parent.dataRowIndex)):(window.parent.isParentIview&&(a=window.parent.isParentIview),window.parent.clickedColumn&&(e=window.parent.clickedColumn),window.parent.dataRowIndex&&(t=window.parent.dataRowIndex));try{ASB.WebService.SessionHasValue(tst,t,e,a,ShowHideNexPrevResult,OnException)}catch(i){}}function ShowHideNexPrevResult(e,t){$j("#goprior").length>0&&$j("#gonext").length>0&&(e?($j("#goprior").parent().show(),$j("#gonext").parent().show(),$j("#nextprevicons").css("display","block"),$j("#backforwrdbuttons").hide(),window.opener||(document.referrer.indexOf("iview.aspx?")>-1?($j("#nextprevicons").css("display","none"),$j("#backforwrdbuttons").show(),$j("#goprior").parent().hide(),$j("#gonext").parent().hide()):($j("#backtohm").css({display:"block","margin-left":"5px"}),$j("#homeico").bind("click",function(){document.location.href=window.parent.homeHref})))):($j("#goprior").parent().hide(),$j("#gonext").parent().hide(),$j("#backforwrdbuttons").show(),$j("#backtohm").css("display","none"),null==window.opener||document.parent))}function EnableDraftFeature(){var e=!1,t=new Array;window.parent.draftEnabledTstructs?t=window.parent.draftEnabledTstructs.toLowerCase().split(","):e=!0;var a=tst.toLowerCase();t.length>0&&$j.each(t,function(t,i){0!=e||i!=a||(e=!0)}),e&&(draftTimer=window.setInterval(SaveAsDraft,1e3*parseInt(window.parent.draftSaveTime,10)))}function AddRows(e){var t=$j("#txtRowsToAdd"+e).val();if(t&&!isNaN(t))for(var a=parseInt(t,10);a>0;)AddRow(e),a--;else AddRow(e)}function ValidateAddRows(e,t,a){return parseInt(e,10)<t||isNaN(e)?t:parseInt(e,10)>a?a:e}function OpenSearchPop(e){(e.ctrlKey||e.metaKey)&&70===e.keyCode?($j("#searchFields").is(":visible")||!$j(".ui-dialog").is(":visible")&&!$j("#searchFields").is(":visible"))&&(e.preventDefault(),$j("#srchDynamicText").val(""),$j("#searchFields").show(),$j("#searchFields").animate({top:"0px"})):27==e.keyCode&&($j("#searchFields").animate({top:"-50px"},500),setTimeout(function(){$j("#searchFields").hide()},500))}var AxSearchArray=new Array,idxSearchFoc=0;function FindTstructString(e){AxSearchArray=new Array,UnSelectSearchItem(),""!=e?$j("#pagebdy").find(":input, textarea, select").not('[id=srchDynamicText],[id=ddlSearch],[type=button],input[type=hidden],[class^=frmAtt],[class="ui-tabs-hide"]').each(function(){if("hidden"!=$j(this).attr("type")){var t=$j(this).attr("id");if(t){var a=GetFieldsDcNo(t);if(IsDcPopGrid(a))return}var i=$j(this).val().toString().trim().toLowerCase();$j(this).is("select")&&(i=$j("#"+t+" :selected").text().trim().toLowerCase()),i.indexOf(e)>-1&&!$j(this).is(":focus")&&AxSearchArray.push($j(this)),AxSearchArray.length>0&&!AxSearchArray[0].parent().hasClass("picklist")?$j(AxSearchArray[0]).addClass("srchselectedfield"):AxSearchArray.length>0&&AxSearchArray[0].parent().hasClass("picklist")&&AxSearchArray[0].parent().addClass("srchselectedfield"),idxSearchFoc=0,AxSearchArray.length>0?$j("#searchResCount").text("1 of "+AxSearchArray.length):$j("#searchResCount").text("0 of 0")}}):$j("#searchResCount").text("0 of 0")}function UnSelectSearchItem(e){e=void 0===e?"":e,$j("input:not([id=srchDynamicText],[type=button]), select, textarea").each(function(){$j(this).hasClass("srchselectedfield")?$j(this).removeClass("srchselectedfield"):$j(this).parent().hasClass("picklist","srchselectedfield")&&$j(this).parent().removeClass("srchselectedfield")}),""!=e&&($j("#searchFields").animate({top:"-50px"},500),setTimeout(function(){$j("#searchFields").hide()},500))}function MoveNext(){if(idxSearchFoc<AxSearchArray.length-1){idxSearchFoc++;var e=0;$j(AxSearchArray[idxSearchFoc]).attr("id")&&(e=GetFieldsDcNo($j(AxSearchArray[idxSearchFoc]).attr("id")));var t=$j(AxSearchArray[idxSearchFoc]).parent().hasClass("picklist"),a=$j(AxSearchArray[idxSearchFoc-1]).parent().hasClass("picklist");t&&!a?($j(AxSearchArray[idxSearchFoc]).parent().addClass("srchselectedfield"),AxSearchArray[idxSearchFoc-1].removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click()):t&&a?($j(AxSearchArray[idxSearchFoc]).parent().addClass("srchselectedfield"),$j(AxSearchArray[idxSearchFoc-1]).parent().removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click()):!t&&a?(AxSearchArray[idxSearchFoc].addClass("srchselectedfield"),$j(AxSearchArray[idxSearchFoc-1]).parent().removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click()):(AxSearchArray[idxSearchFoc].addClass("srchselectedfield"),AxSearchArray[idxSearchFoc-1].removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click()),$j("#searchResCount").text(idxSearchFoc+1+" of "+AxSearchArray.length),AxSearchArray[idxSearchFoc].focus()}else idxSearchFoc==AxSearchArray.length-1&&AxSearchArray[idxSearchFoc].focus()}function MovePrev(){GetOpenTabDcs();if(idxSearchFoc>0&&AxSearchArray.length>=idxSearchFoc){idxSearchFoc--;var e=0;$j(AxSearchArray[idxSearchFoc]).attr("id")&&(e=GetFieldsDcNo($j(AxSearchArray[idxSearchFoc]).attr("id")));var t=$j(AxSearchArray[idxSearchFoc]).parent().hasClass("picklist"),a=$j(AxSearchArray[idxSearchFoc+1]).parent().hasClass("picklist");t&&!a?($j(AxSearchArray[idxSearchFoc]).parent().addClass("srchselectedfield"),AxSearchArray[idxSearchFoc+1].removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click(),AxSearchArray[idxSearchFoc].focus()):t&&a?($j(AxSearchArray[idxSearchFoc]).parent().addClass("srchselectedfield"),$j(AxSearchArray[idxSearchFoc+1]).parent().removeClass("srchselectedfield"),AxSearchArray[idxSearchFoc].focus(),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click()):!t&&a?(AxSearchArray[idxSearchFoc].addClass("srchselectedfield"),$j(AxSearchArray[idxSearchFoc+1]).parent().removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click(),AxSearchArray[idxSearchFoc].focus()):(AxSearchArray[idxSearchFoc].addClass("srchselectedfield"),AxSearchArray[idxSearchFoc+1].removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click(),AxSearchArray[idxSearchFoc].focus()),$j("#searchResCount").text(idxSearchFoc+1+" of "+AxSearchArray.length)}else idxSearchFoc==AxSearchArray.length-1&&AxSearchArray[idxSearchFoc].focus()}function CloseSearchPop(){var e=$j("#searchFields").is(":visible"),t=!1;e&&TabDCs.length>0&&$j(AxSearchArray[idxSearchFoc]).attr("id")&&-1==TabDCs.indexOf(GetFieldsDcNo($j(AxSearchArray[idxSearchFoc]).attr("id")))&&(t=!0),(e&&0==TabDCs.length&&(!event||"blur"!=event.type)||t)&&$j("#searchFields").dialog("close")}function ShowdivContentCK(e,t){if(""!=currentCK){e=t?e.name:e.attr("name");var a=CKEDITOR.instances[e].getData();$j("#"+e).val(a),MainBlur($j("#"+e)),currentCK=""}}var AxGridAttField="";function ShowGridAttachPopUp(e){if($(e).hasClass("disabledClickEvent"))return!1;if(($(e).addClass("disabledClickEvent"),$(e).parent().find(".attach-files").children().length>0&&"0"!=AxpFileUploadlmt)&&$(e).parent().find(".attach-files").children().length>=AxpFileUploadlmt)return showAlertDialog("warning","Uploaded file count reached to limit of file upload."),void o();AxGridAttField=e.id;var t=GetFieldsRowFrameNo(AxGridAttField),a="grdAtt_hlnk_"+t,i=e.id,r=$("#"+AxGridAttField).parents("div").siblings("input.grdAttach").attr("id"),n=r.substring(0,r.lastIndexOf("F")-3),l=GetFieldsDcNo(AxGridAttField),d=GetFieldValue("axpattach_filename"+l+t),s="";function o(){$(e).removeClass("disabledClickEvent"),$("#"+e.id).focus()}s=""!=d?"./gridfileupload.aspx?attFld="+a+"&attTransId="+transid+"&attFldName="+n+"&atFname="+d+"&dcNo="+l:0==IsGridField(e.id)?"./gridfileupload.aspx?attFld="+i+"&attTransId="+transid+"&attFldName="+n+"&dcNo="+l:"./gridfileupload.aspx?attFld="+a+"&attTransId="+transid+"&attFldName="+n+"&dcNo="+l,displayBootstrapModalDialog("Grid Fileupload","xs","156px",!0,s,"","",o)}function ShowAxpFileAttachPopUp(e){if($(e).hasClass("disabledClickEvent"))return!1;if(($(e).addClass("disabledClickEvent"),$(e).parent().find(".attach-files").children().length>0&&"0"!=AxpFileUploadlmt)&&$(e).parent().find(".attach-files").children().length>=AxpFileUploadlmt)return showAlertDialog("warning","Uploaded file count reached to limit of file upload."),void CallbackFunctionBootstrap();AxGridAttField=e.id;var t=$("#"+AxGridAttField).parents("div").siblings("input.grdAttach").attr("id"),a=t.substring(0,t.lastIndexOf("F")-3),i=GetFieldsDcNo(AxGridAttField);IsGridField(a)&&axInlineGridEdit&&!$(e).parents("tr").hasClass("inline-edit")?$(e).removeClass("disabledClickEvent"):("axcad"==transid&&"axpfile_imgcard"==a&&(window.ax_changeValidateFileExtensionParams=function(e,t,a){return{fileType:"image"}}),displayBootstrapModalDialog("Fileupload","lg","300px",!0,"./axpfileupload.aspx?attFld="+AxGridAttField+"&attFldName="+a+"&dcNo="+i,"","",function(){$(e).removeClass("disabledClickEvent"),$("#"+e.id).focus(),"axcad"==transid&&"axpfile_imgcard"==a&&delete window.ax_changeValidateFileExtensionParams}))}function ShowGridAttLink(e){var t=(e=unescape(e)).lastIndexOf("/");t>-1&&(e=e.substring(0,t+1)+encodeURIComponent(e.substring(t+1,e.length))),window.open(e,"GridUploadFile","width=500,height=350,scrollbars=no,resizable=yes")}function ShowAxpFileuploadLink(e,t,a){var i=e.substr(7),r="";r="undefined"!=typeof $("textarea[id*="+i+"]").not(".axpAttach")[0]?$("textarea[id*="+i+"]").not(".axpAttach")[0].value:$("input[id*="+i+"]").not(".axpAttach")[0].value,ASB.WebService.LoadAxpFileToScript(r,t,function(){var e=(a=unescape(a)).lastIndexOf("/");e>-1&&(a=a.substring(0,e+1)+encodeURIComponent(a.substring(e+1,a.length)));window.open(a,"GridUploadFile","width=500,height=350,scrollbars=no,resizable=yes")})}var fileLinks="";function SetGridAttValue(e,t){var a=GetFieldsRowFrameNo(e),i=GetFieldsDcNo(e),r=($j("#recordid000F0").val(),$j("#grdAtt_hlnk_"+a));if(fileLinks="",""!=t){if(-1!=t.indexOf("@")&&(fileLinks=SetGridRefWithdcImage(e,t,!1),""==(t=t.substr(t.lastIndexOf(")")+2))))return void(r[0].outerHTML=fileLinks);try{AxBeforeGrdAttDisplay(e,i,a)}catch(l){}if($j("#hdnScriptsUrlpath")[0]!=undefined){var n=GetFieldValue("axpattach_filename"+i+a);""!=n&&(t=n+t.substring(t.indexOf(".")))}}}function ConstructGridAttachHTML(e,t,a,i,r){var n;r=GetFieldsRowFrameNo(e);n=i.val()+"axpert/"+sid+"/";for(var l=a.split(","),d=0;d<l.length;d++)if(l[d]!=undefined||""!=l[d]){var s=l[d].replace(/\s/g,"♠").replace(/\(/g,"♦").replace(/\)/g,"♣");fileLinks+='<div id="Link_'+r+"_"+s+'"><a onclick="DeleteFileFromRow(\''+e+"','"+r+"','"+l[d]+'\')"><i class="glyphicon glyphicon-remove close icon-arrows-remove attachmentcrossicon"></i></a><a href="javascript:void(0)"  tabindex="-1" class=\'grdAttach handCur\' onclick=\'ShowGridAttLink("'+n+l[d]+"\")'>"+l[d]+"</a></div>"}return fileLinks="<div id='grdAtt_hlnk_"+r+"attach' class='attach-files' style='display:none'>"+fileLinks+"</div>",isMobile?fileLinks+="<a class='pull-"+("ar"===parent.gllangType?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='grdAtt_hlnk_"+r+"attach' class=' attach-popover' data-container='.mobilewrapperForEditFields' data-placement='bottom'>"+l.length+"+</span></a>":fileLinks+="<a class='pull-"+("ar"===parent.gllangType?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='grdAtt_hlnk_"+r+"attach' class=' attach-popover' data-container='#bootstrapModal' data-placement='bottom'>"+l.length+"+</span></a>",fileLinks}function ConstructAxpFileAttachHTML(e,t,a,i,r){r=GetFieldsRowFrameNo(e);var n,l=e.substr(7),d="";d="undefined"!=typeof $("textarea[id*="+l+"]").not(".axpAttach")[0]?$("textarea[id*="+l+"]").not(".axpAttach")[0].value:$("input[id*="+l+"]").not(".axpAttach")[0].value,n=i.val()+"axpert/"+sid+"/";for(var s=a.split(","),o=0;o<s.length;o++)if(""!=s[o]){var c=s[o];""!=d&&d.endsWith("\\*")&&(c=c.substr(20));var p=s[o].replace(/\s/g,"♠").replace(/\(/g,"♦").replace(/\)/g,"♣");fileLinks+='<div id="Link_'+r+"_"+p+'"><a onclick="DeleteFileFromRow(\''+e+"','"+r+"','"+s[o]+'\')"><i class="glyphicon glyphicon-remove close icon-arrows-remove attachmentcrossicon"></i></a><a href="javascript:void(0)"  tabindex="-1" class=\'grdAttach handCur\' onclick=\'ShowAxpFileuploadLink("'+e+'","'+s[o]+'","'+n+s[o]+"\")'>"+c+"</a></div>"}return fileLinks="<div id='axpFileAtt_hlnk_"+r+"attach' class='attach-files' style='display:none'>"+fileLinks+"</div>",isMobile?fileLinks+="<a class='pull-"+("ar"===parent.gllangType?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='axpFileAtt_hlnk_"+r+"attach' class=' attach-popover' data-container='.mobilewrapperForEditFields' data-placement='bottom'>"+s.length+"+</span></a>":fileLinks+="<a class='pull-"+("ar"===parent.gllangType?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='axpFileAtt_hlnk_"+r+"attach' class=' attach-popover' data-container='#bootstrapModal' data-placement='bottom'>"+s.length+"+</span></a>",fileLinks}function ConstructAttachHTML(e,t,a){var i="",r="",n=e.split(","),l=GetFieldsRowFrameNo(t),d=GetFieldsRowNo(t),s=t.substring(t.lastIndexOf("F")+1,t.length),o=$j("#hdnScriptsUrlpath");filePath=o.val()+"axpert/"+sid+"/",$("input#"+t).attr("value",e).text(e).val(e),"000"==d&&(r+='<span id="nonGrdAtt_'+t+'" class="fa fa-paperclip upload-icon nongridAttachIcon inlinediv" style="" onclick="ShowGridAttachPopUp(this);" title="nongrid attachment"></span>'),r+="<div id='grdAtt_hlnk_"+l+"attach' class='attach-files'></div>","000"==d?$("#"+t).siblings(".divnonattach").html(r):"FillGrid"==a&&0!=$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).find(".attach-files").length?($j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).find(".attach-files").remove(),$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).append(r)):$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).append(r);for(var c=0;c<n.length;c++){var p=n[c].replace(/\s/g,"♠").replace(/\(/g,"♦").replace(/\)/g,"♣");if(i+='<div id="Link_'+l+"_"+p+'" class="inlinediv"><a onclick="DeleteFileFromRow(\''+t+"','"+l+"','"+n[c]+'\')"><i class="glyphicon glyphicon-remove close icon-arrows-remove attachmentcrossicon"></i></a><a href="javascript:void(0)"  tabindex="-1" class=\'grdAttach handCur\' onclick=\'ShowGridAttLink("'+filePath+n[c]+"\")'>"+n[c]+"</a></div>",a==undefined){if("000"==d&&""!=e)$("#"+t).siblings(".divnonattach").find(".attach-files").html(i),$("#"+t).siblings(".divnonattach").find(".attach-files").height()>22?function(){var e=$("#"+t).siblings(".divnonattach").attr("data-morefiles");void 0!==e&&""!=e?e+=","+$("#"+t).siblings(".divnonattach").find(".attach-files").children().last().attr("id"):e=$("#"+t).siblings(".divnonattach").find(".attach-files").children().last().attr("id"),$("#"+t).siblings(".divnonattach").attr("data-morefiles",e);var a=e.split(",");$("#"+t).siblings(".divnonattach").find(".attach-files").children().each(function(e,i){var r=$(i).attr("id");$j.inArray(r,a)>-1&&$("#"+t).siblings(".divnonattach").find(".attach-files").find("[id^="+r.split(".")[0]+"]").addClass("revrseInlinediv")}),0==$("#"+t).siblings(".divnonattach").find("a.attachment-count").length?$("#"+t).siblings(".divnonattach").append("<a class='pull-"+("ar"===callParentNew("gllangType","gllangType")?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='grdAtt_hlnk_"+l+"attach' class=' attach-popover' data-container='.dvheightframe' data-placement='bottom'>"+e.split(",").length+"+</span></a>"):$("#"+t).siblings(".divnonattach").find(".attachment-count span").text(e.split(",").length+"+")}():$("#"+t).siblings(".divnonattach").find(".attach-files").children().last().removeClass("hide");else if(""!=e)if($(".attach-files").parent("#GridAttach"+l).find(".attach-files").html(i),$(".attach-files").parent("#GridAttach"+l).find(".attach-files").height()>20){var u=$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).attr("data-morefiles");void 0!==u&&""!=u?u+=","+$(".attach-files").parent("#GridAttach"+l).find(".attach-files").children().last().attr("id"):u=$(".attach-files").parent("#GridAttach"+l).find(".attach-files").children().last().attr("id"),$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).attr("data-morefiles",u),u.split(",").forEach(function(e){$(callParentNew(e,"id")).addClass("revrseInlinediv")}),0==$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).find("a.attachment-count").length?$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).append("<a class='pull-"+("ar"===callParentNew("gllangType","gllangType")?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='grdAtt_hlnk_"+l+"attach' class=' attach-popover' data-container='.dvheightframe' data-placement='bottom'>"+u.split(",").length+"+</span></a>"):$j("#GridAttach"+l,doParentOpInIframe("document","rtn","#GridAttach"+l)).find(".attachment-count span").text(u.split(",").length+"+")}else $(callParentNew("wrapperForEditFields"+s,"id")).children("#sp"+s+"R"+l).css("height","90px"),$(".attach-files").parent("#GridAttach"+l).find(".attach-files").children().last().removeClass("hide")}else a!=undefined&&"FillGrid"==a&&($("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attach-files").html(i),$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attach-files").height()>20?function(){var e=$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).attr("data-morefiles");void 0!==e&&""!=e?e+=","+$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attach-files").children().last().attr("id"):e=$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attach-files").children().last().attr("id"),$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).attr("data-morefiles",e);var t=e.split(",");$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attach-files").children().each(function(e,a){var i=$(a).attr("id");$j.inArray(i,t)>-1&&$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attach-files").find("[id^="+i.split(".")[0]+"]").addClass("revrseInlinediv")}),0==$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find("a.attachment-count").length?$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).append("<a class='pull-"+("ar"===callParentNew("gllangType","gllangType")?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='grdAtt_hlnk_"+l+"attach' class=' attach-popover' data-container='.dvheightframe' data-placement='bottom'>"+e.split(",").length+"+</span></a>"):$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attachment-count span").text(e.split(",").length+"+")}():($(callParentNew("wrapperForEditFields"+s,"id")).children("#sp"+s+"R"+l).css("height","90px"),$("#gridHd"+s+" tbody td .attach-files").parent("#GridAttach"+l).find(".attach-files").children().last().removeClass("hide")))}}function ConstructAxpAttachHTML(e,t,a){var i="",r="",n=e.split(","),l=GetFieldsRowFrameNo(t),d=GetFieldsRowNo(t),s=t.substring(t.lastIndexOf("F")+1,t.length),o=$j("#hdnScriptsUrlpath");filePath=o.val()+"axpert/"+sid+"/",$("input#"+t).attr("value",e).text(e).val(e);var c=t.substr(7),p="";p="undefined"!=typeof $("textarea[id*="+c+"]").not(".axpAttach")[0]?$("textarea[id*="+c+"]").not(".axpAttach")[0].value:$("input[id*="+c+"]").not(".axpAttach")[0].value,"000"==d?r+='<span id="ngAxpFileAtt_'+t+'" class="fa fa-paperclip upload-icon nongridAttachIcon inlinediv" style="" onclick="ShowAxpFileAttachPopUp(this);" title="nongrid attachment"></span>':"FillGrid"!=!a&&a!=undefined||(r+='<span id="GridAxpFileAtt_'+t+'" tabindex=\'0\' class="fa fa-paperclip upload-icon inlinediv" onclick="ShowAxpFileAttachPopUp(this);" class="grdAttach handCur" />'),r+="<div id='axpFileAtt_hlnk_"+l+"attach' class='attach-files'></div>","000"==d?$("#"+t).siblings(".divNonGridAxpFile").html(r):"FillGrid"==a?0!=$j("#GridAxpFile"+t,doParentOpInIframe("document","rtn","#GridAxpFile"+t)).find(".attach-files").length?($j("#GridAxpFile"+t,doParentOpInIframe("document","rtn","#GridAxpFile"+t)).find(".attach-files").remove(),$j("#GridAxpFile"+t,doParentOpInIframe("document","rtn","#GridAxpFile"+t)).append(r)):$j("#GridAxpFile"+t,doParentOpInIframe("document","rtn","#GridAxpFile"+t)).append(r):0!=$j("#GridAxpFile"+t,doParentOpInIframe("document","rtn","#GridAxpFile"+t)).find(".attach-files").length?($j("#GridAxpFile"+t,doParentOpInIframe("document","rtn","#GridAxpFile"+t)).find(".attach-files").remove(),$j("input#"+t,doParentOpInIframe("document","rtn","#"+t)).siblings("#GridAxpFile"+t).html(r)):$j("input#"+t,doParentOpInIframe("document","rtn","#"+t)).siblings("#GridAxpFile"+t).html(r);for(var u=0;u<n.length;u++){var f=n[u];""!=p&&p.endsWith("\\*")&&(f=f.substr(20));var h=n[u].replace(/\s/g,"♠").replace(/\(/g,"♦").replace(/\)/g,"♣");if(i+='<div id="Link_'+l+"_"+h+'" class="inlinediv"><a onclick="DeleteFileFromRow(\''+t+"','"+l+"','"+n[u]+'\')"><i class="glyphicon glyphicon-remove close icon-arrows-remove attachmentcrossicon"></i></a><a href="javascript:void(0)"  tabindex="-1" class=\'grdAttach handCur\' onclick=\'ShowAxpFileuploadLink("'+t+'","'+n[u]+'","'+filePath+n[u]+"\")'>"+f+"</a></div>",a==undefined){if("000"==d&&""!=e)$("#"+t).siblings(".divNonGridAxpFile").find(".attach-files").html(i),$("#"+t).siblings(".divNonGridAxpFile").find(".attach-files").height()>22?function(){var e=$("#"+t).siblings(".divNonGridAxpFile").attr("data-morefiles");void 0!==e&&""!=e?e+=","+$("#"+t).siblings(".divNonGridAxpFile").find(".attach-files").children().last().attr("id"):e=$("#"+t).siblings(".divNonGridAxpFile").find(".attach-files").children().last().attr("id"),$("#"+t).siblings(".divNonGridAxpFile").attr("data-morefiles",e);var a=e.split(",");$("#"+t).siblings(".divNonGridAxpFile").find(".attach-files").children().each(function(e,i){var r=$(i).attr("id");$j.inArray(r,a)>-1&&$("#"+t).siblings(".divNonGridAxpFile").find(".attach-files").find("[id^="+r.split(".")[0]+"]").addClass("revrseInlinediv")}),0==$("#"+t).siblings(".divNonGridAxpFile").find("a.attachment-count").length?$("#"+t).siblings(".divNonGridAxpFile").append("<a class='pull-"+("ar"===callParentNew("gllangType","gllangType")?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='axpFileAtt_hlnk_"+l+"attach' class=' attach-popover' data-container='.dvheightframe' data-placement='bottom'>"+e.split(",").length+"+</span></a>"):$("#"+t).siblings(".divNonGridAxpFile").find(".attachment-count span").text(e.split(",").length+"+")}():$("#"+t).siblings(".divNonGridAxpFile").find(".attach-files").children().last().removeClass("hide");else if(""!=e)if($(".attach-files").parent("#GridAxpFile"+t).find(".attach-files").html(i),$(".attach-files").parent("#GridAxpFile"+t).find(".attach-files").height()>20){var v=$j("input#"+t,doParentOpInIframe("document","rtn","#"+t)).siblings("#GridAxpFile"+t).attr("data-morefiles");void 0!==v&&""!=v?v+=","+$(".attach-files").parent("#GridAxpFile"+t).find(".attach-files").children().last().attr("id"):v=$(".attach-files").parent("#GridAxpFile"+t).find(".attach-files").children().last().attr("id"),$j("input#"+t,doParentOpInIframe("document","rtn","#"+t)).siblings("#GridAxpFile"+t).attr("data-morefiles",v),v.split(",").forEach(function(e){$(callParentNew(e,"id")).addClass("revrseInlinediv")}),0==$j("input#"+t,doParentOpInIframe("document","rtn","#"+t)).siblings("#GridAxpFile"+t).find("a.attachment-count").length?$j("input#"+t,doParentOpInIframe("document","rtn","#"+t)).siblings("#GridAxpFile"+t).append("<a class='pull-"+("ar"===callParentNew("gllangType","gllangType")?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='axpFileAtt_hlnk_"+l+"attach' class=' attach-popover' data-container='.dvheightframe' data-placement='bottom'>"+v.split(",").length+"+</span></a>"):$j("input#"+t,doParentOpInIframe("document","rtn","#"+t)).siblings("#GridAxpFile"+t).find(".attachment-count span").text(v.split(",").length+"+")}else $(callParentNew("wrapperForEditFields"+s,"id")).children("#sp"+s+"R"+l).css("height","90px"),$(".attach-files").parent("#GridAxpFile"+t).find(".attach-files").children().last().removeClass("hide")}else a!=undefined&&"FillGrid"==a&&($("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attach-files").html(i),$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attach-files").height()>20?function(){var e=$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).attr("data-morefiles");void 0!==e&&""!=e?e+=","+$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attach-files").children().last().attr("id"):e=$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attach-files").children().last().attr("id"),$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).attr("data-morefiles",e);var a=e.split(",");$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attach-files").children().each(function(e,i){var r=$(i).attr("id");$j.inArray(r,a)>-1&&$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attach-files").find("[id^="+r.split(".")[0]+"]").addClass("revrseInlinediv")}),0==$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find("a.attachment-count").length?$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).append("<a class='pull-"+("ar"===callParentNew("gllangType","gllangType")?"left":"right")+" attachment-count' href='javascript:void(0)' class=''><span data-target='axpFileAtt_hlnk_"+l+"attach' class=' attach-popover' data-container='.dvheightframe' data-placement='bottom'>"+e.split(",").length+"+</span></a>"):$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attachment-count span").text(e.split(",").length+"+")}():($(callParentNew("wrapperForEditFields"+s,"id")).children("#sp"+s+"R"+l).css("height","90px"),$("#gridHd"+s+" tbody td .attach-files").parent("#GridAxpFile"+t).find(".attach-files").children().last().removeClass("hide")))}}function DeleteFileFromRow(fldName,fNo,fldValue){var hasFolderReference="false",hasReferImages="false",referFieldValue="",cutMsg=eval(callParent("lcm[62]")),glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var DeleteFileFromRowCB=$.confirm({closeIcon:!1,rtl:isRTL,title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:!0,escapeKey:"buttonB",content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){DeleteFileFromRowCB.close();var e=$j("input#"+fldName).val(),t=GetFieldsRowNo(fldName),a=GetFieldsRowFrameNo(fldName);if(-1!=fldName.indexOf("_referimages"))if(-1!=e.indexOf("(")){hasReferImages="true";var i=e.indexOf("("),r=e.indexOf(")");referFieldValue=e.substr(0,i+1),e=e.substr(i+1,r-(i+1))}else hasFolderReference="true",referFieldValue=e.substr(0,e.lastIndexOf("\\")+1),e=e.substr(e.lastIndexOf("\\")+1);fldValue=unescape(fldValue),e=DeleteAttachFiles(e,hasFolderReference,hasReferImages,referFieldValue,fldValue),UpdateFieldArray(fldName,t,e,"gridattachment","parent");var n=fldValue.replace(/\s/g,"♠").replace(/\(/g,"♦").replace(/\)/g,"♣");"000"==t?fldName.toLowerCase().startsWith("axpfile_")?$("input#"+fldName).siblings(".divNonGridAxpFile").find($j('div[id$="'+a+"_"+n+'"]')).remove():$("input#"+fldName).siblings(".divnonattach").find($j('div[id$="'+a+"_"+n+'"]')).remove():$("input#"+fldName).siblings(".grdattch").find($j('div[id$="'+a+"_"+n+'"]')).remove(),fldName.toLowerCase().startsWith("axpfile_")?(DeletedFieldValue.push(fldName+"~"+fldValue),ManageAxpDeleteFiles(fldName,fldValue)):ManageLblOfDltFiles(fldName,fldValue),$j("#"+fldName).val(e)}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy")}}}})}function DeleteAttachFiles(e,t,a,i,r){var n=e.split(",");return n!=undefined&&(n=$j.grep(n,function(e){return e!=r})),e="true"==t?n.length>0?i+n.join(","):"":"true"==a?i+n.join(",")+")":n.join(",")}function ManageLblOfDltFiles(e,t){var a=GetFieldsRowFrameNo(e),r=GetFieldsRowNo(e),n=(new Array,$("input#"+e).val()),l=$("input#"+e).val();e.substring(e.lastIndexOf("F")+1,e.length);if(n=n.replace(t+",","").replace(","+t,"").replace(t,""),$("input#"+e).removeAttr("value").attr("value",n).val(n).text(n),"000"==r){var d=$("#"+e).siblings(".divnonattach").attr("data-morefiles");l.split(",").forEach(function(r){if(d.split(",").forEach(function(n){var l=n.substring(("Link_"+a+"_").length,n.length);if(r!=l){if(r==t)for(i=0;i<$("#"+e).siblings(".divnonattach").find(".attach-files").children().length;i++)if($("#"+e).siblings(".divnonattach").find(".attach-files").children()[i].id==n)if($($("#"+e).siblings(".divnonattach").find(".attach-files").children()[i]).removeClass("revrseInlinediv"),$("#"+e).siblings(".divnonattach").find(".attach-files").height()>22)$($("#"+e).siblings(".divnonattach").find(".attach-files").children()[i]).addClass("revrseInlinediv");else{var d=$("#"+e).siblings(".divnonattach").attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("#"+e).siblings(".divnonattach").attr("data-morefiles",d),""==$("#"+e).siblings(".divnonattach").attr("data-morefiles")&&$("#"+e).siblings(".divnonattach").find(".attachment-count").addClass("revrseInlinediv")}if(t==l.replace(/♠/g," ").replace(/♦/g,"(").replace(/♣/g,")")){var s=$("#"+e).siblings(".divnonattach").attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("#"+e).siblings(".divnonattach").attr("data-morefiles",s),""==$("#"+e).siblings(".divnonattach").attr("data-morefiles")&&($("#"+e).siblings(".divnonattach").find(".attachment-count").addClass("revrseInlinediv"),$(".popover").css("display","none"))}}}),r==t){var n="Link_"+a+"_"+t;n=n.replace(/\s/g,"♠").replace(/\(/g,"♦").replace(/\)/g,"♣");var l=$("#"+e).siblings(".divnonattach").attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("#"+e).siblings(".divnonattach").attr("data-morefiles",l),""==$("#"+e).siblings(".divnonattach").attr("data-morefiles")&&($("#"+e).siblings(".divnonattach").find(".attachment-count").addClass("revrseInlinediv"),$(".popover").css("display","none"))}});var s=$("#"+e).siblings(".divnonattach").attr("data-morefiles");$("#"+e).siblings(".divnonattach").find(".attachment-count span").text(s.split(",").length+"+")}else{"popup"==AxpGridForm&&isMobile&&$("#GridAttach"+a).attr("data-morefiles",$("#GridAttach"+a).siblings("input").val());var o=$("#GridAttach"+a).attr("data-morefiles");l&&l.split(",").forEach(function(r){o&&o.split(",").forEach(function(e){var n=e.substring(("Link_"+a+"_").length,e.length);if(r!=n){if(r==t)for(i=0;i<$(".attach-files").parent("#GridAttach"+a).find(".attach-files").children().length;i++)if($(".attach-files").parent("#GridAttach"+a).find(".attach-files").children()[i].id==e)if($($(".attach-files").parent("#GridAttach"+a).find(".attach-files").children()[i]).removeClass("revrseInlinediv"),$(".attach-files").parent("#GridAttach"+a).find(".attach-files").height()>20)$($(".attach-files").parent("#GridAttach"+a).find(".attach-files").children()[i]).addClass("revrseInlinediv");else{var l=$("#GridAttach"+a).attr("data-morefiles").replace(e+",","").replace(","+e,"").replace(e,"");$("#GridAttach"+a).attr("data-morefiles",l),""==$("#GridAttach"+a).attr("data-morefiles")&&$("#GridAttach"+a).find(".attachment-count").addClass("revrseInlinediv")}if(t==n.replace(/♠/g," ").replace(/♦/g,"(").replace(/♣/g,")")){var d=$("#GridAttach"+a).attr("data-morefiles").replace(e+",","").replace(","+e,"").replace(e,"");$("#GridAttach"+a).attr("data-morefiles",d),""==$("#GridAttach"+a).attr("data-morefiles")&&($("#GridAttach"+a).find(".attachment-count").addClass("revrseInlinediv"),$(".popover").css("display","none"))}}}),r==t&&$("textarea#"+e).text(n).val(n)});var c=$("#GridAttach"+a).attr("data-morefiles");c&&$("#GridAttach"+a).find(".attachment-count span").text(c.split(",").length+"+")}}function ManageAxpDeleteFiles(e,t){var a=GetFieldsRowFrameNo(e),r=GetFieldsRowNo(e),n=(new Array,$("input#"+e).val()),l=$("input#"+e).val();e.substring(e.lastIndexOf("F")+1,e.length);if(n=n.replace(t+",","").replace(","+t,"").replace(t,""),$("input#"+e).removeAttr("value").attr("value",n).val(n).text(n),"000"==r){var d=$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles");l&&l.split(",").forEach(function(r){if(d&&d.split(",").forEach(function(n){var l=n.substring(("Link_"+a+"_").length,n.length);if(r!=l){if(r==t)for(i=0;i<$("#"+e).siblings(".divNonGridAxpFile").find(".attach-files").children().length;i++)if($("#"+e).siblings(".divNonGridAxpFile").find(".attach-files").children()[i].id==n)if($($("#"+e).siblings(".divNonGridAxpFile").find(".attach-files").children()[i]).removeClass("revrseInlinediv"),$("#"+e).siblings(".divNonGridAxpFile").find(".attach-files").height()>22)$($("#"+e).siblings(".divNonGridAxpFile").find(".attach-files").children()[i]).addClass("revrseInlinediv");else{var d=$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles",d),""==$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles")&&$("#"+e).siblings(".divNonGridAxpFile").find(".attachment-count").addClass("revrseInlinediv")}if(t==l.replace(/♠/g," ").replace(/♦/g,"(").replace(/♣/g,")")){var s=$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles",s),""==$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles")&&($("#"+e).siblings(".divNonGridAxpFile").find(".attachment-count").addClass("revrseInlinediv"),$(".popover").css("display","none"))}}}),r==t){var n="Link_"+a+"_"+t;n=n.replace(/\s/g,"♠").replace(/\(/g,"♦").replace(/\)/g,"♣");var l=$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles",l),""==$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles")&&($("#"+e).siblings(".divNonGridAxpFile").find(".attachment-count").addClass("revrseInlinediv"),$(".popover").css("display","none"))}});var s=$("#"+e).siblings(".divNonGridAxpFile").attr("data-morefiles");$("#"+e).siblings(".divNonGridAxpFile").find(".attachment-count span").text(s.split(",").length+"+")}else{"popup"==AxpGridForm&&isMobile&&$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles",$("#GridAxpFile"+e).siblings("input").val());var o=$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles");l&&l.split(",").forEach(function(r){o&&o.split(",").forEach(function(n){var l=n.substring(("Link_"+a+"_").length,n.length);if(r!=l){if(r==t)for(i=0;i<$(".attach-files").parent("#GridAxpFile"+e).find(".attach-files").children().length;i++)if($(".attach-files").parent("#GridAxpFile"+e).find(".attach-files").children()[i].id==n)if($($(".attach-files").parent("#GridAxpFile"+e).find(".attach-files").children()[i]).removeClass("revrseInlinediv"),$(".attach-files").parent("#GridAxpFile"+e).find(".attach-files").height()>20)$($(".attach-files").parent("#GridAxpFile"+e).find(".attach-files").children()[i]).addClass("revrseInlinediv");else{var d=$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles",d),""==$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles")&&$("input#"+e).siblings("#GridAxpFile"+e).find(".attachment-count").addClass("revrseInlinediv")}if(t==l.replace(/♠/g," ").replace(/♦/g,"(").replace(/♣/g,")")){var s=$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles").replace(n+",","").replace(","+n,"").replace(n,"");$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles",s),""==$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles")&&($("input#"+e).siblings("#GridAxpFile"+e).find(".attachment-count").addClass("revrseInlinediv"),$(".popover").css("display","none"))}}}),r==t&&$("textarea#"+e).text(n).val(n)});var c=$("input#"+e).siblings("#GridAxpFile"+e).attr("data-morefiles");c&&$("input#"+e).siblings("#GridAxpFile"+e).find(".attachment-count span").text(c.split(",").length+"+")}}var referRecId="",refFiles=Array(),fldExp="";function SetGridRefWithdcImage(e,t){var a=GetFieldsRowFrameNo(e),i=(GetFieldsDcNo(e),$j("#recordid000F0").val(),Array(),$j("#hdnScriptsUrlpath"));fldExp=t;var r;r=i.val()+"axpert/"+sid+"/";$j("#grdAtt_hlnk_"+a);if(t.indexOf(",")>-1){for(var n=GetReferedFiles(t).split(","),l=0;l<n.length;l++)fileLinks+='<div id="Link'+n[l]+"\"><a href='javascript:void(0)' id='grdAtt_hlnk_001F2' tabindex='-1' class='grdAttach handCur' onclick='ShowGridAttLink(\""+r+referRecId+"-"+n[l]+"\")'>"+n[l]+"</a></div>",refFiles.push(n[l]);window.localStorage&&(localStorage.refFiles=JSON.stringify(n),localStorage.referRecId=JSON.stringify(referRecId),localStorage.fldExp=JSON.stringify(fldExp))}return fileLinks}function GetReferedFiles(e){var t=e,a=t.indexOf("("),i=t.indexOf(","),r=a+1,n=t.indexOf(")")-1;return referRecId=t.substring(i+1,r-1),t.substr(r,n-r+1)}function SetGridRefValue(e,t){var a,i,r,n="",l=t,d=(Array(),"false"),s=new Array;if(""!=t&&(a=l.split("@")).length>=1){var o;o=$j("#hdnScriptsUrlpath").val()+"axpert/"+sid+"/";for(var c=GetFieldsRowFrameNo(e),p=$j("#grdRef_img_"+c),u=GetFieldsDcNo(e),f=GetFieldsRowNo(e),h=($j("#recordid000F0").val(),0);h<a.length;h++)if(""!=(i=a[h])){var v=(i=i.substring(i.lastIndexOf("\\")+1)).indexOf("("),m=i.indexOf(",");if(m<v){var g=v+1,b=i.indexOf(")")-1;referRecId=i.substring(m+1,g-1),r=i.substr(g,b-g+1)}else d="true",r=i;if(r.length>0&&(s=r.split(",")),s.length)for(var w,F=0;F<s.length;F++)s[F]==undefined&&""==s[F]||(w="false"==d?referRecId+"-"+s[F]:s[F],n+='<div id="ReferLink_'+f+"_"+s[F]+'"><a id="grdRefLink_hlnk__'+f+"F"+u+'" onclick="DeleteFileFromRow(\''+e+"','"+c+"','"+s[F]+'\')"><img src="../AxpImages/icons/16x16/delete.png" /></a><a id=\'grdRef_hlnk_'+f+"F"+u+"' class='grdRefer handCur' onclick='ShowGridAttLink(\""+o+w+"\")'>"+s[F]+"</a></div>")}p[0].outerHTML=n}}var hlightRow="";function SetGridBtnAccess(){if("0"!=$j("#recordid000F0").val()&&$j("#axp_btnaccess000F1").length>0){var e=$j("#axp_btnaccess000F1").val().toLowerCase();if(""!=e){var t;t="-1"!=e.indexOf("{")?e.substring(1,e.length-1).split("^"):e.split("^");for(var a=0;a<t.length;a++)for(var i=t[a].split("~"),r=i[0].substring(2),n=1;n<i.length;n++)i[n].toString().startsWith("a")?SetAddBtnAccess(r,i[n]):i[n].toString().startsWith("d")?SetDeleteBtnAccess(r,i[n]):SetFillGridBtnAccess(r,i[n])}}}function SetAddBtnAccess(e,t){$j("#divDc"+e).length>0&&$j("#addrow"+e).length>0&&("a0"==t.toString()?$j("#addrow"+e).removeClass("disableadd"):"a1"==t.toString()?$j("#addrow"+e).addClass("disableadd"):"a2"==t.toString()?$j("#addrow"+e).show():"a3"==t.toString()&&$j("#addrow"+e).hide())}function SetDeleteBtnAccess(e,t){for(var a=parseInt(GetDcRowCount(e),10),i=1;i<=a;i++){var r=r="del"+GetRowNoHelper(GetClientRowNo(i,e))+"F"+e;"d0"==t.toString().toLowerCase()?$j("#"+r).length>0&&$j("#"+r).removeClass("disabledelete"):"d1"==t.toString().toLowerCase()&&$j("#"+r).length>0&&$j("#"+r).addClass("disabledelete")}}function SetFillGridBtnAccess(e,t){if($j("#fillgrid"+e).length>0)for(var a,i=document.getElementsByClassName("handCur fillcls"),r=0;r<i.length;r++)a=i[r].name,t.toString().startsWith("f*")?"f*0"==t.toString()?$j("[name="+a+"]").removeClass("disablefill"):"f*1"==t.toString()?$j("[name="+a+"]").addClass("disablefill"):"f*2"==t.toString()?($j("[name="+a+"]").show(),$j("[name = lbl"+a+"]").show()):"f*3"==t.toString()&&($j("[name="+a+"]").hide(),$j("[name = lbl"+a+"]").hide()):t.toString()==a+0?$j("[name="+a+"]").removeClass("disablefill"):t.toString()==a+1?$j("[name="+a+"]").addClass("disablefill"):t.toString()==a+2?($j("[name="+a+"]").show(),$j("[name = lbl"+a+"]").show()):t.toString()==a+3&&($j("[name="+a+"]").hide(),$j("[name = lbl"+a+"]").hide())}function SafariTabDcHeight(){$j(document).ready(function(){if(-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")){var e=0;for(e=0;e<PagePositions.length;e++)if(-1!=PagePositions[e].toString().indexOf(",")){var t="tabs"+PagePositions[e].toString().split(",")[0];$j("#"+t+" ul").css("height","100%")}}$("body").click(function(e){0!=$(".agc-alert-success").length&&HideDialog()}),$(document).keypress(function(e){0!=$(".agc-alert-success").length&&HideDialog()})}),checkSuccessAxpertMsg()}function CheckCustFooter(){var e=$j("#ax_customtoolbar000F1");if(null!=e&&e.length>0){$j("#dvCustToolbar").css("display","block"),$j("#dvsubmitCancelBtns").css("display","none");for(var t=e.val().split("~"),a="",i=0;i<t.length;i++){var r=t[i].split(",");r.length>3?a+=CreateCustFooter(r[0],r[1],r[2],r[3]):a+=CreateCustFooter(r[0],r[1],r[2])}$j("#dvCustToolbar").html('<table><tbody><tr><td align="center" valign="middle"><center>'+a+"</center></td></tr></tbody></table>")}}function CreateCustFooter(e,t,a,i){var r="";return"ax_save"==a?r='<span id="dvSaveNew"><input id="btnSaveNew" name="axFooBtn_'+e+'" type="button" onclick="javascript: FormSaveNew();" value="'+t+'" class="button"/>&nbsp;&nbsp;</span>':"ax_savereset"==a?r='<span id="dvSaveReset"><input id="btnSaveReset" name="axFooBtn_'+e+'" type="button" onclick="javascript: FormSaveReset();" value="'+t+'" class="button"/>&nbsp;&nbsp;</span>':"ax_savecontinue"==a?(r='<span id="dvSaveCont"><input id="btnSaveCont" name="axFooBtn_'+e+'" type="button" onclick="javascript: FormSaveContinue();" value="'+t+'" class="button"/>&nbsp;&nbsp;</span>',btnSaveContVal=i):"ax_savesend"==a?(r='<span id="dvSaveSend"><input id="btnSaveSend" name="axFooBtn_'+e+'" type="button" onclick="javascript: FormSaveSend(\''+i+'\');" value="'+t+'" class="button"/>&nbsp;&nbsp;</span>',btnSaveSendVal=i):"ax_reset"==a&&(r='<span id="dvReset"><input id="btnFooReset" name="axFooBtn_'+e+'" type="button" onclick="javascript: FormReset();" value="'+t+'" class="button"/>&nbsp;&nbsp;</span>'),r}var axFooAction="";function FormSaveNew(){axFooAction="ax_savenew",FormSubmit()}function FormSaveReset(){axFooAction="ax_save",FormSubmit()}function FormSaveContinue(){axFooAction="ax_savecontinue",FormSubmit()}function FormSaveSend(e){axFooAction="ax_savesend";var t=e.split(":");if(t.length>1){var a="#"+t[0]+"000F1",i=t[1];$j(a).length>0&&($j(a).val(i),UpdateFieldArray(a.substring(1),"0",i,"parent"))}FormSubmit()||$j(a).length>0&&($j(a).val(i),UpdateFieldArray(a.substring(1),"0",i,"parent"))}function FormReset(){axFooAction="ax_reset",NewTstruct()}function ShowTstHelp(transId){var loadPop;try{loadPop=window.open("Formhelp.aspx?transid="+tst+"&key="+tstDataId,"LoadPop","width=800,height=500,resizable=1,scrollbars=yes")}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}function ShowFileUplDSignPopUp(e){var t=e.id;t=t.replace("img_","");var a=document.getElementById("hdn_"+t).value;if(""==a)showAlertDialog("warning",2020,"client");else{var i="../dsign/DsignUploadFile.aspx?pdocname="+a+"&attachtxtid="+t;window.open(i,"Fileupload","width=500,height=350,scrollbars=no,resizable=yes")}}function DisableFileUplDSignFld(){$j(".disupldsign").length>0&&$j(".disupldsign").each(function(){$j(".disupldsign").prop("disabled",!0);var e=$j(this);"text"!=e[0].type?$j("#recordid000F0").val()>0?e.show():e.hide():$j("#recordid000F0").val()<=0&&$j(".disupldsign").val("")})}function OpenMulSelSrchPop(e){var t=e.id.split(/_(.*)/);multiSelectID=t[1];var a=$j("#"+multiSelectID).offset().top;$j("#srchMulSelResCnt").text("0 of 0"),$j(".ui-dialog").is(":visible")&&$j("#srchMulSelFlds").is(":visible")||!$j(".ui-dialog").is(":visible")&&!$j("#srchMulSelFlds").is(":visible")?($j("#srchMulSelDynTxt").val(""),srchDlg=$j("#srchMulSelFlds").dialog({resizable:!1,autoOpen:!0,height:100,modal:!1,title:"Search",position:["top",a-40],buttons:{OK:function(){focusSelected()},Next:function(){MovMulSelNxt()},Prev:function(){MovMulSelPrv()},Close:function(){UnSelMuSelSrchItm(),$j(this).dialog("close")}},close:function(e,t){UnSelMuSelSrchItm()}}).prev(".ui-dialog-titlebar").css("color","white")):UnSelMuSelSrchItm()}function FndMulSelStr(e){AxSearchArray=new Array,UnSelectSearchItem(),""!=e?$j("span [name ="+multiSelectID+"]").find(":checkbox").each(function(){if("hidden"!=$j(this).attr("type")){var t=$j(this).attr("id");if(t){var a=GetFieldsDcNo(t);if(IsDcPopGrid(a))return}$j(this).val().toString().trim().toLowerCase().indexOf(e.toString().toLowerCase())>-1&&!$j(this).is(":focus")&&AxSearchArray.push($j(this)),idxSearchFoc=0,AxSearchArray.length>0?$j("#srchMulSelResCnt").text(AxSearchArray.length+" Found"):$j("#srchMulSelResCnt").text("0 Found")}}):$j("#srchMulSelResCnt").text("0 Found")}function UnSelMuSelSrchItm(){$j("input:not([id=srchMulSelDynTxt]").each(function(){$j(this).hasClass("srchselectedfield")&&$j(this).removeClass("srchselectedfield")})}function focusSelected(){$j(AxSearchArray[0]).focus()}function MovMulSelNxt(){if(idxSearchFoc<AxSearchArray.length-1){idxSearchFoc++;var e=0;$j(AxSearchArray[idxSearchFoc]).attr("id")&&(e=GetFieldsDcNo($j(AxSearchArray[idxSearchFoc]).attr("id"))),AxSearchArray[idxSearchFoc].addClass("srchselectedfield"),AxSearchArray[idxSearchFoc-1].removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click(),$j("#srchMulSelResCnt").text(idxSearchFoc+1+" of "+AxSearchArray.length),AxSearchArray[idxSearchFoc].focus()}else idxSearchFoc==AxSearchArray.length-1&&AxSearchArray[idxSearchFoc].focus()}function MovMulSelPrv(){GetOpenTabDcs();if(idxSearchFoc>0&&AxSearchArray.length>=idxSearchFoc){idxSearchFoc--;var e=0;$j(AxSearchArray[idxSearchFoc]).attr("id")&&(e=GetFieldsDcNo($j(AxSearchArray[idxSearchFoc]).attr("id"))),AxSearchArray[idxSearchFoc].addClass("srchselectedfield"),AxSearchArray[idxSearchFoc+1].removeClass("srchselectedfield"),$j.inArray(e,TabDCs)>-1&&$j("#ank"+e).click(),AxSearchArray[idxSearchFoc].focus(),$j("#srchMulSelResCnt").text(idxSearchFoc+1+" of "+AxSearchArray.length)}else idxSearchFoc==AxSearchArray.length-1&&AxSearchArray[idxSearchFoc].focus()}function ParseJSON(){for(var e=$j('[id*="divDc"]'),t=0;t<e.length;t++){var a,i=!1;try{a=$j("#"+e[t].id+" [id^=wrapperForEditFields]")[0].id,$j("#"+a).hasClass("hide")&&(i=!0,$j("#"+a).removeClass("hide"))}catch(r){}AlignDcElements(e[t].id,"firstLoad");try{1==i&&($j("#"+a).addClass("hide"),i=!1)}catch(r){}AssignGrdFreezeHdrScript(t+1),OnRowChangeSetHeight(t+1)}$j("div#wBdr").show(),ShowDimmer(!1)}function openTstDesign(){}function AlignDcElements(e,t){if(t=void 0!==t?t:"default",e.indexOf("divDc")>-1&&$("#"+e).is(":visible")&&(TabDCAlignmentStatus[e.substr(e.indexOf("divDc")+5)-1]="aligned"),jsonText!=undefined&&""!=jsonText);else{var a=parseInt(e.substring(5));if($j("#contentScroll"+a).length>0){0==$j("#myTab").length&&$j("[id^=containerDc]").css("padding","0px 15px");var i=parseInt($j("#gridHd"+a).css("min-width").replace("px",""));$j("#gridHd"+a).css("width",i+"px"),"design"==theMode&&$j("#gridHd"+a+" thead th").each(function(){var e=$(this);e.is(":visible")&&e.attr("id")!=undefined&&""!=e.attr("id")&&e.append('<button type="button" class="eyeBtn" onclick="toggleEyeClass(this,event);"><i class="icon-basic-eye" title="Hide Column"></i></button>')}),i<$j("#wBdr").width()?$j("#contentScroll"+a).css("width",parseInt(i)):$j("#contentScroll"+a).css("width",parseInt($j("#wBdr").width())-30)}}var r=e.substr(5);checkTableBodyWidths(r)}function OnRowChangeSetHeight(e){var t=$j("#gridHd"+e),a=$j("#contentScroll"+e);if(t.length>0&&a.length>0){var i=parseInt($j("#gridDc"+e+" tbody").css("height").replace("px",""));(parseInt(t.css("min-width").replace("px",""))<parseInt($j("#wBdr").css("width").replace("px",""))||a[0].scrollWidth>a[0].clientWidth)&&(i+20>parseInt(a.css("height").replace("px",""))?a.hasClass("hasScroll")||(a.css("width",parseInt(a.css("width").replace("px",""))+18),a.addClass("hasScroll")):a.hasClass("hasScroll")&&(a.css("width",parseInt(a.css("width").replace("px",""))-18),a.removeClass("hasScroll")))}}function FocusOnLastField(e,t){var a=$j("#contentScroll"+e);if(OnRowChangeSetHeight(e),a!=undefined){if(a.scrollTop(a[0].scrollHeight),$j("#gridDc"+e+" tbody tr:last").find("td:visible:not('.gridtdclass')").length>0)var i=$j("#gridDc"+e+" tbody tr:last").find("td:visible:not('.gridtdclass')")[0];$j(i).find("select,input").focus()}}function FocusOnFirstGridField(e){var t=$j("#contentScroll"+e);if(t.length>0&&(OnRowChangeSetHeight(e),t!=undefined)){if(t.scrollTop(t[0].scrollHeight),$j("#gridDc"+e+" tbody tr:first").find("td:visible:not('.gridtdclass')").length>0)var a=$j("#gridDc"+e+" tbody tr:first").find("td:visible:not('.gridtdclass')")[0];$j(a).find("select,input").focus()}}function OnMenuPanelChange(e){var t=$j("[id^='gridHd']");if(t.length>0)for(i=0;i<t.length;i++){var a=t[i].id.substring(6),r=$j("#contentScroll"+a);parseInt($j("#gridDc"+a+" tbody").css("height").replace("px",""));if(a!=undefined&&!isNaN(a)){0==$j("#myTab").length&&$j("[id^=containerDc]").css("padding","0px 15px");var n=parseInt($j(t[i]).css("min-width").replace("px",""));n>parseInt($j("#wBdr").css("width").replace("px",""))+30?($j("#contentScroll"+a).css("width",parseInt($j("#wBdr").css("width").replace("px",""))-30),r.hasClass("hasScroll")&&r.css("width",parseInt(r.css("width").replace("px",""))+18)):($j("#contentScroll"+a).css("width",n),r.hasClass("hasScroll")&&r.css("width",parseInt(r.css("width").replace("px",""))+18)),OnRowChangeSetHeight(a)}}}function pickDownn(){var e=$j("#tblPickData tr").length,t="";"-1"==(t=$j("#tblPickData tr.active").index()+1)&&(t=0),$j("#tblPickData tr").removeClass("active"),t<e?$j("#tblPickData tr:nth-child("+(t+1)+")").addClass("active"):$j("#tblPickData tr:nth-child(1)").addClass("active")}function pickUpp(){$j("#tblPickData tr").length;var e="";"0"==(e=$j("#tblPickData tr.active").index()+1)&&(e=1),$j("#tblPickData tr").removeClass("active"),1==e?$j("#tblPickData tr:nth-last-child(1)").addClass("active"):$j("#tblPickData tr:nth-child("+(e-1)+")").addClass("active")}function AxCustomExportToXml(){var e,t,a,i;e=GetFieldValue("branch000F1").replace(/\&/g,"¿"),t=GetFieldValue("company000F1").replace(/\&/g,"¿"),a=GetFieldValue("docdate000F1"),i="ExportasXML.aspx?tid="+transid+"&branch="+e+"&comp="+t+"&vcd="+a,window.open(i,"_self")}function ChangeDir(e){$j("#form1").attr("dir",e)}function LoadPdfDDL(e){document.getElementById("dvPdfDDl").innerHTML=e}function deletepdffile(e){$j.ajax({url:"htmltopdf.aspx/DeletePrintPDF",type:"POST",cache:!1,data:JSON.stringify({pdfPath:e}),async:!1,dataType:"json",contentType:"application/json",success:function(e){ShowDimmer(!1)},error:function(e,t,a){ShowDimmer(!1)}})}function resetActions(){$("#selectbox").val("#consumergoods"),$("#comment").val(""),$("#message").text("")}function clickOnWrkBtn(){switch($("#selectbox").find("li.selected").text()){case"Approve":$("#btntabapprove").click();break;case"Reject":$("#btntabreject").click();break;case"Review & Forward":$("#btntabreview").click();break;case"Return":$("#btntabreturn").click()}}function SlectBoxWrf(e){isWizardTstruct&&$("body").append($("#consumergoods2").detach()),$("#accordion").hide(),$("#selectbox li").removeClass("selected"),$("#"+e).addClass("selected"),$("#consumergoods2").modal("show"),$("#comment").val(e),$("#commentimp").attr("style","display: block,margin-left: 75px,margin-top: -22px;"),$("#comment").removeClass("hide"),$("#btnWrfSave").removeClass("hide"),$("#btnWrfCancel").removeClass("hide"),$("#lblreject").text(""),$("#comment").length&&$("#comment").focus(),$("#consumergoods2").on("hidden.bs.modal",function(){resetActions()})}function TstructTabEventsInPopUP(e){$(".firstFocusable").removeClass("firstFocusable").off("keydown.tabRot"),$(".lastFocusable").removeClass("lastFocusable").off("keydown.tabRot");var t='button[tabindex!="-1"],a[tabindex!="-1"],input[tabindex!="-1"],textarea[tabindex!="-1"],select[tabindex!="-1"],table tbody tr[tabindex!="-1"]',a=$("#dvlayout").find(t).filter(":visible").not(":disabled"),i="";$j(".wrapperForGridData"+e+" tbody tr").length>0&&(i=$j(".wrapperForGridData"+e+" tbody tr").find(t).filter(":visible").not(":disabled").last());firstInput=a.first(),lastInput=a.last(),0!=$("#imgSaveTst").length?$("#imgSaveTst").addClass("firstFocusable"):firstInput.addClass("firstFocusable"),lastInput.addClass("lastFocusable"),$(".firstFocusable").focus(),""!=i&&(lastInput.removeClass("lastFocusable"),i.addClass("lastFocusable")),$(".lastFocusable").on("keydown.tabRot",function(e){axInlineGridEdit&&$(".inline-edit").length||9!==e.which||e.shiftKey||(e.preventDefault(),$(".firstFocusable").focus())}),$(".firstFocusable").on("keydown.tabRot",function(e){9===e.which&&e.shiftKey&&(e.preventDefault(),$(".lastFocusable").focus())})}function SetGridElementsHeight(){$j("[id^=containerDc] [id^=wrapperForEditFields] input[type=checkbox], #bootstrapModalData [id^=wrapperForEditFields] input[type=checkbox]").each(function(){var e=!1;($("#ckbCompressedMode").length&&1==$("#ckbCompressedMode").prop("checked")||$j("#hdnCompMode").length&&"true"==$j("#hdnCompMode").val().toLowerCase())&&(e=!0),$(this).parent().is("div")&&(e?($(this).parent().css("min-height","23px"),$(this).parent().css("height","23px")):($(this).parent().css("min-height","24px"),$(this).parent().css("height","24px")))})}function lnkNextClick(){if($("#lnkNext").length>0&&1==$("#lnkNext").prop("disabled"))return!1;if($("#lnkNext").addClass("disabled").prop("disabled",!0),lvNavDetails="",navValidator)eval(callParent("loadFrame()","function")),ASB.WebService.GetListViewNext(findGetParameter("openerIV"),tstDataId,SuccGetLVNxtDetails,OnExceptionGetLVDetails);else var cutMsg=eval(callParent("lcm[284]")),lvConfirm=$.confirm({title:eval(callParent("lcm[155]")),content:cutMsg,onContentReady:function(){disableBackDrop("bind")},escapeKey:"buttonB",buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"hotbtn",action:function(){lvNavDetails="next",FormSubmit()}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"coldbtn",action:function action(){eval(callParent("loadFrame()","function")),disableBackDrop("destroy"),ASB.WebService.GetListViewNext(findGetParameter("openerIV"),tstDataId,SuccGetLVNxtDetails,OnExceptionGetLVDetails)}}}})}function lnkPrevClick(){if($("#lnkPrev").length>0&&1==$("#lnkPrev").prop("disabled"))return!1;if($("#lnkPrev").addClass("disabled").prop("disabled",!0),lvNavDetails="",navValidator)eval(callParent("loadFrame()","function")),ASB.WebService.GetListViewPrev(findGetParameter("openerIV"),tstDataId,SuccGetLVPrvDetails,OnExceptionGetLVDetails);else var cutMsg=eval(callParent("lcm[284]")),lvConfirm=$.confirm({title:eval(callParent("lcm[155]")),content:cutMsg,onContentReady:function(){disableBackDrop("bind")},escapeKey:"buttonB",buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"hotbtn",action:function(){lvNavDetails="prev",FormSubmit()}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"coldbtn",action:function action(){eval(callParent("loadFrame()","function")),disableBackDrop("destroy"),ASB.WebService.GetListViewPrev(findGetParameter("openerIV"),tstDataId,SuccGetLVPrvDetails,OnExceptionGetLVDetails)}}}})}function SuccGetLVPrvDetails(result,eventArgs){if(""!=result){if(CheckSessionTimeout(result))return;if(0==result.indexOf("sess.aspx")||0==result.indexOf("err.aspx"))top.location.href=result;else{var redirLocation=result,axPopData=findGetParameter("AxPop");null!=axPopData&&(redirLocation=redirLocation+"&AxPop="+axPopData),redirLocation.toLowerCase().indexOf("tstruct.aspx?")>-1?AvoidPostBackAfterSave(redirLocation):window.location.href=redirLocation,$("#lnkPrev").removeClass("disabled").prop("disabled",!1),$("#lnkNext").removeClass("disabled").prop("disabled",!1)}}else eval(callParent("closeFrame()","function"))}function SuccGetLVNxtDetails(result,eventArgs){if(""!=result){if(CheckSessionTimeout(result))return;if(0==result.indexOf("sess.aspx")||0==result.indexOf("err.aspx"))top.location.href=result;else{var redirLocation=result,axPopData=findGetParameter("AxPop");null!=axPopData&&(redirLocation=redirLocation+"&AxPop="+axPopData),redirLocation.toLowerCase().indexOf("tstruct.aspx?")>-1?AvoidPostBackAfterSave(redirLocation):window.location.href=redirLocation,$("#lnkNext").removeClass("disabled").prop("disabled",!1),$("#lnkPrev").removeClass("disabled").prop("disabled",!1)}}else eval(callParent("closeFrame()","function"))}function OnExceptionGetLVDetails(result){eval(callParent("closeFrame()","function")),console.log("ListView Navigation Exception")}function setListviewButtons(){if("0"!=recordid){var e=findGetParameter("pageType");"single"==e?($("#lnkPrev").addClass("disabled").prop("disabled",!0),$("#lnkNext").addClass("disabled").prop("disabled",!0)):"first"==e?$("#lnkPrev").addClass("disabled").prop("disabled",!0):"last"==e&&$("#lnkNext").addClass("disabled").prop("disabled",!0)}}function toggleGridStretch(e,t,a){t=t||!1,"firstLoad"!=(a=void 0!==a?a:"default")&&(designChanged=!0,$(".grid-stack").addClass("dirty"),changeStatus("notSaved")),t||1!=$("#ckbGridStretch"+e).prop("checked")?($(".wrapperForGridData"+e+" table").css("max-width","100%").css("min-width","100%"),$(".wrapperForGridData"+e).outerWidth(!0)<$(".wrapperForGridData"+e+" table").outerWidth(!0)?fixGridStretch(e,"stretch"):$(".wrapperForGridData"+e+" table").css("display","")):($(".wrapperForGridData"+e+" table").css("max-width","").css("min-width",""),"block"==$(".wrapperForGridData"+e+" table").css("display")?fixGridStretch(e,"reset"):$(".wrapperForGridData"+e+" table").css("display","block"))}function fixGridStretch(e,t){$(".wrapperForGridData"+e+" table").css("max-width","100%").css("min-width","100%"),"stretch"==t?$(".wrapperForGridData"+e+" table").css("display","block"):"reset"==t&&$(".wrapperForGridData"+e+" table").css("display",""),$(".wrapperForGridData"+e+" table thead tr th").each(function(e){"stretch"==t?$(this).data("min-width",$(this).css("min-width")).css("min-width",""):"reset"==t&&$(this).css("min-width",$(this).data("min-width")).data("min-width","")})}function disableBtnBeforeReload(e){(e=void 0===e||e)?$("#icons").find("a").css("pointer-events","none").prop("disabled",!0).attr("disabled","disabled"):$("#icons").find("a").css("pointer-events").prop("disabled",!1).removeAttr("disabled")}function CheckIsAccessVoilation(){$("#reloaddiv").show(),$("#dvlayout").hide()}function ResetFormLoadCache(){try{AxWaitCursor(!0),ShowDimmer(!0);var e="";window.location.href.split("&").forEach(function(t){e+=t+"♠"}),GetFormLoadData(e,"","true")}catch(t){AxWaitCursor(!1)}}function OnExceptionFormLoad(e){AxWaitCursor(!1),ShowDimmer(!1)}function SuccResetFormLoadCache(e,t){if(CheckSessionTimeout(e))return AxWaitCursor(!1),void ShowDimmer(!1);"done"==e?window.location.href=window.location.href:(AxWaitCursor(!1),ShowDimmer(!1))}function ReloadOnAccessVoilation(){$("#reloaddiv").hide(),$("#dvlayout").show(),AxWaitCursor(!0),ShowDimmer(!0);var e=callBackFunDtls.split("♠")[0];"GetDependents"==e?GetDependents(callBackFunDtls.split("♠")[1],callBackFunDtls.split("♠")[2]):"createAutoComplete"==e?(createAutoComplete(callBackFunDtls.split("♠")[1]),callBackFunDtls=""):"GetTabData"==e?(GetTabData(callBackFunDtls.split("♠")[1]),callBackFunDtls=""):"CallActionExt"==e?(CallActionExt(callBackFunDtls.split("♠")[1],callBackFunDtls.split("♠")[2],callBackFunDtls.split("♠")[3],callBackFunDtls.split("♠")[4]),callBackFunDtls=""):"FillGridAfterConfirm"==e?(FillGridAfterConfirm(callBackFunDtls.split("♠")[1]),callBackFunDtls=""):"ProcessFillGrid"==e?(ProcessFillGrid(callBackFunDtls.split("♠")[1],callBackFunDtls.split("♠")[2]),callBackFunDtls=""):"RefreshDc"==e&&(ProcessFillGrid(callBackFunDtls.split("♠")[1],callBackFunDtls.split("♠")[2]),callBackFunDtls="")}function switchTstructMode(){"undefined"!=typeof theModeDesign&&"true"==theModeDesign&&(theMode="design",isWizardTstruct=!1,"design"==theMode&&$(callParentNew("splitIcon","id")).addClass("hide")),"undefined"!=typeof isWizardTstruct&&isWizardTstruct?(createTstructWizard(),wizardObj.checkNxtPrevBtns()):$("#wizardTstructWrapper").remove()}function createTstructWizard(){$("#dvFooter").hide(),$(".dcTitle").hide().next("hr.hrline").hide();try{"undefined"!=typeof designObj&&null!=designObj[0]&&null!=designObj[0].selectedLayout&&""!=designObj[0].selectedLayout&&"tile"==designObj[0].selectedLayout&&$(".dcTitle").show().next("hr.hrline").show()}catch(a){}$("#tstIcons #imgSaveTst,#tstIcons [title='Save' i]").hide(),wizardSaveActionBtn=1==$("#tstIcons #imgSaveTst").length?wizardSaveActionBtn:1==$("#tstIcons [onclick*='CallAction'][title='Save' i]").length?$("#tstIcons [onclick*='CallAction'][title='Save' i]").attr("onclick"):1==$("#tstIcons [onclick*='CallAction'][data-hint='Save' i]").length?$("#tstIcons [onclick*='CallAction'][data-hint='Save' i]").attr("onclick"):wizardSaveActionBtn,$("#wizardTstructWrapper").append(Array.prototype.reverse.call($("#pagebdy").prevAll()).detach()),$("#searchBar").addClass("oldSearchBar"),$("#wizardTstructWrapper").append('<div style="" id="wizardWrappper"><div class="wizardContent"><div id="wizardHeader"></div><div id="toolBarBtns"></div><div id="wizardBodyFooterWrapper"><div id="wizardBodyContent" class="wizardBodyContent"><div id="wizardFormContainer"></div></div><div class="wizardFooter"><div class="wizardNextPrevWrapper"><button onclick="wizardObj.checkClick(this,\'prev\')" type="button" id="wizardPrevbtn" class="wizardPrevNxtBtns waves-effect btn themeButton cutsomColorbtn left" title="Previous"><span class="material-icons">skip_previous</span> <span class="wizard-next">Prev</span></button><button onclick="javascript:NewTstruct();" type="button" id="wizardCancelbtn" class="wizardPrevNxtBtns waves-effect btn coldbtn left" title="Cancel"><span class="material-icons">close</span> <span class="wizard-next">Cancel</span></button><button onclick="'+(DCFrameNo.length>1?"wizardObj.checkClick(this,'next')":wizardSaveActionBtn)+'" data-validator="" id="wizardNextbtn" type="button" style="" class="wizardPrevNxtBtns waves-effect btn themeButton cutsomColorbtn" '+(DCFrameNo.length>1?'title="Next"':'title="Save"')+">"+(DCFrameNo.length>1?'<span class="material-icons">skip_next</span> <span class="wizard-next">Next</span>':'<span class="material-icons">save</span> <span class="wizard-next">Save</span>')+"</button></div></div></div></div></div>"),$("#searchBar").clone().removeClass("oldSearchBar").appendTo("#toolBarBtns"),$("#searchBar.oldSearchBar").remove();var e="modern"===AxwizardType?"flat":AxwizardType;wizardObj=new WizardComp({progress_bar:e}),wizardObj.tabCallback=!1;var t=DCFrameNo.map(function(e){return"DivFrame"+e});wizardObj.dcWizard={steps:t.length,ids:t,stepNames:DCCaption,validateKeys:t},wizardObj.checkNxtPrevBtns=function(e){e==undefined&&(e=!0);var t=$("#wizardHeader .step").filter(":visible").length,a=$("#wizardHeader .step").filter(":visible").index($("#wizardHeader .step.active")),i=GetWizardDcNo($j("#wizardWrappper #wizardHeader .step.active").data("target"));0==a?($("#wizardPrevbtn").hide(),$("#wizardNextbtn").show().attr({onclick:"wizardObj.checkClick(this,'next')",title:"Next"}).html("<span class='material-icons'>skip_next</span> <span class='wizard-next'>Next</span>")):a==t-1?($("#wizardPrevbtn").show(),"ad_lg"==transid?$("#wizardNextbtn").show().attr({onclick:"javascript:btn24onclick();",title:"Publish to runtime"}).html("<span class='material-icons'>sync_alt</span> <span class='wizard-next'>Publish to runtime</span>"):$("#wizardNextbtn").show().attr({onclick:wizardSaveActionBtn,title:"Save"}).html("<span class='material-icons'>save</span> <span class='wizard-next'>Save</span>")):($("#wizardPrevbtn").show(),$("#wizardNextbtn").show().attr({onclick:"wizardObj.checkClick(this,'next')",title:"Next"}).html("<span class='material-icons'>skip_next</span> <span class='wizard-next'>Next</span> ")),e&&i&&(FocusOnFirstField(i),SetFocusFormControl()),Closediv()},wizardObj.completeCurrentStep=function(){var e=$("#wizardHeader .step.in-progress"),t=e.nextAll(":visible").first();e.removeClass("in-progress active").addClass("complete"),t.addClass("in-progress active"),wizardObj.showActiveData(t.data("target"))},wizardObj.showActiveData=function(e){var t=e.startsWith("divDc")?parseInt(e.substr(5),10):e.startsWith("sp")?parseInt(e.substr(e.lastIndexOf("F")+1),10):e.startsWith("#gridHd")?parseInt(e.substr(7),10):e.startsWith("#tab-")?parseInt(e.substr(5),10):e.startsWith("DivFrame")?parseInt(e.substr(8),10):0;if($("#wizardBodyContent").children().not("#wizardFormContainer").length>0&&$("#wBdr").append($("#wizardBodyContent").children().not("#wizardFormContainer").detach()),$("#"+e).length){if(isMobile)isMobile&&($(".btnMobile").addClass("hide"),$("#divDc"+t).find(".mobilewrapperForEditFields").length>0&&$("#wrapperForEditFields"+t+" .grdButtons.btnMobile").removeClass("hide"));else{var i=e.slice(8);$("#myTab").find("#li"+i).find(".gridoptions").length>0?($("#wizardBodyContent").append('<div class="gridoptionlabel" id="grdOptId'+i+'"><span>Grid Options </span></div>'),$("#grdOptId"+i).append($("#myTab").find("#li"+i).find(".gridoptions").detach())):$("#head"+i).find(".gridoptions").length>0?($("#wizardBodyContent").append('<div class="gridoptionlabel" id="grdOptId'+i+'"><span>Grid Options </span></div>'),$("#grdOptId"+i).append($("#head"+i).find(".gridoptions").detach())):$("#grdOptId"+i).length>0&&$("#wizardBodyContent").append($("#grdOptId"+i).detach())}if($("#wizardBodyContent").append($("#"+e).detach()),IsDcGrid(t)&&!axInlineGridEdit){var r=$("#wrapperForEditFields"+t).find(".editWrapTr").attr("id"),n=r.substring(r.lastIndexOf("F"),r.lastIndexOf("F")-3);CallEvaluateOnAddPerf(t,n,GetGridFields(t),"AddRow"),UpdateFieldArray(ConstructFieldName(axpIsRowValid+t,t,parseInt(n,10)),n,"","parent","AddRow")}tabFocusEventHandler("unbind","pagebdy"),tabFocusEventHandler("bind","wizardWrappper",!0,!0),isMobile&&$(".wrapperForGridData"+t+" table tbody tr").length>0&&$("#colScroll"+t).show();try{AxAfterLoadTab(t)}catch(a){}}else isWizardTstruct&&(GetTabData(t.toString()),wizardObj.tabCallback=!0)},wizardObj.successRequestFreshTabData=function(e){var t=e.startsWith("divDc")?parseInt(e.substr(5),10):e.startsWith("sp")?parseInt(e.substr(e.lastIndexOf("F")+1),10):e.startsWith("#gridHd")?parseInt(e.substr(7),10):e.startsWith("#tab-")?parseInt(e.substr(5),10):e.startsWith("DivFrame")?parseInt(e.substr(8),10):0;wizardObj.tabCallback=!1,$("#wizardBodyContent").append($("#"+e).detach()),tabFocusEventHandler("unbind","pagebdy"),tabFocusEventHandler("bind","wizardWrappper",!0,!0),wizardObj.checkNxtPrevBtns(),recordid>0&&$("div#wizardWrappper div#wizardHeader div.step").addClass("complete"),isMobile&&$(".wrapperForGridData"+t+" table tbody tr").length>0&&$("#colScroll"+t).show()},t.forEach(function(e){e.substr(e.length-1)}),wizardObj.validateTheKey=function(){var e=GetWizardDcNo($j("#wizardWrappper #wizardHeader .step.active").data("target"));return!(e!=undefined&&""!=e&&!ValidateBeforeSubmit(e))||void 0},wizardObj.createWizard("dcWizard"),wizardObj.checkClick=function(e,t){if(isMobile){var a=parseInt(GetWizardDcNo($j("#wizardWrappper #wizardHeader .step.active").data("target")))+1,i="wrapperForEditFields"+a;try{AxAfterPopupAddRow(a,GetFieldsRowNo($j("#"+i+" .editWrapTr").attr("id")))}catch(b){}}if("prev"==t||"next"==t){var r=(p=$("#wizardHeader .step.active")).data("id"),n=p.data("objtype");if("next"==t)var l=wizardObj.validateTheKey(n,r);else if("prev"==t)l=!0;if(!0===l)if("next"==t){var d=p.nextAll(":visible").first();p.hasClass("complete")?(p.removeClass("active"),d.hasClass("complete")?d.addClass("active"):d.addClass("in-progress active")):(p.addClass("complete").removeClass("in-progress active"),d.addClass("in-progress active"));var s=d.data("objtype"),o=wizardObj[s].ids[d.data("id")];wizardObj.showActiveData(o),wizardObj.checkNxtPrevBtns()}else{p.removeClass("active");var c=p.prevAll(":visible:first");c.hasClass("complete")?c.addClass("active"):c.addClass("in-progress active");s=c.data("objtype"),o=wizardObj[s].ids[c.data("id")];wizardObj.showActiveData(o),wizardObj.checkNxtPrevBtns()}else l!==undefined&&""!=l&&showAlertDialog("warning",l)}else{var p,u=(p=e.parents(".step")).data("id"),f=(n=p.data("objtype"),$("#wizardHeader .step.active").data("id"));if(f===u||!p.hasClass("in-progress")&&!p.hasClass("complete"))return;targetElemClicked=e;var h=!0;if(u>f)for(var v=f;v<u;v++){var m=wizardObj.validateTheKey(n,v);if(!0!==m){m!==undefined&&$("#wizardHeader .step[data-id="+v+"] a").click(),h=m;break}}if(!0!==h||p.hasClass("active")||!p.hasClass("complete")&&!p.hasClass("in-progress"))h!==undefined&&""!=h&&showAlertDialog("warning",h);else{targetElemClicked="",$("#wizardHeader .step.active").removeClass("active");var g=p.addClass("active").data("target");wizardObj.showActiveData(g),wizardObj.checkNxtPrevBtns()}}},recordid>0&&$("div#wizardWrappper div#wizardHeader div.step").addClass("complete")}function GetWizardDcNo(e){try{return e.split("DivFrame")[1]}catch(t){console.log("Error in GetWizardDcNo. Incoming WizardId = "+e)}return""}function CheckWizardSaveButton(){var e=$("#wizardHeader .step").filter(":visible").length,t=$("#wizardHeader .step").filter(":visible").index($("#wizardHeader .step.active"));1==$("#wizardHeader .step").filter(":visible").length||t==e-1?$("#wizardNextbtn").show().attr({onclick:wizardSaveActionBtn,title:"Save"}).html('<span class="material-icons">save</span> <span class="wizard-next">Save</span>'):$("#wizardNextbtn").show().attr({onclick:"wizardObj.checkClick(this,'next')",title:"Next"}).html('<span class="material-icons">skip_next</span> <span class="wizard-next">Next</span>')}function ToggleWizardDc(e,t){var a=$("div#wizardWrappper div#wizardHeader div").find('[data-target="DivFrame'+e+'"]');if(a!=undefined)if("hide"==t){var i=GetWizardDcNo($j("#wizardWrappper #wizardHeader .step.active").data("target"));a.hide(),e==i?$j("#wizardPrevbtn").is(":visible")?wizardObj.checkClick(this,"prev"):$j("#wizardNextbtn").is(":visible")&&wizardObj.checkClick(this,"next"):wizardObj.checkNxtPrevBtns(!1)}else"show"==t&&(a.show(),a.hasClass("complete")||a.nextAll().removeClass("in-progress complete"));var r=$("#wizardHeader .step");r.removeClass("lastStep"),r.filter(":visible").last().addClass("lastStep")}function CompressMode(e){"true"===e||!0===e?($("#wBdr").find(".grid-stack").each(function(e,t){$(t).data("gridstack")&&($(t).data("gridstack").cellHeight(45,!1),$(t).data("gridstack").verticalMargin(1,!1))}),1!=$("link[href='../Css/compressedTstruct.min.css?v=36']").length&&$("head").append($('<link rel="stylesheet" type="text/css" />').attr("href","../Css/compressedTstruct.min.css?v=36")),"design"==theMode&&$("#ckbCompressedMode").prop("checked",!0)):($("#wBdr").find(".grid-stack").each(function(e,t){$(t).data("gridstack")&&($(t).data("gridstack").cellHeight(60,!1),$(t).data("gridstack").verticalMargin(20,!1))}),$("link[href='../Css/compressedTstruct.min.css?v=36']").length>0&&$('link[rel=stylesheet][href~="../Css/compressedTstruct.min.css?v=36"]').remove(),"design"==theMode&&$("#ckbCompressedMode").prop("checked",!1))}!function(e){"use strict";e(document).on("show.bs.tab",'.nav-tabs-responsive [data-toggle="tab"]',function(t){var a=e(t.target),i=a.closest(".nav-tabs-responsive"),r=a.closest("li"),n=r.closest("li.dropdown"),l=(r=n.length>0?n:r).next(),d=r.prev(),s=function(e,t){e.find(".dropdown-menu").removeClass("pull-xs-left pull-xs-center pull-xs-right").addClass("pull-xs-"+t)};i.find(">li").removeClass("next prev"),d.addClass("prev"),l.addClass("next"),s(d,"left"),s(r,"center"),s(l,"right")})}(jQuery),$j(document).on("click",".printhtmltopdf",function(){if(eval(callParent("isPrintPDFClick")+"= false"),""!=currentCK&&ShowdivContentCK($j("#"+currentCK),!1),eval(callParent("globalChange"))){var cutMsg=eval(callParent("lcm[31]"));if(confirm(cutMsg))return eval(callParent("isPrintPDFClick")+"= true"),SetFormDirty(!1),void FormSubmit()}ShowDimmer(!0);var formId=$j(this).attr("id"),rid=$j("#recordid000F0").val();if("0"==rid)return ShowDimmer(!1),void ShowDialog("error",2021,"client");$j.ajax({url:"htmltopdf.aspx/Getpdftohtml",type:"POST",cache:!1,async:!1,data:JSON.stringify({key:tstDataId,fname:formId}),dataType:"json",contentType:"application/json",beforeSend:function(){ShowDimmer(!0)},success:function success(data){if(null!=data.d||""!=data.d)if("error"!=data.d.split("~")[0]&&"session"!=data.d.split("~")[0]){var waitTime=1e3;if(jQBrowser.chrome||jQBrowser.opera||jQBrowser.safari)try{printJS(data.d)}catch(ex){var URL=data.d,W;try{W=window.open(URL,"","width=600,height=500,scrollbars=yes,resizable=yes"),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.mozilla){var URL=data.d,W;try{W=window.open(URL,"","width=600,height=500,scrollbars=yes,resizable=yes"),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.msie){var URL=data.d,W;try{W=window.open(URL),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}else if(jQBrowser.msedge){var fileUrl=data.d,win;try{win=window.open("","htmltopdf","width=600,height=400,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=auto,resizable=yes"),win.location.href=fileUrl,win.focus(),setTimeout(function(){win.print()},5e3)}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}waitTime=1e3}else{var URL=data.d,W;try{W=window.open(URL),W.window.focus()}catch(ex){showAlertDialog("warning",eval(callParent("lcm[356]")))}}setTimeout(function(){deletepdffile(data.d)},waitTime)}else"session"==data.d.split("~")[0]?(ShowDimmer(!1),parent.parent.location.href=data.d.split("~")[1]):(ShowDimmer(!1),ShowDialog("warning",data.d.split("~")[1]));else ShowDimmer(!1),ShowDialog("warning",2022,"client")},error:function(e,t,a){ShowDimmer(!1)}})});var primaryApiSettings=function(){return{async:!0,crossDomain:!0,method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},data:{session_id:callParentNew("thmSid"),utl:callParentNew("utl"),username:callParentNew("thmUser"),authorization:callParentNew("nodeAccessToken"),appSKey:appsessionKey}}};function getDraftsList(e){try{ASB.WebService.GetDraftsFromRedis(tst,tstructCaption,SuccessCallbackDraftKeys,FailureCallBackDraftKeys)}catch(t){AxWaitCursor(!1)}}function SuccessCallbackDraftKeys(e,t){CheckSessionTimeout(e)}function FailureCallBackDraftKeys(e,t){}function loadSavedDraft(CreatedOn){var cutMsg=eval(callParent("lcm[31]")),cutMsgTime=CreatedOn,glType=eval(callParent("gllangType"));cutMsg=cutMsg.split(".")[0]+" created on "+cutMsgTime+".Do you want to retrieve and edit this data?";var isRTL=!1;isRTL="ar"==glType,draftSetTimeoutObj=setInterval(SaveAsDraft,parseInt(AutosaveDraftTime)),clearInterval(draftSetTimeoutObj);var CallListViewCB=$.confirm({closeIcon:!1,title:eval(callParent("lcm[155]")),rtl:isRTL,onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:!0,escapeKey:"buttonB",content:cutMsg,buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"hotbtn",action:function(){CallListViewCB.close(),ShowDimmer(!0),GetFormLoadData("","true"),window.parent.isSessionCleared=!0,"true"==AutosaveDraft&""!=AutosaveDraftTime&&(draftSetTimeoutObj=setInterval(SaveAsDraft,parseInt(AutosaveDraftTime)))}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"coldbtn",action:function(){ShowDimmer(!1),disableBackDrop("destroy"),clearDraftrediskeys("true"),closeParentFrame(),window.parent.isSessionCleared=!0,"true"==AutosaveDraft&""!=AutosaveDraftTime&&(draftSetTimeoutObj=setInterval(SaveAsDraft,parseInt(AutosaveDraftTime)))}}}})}function clearDraftrediskeys(e){try{$.ajax({url:"tstruct.aspx/DeletedraftRediskeys",type:"POST",cache:!1,async:!0,data:JSON.stringify({key:transid,Isclear:e}),dataType:"json",contentType:"application/json",success:function(e){e.d},error:function(e){}})}catch(t){}}function loadSavedDraftExt(e){document.getElementById("hdnDraftName").value=e,$("#hdnDraftName").attr("value",e),SetSession({key:"DraftName",val:e,async:!1}),window.location.href=window.location.href.replace("#","")}function changeStatus(e){var t,a="",i="";if(e)switch(e){case"save":a="icon-basic-elaboration-cloud-check",i="Design Saved. Not yet published";break;case"notSaved":a="icon-basic-elaboration-cloud-remove",i="Design not yet saved.";break;case"published":a="icon-basic-elaboration-cloud-upload",i="Design published."}t='<a title="'+i+'" class="toolbarIcons widgetStatus-'+e+'"><i class="icon '+a+' "></i></a>',$("#designStatus").html(t)}function confirmOnAction(fromPropsheet){var ConfirmLeave=$.confirm({title:eval(callParent("lcm[155]")),animation:"scale",closeAnimation:"scale",animateFromElement:!1,onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .hotbtn").focus()},backgroundDismiss:"false",escapeKey:"cancel",content:eval(callParent("lcm[121]")),buttons:{confirm:{text:eval(callParent("lcm[164]")),btnClass:"hotbtn",action:function(){ConfirmLeave.close(),fromPropsheet?openProprtySht("addFieldPS"):window.location.href="tstruct.aspx"+window.location.search.replace(/&theMode=design/g,"")}},cancel:{text:eval(callParent("lcm[192]")),btnClass:"coldbtn",action:function(){disableBackDrop("destroy"),parent.actionsClicked=""}}}})}function refreshEditor(e){$("#divDc"+e).find("textarea[id*='sql_editor'],textarea[id*='SQL_EDITOR'],textarea[id*='exp_editor'],textarea[id*='EXP_EDITOR']").each(function(){var e=$(this).data("myeditor");e&&e.refresh()})}function TimePickerChecker(e){var t=!1;if("string"==typeof e&&""!=e&&"{"==e.charAt(0)&&"}"==e.charAt(e.length-1)&&e.indexOf(":")>-1){var a=e.slice(1,-1).split(":");a.forEach(function(e,i){if(!isNaN(e)&&i==a.length-1&&3==a.length)return t=!0})}return t}function TimePickerEvent(e,t){_toConsumableArray(e==undefined||""==e?$j(".tstOnlyTime"):$j(e+" .tstOnlyTime")).forEach(function(e,a){var i=$(e).attr("id"),r=GetFieldsName(i),n=GetFldNamesIndx(r),l="";-1!=n&&(l=Expressions[n].toString());var d=TimePickerChecker(l);isMobile&&!$(e).parent().hasClass("mobileTimeWrapper")&&$(e).wrap('<span class="mobileTimeWrapper"></span>'),$(e).timepicker("destroy"),$(e).timeEntry("destroy"),$(e).attr("id").startsWith("axpdbtm_")?$(e).timepicker({isRTL:t,controlType:"select",oneLine:!0,timeFormat:1==d?"HH:mm:ss":"HH:mm",defaultValue:1==d?"00:00:00":"00:00",onSelect:function(e,t){$j("#"+t.inst.id).trigger("blur")}}).timeEntry({show24Hours:!0,showSeconds:1==d}).focus(function(t){$(".ui-datepicker-current").click(function(){var t=GetFieldsName($(e).attr("id")),a=GetFldNamesIndx(t),i="";-1!=a&&(i=Expressions[a].toString());var r=ShowCurrentTime(TimePickerChecker(i));$(e).timepicker("setTime",r)})}):$(e).timepicker({isRTL:t,controlType:"select",oneLine:!0,timeFormat:1==d?"HH:mm:ss":"HH:mm",defaultValue:1==d?"00:00:00":"00:00",onSelect:function(e,t){$j("#"+t.inst.id).trigger("blur")}}).timeEntry({show24Hours:!0,showSeconds:1==d}),isMobile&&$(e).timeEntry("destroy")})}function ShowCurrentTime(e){var t="";try{$.ajax({url:"tstruct.aspx/GetCurrentTime",type:"POST",cache:!1,async:!1,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({setTimeFormat:e}),success:function(e){"success"==e.d.status?t=e.d.result:showAlertDialog("error","Error while getting server time.")},error:function(e){showAlertDialog("error","Error while getting server time.")}})}catch(a){showAlertDialog("error","Error while getting server time.")}return t}function ConfirmLeave(){return!1;var e,t,a}function MultiGroupSelectClk(e,t){if("dropdown-main"!=e.target.className){var a=$(t).find("select").attr("id"),i="",r=a.substring(0,a.lastIndexOf("F")-3);$("body #dv"+r).css("overflow-x","visible"),$("body #dv"+r).css("overflow-y","visible"),$("body #dv"+r).css("position","static"),0==axInlineGridEdit&&($("#"+a).parents(".grid-stack-item-content").css("overflow-x","visible"),$("#"+a).parents(".grid-stack-item-content").css("overflow-y","visible"),$("#"+a).parents(".grid-stack-item-content").css("position","static")),$("#"+a).parents(".edit-mode-content").length>0&&$("#"+a).parents(".edit-mode-content").css({position:"absolute",width:$("#"+a).parents("td").outerWidth(),left:$("#"+a).parents("td").offset().left});var n=$("#"+a).attr("data-selected"),l=$("#"+a).attr("data-sep");if(i="undefined"!=typeof wsPerfEnabled&&wsPerfEnabled?ISBoundAutoCom(r,a):ISBoundNew(r,a),jQuery.inArray(a,multiSelectflds)>-1){if(multiSelFldParents[multiSelectflds.indexOf(a)]!=i){multiSelFldParents[multiSelectflds.indexOf(a)]=i;var d=GetMultiSelectValues(t,i);multiSelFldResult[multiSelectflds.indexOf(a)]=d,""!=n&&(d=filterSelectedData(d,n,l),$("#"+a).parent(".dropdown-mul").find(".dropdown-selected").remove()),$(t).data("dropdown").destroy(),$(t).dropdown({data:d,multipleMode:"label",choice:function(){}}),MultiGroupSelectChoice($(t).data("dropdown"))}else if(multiSelFldParents[multiSelectflds.indexOf(a)]==i&&IsGridField(r)&&0==$(t).data("dropdown").config.data.length){d=multiSelFldResult[multiSelectflds.indexOf(a)];""!=n?($("#"+a).parent(".dropdown-mul").find(".dropdown-selected").remove(),d=filterSelectedData(d,n,l),$(t).data("dropdown").update(d,!0)):$(t).data("dropdown").update(d,!1),MultiGroupSelectChoice($(t).data("dropdown"))}}else{multiSelectflds.push(a),multiSelFldParents.push(i),jsonData=GetMultiSelectValues(t,i);d=jsonData;multiSelFldResult.push(d),""!=n?($("#"+a).parent(".dropdown-mul").find(".dropdown-selected").remove(),d=filterSelectedData(d,n,l),$(t).data("dropdown").update(d,!0)):$(t).data("dropdown").update(d,!1),MultiGroupSelectChoice($(t).data("dropdown"))}}}function filterSelectedData(e,t,a){var i=t.split(a);return $(e).each(function(){-1!=$.inArray(this.mslist,i)&&(this.selected="true")})}function MultiGroupSelectChoice(e){var t=$(e)[0].$select.attr("id"),a="";if("undefined"!=typeof $(e)[0].name&&$(e)[0].name.length>0){var i=$(e)[0].$select.attr("data-sep");jQuery.each($(e)[0].name,function(e,t){a+=""==a?$(t).text():i+$(t).text()})}else if("undefined"==typeof $(e)[0].name&&$(e)[0].$choseList[0].children.length>0){var r=$(e)[0].$select.attr("data-sep");jQuery.each($(e)[0].$choseList[0].children,function(e,t){$(t).hasClass("dropdown-selected")&&(a+=""==a?$(t)[0].innerText:r+$(t)[0].innerText)})}$(e)[0].$select.attr("data-selected",a);GetFieldsRowFrameNo(t);var n=GetFieldsDcNo(t),l=GetDbRowNo(GetFieldsRowNo(t),n),d=GetFieldsRowNo(t);IsDcGrid(n)&&isGrdEditDirty&&UpdateFieldArray(axpIsRowValid+n+d+"F"+n,GetDbRowNo(d,n),"","parent","AddRow"),UpdateFieldArray(t,l,a,"parent","AutoComplete"),MainBlur($("#"+t))}function AxGetFieldData(e){if("select-one"==$("#"+e).prop("type")){var t=[],a=[];return $("#"+e+" option").each(function(){a.push($(this).text()),t.push($(this).val())}),[t,a]}if("text"==$("#"+e).prop("type")&&$("#"+e).hasClass("fldAutocomplete")||"textarea"==$("#"+e).prop("type")&&1==$("#"+e).attr("data-type").startsWith("autocomplete-")){var i=[],r=[],n=[],l=AxGetCustSelectFldData(e);if(""!=l){var d=JSON.parse(l).pickdata[3].data;i=[];$(d).each(function(e,t){t.i=t.i.replace(/\^\^dq/g,'"'),i.push(t.i),r.push(t.v),n.push(t.d)})}return[i,r,n]}}function GetFieldId(e,t,a){return e+t+"F"+a}function FieldTypeTable(e,t){var a=$(t).parents(".autoinput-parent").find("input").attr("id");src="./tsttable.aspx?fldId="+a;var i=-1!=GetFieldCaption(a).length?GetFieldCaption(a):"Table";displayBootstrapModalDialog(i,"","330px",!0,src,"","",function(){ChangedTblFields=new Array,ChangedTblFieldVals=new Array,MainBlur($j($("#"+a))),$("#"+a).blur(),$("#"+a).focus()})}function ReloadJqueryReference(){if($('script[src^="/Js/formInit"]').length){$('script[src^="/Js/formInit"]').attr("id","removeInit");var e=$("#removeInit")[0].src;(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src",e),void 0!==t&&($("#removeInit").remove(),document.getElementsByTagName("head")[0].appendChild(t))}else{var t;$('head script[src*="/process.min.js"]').remove(),$('head script[src*="/tstruct.min.js"]').remove(),$('head script[src*="/helper.min.js"]').remove(),$('head script[src*="/jsclient.min.js"]').remove(),$('head script[src*="/main-tstruct.min.js"]').remove(),$('head script[src*="/newGridJS.min.js"]').remove(),$('head script[src*="/autoComplete.min.js"]').remove(),$('head script[src*="/multigroupselect.min.js"]').remove(),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/process.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/tstruct.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/helper.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/jsclient.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/main-tstruct.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/newGridJS.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/autoComplete.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("src","../Js/multigroupselect.min.js"),void 0!==t&&document.getElementsByTagName("head")[0].appendChild(t)}}function exportGridToExcel(e){({processGridExcelTable:function(){var t=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0];$("body").append($("#gridHd"+e).clone().attr("id","gridToExport").css({position:"fixed",left:$(window).width()+1e3+"px"})),$("#gridToExport").find("td").each(function(e,t){$(t).find("textarea").length>0&&$(t).text($(t).find("textarea").val())});var a=$("#gridToExport thead th").index($("#gridToExport thead th[id=uniqueEditDeleteAct"+e+"]"));a>-1&&($("#gridToExport thead th[id=uniqueEditDeleteAct"+e+"]").addClass("hide"),$("#gridToExport tbody tr").each(function(e,t){$(t).find("td:eq("+a+")").addClass("hide")}));var i=$("#gridToExport thead th").index($("#gridToExport thead th[id=uniqueThHead"+e+"]"));i>-1&&($("#gridToExport thead th[id=uniqueThHead"+e+"]").addClass("hide"),$("#gridToExport tbody tr").each(function(e,t){$(t).find("td:eq("+i+")").addClass("hide")})),$("#gridToExport thead th").each(function(e,t){$(t).attr("id")&&0==$(t).attr("id").indexOf("th-")&&$(t).text($(t).attr("id").substr(3))}),_this.header=$("#gridToExport thead").clone(),t||$("#gridToExport thead").remove()},generateExcel:function(){var t=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0];_this.processGridExcelTable(t);try{var a=XLSX.utils.table_to_book($("#gridToExport")[0],{sheet:DCName[parseInt(e)-1],display:!0,raw:!0});if(a){var i=_this.header.find("th:not(.hide):not(.none)").toArray().map(function(e){return $(e).attr("id").substring(3)}),r=[],n=a.Sheets[a.SheetNames[0]],l=i.length;Math.floor(Object.keys(n).filter(function(e){return"!ref"!=e}).length/l);Object.keys(n).forEach(function(e,a){var l=e.match(/[a-zA-Z]/g)?e.match(/[a-zA-Z]/g).join(""):"",d=e.match(/[0-9]/g)?e.match(/[0-9]/g).join(""):"";if(l&&d){var s=parseInt(d)-1,o=l.split("").reduce(function(e,t,a,i){var r=t.charCodeAt(0)-64;return i[a+1]&&(r*=26),r+e},0)-1,c=i[o],p=FNames.indexOf(c),u=FDataType[p],f="F"!=FProps[p][0],h=FDecimal[p],v="";"Numeric"==u&&(!t||s>0)&&(n[e].t="n",n[e].w&&delete n[e].w,n[e].v=n[e].v.replace(/,/g,""),""!==h&&"0"!=h&&(v="."+"0".repeat(h)),n[e].v&&0!=n[e].v?n[e].z=f?"#,###"+v:"#"+v:n[e].z="0"+v);var m=(n[e].v||"").length,g=v.length,b=Math.ceil(m/3);r[o]=r[o]>=m+g+b?r[o]:m+g+b}}),n["!cols"]=r.map(function(e){return{width:e}}),XLSX.writeFile(a,tstructName+"-"+DCName[parseInt(e)-1]+".xlsx")}}catch(d){}$("#gridToExport").remove()},confirm:function(){_this.confirmObj=$.confirm({title:appGlobalVarsObject.lcm[155],animation:"scale",closeAnimation:"scale",animateFromElement:!1,onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .hotbtn").focus()},backgroundDismiss:"false",escapeKey:"escape",content:appGlobalVarsObject.lcm[485],buttons:{confirm:{text:appGlobalVarsObject.lcm[279],btnClass:"hotbtn",action:function(){_this.confirmObj.close(),_this.generateExcel()}},cancel:{text:appGlobalVarsObject.lcm[280],btnClass:"coldbtn",action:function(){_this.confirmObj.close(),_this.generateExcel(!1)}},escape:{isHidden:!0,action:function(){disableBackDrop("destroy"),parent.actionsClicked=""}}}})},process:function(){_this=this,"undefined"==typeof XLSX?(ShowDimmer(!0),loadAndCall({files:{css:[],js:["/Js/shim.min.js","/Js/xlsx.full.min.js"]},callBack:function(){ShowDimmer(!1),_this.confirm()}})):_this.confirm()}}).process()}function GetAppDbVars(){try{AxWaitCursor(!0),ShowDimmer(!0);var e=$("#db_function000F1").val(),t=$("#db_function_params000F1").val();if(""==e)return showAlertDialog("error","Please enter DB function name."),AxWaitCursor(!1),void ShowDimmer(!1);$.ajax({url:"tstruct.aspx/GetFromDBJSON",type:"POST",cache:!1,async:!0,data:JSON.stringify({funName:e,funParams:t}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var t=e.d;if(t.startsWith("error:"))showAlertDialog("error",t.replace("error:",""));else{var a=JSON.parse(t);a=a[0];var i=1;try{$.each(a,function(e,t){var a=e.charAt(e.length-1),r=e.substr(0,e.length-1),n=null==t?"":t;gridDummyRowVal.length>0&&gridDummyRowVal.map(function(e){2==e.split("~")[0]&&gridDummyRowVal.splice($.inArray(e,gridDummyRowVal),1)});var l="";if(l=1==i.toString().length?"00"+i:2==i.toString().length?"0"+i:i,"0"!=recordid&&1==i){var d=GetDcRowCount("2");d>1&&DeleteAllRows("2",d),editTheRow("",2,"",event)}1!=i&&editTheRow("",2,"",event),$("#db_varname"+l+"F2").val(r),UpdateFieldArray("db_varname"+l+"F2",l,r,"parent"),$("#db_varval"+l+"F2").val(n),UpdateFieldArray("db_varval"+l+"F2",l,n,"parent"),$("#db_vartype"+l+"F2").val(a),UpdateFieldArray("db_vartype"+l+"F2",l,a,"parent"),UpdateFieldArray(axpIsRowValid+"2"+l+"F2",GetDbRowNo(l,"2"),"","parent","AddRow"),i++})}catch(r){}}}else showAlertDialog("error",1031,"client");AxWaitCursor(!1),ShowDimmer(!1)},error:function(e){showAlertDialog("error",1031,"client"),AxWaitCursor(!1),ShowDimmer(!1)}})}catch(a){AxWaitCursor(!1),ShowDimmer(!1)}}