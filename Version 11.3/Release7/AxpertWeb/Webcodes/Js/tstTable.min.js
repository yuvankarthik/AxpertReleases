/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/var fldAutoData=[],fldAutoList="",fldExpData=[],colNames=[],colVExp=[],colfExp=[],aportionWhat=[],aportionAgainst=[],aportionWhatVal=[],isQuery="",QueryData="",colSource=[],thisFldId="",valuesep="",rowsep="",rowObj=$();function LoadTableEvents(dvId){var autoDiv=dvId==undefined?"#divDc1":dvId;$j(dvId).find(".tblFromSelect:not(span)").select2(),createFormSelect(dvId+" .tblFromSelect:not(span)");var glType=eval(callParent("gllangType")),dtpkrRTL=!1;dtpkrRTL="ar"==glType;var glCulture=eval(callParent("glCulture")),dtFormat="dd/mm/yy";"en-us"==glCulture&&(dtFormat="mm/dd/yy"),$(".flatpickr-input").flatpickr({dateFormat:dtFormat}),$j(dvId+" .number").unbind("keypress"),$j(".number").keypress(function(e){return CheckNumeric(e,$j(this).val())}),$j("input.number").on("input",function(){var e=$j(this).val(),t=$j(this).attr("id"),a=$j(this).attr("data-fInd");if(t!=undefined){var l=callParentNew("FMaxLength")[a],n=callParentNew("FDecimal")[a];if(n!=undefined&&n>0){var r=l-n-1;if(-1==e.indexOf("."))e.length>r&&$j(this).val(e.slice(0,r));else if(-1!=e.indexOf(".")){var s=e.substring(0,e.indexOf(".")),i=e.substring(e.indexOf(".")+1,e.length);s.length>r&&(s=s.slice(0,r)),i.length>n&&(i=i.slice(0,n)),$j(this).val(s+"."+i)}}}}),$j(":text").unbind("blur"),$j(":text").blur(function(e){MainBlur($j(this),"input")}),$j("select").unbind("change"),$j("select").change(function(){MainBlur($j(this),"select")}),$(dvId).find(".selection .select2-selection").addClass("form-select-sm"),$(dvId).find(".select2-hidden-accessible").addClass("form-select-sm"),$(dvId).find(".fldmultiSelect").addClass("py-0")}$j(document).ready(function(){GetTableHtml(),$j(":text").blur(function(e){MainBlur($j(this),"input")}),$j("select").change(function(){MainBlur($j(this),"select")}),LoadTableEvents("#divTable")});var dtAssoc=[],searchResult=[],AutPageNo=1,AutPageSize=50,rcount=0,fetchRCount=callParentNew("FetchPickListRows")||1e3;PageCount=0;var CangefldName="",isNavigation=!1,refreshAC=!1,pickarrow=!1;function createFormSelect(fld){var formSelect=$(fld),fldNameAc="",fieldName="",fastdll="",termVal="",depFldName="";formSelect.select2({ajax:{url:"tstruct.aspx/GetAutoCompleteData",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",delay:250,data:function(e){termVal=e.term==undefined?"":e.term;var t=$(this).attr("data-id");fastdll=$(callParentNew(t,"id")).hasClass("fastdll");var a=$(callParentNew(t,"id")).hasClass("isrefreshsave"),l=GetSourceParamValue($(this)),n=GetAutoCompData(fldNameAc,termVal,AutPageNo,AutPageSize),r=fldNameAc.substring(0,fldNameAc.lastIndexOf("F")-3),s="";s=void 0!==callParentNew("wsPerfEnabled")&&callParentNew("wsPerfEnabled")?callParentNew("ISBoundAutoCom("+r+","+fldNameAc+")","function"):callParentNew("ISBoundNew("+r+","+fldNameAc+")","function");var i=callParentNew("GetFieldIndex("+r+")","function"),o=callParentNew("FldIsAPI")[i];return JSON.stringify({tstDataId:callParentNew("tstDataId"),FldName:r,FltValue:termVal,ChangedFields:parent.ChangedFields,ChangedFieldDbRowNo:parent.ChangedFieldDbRowNo,ChangedFieldValues:parent.ChangedFieldValues,DeletedDCRows:parent.DeletedDCRows,pageData:n,fastdll:fastdll,fldNameAc:fldNameAc,refreshAC:refreshAC,pickArrow:pickarrow,parentsFlds:s,rfSave:a,IsApiFld:o,tblSourceParams:l,isTstHtmlLs:callParentNew("resTstHtmlLS")})},processResults:function processResults(data){refreshAC=!1,callParentNew("resTstHtmlLS=","");try{var result=data.d.toString().replace(new RegExp("\\n","g"),"");if(""!=result&&(result.split("♠*♠").length>1&&(tstDataId=result.split("♠*♠")[0],result=result.split("♠*♠")[1]),result.split("*♠*").length>1&&(result=result.split("*♠*")[0])),callParentNew("CheckSessionTimeout("+result+")","function"))return;if(result=result.toString().replace(new RegExp("\\t","g"),"&#9;"),ChangedFields=new Array,ChangedFieldDbRowNo=new Array,ChangedFieldValues=new Array,DeletedDCRows=new Array,!result.toLowerCase().includes("access violation")||!result.toLowerCase().includes("asbtstruct.dll")){var serResult=$.parseJSON(result);if(datasss=serResult,serResult.error)return void ExecErrorMsg(serResult.error,"autocomplete");if(dtAssoc=serResult.pickdata[3].data,dtAssoc!=undefined&&0!=dtAssoc.length){if(fastdll){var aSearch=[];if($(dtAssoc).each(function(e,t){t.i=t.i.replace(/\^\^dq/g,'"'),t.i.toLowerCase().indexOf(termVal.toLowerCase())>=0&&aSearch.push(t)}),$("#"+fldNameAc).data("rowcount",aSearch.length),0!=aSearch.length){var result=$.map(aSearch,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:""==e.v?e.i:e.v,text:e.i,dep:e.d}});return searchResult=result,{results:result}}var cutMsg=eval(callParent("lcm[0]"));return{results:"",noResults:cutMsg}}var result=$.map(dtAssoc,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:""==e.v?e.i:e.v,text:e.i,dep:e.d}});return searchResult=result,{results:result}}var cutMsg=eval(callParent("lcm[0]"));return{results:"",noResults:cutMsg}}AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide()}catch(exception){-1!=exception.message.toLowerCase().indexOf("access violation")&&(AxWaitCursor(!1),ShowDimmer(!1),$("#reloaddiv").show(),$("#dvlayout").hide())}}},placeholder:"Search for a repository",minimumInputLength:0}).on("select2:open",function(e){var t=$(this).attr("data-id");fldNameAc=t})}function GetTableHtml(){var e="",t="";try{parent.ChangedTblFields=new Array,parent.ChangedTblFieldVals=new Array,thisFldId=$("#hdnfieldId").val();var a=$(callParentNew(thisFldId,"id")).val(),l=$(callParentNew(thisFldId,"id")).prop("disabled"),n=callParentNew("GetFieldsRowNo("+thisFldId+")","function"),r=thisFldId.substring(0,thisFldId.lastIndexOf("F")-3),s=callParentNew("GetFieldIndex("+r+")","function"),i=callParentNew("FTableTypeVal")[s];if(""!=i){if((i=RepSpecialCharsInHTML(i)).startsWith("{")||i.startsWith("db@"))i.startsWith("db@")&&(t=i=GetDBProcTableJson(i));else{var o=i.split("~")[1],d=callParentNew("GetDcNo("+o+")","function");t=i=GetstrTableJson("True"==parent.DCIsGrid[d-1]?$(callParentNew(o+n+"F"+d,"id")).val():$(callParentNew(o+"000F"+d,"id")).val())}var c=JSON.parse(i);if(void 0!==c){var u=c.props.type,p=c.props.colcount,f=c.props.rowcount,h=c.props.deleterow,v=c.props.addrow;rowsep=c.props.rowseparator,valuesep=c.props.valueseparator,"undefined"!=typeof c.props.sql&&(isQuery=c.props.sql);var m=1==l?"disabled":"";if("table"==u){var b="";""!=a&&(b=a.split(rowsep)).length>f&&(f=b.length),""==b&&"true"==isQuery&&SqlFillData();var g="",w="";g+='<tr class="fw-bold fs-6 text-gray-800 border-bottom-2 border-gray-200">',"t"!=h.toLowerCase()&&"true"!=h.toLowerCase()||(g+='<th class="w-10px"><div class="form-check form-check-sm form-check-custom p-2"><input type="checkbox" class="form-check-input fgHdrChk" name="chkItem" onclick="javascript:CheckAll(this);"></div></th>');for(var y=0;y<p;y++){var N=c.columns[y+1].caption,F="";"undefined"!=typeof c.columns[y+1].hide&&""!=c.columns[y+1].hide&&(F="t"==c.columns[y+1].hide.toLowerCase()?" d-none ":""),colNames.push(c.columns[y+1].name),parent.ChangedTblFields.push(c.columns[y+1].name),parent.ChangedTblFieldVals.push(""),g+=""!=F?'<th class="'+F+'">'+N+"</th>":"<th>"+N+"</th>";var C=c.columns[y+1].exp;colfExp.push(C);var x="";if(""!=C&&(C=C.replace(/,/g,"♦"),x=callParentNew("Evaluate("+c.columns[y+1].name+",000,"+C+",expr,table)","function")),fldExpData.push(x),colVExp.push(c.columns[y+1].vexp),"undefined"!=typeof c.columns[y+1].aportionwhat&&""!=c.columns[y+1].aportionwhat){aportionWhat.push(c.columns[y+1].aportionwhat);var I=c.columns[y+1].aportionwhat,P=$j($j("[id*='"+I+"']",doParentOpInIframe("document","rtn","[id*='"+I+"']")).find("input")).attr("id");aportionWhatVal.push($(callParentNew(P,"id")).val())}else aportionWhat.push(""),aportionWhatVal.push("");"undefined"!=typeof c.columns[y+1].aportionagainst?aportionAgainst.push(c.columns[y+1].aportionagainst):aportionAgainst.push("")}g+="</tr>";for(var D=0;D<f;D++){var j="";"undefined"!=typeof b[D]&&""!=b[D]&&""!=b&&(j=(j=b[D]).split(valuesep)),w+="<tr id="+D+">","t"!=h.toLowerCase()&&"true"!=h.toLowerCase()||(w+='<td class="input-group-sm"><div class="form-check form-check-sm form-check-custom p-2"><input type="checkbox" class="form-check-input fgChk" name="chkItem" onclick="javascript:ChkHdrCheckbox(this);" '+m+"></div></td>");var A=function(){var e="";e="undefined"!=typeof j[y]&&""!=j[y]&&""!=j?j[y]:"undefined"!=typeof fldExpData[y]&&""!=fldExpData[y]?fldExpData[y]:"undefined"!=typeof aportionWhatVal[y]&&""!=aportionWhatVal[y]&&0==D?aportionWhatVal[y]:c.columns[y+1].value;var t=c.columns[y+1].source,a="";"undefined"!=typeof c.columns[y+1].allowempty&&""!=c.columns[y+1].allowempty&&(a="f"==c.columns[y+1].allowempty.toLowerCase()?" data-ae='false' ":"");var l="";"undefined"!=typeof c.columns[y+1].allowduplicate&&""!=c.columns[y+1].allowduplicate&&(l="f"==c.columns[y+1].allowduplicate.toLowerCase()?" data-ad='false' ":"");var r="";"undefined"!=typeof c.columns[y+1].readyonly&&""!=c.columns[y+1].readyonly&&(r="t"==c.columns[y+1].readyonly.toLowerCase()?" disabled ":"");var s="";"undefined"!=typeof c.columns[y+1].hide&&""!=c.columns[y+1].hide&&(s="t"==c.columns[y+1].hide.toLowerCase()?" d-none ":""),colSource.push(t);var i=callParentNew("GetFieldIndex("+t+")","function"),o=(callParentNew("GetDWBFieldType('',"+i+")","function"),callParentNew("GetDcNo("+t+")","function")),d=t+n+"F"+o;if("Select"==callParentNew("FMoe")[i])if("True"==callParentNew("FldIsSql")[i])w+='<td class="input-group-sm '+s+'"><select '+m+r+a+l+' class="combotem Family form-control form-select tblFromSelect fldtableinput" data-control="select2" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+e+'" data-id="'+d+'" data-placeholder="Select an option" data-allow-clear="true">',""!=e&&(w+='<option value="'+e+'" selected="selected">'+e+"</option>"),w+="</select></td>";else if(V="",$(callParentNew(d)).find("option").each(function(){""!=e&&$(this)[0].value==e?V+=$(this)[0].outerHTML.replace("<option ","<option selected "):V+=$(this)[0].outerHTML.replace('selected="selected"',"")}),""==V){var u=$(callParentNew(d)).data("val").split(","),p=""==$(callParentNew(d)).val()?e:$(callParentNew(d)).val();for(k=0;k<u.length;k++)""!=p&&p==u[k]?V+='<option selected="selected" value="'+u[k]+'">'+(""==u[k]?"-- Select --":u[k])+"</option>":V+='<option value="'+u[k]+'">'+(""==u[k]?"-- Select --":u[k])+"</option>";w+='<td class="input-group-sm '+s+'"><select '+m+r+a+l+' class="tem Family form-control" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+p+'">'+V+"</select></td>"}else w+='<td class="input-group-sm '+s+'"><select '+m+r+a+l+' class="tem Family form-control" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+e+'">'+V+"</select></td>";else if("Accept"==callParentNew("FMoe")[i]&&"True"==callParentNew("FldIsSql")[i])w+='<td class="input-group-sm '+s+'"><input '+m+r+a+l+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+e+'"></td>';else if("undefined"!=typeof aportionWhat[y]&&""!=aportionWhat[y])w+='<td class="input-group-sm '+s+'"><input '+m+r+a+l+' type="text" class="tem Family form-control fldtableinput" readonly name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+e+'"></td>';else if("Numeric"==callParentNew("FDataType")[i])w+='<td class="input-group-sm '+s+'"><input '+m+r+a+l+' type="text" style="text-align:right;" class="tem Family form-control number fldtableinput" data-fInd="'+i+'" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+e+'"></td>';else if("Date/Time"==callParentNew("FDataType")[i])w+='<td class="input-group-sm '+s+'"><input '+m+r+a+l+' type="text" class="tem Family form-control flatpickr-input fldtableinput" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+e+'">',w+='<span class="input-group-addon spandate "><i class="glyphicon glyphicon-calendar icon-basic-calendar" title='+colNames[y]+"></i></span></td>";else if(""!=t&&"Accept"==callParentNew("FMoe")[i]&&""!=$(callParentNew(d)).val()&&$(callParentNew(d)).val().indexOf(",")>0){var f=$(callParentNew(d)).val().split(","),h=e;for(V="",V+='<option value="">-- Select --</option>',k=0;k<f.length;k++)""!=h&&h==f[k]?V+='<option selected="selected" value="'+f[k]+'">'+f[k]+"</option>":V+='<option value="'+f[k]+'">'+f[k]+"</option>";w+='<td class="input-group-sm '+s+'"><select '+m+r+a+l+' class="tem Family form-control" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+h+'">'+V+"</select></td>"}else w+='<td class="input-group-sm '+s+'"><input '+m+r+a+l+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[y]+'" id="'+colNames[y]+"R"+D+'" value="'+e+'"></td>';parent.ChangedTblFieldVals[y]=0==D?e:parent.ChangedTblFieldVals[y]+"~"+e};for(y=0;y<p;y++){A()}w+="</tr>"}e='<div class="">',e+='<div class="pb-5">',"t"!=v.toLowerCase()&&"true"!=v.toLowerCase()||(e+='<div class="btn btn-sm btn-icon btn-white btn-color-gray-600 btn-active-primary me-2 shadow-sm pull-left '+m+'"><span class="material-icons material-icons-style material-icons-3" title="Add" onclick="AddTableRows(\'fldTable\');">add</span></div>'),"t"!=h.toLowerCase()&&"true"!=h.toLowerCase()||(e+='<div class="btn btn-sm btn-icon btn-white btn-color-gray-600 btn-active-primary me-2 shadow-sm pull-left '+m+'"><span class="material-icons material-icons-style material-icons-3" title="Delete" onclick="DeleteTableRows(\'fldTable\');">delete_outline</span></div>'),""!=isQuery&&(e+='<div class="btn btn-sm btn-icon btn-white btn-color-gray-600 btn-active-primary me-2 shadow-sm pull-left '+m+'"><span class="material-icons material-icons-style material-icons-3" title="Fill Data" onclick="SqlFillData();">view_list</span></div>'),e+='<table id="fldTable" class="table table-bordered table-sm mt-10">',e+="<thead>",e+=g,e+="</thead>",e+="<tbody>",e+=w,e+="</tbody>",e+="</table>",e+="</div>",e+="<div></div>",e+='<div class="float-end d-none"><a href="javascript:void(0)" onclick="ClearTableData(\'fldTable\');" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center shadow-sm me-2 '+m+'"><span class="material-icons">clear</span>Clear</a><a href="javascript:void(0);" title="Ok" onclick="AddTableData(\''+thisFldId+"','"+valuesep+"','"+rowsep+'\');" class="btn btn-primary d-inline-flex align-items-center shadow-sm me-2 '+m+'"><span class="material-icons">save</span>Ok</a></div>',e+="</div>",""==b&&"sqlDescr"==isQuery&&setTimeout(function(){SqlFillData()},0)}else{var T="";""!=a&&(T=(T=a).split(valuesep));var R='<div id="divtblForm" >',S=function(){var e="";"undefined"!=typeof c.columns[y+1].hide&&""!=c.columns[y+1].hide&&(e="t"==c.columns[y+1].hide.toLowerCase()?" d-none ":"");var t=c.columns[y+1].caption;R+='<div class="col-lg-12 col-sm-3 col-md-3 col-xs-12 '+e+'"><label>'+t+"</label></div>",R+='<div class="col-lg-12 col-sm-9 col-md-9 col-xs-12 '+e+'">',colNames.push(c.columns[y+1].name),parent.ChangedTblFields.push(c.columns[y+1].name),parent.ChangedTblFieldVals.push("");var a=c.columns[y+1].exp;if(colfExp.push(a),x="",""!=a&&(a=a.replace(/,/g,"♦"),x=callParentNew("Evaluate("+c.columns[y+1].name+",000,"+a+",expr,table)","function")),fldExpData.push(x),colVExp.push(c.columns[y+1].vexp),"undefined"!=typeof c.columns[y+1].aportionwhat&&""!=c.columns[y+1].aportionwhat){aportionWhat.push(c.columns[y+1].aportionwhat);var l=c.columns[y+1].aportionwhat;P=$j($j("[id*='"+l+"']",doParentOpInIframe("document","rtn","[id*='"+l+"']")).find("input")).attr("id"),aportionWhatVal.push($(callParentNew(P,"id")).val())}else aportionWhat.push(""),aportionWhatVal.push("");"undefined"!=typeof c.columns[y+1].aportionagainst?aportionAgainst.push(c.columns[y+1].aportionagainst):aportionAgainst.push("");var r="";r="undefined"!=typeof T[y]&&""!=T[y]&&""!=T?T[y]:"undefined"!=typeof fldExpData[y]&&""!=fldExpData[y]?fldExpData[y]:"undefined"!=typeof aportionWhatVal[y]&&""!=aportionWhatVal[y]?aportionWhatVal[y]:c.columns[y+1].value;var s=c.columns[y+1].source,i="";"undefined"!=typeof c.columns[y+1].allowempty&&""!=c.columns[y+1].allowempty&&(i="f"==c.columns[y+1].allowempty.toLowerCase()?" data-ae='false' ":"");var o="";"undefined"!=typeof c.columns[y+1].allowduplicate&&""!=c.columns[y+1].allowduplicate&&(o="f"==c.columns[y+1].allowduplicate.toLowerCase()?" data-ad='false' ":"");var d="";"undefined"!=typeof c.columns[y+1].readyonly&&""!=c.columns[y+1].readyonly&&(d="t"==c.columns[y+1].readyonly.toLowerCase()?" disabled ":""),colSource.push(s);var u=callParentNew("GetFieldIndex("+s+")","function"),p=(callParentNew("GetDWBFieldType('',"+u+")","function"),callParentNew("GetDcNo("+s+")","function")),f=s+n+"F"+p;if("Select"==callParentNew("FMoe")[u])if("True"==callParentNew("FldIsSql")[u])R+="<select "+m+d+i+o+' class="combotem Family form-control form-select tblFromSelect fldtableinput" data-control="select2" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+r+'" data-id="'+f+'" data-placeholder="Select an option" data-allow-clear="true">',""!=r&&(R+='<option value="'+r+'" selected="selected">'+r+"</option>"),R+="</select>";else if(V="",$(callParentNew(f)).find("option").each(function(){""!=r&&$(this)[0].value==r?V+=$(this)[0].outerHTML.replace("<option ","<option selected "):V+=$(this)[0].outerHTML.replace('selected="selected"',"")}),""==V){var h=$(callParentNew(f)).data("val").split(","),v=""==$(callParentNew(f)).val()?r:$(callParentNew(f)).val();for(k=0;k<h.length;k++)""!=v&&v==h[k]?V+='<option selected="selected" value="'+h[k]+'">'+(""==h[k]?"-- Select --":h[k])+"</option>":V+='<option value="'+h[k]+'">'+(""==h[k]?"-- Select --":h[k])+"</option>";R+="<select "+m+d+i+o+' class="tem Family form-control" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+v+'">'+V+"</select>"}else R+="<select "+m+d+i+o+' class="tem Family form-control" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+r+'">'+V+"</select>";else if("Accept"==callParentNew("FMoe")[u]&&"True"==callParentNew("FldIsSql")[u])R+="<input "+m+d+i+o+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+r+'">';else if("undefined"!=typeof aportionWhat[y]&&""!=aportionWhat[y])R+="<input "+m+d+i+o+' type="text" class="tem Family form-control fldtableinput" readonly name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+r+'">';else if("Numeric"==callParentNew("FDataType")[u])R+="<input "+m+d+i+o+' type="text" style="text-align:right;" class="tem Family form-control number fldtableinput" data-fInd="'+u+'" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+r+'">';else if("Date/Time"==callParentNew("FDataType")[u])R+='<div class="input-group"><input '+m+d+i+o+' type="text" class="tem Family form-control flatpickr-input fldtableinput" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+r+'">',R+='<span class="input-group-addon spandate "><i class="glyphicon glyphicon-calendar icon-basic-calendar" title="'+colNames[y]+'"></i></span></div>';else if(""!=s&&"Accept"==callParentNew("FMoe")[u]&&""!=$(callParentNew(f)).val()&&$(callParentNew(f)).val().indexOf(",")>0){var b=$(callParentNew(f)).val().split(","),g=r;for(V="",V+='<option value="">-- Select --</option>',k=0;k<b.length;k++)""!=g&&g==b[k]?V+='<option selected="selected" value="'+b[k]+'">'+b[k]+"</option>":V+='<option value="'+b[k]+'">'+b[k]+"</option>";R+="<select "+m+d+i+o+' class="tem Family form-control" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+g+'">'+V+"</select>"}else R+="<input "+m+d+i+o+' type="text" class="tem Family form-control fldtableinput" name="'+colNames[y]+'" id="'+colNames[y]+'R0" value="'+r+'">';parent.ChangedTblFieldVals[y]=0==y?r:parent.ChangedTblFieldVals[y]+"~"+r,R+='</div><div class="clearfix"></div>'};for(y=0;y<p;y++){var V,k;S()}e="<div>",e+=R+="</div>",e+='</div><div class="clearfix"></div>',e+='<div class="d-none"><div class="col-12 float-end"><a href="javascript:void(0)" onclick="ClearTableData(\'fldTable\');" title="Clear" class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center shadow-sm me-2 '+m+'"><span class="material-icons">clear</span>Clear</a><a href="javascript:void(0);" title="Ok" onclick="AddTableData(\''+thisFldId+"','"+valuesep+"','"+rowsep+'\');" class="btn btn-primary d-inline-flex align-items-center shadow-sm me-2 '+m+'"><span class="material-icons">save</span>Ok</a></div></div>'}}}}catch(O){}$("#divTable").html(e);try{parent.AxAfterTableLoad(t)}catch(O){}}function AddTableData(){var e="",t=!0,a="";if($("#fldTable tbody tr").length>0)$("#fldTable tbody tr").each(function(){var l="";$(this).find("td").each(function(){if($(this).find("select").length>0&&void 0!==$(this).find("select").attr("value")){if(void 0!==$(this).find("select").data("ae")&&0==$(this).find("select").data("ae")&&""==$(this).find("select").attr("value"))return callParentNew('showAlertDialog("error",'+$(this).find("select").attr("id")+" cannot be left empty.)","function"),$(this).find("select").focus(),t=!1,!1;if(void 0!==$(this).find("select").data("ad")&&0==$(this).find("select").data("ad")&&""!=$(this).find("select").attr("value")){var e=$(this).find("select").attr("name")+"~"+$(this).find("select").attr("value")+"♠";if(a.indexOf(e)>-1)return callParentNew('showAlertDialog("error",'+$(this).find("select").attr("id")+" duplicate value not allowed.)","function"),$(this).find("select").focus(),t=!1,!1;a+=$(this).find("select").attr("name")+"~"+$(this).find("select").attr("value")+"♠"}l+=$(this).find("select").attr("value")+valuesep}else if($(this).find("input:text").length>0){if(void 0!==$(this).find("input").data("ae")&&0==$(this).find("input").data("ae")&&""==$(this).find("input").attr("value"))return callParentNew('showAlertDialog("error",'+$(this).find("input").attr("id")+" cannot be left empty.)","function"),$(this).find("input").focus(),t=!1,!1;if(void 0!==$(this).find("input").data("ad")&&0==$(this).find("input").data("ad")&&""!=$(this).find("input").attr("value")){var n=$(this).find("input").attr("name")+"~"+$(this).find("input").attr("value")+"♠";if(a.indexOf(n)>-1)return callParentNew('showAlertDialog("error",'+$(this).find("input").attr("id")+" duplicate value not allowed.)","function"),$(this).find("select").focus(),t=!1,!1;a+=$(this).find("input").attr("name")+"~"+$(this).find("input").attr("value")+"♠"}l+=$(this).find("input").attr("value")+valuesep}}),""!=l&&(l=l.substring(0,l.length-1)),e+=l+rowsep});else{var l="";$("#divTable").find("input,select").each(function(){if($(this).is("select")&&void 0!==$(this).attr("value")){if(void 0!==$(this).data("ae")&&0==$(this).data("ae")&&""==$(this).attr("value"))return callParentNew('showAlertDialog("error",'+$(this).attr("name")+" cannot be left empty.)","function"),$(this).find("select").select2("open"),t=!1,!1;l+=$(this).attr("value")+valuesep}else if($(this).is("input")&&"text"==$(this).attr("type")){if(void 0!==$(this).data("ae")&&0==$(this).data("ae")&&""==$(this).attr("value"))return callParentNew('showAlertDialog("error",'+$(this).attr("name")+" cannot be left empty.)","function"),$(this).find("input").focus(),t=!1,!1;l+=$(this).attr("value")+valuesep}}),""!=l&&(l=l.substring(0,l.length-1)),e+=l+rowsep}if(t){e=e.substring(0,e.length-1),$j("#"+thisFldId,doParentOpInIframe("document","rtn","#"+thisFldId)).val(e),UpdateArray(thisFldId,e),parent.CallbackFunctionBootstrap(thisFldId);try{parent.AxAfterAddTableData()}catch(n){}callParentNew("modalIdTableField","id").dispatchEvent(new CustomEvent("close"))}}function ClearTableData(e){$("#"+e+" tbody tr td").each(function(){$(this).find("input:text").val(""),$(this).find("input:text").attr("value",""),$(this).find("select").val(""),$(this).find("select").prop("selected",!1),$(this).find("select").hasClass("tblFromSelect")&&$(this).find("select").find("option").remove()})}function DeleteTableRows(e){$("#"+e+" tbody tr").each(function(){void 0!==$(this).find(".fgChk:checked").prop("checked")&&$(this).find(".fgChk:checked").prop("checked")&&(1==$("#"+e+" tbody tr").length&&($j(".fgHdrChk").prop("checked",!1),rowObj=$(this).clone()),$(this).remove())})}function AddTableRows(e){var t=$("#"+e+" tbody tr:last"),a="-1";0==t.length?(rowObj.find("input:text").val(""),$("#"+e+" tbody").append(rowObj)):(a=$("#"+e+" tbody tr:last").attr("id"),$(t).clone().insertAfter(t).find("input:text").val("")),$("#"+e+" tbody tr:last").find(".fgChk").prop("checked",!1),$j(".fgHdrChk").prop("checked",!1),$("#"+e+" tbody tr:last").find("select,input,div.autoclear i,div.edit i,div[id^=autoadv],div[id^=autoadv] i").each(function(e,t){var l=$j(this);if(l.hasClass("tblFromSelect")){var n=l.attr("disabled"),r=l.parent("td"),s=l.attr("name"),i=s+"R"+(parseInt(a)+1),o=l.attr("data-id"),d=l.attr("class");d=d.replace(" select2-hidden-accessible"," "),l.siblings("span.select2").remove(),l.remove();var c=void 0!==l.data("ae")&&0==l.data("ae")?" data-ae='false' ":"",u=void 0!==l.data("ad")&&0==l.data("ad")?" data-ad='false' ":"";r.html("<select "+n+c+u+' class="'+d+'" data-control="select2" name='+s+" id="+i+' value="" data-id='+o+' data-placeholder="Select an option" data-allow-clear="true"></select>')}else{if(id=l.attr("data-clk"),id!=undefined)l.attr("data-clk",$j(this).parents(".autoinput-parent").find("input").attr("id"));else{var p=l.attr("name"),f=p+"R"+(parseInt(a)+1);l.attr("id",f),l.removeAttr("value").attr("value","")}}}),$("#"+e+" tbody tr:last").attr("id",(parseInt(a)+1).toString()),LoadTableEvents("#divTable")}function MainBlur(obj,type){var fldInd=colNames.indexOf(obj.attr("name"));if("undefined"!=typeof colVExp[fldInd]&&""!=colVExp[fldInd]){var vExp=colVExp[fldInd].replace(/,/g,"♦"),vRowNo=obj.attr("id").replace(obj.attr("name")+"R",""),indx=$j.inArray(obj.attr("name"),parent.ChangedTblFields),cellVal=parent.ChangedTblFieldVals[indx].split("~");cellVal[vRowNo]=$(obj).val(),parent.ChangedTblFieldVals[indx]=cellVal.join("~");var fResult=callParentNew("Evaluate("+obj.attr("name")+","+vRowNo+","+vExp+",vexpr,table)","function");if("T"!=fResult&&"t"!=fResult&&1!=fResult){var cutMsg=eval(callParent("lcm[52]")),firstChar=fResult.substring(0,1),alertMsg=fResult.substring(1);if("_"!=firstChar){if("?"==firstChar){if(showAlertDialog("error",alertMsg),"input"==type)$(obj).val($(obj).val()),$(obj).attr("value",$(obj).val());else{var ddlValue=$j(obj).val();$(obj).hasClass("tblFromSelect")?(ddlValue=null==ddlValue?"":ddlValue,$(obj).append('<option value="'+ddlValue+'" selected="selected">'+ddlValue+"</option>"),$(obj).attr("value",ddlValue)):($j(obj).attr("selected","selected"),$(obj).attr("value",ddlValue))}return!1}if("*"==firstChar)return showAlertDialog("error",alertMsg),!1;if("MessageSetAxFont"==fResult)return!0;if(confirm(fResult+". "+cutMsg)){if("input"==type)$(obj).val($(obj).val()),$(obj).attr("value",$(obj).val());else{var _ddlValue=$j(obj).val();$(obj).hasClass("tblFromSelect")?(_ddlValue=null==_ddlValue?"":_ddlValue,$(obj).append('<option value="'+_ddlValue+'" selected="selected">'+_ddlValue+"</option>"),$(obj).attr("value",_ddlValue)):($j(obj).attr("selected","selected"),$(obj).attr("value",_ddlValue))}return!1}return!0}showAlertDialog("error",alertMsg)}TableEvalonBlur(indx,vRowNo)}else{if("input"==type)$(obj).val($(obj).val()),$(obj).attr("value",$(obj).val());else{var _ddlValue2=$j(obj).val();$(obj).hasClass("tblFromSelect")?(_ddlValue2=null==_ddlValue2?"":_ddlValue2,$(obj).append('<option value="'+_ddlValue2+'" selected="selected">'+_ddlValue2+"</option>"),$(obj).attr("value",_ddlValue2)):($j(obj).attr("selected","selected"),$(obj).attr("value",_ddlValue2))}var vRowNo=obj.attr("id").replace(obj.attr("name")+"R",""),indx=$j.inArray(obj.attr("name"),parent.ChangedTblFields),cellVal=parent.ChangedTblFieldVals[indx].split("~");cellVal[vRowNo]=$(obj).val(),parent.ChangedTblFieldVals[indx]=cellVal.join("~"),TableEvalonBlur(indx,vRowNo)}Aportion(obj)}function TableEvalonBlur(e,t){if("undefined"!=typeof colfExp[e]&&""==colfExp[e])for(var a=e;a<colfExp.length;a++)if("undefined"!=typeof colfExp[a]&&""!=colfExp[a]){var l=colfExp[a].replace(/,/g,"♦"),n=$("#"+colNames[a]+"R"+t),r=$j.inArray(n.attr("name"),parent.ChangedTblFields),s=parent.ChangedTblFieldVals[r].split("~");s[t]=$(n).val(),parent.ChangedTblFieldVals[r]=s.join("~");var i=callParentNew("Evaluate("+n.attr("name")+","+t+","+l+",expr,table)","function");if(""!=i){if("text"==$(n).attr("type"))$(n).val(i),$(n).attr("value",i);else{var o=i;$j(n).attr("selected","selected"),$(n).attr("value",o)}s[t]=i,parent.ChangedTblFieldVals[r]=s.join("~")}}}function UpdateArray(e,t){for(var a=!1,l=0;l<doParentOpInIframe("ChangedFields","rtn").length;l++){if(doParentOpInIframe("ChangedFields["+l+"]","rtn").toString()==e){"***"==t?(doParentOpInIframe("ChangedFields","rtn").splice(l,1),doParentOpInIframe("ChangedFieldDbRowNo","rtn").splice(l,1),doParentOpInIframe("ChangedFieldValues","rtn").splice(l,1),doParentOpInIframe().ChangedFieldOldValues.splice(l,1)):(doParentOpInIframe("ChangedFieldOldValues["+l+"]","var",doParentOpInIframe("ChangedFieldValues["+l+"]","rtn").toString()),doParentOpInIframe("ChangedFieldDbRowNo["+l+"]","var",doParentOpInIframe("ChangedFieldDbRowNo["+l+"]","rtn")),doParentOpInIframe("ChangedFieldValues["+l+"]","var",t)),a=!0;break}}if(!a&&"***"!=t){var n=e.lastIndexOf("F"),r=e.substring(n-3,n),s=e.substring(n+1),i=callParentNew("GetDbRowNo("+r+","+s+")","function");parent.ChangedFields.push(e),parent.ChangedFieldDbRowNo.push(i),parent.ChangedFieldValues.push(t),parent.ChangedFieldOldValues.push("")}}function CheckSpecialCharsInStr(e){return e=(e=e)!=undefined?(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;"):""}function RepSpecialCharsInHTML(e){return e=(e=(e=(e=(e=e.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')}function CheckAll(e){$j("input[name=chkItem]:checkbox").each(function(){$j(this).prop("checked",e.checked)})}function ChkHdrCheckbox(e,t){$j(".fgChk:visible").length==$j(".fgChk:checked").length?$j(".fgHdrChk").prop("checked",!0):$j(".fgHdrChk").prop("checked",!1)}function GetTblFldAutoData(thisId,thisfldId){fldAutoData=[];var custData=callParentNew("AxGetCustSelectFldData("+thisfldId+")","function");if(""!=custData){fldAutoList=thisfldId;var JsonData=JSON.parse(custData),fldData=JsonData.pickdata[3].data,aSearch=[];if($(fldData).each(function(e,t){t.i=t.i.replace(/\^\^dq/g,'"'),aSearch.push(t)}),0!=aSearch.length){var result=$.map(aSearch,function(e){return e.i=e.i.replace(/\^\^dq/g,'"'),{id:""==e.v?e.i:e.v,text:e.i}});fldAutoData=result}else{var cutMsg=eval(callParent("lcm[0]"));fldAutoData={results:"",noResults:cutMsg}}}}function Aportion(e){colNames.indexOf(e.attr("name"));var t=e.attr("name"),a=aportionAgainst.indexOf(t);if(a>-1){var l=colNames[a],n=0;$('[name="'+l+'"]').each(function(){n=parseInt(n)+parseInt(""==$(this).val()?0:$(this).val())});var r=$(e).val();if(""!=r){var s=$(e).parents("tr").find("[name='"+l+"']").val(),i=$(e).parents("tr").find("[name='"+l+"']").attr("id");if(parseInt(r)<=parseInt(s)){$($("#"+i)).val(r),$($("#"+i)).attr("value",r);var o=$(e).parents("tr").next("tr").find("[name='"+l+"']").val(),d=$(e).parents("tr").next("tr").find("[name='"+l+"']").attr("id"),c=0;if($('[name="'+l+'"]').each(function(){c=parseInt(c)+parseInt(""==$(this).val()?0:$(this).val())}),""==o&&parseInt(aportionWhatVal[a])>parseInt(r)){var u=0;u=aportionWhatVal[a]==n?aportionWhatVal[a]-parseInt(c):aportionWhatVal[a]-(n+parseInt(r)),$($("#"+d)).val(u),$($("#"+d)).attr("value",u)}else if(""!=o&&parseInt(aportionWhatVal[a])>parseInt(n));}else if(""!=s&&"0"!=s||parseInt(aportionWhatVal[a])==parseInt(n)){if(""!=s&&""==aportionWhatVal[a])$($("#"+i)).val(r),$($("#"+i)).attr("value",r);else if(parseInt(aportionWhatVal[a])!=parseInt(n)){var p=parseInt(aportionWhatVal[a])-parseInt(n),f=$(e).parents("tr").find("[name='"+l+"']").val();r>=(p+=parseInt(f))?($($("#"+i)).val(p),$($("#"+i)).attr("value",p)):($($("#"+i)).val(r),$($("#"+i)).attr("value",r))}}else $($("#"+i)).val(r),$($("#"+i)).attr("value",r)}}}function SqlFillData(){if("true"==isQuery){var e="";try{$.ajax({url:"tsttable.aspx/GetSqlFillData",type:"POST",cache:!1,async:!0,data:JSON.stringify({tstDId:callParentNew("tstDataId"),fldName:$("#hdnfieldId").val()}),dataType:"json",contentType:"application/json",success:function(t){if(""!=t.d){e=JSON.parse(t.d);for(var a=0;a<e.length;a++){var l=e[a];for(var n in l)for(var r in l[n]){var s=r,i=$($("#"+s+"R"+a));0==i.length&&(AddTableRows("fldTable"),i=$($("#"+s+"R"+a)));var o=l[n][r];if("text"==$(i).attr("type"))$(i).val(o),$(i).attr("value",o);else{var d=o;i.hasClass("tblFromSelect")?(d=null==d?"":d,$(i).append('<option value="'+d+'" selected="selected">'+d+"</option>"),$(i).attr("value",d)):($(i).attr("selected","selected"),$(i).attr("value",d))}}}}else e=""},error:function(t){e=""}})}catch(d){}}else if("sqlDescr"==isQuery&&""!=QueryData){e=JSON.parse(QueryData);for(var t=0;t<e.length;t++){var a=e[t];for(var l in a)for(var n in a[l]){var r=n,s=$($("#"+r+"R"+t));0==s.length&&(AddTableRows("fldTable"),s=$($("#"+r+"R"+t)));var i=a[l][n];if("text"==$(s).attr("type"))$(s).val(i),$(s).attr("value",i);else{var o=i;s.hasClass("tblFromSelect")?(o=null==o?"":o,$(s).append('<option value="'+o+'" selected="selected">'+o+"</option>"),$(s).attr("value",o)):($(s).attr("selected","selected"),$(s).attr("value",o))}}}}}function GetstrTableJson(e){var t="";try{$.ajax({url:"tsttable.aspx/GetstrTableJson",type:"POST",cache:!1,async:!1,data:JSON.stringify({descrName:e,tstDId:callParentNew("tstDataId"),fldName:$("#hdnfieldId").val()}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var a=e.d;QueryData=a.split("♥")[1],""!=(a=a.split("♥")[0])&&(t=a)}else t=""},error:function(e){t=""}})}catch(a){}return t}function GetAutoCompData(e,t,a,l){var n="";if(arrRefreshDcs.length>0)for(var r=0;r<arrRefreshDcs.length;r++){var s=arrRefreshDcs[r].split(":");n=s[1].replace("dc","")+","+s[0].replace("dc","")}t=CheckSpecialCharsInStr(t);var i=callParentNew("GetFieldsDcNo("+e+")","function");AxActiveRowNo=parseInt(callParentNew("GetFieldsRowNo("+e+")","function"),10),AxActiveRowNo=callParentNew("GetDbRowNo("+AxActiveRowNo+","+i+")","function");var o=AxActiveRowNo,d="";""!=AxActivePRow&&""!=AxActivePDc&&(d=AxActivePDc+"♠"+AxActivePRow);return a.toString()+"~"+l.toString()+"~"+i+"~"+o+"~"+d+"~~"+n}function GetDBProcTableJson(e){var t="";try{var a=$("#hdnfieldId").val().substring(0,$("#hdnfieldId").val().lastIndexOf("F")-3),l=callParentNew("GetFieldsRowNo("+$("#hdnfieldId").val()+")","function"),n=callParentNew("GetDcNo("+a+")","function"),r=callParentNew("GetDbRowNo("+l+","+n+")","function");$.ajax({url:"tsttable.aspx/GetDBProcTableJson",type:"POST",cache:!1,async:!1,data:JSON.stringify({procName:e,tstDId:callParentNew("tstDataId"),fldName:$("#hdnfieldId").val(),ChangedFields:parent.ChangedFields,ChangedFieldDbRowNo:parent.ChangedFieldDbRowNo,ChangedFieldValues:parent.ChangedFieldValues,DeletedDCRows:parent.DeletedDCRows,tfldDc:n,tfldRowNo:r}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var a=e.d;QueryData=a.split("♥")[1],""!=(a=a.split("♥")[0])&&(t=a)}else t=""},error:function(e){t=""}})}catch(s){}return t}function GetSourceParamValue(e){var t="",a=void 0===e.parents("tr").attr("id")?"0":e.parents("tr").attr("id"),l=e.attr("name");return $(colNames).each(function(e,n){if(""!=colSource[e]&&l!=n){var r=n+"R"+a;$("#"+r).is("select")&&void 0!==$("#"+r).attr("value")&&""!=$("#"+r).attr("value")?t+=""==t?colSource[e]+":"+$("#"+r).attr("value"):"♠"+colSource[e]+":"+$("#"+r).attr("value"):$("#"+r).is("input")&&"text"==$("#"+r).attr("type")&&""!=$("#"+r).attr("value")&&(t+=""==t?colSource[e]+":"+$("#"+r).attr("value"):"♠"+colSource[e]+":"+$("#"+r).attr("value"))}}),t}