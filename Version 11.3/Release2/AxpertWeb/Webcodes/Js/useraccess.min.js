/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/var isFormDirty=!1,totelements="",dcres="",fldres="",butres="",lvbutres="",tcindex=0;function setAccessValues(){for(i=0;i<totelements;i++)if("checkbox"==document.form1.elements[i].type){var e=document.form1.elements[i].id,t=e.substring(0,e.length-3);if("dcview"==t){var a=document.form1.elements[i].checked,c=document.form1.elements[i].value,l=document.form1.elements[i+1].checked,n=document.form1.elements[i+2].value;dcres=dcres+"<"+c+' cap="'+n+'" view="'+a+'" enable="'+l+'" ></'+c+">",i+=1}else if("fldview"==t){a=document.form1.elements[i].checked;var r=document.form1.elements[i].value,o=(l=document.form1.elements[i+1].checked,document.form1.elements[i+2].value);fldres=fldres+"<"+r+' cap="'+o+'"  view="'+a+'" enable="'+l+'" ></'+r+">",i+=1}else if("butview"==t){a=document.form1.elements[i].checked;var s=document.form1.elements[i].value,d=document.form1.elements[i+1].value;l=document.form1.elements[i+1].checked;butres=butres+"<"+s+' cap="'+d+'" view="'+a+'" enable="'+l+'" ></'+s+">",i+=1}else if("lvbview"==t){a=document.form1.elements[i].checked,s=document.form1.elements[i].value,d=document.form1.elements[i+1].value,l=document.form1.elements[i+1].checked;lvbutres=lvbutres+"<"+s+'  cap="'+d+'" view="'+a+'" enable="'+l+'" ></'+s+">",i+=1}}""!=dcres&&(document.getElementById("dc_xml").value=dcres);""!=fldres&&(document.getElementById("fld_xml").value=fldres);""!=butres&&(document.getElementById("but_xml").value=butres);""!=lvbutres&&(document.getElementById("lv_xml").value=lvbutres)}function checkIfFormChanges(){return isFormDirty=JSON.parse($("#hdnFormChanges").val())}function ConfirmLeave(){if($(".jconfirm").length>0)$(".jconfirm").remove();else var ConfirmSaveCB=$.confirm({theme:"modern",title:eval(callParent("lcm[155]")),rtl:"ar"==callParentNew("gllangType"),onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .hotbtn").focus()},backgroundDismiss:"false",escapeKey:"cancel",content:eval(callParent("lcm[319]")),buttons:{confirm:{text:eval(callParent("lcm[164]")),btnClass:"btn btn-primary btn-sm",action:function(){ConfirmSaveCB.close(),parent.closeModalDialog(),parent.checkIfAnyActionPerformed()}},cancel:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger btn-sm",action:function(){disableBackDrop("destroy"),parent.actionsClicked=""}}}})}function validateTransactionControl(){return fld=$("#tc_fld_cb"),opr=$("#tc_opr_cb"),values=$("#tc_values_cb"),btwnvalues=$("#tc_betvalues_cb"),_thisEmpty(fld)?(showAlertDialog("warning",eval(callParent("lcm[343]"))),fld.focus(),!1):_thisEmpty(opr)?(showAlertDialog("warning",eval(callParent("lcm[344]"))),opr.focus(),!1):_thisEmpty(values)?(showAlertDialog("warning",eval(callParent("lcm[345]"))),values.focus(),!1):!_thisEmpty(opr)&&"Between"==_thisVal(opr)&&_thisEmpty(btwnvalues)?(showAlertDialog("warning",eval(callParent("lcm[345]"))),btwnvalues.focus(),!1):void tcUpdate(transid)}function enableDisableChkboxes(){$.each(["dc","fld","btn","lbtn"],function(e,t){$("[data-"+t+"-view]").on("change",function(e){var a=$(e.target).attr("data-"+t+"-view");$(e.target).is(":checked")||$("[data-"+t+"-enable='"+a+"']").prop("checked",!1)}),$("[data-"+t+"-enable]").on("change",function(e){var a=$(e.target).attr("data-"+t+"-enable");$(e.target).is(":checked")&&$("[data-"+t+"-view='"+a+"']").prop("checked",!0)})})}function closeWindow(){checkIfFormChanges()?ConfirmLeave():parent.closeModalDialog()}function editTransactionControl(index){ShowDimmer(!0),$.ajax({type:"POST",url:"../aspx/UserAccess.aspx/getTCDetails",contentType:"application/json;charset=utf-8",data:'{transid:"'+transid+'", index:"'+index+'"}',dataType:"json",success:function success(data){"SessionExpiry"==data.d?parent.window.location.href="../aspx/sess.aspx":"Error"==data.d?showAlertDialog("warning",eval(callParent("lcm[346]"))):(showTransactionFields(),$("#tc_fld_cb").val(data.d.tc_fld_cb).trigger("change"),$("#tc_opr_cb").val(data.d.tc_opr_cb).trigger("change"),0==$('#tc_values_cb option[value="'.concat(data.d.tc_values_cb,'"]')).length&&$("#tc_values_cb").append('<option value="'.concat(data.d.tc_values_cb,'" data-select2-tag="true">').concat(data.d.tc_values_cb,"</option>")),$("#tc_values_cb").val(data.d.tc_values_cb).trigger("change"),$("#tc_view_cb").prop("checked",data.d.tc_view_cb),$("#tc_edit_cb").prop("checked",data.d.tc_edit_cb),$("#tc_delete_cb").prop("checked",data.d.tc_delete_cb),""!=data.d.tc_betvalues_cb?(0==$('#tc_betvalues_cb option[value="'.concat(data.d.tc_betvalues_cb,'"]')).length&&$("#tc_betvalues_cb").append('<option value="'.concat(data.d.tc_betvalues_cb,'" data-select2-tag="true">').concat(data.d.tc_betvalues_cb,"</option>")),$("#tc_betvalues_cb").removeAttr("disabled").val(data.d.tc_betvalues_cb).trigger("change")):$("#tc_betvalues_cb").attr("disabled","disabled").val("").trigger("change"),actionType="update",tcindex=index),ShowDimmer(!1)},error:function error(response){showAlertDialog("warning",eval(callParent("lcm[342]"))),ShowDimmer(!1)}})}function deleteTransactionControl(index){ShowDimmer(!0),$.ajax({type:"POST",url:"../aspx/UserAccess.aspx/DeleteTC",contentType:"application/json;charset=utf-8",data:'{transid:"'+transid+'", index:"'+index+'"}',dataType:"json",success:function success(data){"SessionExpiry"==data.d?parent.window.location.href="../aspx/sess.aspx":"Error"==data.d?showAlertDialog("warning",eval(callParent("lcm[347]"))):(showAlertDialog("success",eval(callParent("lcm[348]"))),createDataTable(data.d)),ShowDimmer(!1)},error:function error(response){showAlertDialog("warning",eval(callParent("lcm[347]"))),ShowDimmer(!1)}})}function showTransactionExp(){$("#tblTC_wrapper,#tcadd, .dialog-footer").removeClass("d-none"),$("#tc_flds").addClass("d-none")}function showTransactionFields(){$("#tblTC_wrapper,#tcadd, .dialog-footer").addClass("d-none"),$("#tc_flds").removeClass("d-none")}function cancelTransactionControl(){$("#tc_fld_cb, #tc_opr_cb, #tc_values_cb,#tc_betvalues_cb").val("").trigger("change"),showTransactionExp()}function confirmDeleteTransaction(index){if($(".jconfirm").length>0)$(".jconfirm").remove();else var ConfirmSaveCB=$.confirm({theme:"modern",title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .hotbtn").focus()},backgroundDismiss:"false",escapeKey:"cancel",content:"Are you sure, you want to delete this Transaction control?",buttons:{confirm:{text:eval(callParent("lcm[164]")),btnClass:"btn btn-primary btn-sm",action:function(){ConfirmSaveCB.close(),deleteTransactionControl(index)}},cancel:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger btn-sm",action:function(){disableBackDrop("destroy")}}}})}function bindGridData(transid){ShowDimmer(!0),$.ajax({type:"POST",url:"../aspx/UserAccess.aspx/BindGridData",contentType:"application/json;charset=utf-8",data:'{transid:"'+transid+'"}',dataType:"json",success:function success(data){"SessionExpiry"==data.d?parent.window.location.href="../aspx/sess.aspx":"Error"==data.d?showAlertDialog("warning",eval(callParent("lcm[346]"))):createDataTable(data.d),$("#chkSelectAll").prop("checked",!1),ShowDimmer(!1)},error:function error(response){showAlertDialog("warning",eval(callParent("lcm[346]"))),ShowDimmer(!1)}})}$(document).ready(function(){parseAndLoad(),$("#save").prop({value:eval(callParent("lcm[442]")),title:eval(callParent("lcm[442]"))}),$("#btnClose").prop({value:eval(callParent("lcm[192]")),title:eval(callParent("lcm[192]"))}),$("#aViewControl").text(eval(callParent("lcm[333]"))),$("#aTransactionControl").text(eval(callParent("lcm[334]"))),$("#aDCs").text(eval(callParent("lcm[329]"))),$("#aFields").text(eval(callParent("lcm[330]"))),$("#aButtons").text(eval(callParent("lcm[331]"))),$("#aListViewButtons").text(eval(callParent("lcm[332]"))),$("#thDCName").text(eval(callParent("lcm[353]"))),$("#thFieldName").text(eval(callParent("lcm[354]"))),$("#thButtonName,#thLVButtonName").text(eval(callParent("lcm[355]"))),$(".view").text(eval(callParent("lcm[335]"))),$(".enable").text(eval(callParent("lcm[336]"))),$("#lblFieldColumn").text(eval(callParent("lcm[354]"))),$("#lblOperator").text(eval(callParent("lcm[327]"))),$("#lblValues,#lblValuesBtw").text(eval(callParent("lcm[352]"))),$("[for='tc_view_cb']").text(eval(callParent("lcm[335]"))),$("[for='tc_edit_cb']").text(eval(callParent("lcm[168]"))),$("[for='tc_delete_cb']").text(eval(callParent("lcm[248]"))),$("#btnTCOK").prop({value:eval(callParent("lcm[281]")),title:eval(callParent("lcm[281]"))}),$("#btnTCCancel").prop({value:eval(callParent("lcm[192]")),title:eval(callParent("lcm[192]"))}),$("#tcadd").attr("title",eval(callParent("lcm[314]"))),checkSuccessAxpertMsg(),$('#ViewControl input[type="checkbox"]').each(function(e,t){$(t).on("change",function(){$("#hdnFormChanges").val("true")})}),setAccessValues(),totelements=document.form1.elements.length,$("#save").off("click").on("click",function(){return setAccessValues(),$("#tc_flds").hasClass("d-none")?(ShowDimmer(!0),!0):(showAlertDialog("warning",eval(callParent("lcm[341]"))),$("#liTransactionControl, #TransactionControl").addClass("active"),$("#liViewControl,#ViewControl").removeClass("active"),$("#tc_ok").focus(),!1)}),enableDisableChkboxes(),$("#tc_opr_cb").on("change",function(e){"Between"==_thisVal($(e.currentTarget))?$("#tc_betvalues_cb").removeAttr("disabled"):$("#tc_betvalues_cb").attr("disabled","disabled")}),bindGridData(transid),$("#liTransactionControl, #liTransactionControl a").off("click").on("click",function(){$(".dataTables_scrollHeadInner, .gridData").addClass("w-100")}),$("#tcadd").off("click").on("click",function(){$("#tblTC_wrapper,#tcadd").addClass("d-none"),$("#tc_flds").removeClass("d-none"),$("#editmode").val(""),$("#tc_betvalues_cb, #tc_fld_cb, #tc_opr_cb, #tc_values_cb").val("").trigger("change"),$("#tc_betvalues_cb").attr("disabled","disabled"),$("#tc_view_cb,#tc_edit_cb,#tc_delete_cb").prop("checked","checked"),actionType="add",tcindex=0})});var dt="";function createDataTable(data){var rowIndex=0;dt=$("#tblTC").DataTable({data:data,language:{search:"",searchPlaceholder:eval(callParent("lcm[287]")),zeroRecords:eval(callParent("lcm[0]")),info:"",infoEmpty:""},paging:!1,autoWidth:!0,destroy:!0,scrollY:"250px",scrollCollapse:!0,bSort:!1,columns:[{data:"Expression",className:"col-7",title:eval(callParent("lcm[337]"))},{data:"View",className:"col-1",title:eval(callParent("lcm[335]")),render:function(e,t,a,c){return'<input class="w-15px h-15px" type="checkbox" disabled '.concat(e?"checked='true'":"",'  value="').concat($("<div/>").text(e).html(),'"/>')}},{data:"Edit",className:"col-1",title:eval(callParent("lcm[168]")),render:function(e,t,a,c){return'<input class="w-15px h-15px" type="checkbox" disabled '.concat(e?"checked='true'":"",'  value="').concat($("<div/>").text(e).html(),'"/>')}},{data:"Delete",className:"col-1",title:eval(callParent("lcm[248]")),render:function(e,t,a,c){return'<input class="w-15px h-15px" type="checkbox" disabled '.concat(e?"checked='true'":"",'  value="').concat($("<div/>").text(e).html(),'"/>')}},{data:"Expression",className:"col-2",render:function render(data,type,full,meta){return'<div class="d-flex gap-2">\n                        <a href="javascript:void(0);" class="pointer-cursor" onclick="editTransactionControl('.concat(rowIndex,')" title="').concat(eval(callParent("lcm[168]")),'">\n                            <span class="material-icons material-icons-style material-icons-2 text-warning">edit</span>\n                        </a>\n                        <a href="javascript:void(0);" class="pointer-cursor" onclick="confirmDeleteTransaction(').concat(rowIndex++,')" title="').concat(eval(callParent("lcm[248]")),'">\n                            <span class="material-icons material-icons-style material-icons-2 text-danger">delete</span>\n                        </a>\n                    </div>')}}]}),setTimeout(function(){dt.columns.adjust().draw(),$("#tblTC tbody .dataTables_empty").addClass("text-center"),$("#tblTC tbody tr td:not(:first-child)").addClass("text-center"),$("#tblTC_filter").addClass("d-none"),$(".dataTables_scroll .dataTables_scrollBody thead").addClass("d-none"),$(".dataTables_scrollHeadInner .gridData").addClass("mb-0"),$(".dataTables_scrollHeadInner .gridData th").removeAttr("style")},0)}function tcUpdate(transid){tc_view_cb=$("#tc_view_cb").prop("checked"),tc_edit_cb=$("#tc_edit_cb").prop("checked"),tc_delete_cb=$("#tc_delete_cb").prop("checked"),ShowDimmer(!0),$.ajax({type:"POST",url:"../aspx/UserAccess.aspx/tcUpdate",contentType:"application/json;charset=utf-8",data:'{transid:"'.concat(transid,'", tc_betvalues_cb:"').concat(_thisVal($("#tc_betvalues_cb")),'", tc_fld_cb:"').concat(_thisVal($("#tc_fld_cb")),'", tc_opr_cb:"').concat(_thisVal($("#tc_opr_cb")),'", tc_values_cb:"').concat(_thisVal($("#tc_values_cb")),'", tc_view_cb:"').concat(tc_view_cb,'", tc_edit_cb:"').concat(tc_edit_cb,'", tc_delete_cb:"').concat(tc_delete_cb,'", actionType:"').concat(actionType,'" , index:"').concat(tcindex,'"}'),dataType:"json",success:function success(data){"SessionExpiry"==data.d?parent.window.location.href="../aspx/sess.aspx":"Error"==data.d?showAlertDialog("warning",eval(callParent("lcm[342]"))):(showAlertDialog("success",eval(callParent("lcm[338]"))),showTransactionExp(),createDataTable(data.d)),$("#hdnFormChanges").val("true"),ShowDimmer(!1)},error:function error(response){showAlertDialog("warning",eval(callParent("lcm[342]"))),ShowDimmer(!1)}})}function parseAndLoad(){try{if(""!=hdnUsrAccessRes.value){var e=JSON.parse(hdnUsrAccessRes.value);$("#tc_opr_cb").select2({allowClear:!0,placeholder:appGlobalVarsObject.lcm[441]});var t=Object.keys(e.tcfld).map(function(e){return{id:e,text:e}});$("#tc_fld_cb").select2({allowClear:!0,data:t,placeholder:appGlobalVarsObject.lcm[441]}),t.forEach(function(e){return e.id=":".concat(e.id),e.text=":".concat(e.text),e}),$("#tc_values_cb, #tc_betvalues_cb").select2({allowClear:!0,data:t,placeholder:appGlobalVarsObject.lcm[441],tags:!0})}else showAlertDialog("error","No user access details")}catch(a){console.log(a.message)}}function _thisEmpty(e){try{return""==e.val()||0===e.find(":selected").length}catch(t){return!1}}function _thisVal(e){try{return null==e.val()?e.find(":selected").length>0?e.find(":selected").text():"":e.val()}catch(t){return""}}